function aG(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function Vd(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var KN={exports:{}},QE={},JN={exports:{}},pn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xg=Symbol.for("react.element"),lG=Symbol.for("react.portal"),cG=Symbol.for("react.fragment"),uG=Symbol.for("react.strict_mode"),hG=Symbol.for("react.profiler"),fG=Symbol.for("react.provider"),dG=Symbol.for("react.context"),pG=Symbol.for("react.forward_ref"),mG=Symbol.for("react.suspense"),gG=Symbol.for("react.memo"),yG=Symbol.for("react.lazy"),DP=Symbol.iterator;function vG(n){return n===null||typeof n!="object"?null:(n=DP&&n[DP]||n["@@iterator"],typeof n=="function"?n:null)}var YN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qN=Object.assign,QN={};function Gd(n,e,t){this.props=n,this.context=e,this.refs=QN,this.updater=t||YN}Gd.prototype.isReactComponent={};Gd.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Gd.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function ZN(){}ZN.prototype=Gd.prototype;function ZC(n,e,t){this.props=n,this.context=e,this.refs=QN,this.updater=t||YN}var eb=ZC.prototype=new ZN;eb.constructor=ZC;qN(eb,Gd.prototype);eb.isPureReactComponent=!0;var LP=Array.isArray,ek=Object.prototype.hasOwnProperty,tb={current:null},tk={key:!0,ref:!0,__self:!0,__source:!0};function nk(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)ek.call(e,r)&&!tk.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Xg,type:n,key:s,ref:o,props:i,_owner:tb.current}}function _G(n,e){return{$$typeof:Xg,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function nb(n){return typeof n=="object"&&n!==null&&n.$$typeof===Xg}function EG(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var OP=/\/+/g;function a1(n,e){return typeof n=="object"&&n!==null&&n.key!=null?EG(""+n.key):e.toString(36)}function s_(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case Xg:case lG:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+a1(o,0):r,LP(i)?(t="",n!=null&&(t=n.replace(OP,"$&/")+"/"),s_(i,e,t,"",function(c){return c})):i!=null&&(nb(i)&&(i=_G(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(OP,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",LP(n))for(var a=0;a<n.length;a++){s=n[a];var l=r+a1(s,a);o+=s_(s,e,t,l,i)}else if(l=vG(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=r+a1(s,a++),o+=s_(s,e,t,l,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Sv(n,e,t){if(n==null)return n;var r=[],i=0;return s_(n,r,"","",function(s){return e.call(t,s,i++)}),r}function xG(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var rs={current:null},o_={transition:null},AG={ReactCurrentDispatcher:rs,ReactCurrentBatchConfig:o_,ReactCurrentOwner:tb};pn.Children={map:Sv,forEach:function(n,e,t){Sv(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Sv(n,function(){e++}),e},toArray:function(n){return Sv(n,function(e){return e})||[]},only:function(n){if(!nb(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};pn.Component=Gd;pn.Fragment=cG;pn.Profiler=hG;pn.PureComponent=ZC;pn.StrictMode=uG;pn.Suspense=mG;pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AG;pn.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=qN({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=tb.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)ek.call(e,l)&&!tk.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Xg,type:n.type,key:i,ref:s,props:r,_owner:o}};pn.createContext=function(n){return n={$$typeof:dG,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:fG,_context:n},n.Consumer=n};pn.createElement=nk;pn.createFactory=function(n){var e=nk.bind(null,n);return e.type=n,e};pn.createRef=function(){return{current:null}};pn.forwardRef=function(n){return{$$typeof:pG,render:n}};pn.isValidElement=nb;pn.lazy=function(n){return{$$typeof:yG,_payload:{_status:-1,_result:n},_init:xG}};pn.memo=function(n,e){return{$$typeof:gG,type:n,compare:e===void 0?null:e}};pn.startTransition=function(n){var e=o_.transition;o_.transition={};try{n()}finally{o_.transition=e}};pn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};pn.useCallback=function(n,e){return rs.current.useCallback(n,e)};pn.useContext=function(n){return rs.current.useContext(n)};pn.useDebugValue=function(){};pn.useDeferredValue=function(n){return rs.current.useDeferredValue(n)};pn.useEffect=function(n,e){return rs.current.useEffect(n,e)};pn.useId=function(){return rs.current.useId()};pn.useImperativeHandle=function(n,e,t){return rs.current.useImperativeHandle(n,e,t)};pn.useInsertionEffect=function(n,e){return rs.current.useInsertionEffect(n,e)};pn.useLayoutEffect=function(n,e){return rs.current.useLayoutEffect(n,e)};pn.useMemo=function(n,e){return rs.current.useMemo(n,e)};pn.useReducer=function(n,e,t){return rs.current.useReducer(n,e,t)};pn.useRef=function(n){return rs.current.useRef(n)};pn.useState=function(n){return rs.current.useState(n)};pn.useSyncExternalStore=function(n,e,t){return rs.current.useSyncExternalStore(n,e,t)};pn.useTransition=function(){return rs.current.useTransition()};pn.version="18.2.0";JN.exports=pn;var D=JN.exports;const ne=Vd(D),wG=aG({__proto__:null,default:ne},[D]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SG=D,TG=Symbol.for("react.element"),CG=Symbol.for("react.fragment"),bG=Object.prototype.hasOwnProperty,MG=SG.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,RG={key:!0,ref:!0,__self:!0,__source:!0};function rk(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)bG.call(e,r)&&!RG.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:TG,type:n,key:s,ref:o,props:i,_owner:MG.current}}QE.Fragment=CG;QE.jsx=rk;QE.jsxs=rk;KN.exports=QE;var Oe=KN.exports,dS={},ik={exports:{}},Ws={},sk={exports:{}},ok={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(X,ee){var ie=X.length;X.push(ee);e:for(;0<ie;){var fe=ie-1>>>1,me=X[fe];if(0<i(me,ee))X[fe]=ee,X[ie]=me,ie=fe;else break e}}function t(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var ee=X[0],ie=X.pop();if(ie!==ee){X[0]=ie;e:for(var fe=0,me=X.length,he=me>>>1;fe<he;){var Ae=2*(fe+1)-1,De=X[Ae],Ie=Ae+1,He=X[Ie];if(0>i(De,ie))Ie<me&&0>i(He,De)?(X[fe]=He,X[Ie]=ie,fe=Ie):(X[fe]=De,X[Ae]=ie,fe=Ae);else if(Ie<me&&0>i(He,ie))X[fe]=He,X[Ie]=ie,fe=Ie;else break e}}return ee}function i(X,ee){var ie=X.sortIndex-ee.sortIndex;return ie!==0?ie:X.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,f=null,p=3,m=!1,y=!1,A=!1,_=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(X){for(var ee=t(c);ee!==null;){if(ee.callback===null)r(c);else if(ee.startTime<=X)r(c),ee.sortIndex=ee.expirationTime,e(l,ee);else break;ee=t(c)}}function T(X){if(A=!1,x(X),!y)if(t(l)!==null)y=!0,oe(O);else{var ee=t(c);ee!==null&&le(T,ee.startTime-X)}}function O(X,ee){y=!1,A&&(A=!1,g(R),R=-1),m=!0;var ie=p;try{for(x(ee),f=t(l);f!==null&&(!(f.expirationTime>ee)||X&&!B());){var fe=f.callback;if(typeof fe=="function"){f.callback=null,p=f.priorityLevel;var me=fe(f.expirationTime<=ee);ee=n.unstable_now(),typeof me=="function"?f.callback=me:f===t(l)&&r(l),x(ee)}else r(l);f=t(l)}if(f!==null)var he=!0;else{var Ae=t(c);Ae!==null&&le(T,Ae.startTime-ee),he=!1}return he}finally{f=null,p=ie,m=!1}}var I=!1,b=null,R=-1,C=5,M=-1;function B(){return!(n.unstable_now()-M<C)}function F(){if(b!==null){var X=n.unstable_now();M=X;var ee=!0;try{ee=b(!0,X)}finally{ee?z():(I=!1,b=null)}}else I=!1}var z;if(typeof E=="function")z=function(){E(F)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,Y=j.port2;j.port1.onmessage=F,z=function(){Y.postMessage(null)}}else z=function(){_(F,0)};function oe(X){b=X,I||(I=!0,z())}function le(X,ee){R=_(function(){X(n.unstable_now())},ee)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_continueExecution=function(){y||m||(y=!0,oe(O))},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(X){switch(p){case 1:case 2:case 3:var ee=3;break;default:ee=p}var ie=p;p=ee;try{return X()}finally{p=ie}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(X,ee){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var ie=p;p=X;try{return ee()}finally{p=ie}},n.unstable_scheduleCallback=function(X,ee,ie){var fe=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?fe+ie:fe):ie=fe,X){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=ie+me,X={id:u++,callback:ee,priorityLevel:X,startTime:ie,expirationTime:me,sortIndex:-1},ie>fe?(X.sortIndex=ie,e(c,X),t(l)===null&&X===t(c)&&(A?(g(R),R=-1):A=!0,le(T,ie-fe))):(X.sortIndex=me,e(l,X),y||m||(y=!0,oe(O))),X},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(X){var ee=p;return function(){var ie=p;p=ee;try{return X.apply(this,arguments)}finally{p=ie}}}})(ok);sk.exports=ok;var IG=sk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ak=D,Vs=IG;function je(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var lk=new Set,tg={};function Eh(n,e){pd(n,e),pd(n+"Capture",e)}function pd(n,e){for(tg[n]=e,n=0;n<e.length;n++)lk.add(e[n])}var vl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pS=Object.prototype.hasOwnProperty,PG=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,BP={},NP={};function DG(n){return pS.call(NP,n)?!0:pS.call(BP,n)?!1:PG.test(n)?NP[n]=!0:(BP[n]=!0,!1)}function LG(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function OG(n,e,t,r){if(e===null||typeof e>"u"||LG(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function is(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var yi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){yi[n]=new is(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];yi[e]=new is(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){yi[n]=new is(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){yi[n]=new is(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){yi[n]=new is(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){yi[n]=new is(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){yi[n]=new is(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){yi[n]=new is(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){yi[n]=new is(n,5,!1,n.toLowerCase(),null,!1,!1)});var rb=/[\-:]([a-z])/g;function ib(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(rb,ib);yi[e]=new is(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(rb,ib);yi[e]=new is(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(rb,ib);yi[e]=new is(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){yi[n]=new is(n,1,!1,n.toLowerCase(),null,!1,!1)});yi.xlinkHref=new is("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){yi[n]=new is(n,1,!1,n.toLowerCase(),null,!0,!0)});function sb(n,e,t,r){var i=yi.hasOwnProperty(e)?yi[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(OG(e,t,i,r)&&(t=null),r||i===null?DG(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Il=ak.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Tv=Symbol.for("react.element"),Pf=Symbol.for("react.portal"),Df=Symbol.for("react.fragment"),ob=Symbol.for("react.strict_mode"),mS=Symbol.for("react.profiler"),ck=Symbol.for("react.provider"),uk=Symbol.for("react.context"),ab=Symbol.for("react.forward_ref"),gS=Symbol.for("react.suspense"),yS=Symbol.for("react.suspense_list"),lb=Symbol.for("react.memo"),rc=Symbol.for("react.lazy"),hk=Symbol.for("react.offscreen"),kP=Symbol.iterator;function zp(n){return n===null||typeof n!="object"?null:(n=kP&&n[kP]||n["@@iterator"],typeof n=="function"?n:null)}var pr=Object.assign,l1;function xm(n){if(l1===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);l1=e&&e[1]||""}return`
`+l1+n}var c1=!1;function u1(n,e){if(!n||c1)return"";c1=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{c1=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?xm(n):""}function BG(n){switch(n.tag){case 5:return xm(n.type);case 16:return xm("Lazy");case 13:return xm("Suspense");case 19:return xm("SuspenseList");case 0:case 2:case 15:return n=u1(n.type,!1),n;case 11:return n=u1(n.type.render,!1),n;case 1:return n=u1(n.type,!0),n;default:return""}}function vS(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Df:return"Fragment";case Pf:return"Portal";case mS:return"Profiler";case ob:return"StrictMode";case gS:return"Suspense";case yS:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case uk:return(n.displayName||"Context")+".Consumer";case ck:return(n._context.displayName||"Context")+".Provider";case ab:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case lb:return e=n.displayName||null,e!==null?e:vS(n.type)||"Memo";case rc:e=n._payload,n=n._init;try{return vS(n(e))}catch{}}return null}function NG(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vS(e);case 8:return e===ob?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ic(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function fk(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function kG(n){var e=fk(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Cv(n){n._valueTracker||(n._valueTracker=kG(n))}function dk(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=fk(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function F_(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function _S(n,e){var t=e.checked;return pr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function FP(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Ic(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function pk(n,e){e=e.checked,e!=null&&sb(n,"checked",e,!1)}function ES(n,e){pk(n,e);var t=Ic(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?xS(n,e.type,t):e.hasOwnProperty("defaultValue")&&xS(n,e.type,Ic(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function UP(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function xS(n,e,t){(e!=="number"||F_(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Am=Array.isArray;function qf(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Ic(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function AS(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(je(91));return pr({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function zP(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(je(92));if(Am(t)){if(1<t.length)throw Error(je(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Ic(t)}}function mk(n,e){var t=Ic(e.value),r=Ic(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function HP(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function gk(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wS(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?gk(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var bv,yk=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(bv=bv||document.createElement("div"),bv.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bv.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function ng(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Im={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FG=["Webkit","ms","Moz","O"];Object.keys(Im).forEach(function(n){FG.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Im[e]=Im[n]})});function vk(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Im.hasOwnProperty(n)&&Im[n]?(""+e).trim():e+"px"}function _k(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=vk(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var UG=pr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function SS(n,e){if(e){if(UG[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(je(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(je(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(je(61))}if(e.style!=null&&typeof e.style!="object")throw Error(je(62))}}function TS(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var CS=null;function cb(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var bS=null,Qf=null,Zf=null;function VP(n){if(n=Yg(n)){if(typeof bS!="function")throw Error(je(280));var e=n.stateNode;e&&(e=rx(e),bS(n.stateNode,n.type,e))}}function Ek(n){Qf?Zf?Zf.push(n):Zf=[n]:Qf=n}function xk(){if(Qf){var n=Qf,e=Zf;if(Zf=Qf=null,VP(n),e)for(n=0;n<e.length;n++)VP(e[n])}}function Ak(n,e){return n(e)}function wk(){}var h1=!1;function Sk(n,e,t){if(h1)return n(e,t);h1=!0;try{return Ak(n,e,t)}finally{h1=!1,(Qf!==null||Zf!==null)&&(wk(),xk())}}function rg(n,e){var t=n.stateNode;if(t===null)return null;var r=rx(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(je(231,e,typeof t));return t}var MS=!1;if(vl)try{var Hp={};Object.defineProperty(Hp,"passive",{get:function(){MS=!0}}),window.addEventListener("test",Hp,Hp),window.removeEventListener("test",Hp,Hp)}catch{MS=!1}function zG(n,e,t,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var Pm=!1,U_=null,z_=!1,RS=null,HG={onError:function(n){Pm=!0,U_=n}};function VG(n,e,t,r,i,s,o,a,l){Pm=!1,U_=null,zG.apply(HG,arguments)}function GG(n,e,t,r,i,s,o,a,l){if(VG.apply(this,arguments),Pm){if(Pm){var c=U_;Pm=!1,U_=null}else throw Error(je(198));z_||(z_=!0,RS=c)}}function xh(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function Tk(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function GP(n){if(xh(n)!==n)throw Error(je(188))}function WG(n){var e=n.alternate;if(!e){if(e=xh(n),e===null)throw Error(je(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return GP(i),n;if(s===r)return GP(i),e;s=s.sibling}throw Error(je(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o)throw Error(je(189))}}if(t.alternate!==r)throw Error(je(190))}if(t.tag!==3)throw Error(je(188));return t.stateNode.current===t?n:e}function Ck(n){return n=WG(n),n!==null?bk(n):null}function bk(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=bk(n);if(e!==null)return e;n=n.sibling}return null}var Mk=Vs.unstable_scheduleCallback,WP=Vs.unstable_cancelCallback,$G=Vs.unstable_shouldYield,jG=Vs.unstable_requestPaint,Cr=Vs.unstable_now,XG=Vs.unstable_getCurrentPriorityLevel,ub=Vs.unstable_ImmediatePriority,Rk=Vs.unstable_UserBlockingPriority,H_=Vs.unstable_NormalPriority,KG=Vs.unstable_LowPriority,Ik=Vs.unstable_IdlePriority,ZE=null,ya=null;function JG(n){if(ya&&typeof ya.onCommitFiberRoot=="function")try{ya.onCommitFiberRoot(ZE,n,void 0,(n.current.flags&128)===128)}catch{}}var $o=Math.clz32?Math.clz32:QG,YG=Math.log,qG=Math.LN2;function QG(n){return n>>>=0,n===0?32:31-(YG(n)/qG|0)|0}var Mv=64,Rv=4194304;function wm(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function V_(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~i;a!==0?r=wm(a):(s&=o,s!==0&&(r=wm(s)))}else o=t&~i,o!==0?r=wm(o):s!==0&&(r=wm(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-$o(e),i=1<<t,r|=n[t],e&=~i;return r}function ZG(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function e6(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-$o(s),a=1<<o,l=i[o];l===-1?(!(a&t)||a&r)&&(i[o]=ZG(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function IS(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Pk(){var n=Mv;return Mv<<=1,!(Mv&4194240)&&(Mv=64),n}function f1(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Kg(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-$o(e),n[e]=t}function t6(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-$o(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function hb(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-$o(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var Dn=0;function Dk(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var Lk,fb,Ok,Bk,Nk,PS=!1,Iv=[],yc=null,vc=null,_c=null,ig=new Map,sg=new Map,ac=[],n6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $P(n,e){switch(n){case"focusin":case"focusout":yc=null;break;case"dragenter":case"dragleave":vc=null;break;case"mouseover":case"mouseout":_c=null;break;case"pointerover":case"pointerout":ig.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":sg.delete(e.pointerId)}}function Vp(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Yg(e),e!==null&&fb(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function r6(n,e,t,r,i){switch(e){case"focusin":return yc=Vp(yc,n,e,t,r,i),!0;case"dragenter":return vc=Vp(vc,n,e,t,r,i),!0;case"mouseover":return _c=Vp(_c,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return ig.set(s,Vp(ig.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,sg.set(s,Vp(sg.get(s)||null,n,e,t,r,i)),!0}return!1}function kk(n){var e=Lu(n.target);if(e!==null){var t=xh(e);if(t!==null){if(e=t.tag,e===13){if(e=Tk(t),e!==null){n.blockedOn=e,Nk(n.priority,function(){Ok(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function a_(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=DS(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);CS=r,t.target.dispatchEvent(r),CS=null}else return e=Yg(t),e!==null&&fb(e),n.blockedOn=t,!1;e.shift()}return!0}function jP(n,e,t){a_(n)&&t.delete(e)}function i6(){PS=!1,yc!==null&&a_(yc)&&(yc=null),vc!==null&&a_(vc)&&(vc=null),_c!==null&&a_(_c)&&(_c=null),ig.forEach(jP),sg.forEach(jP)}function Gp(n,e){n.blockedOn===e&&(n.blockedOn=null,PS||(PS=!0,Vs.unstable_scheduleCallback(Vs.unstable_NormalPriority,i6)))}function og(n){function e(i){return Gp(i,n)}if(0<Iv.length){Gp(Iv[0],n);for(var t=1;t<Iv.length;t++){var r=Iv[t];r.blockedOn===n&&(r.blockedOn=null)}}for(yc!==null&&Gp(yc,n),vc!==null&&Gp(vc,n),_c!==null&&Gp(_c,n),ig.forEach(e),sg.forEach(e),t=0;t<ac.length;t++)r=ac[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<ac.length&&(t=ac[0],t.blockedOn===null);)kk(t),t.blockedOn===null&&ac.shift()}var ed=Il.ReactCurrentBatchConfig,G_=!0;function s6(n,e,t,r){var i=Dn,s=ed.transition;ed.transition=null;try{Dn=1,db(n,e,t,r)}finally{Dn=i,ed.transition=s}}function o6(n,e,t,r){var i=Dn,s=ed.transition;ed.transition=null;try{Dn=4,db(n,e,t,r)}finally{Dn=i,ed.transition=s}}function db(n,e,t,r){if(G_){var i=DS(n,e,t,r);if(i===null)A1(n,e,r,W_,t),$P(n,r);else if(r6(i,n,e,t,r))r.stopPropagation();else if($P(n,r),e&4&&-1<n6.indexOf(n)){for(;i!==null;){var s=Yg(i);if(s!==null&&Lk(s),s=DS(n,e,t,r),s===null&&A1(n,e,r,W_,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else A1(n,e,r,null,t)}}var W_=null;function DS(n,e,t,r){if(W_=null,n=cb(r),n=Lu(n),n!==null)if(e=xh(n),e===null)n=null;else if(t=e.tag,t===13){if(n=Tk(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return W_=n,null}function Fk(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(XG()){case ub:return 1;case Rk:return 4;case H_:case KG:return 16;case Ik:return 536870912;default:return 16}default:return 16}}var pc=null,pb=null,l_=null;function Uk(){if(l_)return l_;var n,e=pb,t=e.length,r,i="value"in pc?pc.value:pc.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return l_=i.slice(n,1<r?1-r:void 0)}function c_(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Pv(){return!0}function XP(){return!1}function $s(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Pv:XP,this.isPropagationStopped=XP,this}return pr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Pv)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Pv)},persist:function(){},isPersistent:Pv}),e}var Wd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mb=$s(Wd),Jg=pr({},Wd,{view:0,detail:0}),a6=$s(Jg),d1,p1,Wp,ex=pr({},Jg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gb,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Wp&&(Wp&&n.type==="mousemove"?(d1=n.screenX-Wp.screenX,p1=n.screenY-Wp.screenY):p1=d1=0,Wp=n),d1)},movementY:function(n){return"movementY"in n?n.movementY:p1}}),KP=$s(ex),l6=pr({},ex,{dataTransfer:0}),c6=$s(l6),u6=pr({},Jg,{relatedTarget:0}),m1=$s(u6),h6=pr({},Wd,{animationName:0,elapsedTime:0,pseudoElement:0}),f6=$s(h6),d6=pr({},Wd,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),p6=$s(d6),m6=pr({},Wd,{data:0}),JP=$s(m6),g6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},y6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},v6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _6(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=v6[n])?!!e[n]:!1}function gb(){return _6}var E6=pr({},Jg,{key:function(n){if(n.key){var e=g6[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=c_(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?y6[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gb,charCode:function(n){return n.type==="keypress"?c_(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?c_(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),x6=$s(E6),A6=pr({},ex,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),YP=$s(A6),w6=pr({},Jg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gb}),S6=$s(w6),T6=pr({},Wd,{propertyName:0,elapsedTime:0,pseudoElement:0}),C6=$s(T6),b6=pr({},ex,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),M6=$s(b6),R6=[9,13,27,32],yb=vl&&"CompositionEvent"in window,Dm=null;vl&&"documentMode"in document&&(Dm=document.documentMode);var I6=vl&&"TextEvent"in window&&!Dm,zk=vl&&(!yb||Dm&&8<Dm&&11>=Dm),qP=" ",QP=!1;function Hk(n,e){switch(n){case"keyup":return R6.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vk(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Lf=!1;function P6(n,e){switch(n){case"compositionend":return Vk(e);case"keypress":return e.which!==32?null:(QP=!0,qP);case"textInput":return n=e.data,n===qP&&QP?null:n;default:return null}}function D6(n,e){if(Lf)return n==="compositionend"||!yb&&Hk(n,e)?(n=Uk(),l_=pb=pc=null,Lf=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zk&&e.locale!=="ko"?null:e.data;default:return null}}var L6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ZP(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!L6[n.type]:e==="textarea"}function Gk(n,e,t,r){Ek(r),e=$_(e,"onChange"),0<e.length&&(t=new mb("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Lm=null,ag=null;function O6(n){e3(n,0)}function tx(n){var e=Nf(n);if(dk(e))return n}function B6(n,e){if(n==="change")return e}var Wk=!1;if(vl){var g1;if(vl){var y1="oninput"in document;if(!y1){var e2=document.createElement("div");e2.setAttribute("oninput","return;"),y1=typeof e2.oninput=="function"}g1=y1}else g1=!1;Wk=g1&&(!document.documentMode||9<document.documentMode)}function t2(){Lm&&(Lm.detachEvent("onpropertychange",$k),ag=Lm=null)}function $k(n){if(n.propertyName==="value"&&tx(ag)){var e=[];Gk(e,ag,n,cb(n)),Sk(O6,e)}}function N6(n,e,t){n==="focusin"?(t2(),Lm=e,ag=t,Lm.attachEvent("onpropertychange",$k)):n==="focusout"&&t2()}function k6(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return tx(ag)}function F6(n,e){if(n==="click")return tx(e)}function U6(n,e){if(n==="input"||n==="change")return tx(e)}function z6(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Xo=typeof Object.is=="function"?Object.is:z6;function lg(n,e){if(Xo(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!pS.call(e,i)||!Xo(n[i],e[i]))return!1}return!0}function n2(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function r2(n,e){var t=n2(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=n2(t)}}function jk(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?jk(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Xk(){for(var n=window,e=F_();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=F_(n.document)}return e}function vb(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function H6(n){var e=Xk(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&jk(t.ownerDocument.documentElement,t)){if(r!==null&&vb(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=r2(t,s);var o=r2(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var V6=vl&&"documentMode"in document&&11>=document.documentMode,Of=null,LS=null,Om=null,OS=!1;function i2(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;OS||Of==null||Of!==F_(r)||(r=Of,"selectionStart"in r&&vb(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Om&&lg(Om,r)||(Om=r,r=$_(LS,"onSelect"),0<r.length&&(e=new mb("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Of)))}function Dv(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Bf={animationend:Dv("Animation","AnimationEnd"),animationiteration:Dv("Animation","AnimationIteration"),animationstart:Dv("Animation","AnimationStart"),transitionend:Dv("Transition","TransitionEnd")},v1={},Kk={};vl&&(Kk=document.createElement("div").style,"AnimationEvent"in window||(delete Bf.animationend.animation,delete Bf.animationiteration.animation,delete Bf.animationstart.animation),"TransitionEvent"in window||delete Bf.transitionend.transition);function nx(n){if(v1[n])return v1[n];if(!Bf[n])return n;var e=Bf[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Kk)return v1[n]=e[t];return n}var Jk=nx("animationend"),Yk=nx("animationiteration"),qk=nx("animationstart"),Qk=nx("transitionend"),Zk=new Map,s2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $c(n,e){Zk.set(n,e),Eh(e,[n])}for(var _1=0;_1<s2.length;_1++){var E1=s2[_1],G6=E1.toLowerCase(),W6=E1[0].toUpperCase()+E1.slice(1);$c(G6,"on"+W6)}$c(Jk,"onAnimationEnd");$c(Yk,"onAnimationIteration");$c(qk,"onAnimationStart");$c("dblclick","onDoubleClick");$c("focusin","onFocus");$c("focusout","onBlur");$c(Qk,"onTransitionEnd");pd("onMouseEnter",["mouseout","mouseover"]);pd("onMouseLeave",["mouseout","mouseover"]);pd("onPointerEnter",["pointerout","pointerover"]);pd("onPointerLeave",["pointerout","pointerover"]);Eh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Eh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Eh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Eh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Eh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Eh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$6=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sm));function o2(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,GG(r,e,void 0,n),n.currentTarget=null}function e3(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;o2(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;o2(i,a,c),s=l}}}if(z_)throw n=RS,z_=!1,RS=null,n}function Kn(n,e){var t=e[US];t===void 0&&(t=e[US]=new Set);var r=n+"__bubble";t.has(r)||(t3(e,n,2,!1),t.add(r))}function x1(n,e,t){var r=0;e&&(r|=4),t3(t,n,r,e)}var Lv="_reactListening"+Math.random().toString(36).slice(2);function cg(n){if(!n[Lv]){n[Lv]=!0,lk.forEach(function(t){t!=="selectionchange"&&($6.has(t)||x1(t,!1,n),x1(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Lv]||(e[Lv]=!0,x1("selectionchange",!1,e))}}function t3(n,e,t,r){switch(Fk(e)){case 1:var i=s6;break;case 4:i=o6;break;default:i=db}t=i.bind(null,e,t,n),i=void 0,!MS||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function A1(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Lu(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Sk(function(){var c=s,u=cb(t),f=[];e:{var p=Zk.get(n);if(p!==void 0){var m=mb,y=n;switch(n){case"keypress":if(c_(t)===0)break e;case"keydown":case"keyup":m=x6;break;case"focusin":y="focus",m=m1;break;case"focusout":y="blur",m=m1;break;case"beforeblur":case"afterblur":m=m1;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=KP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=c6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=S6;break;case Jk:case Yk:case qk:m=f6;break;case Qk:m=C6;break;case"scroll":m=a6;break;case"wheel":m=M6;break;case"copy":case"cut":case"paste":m=p6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=YP}var A=(e&4)!==0,_=!A&&n==="scroll",g=A?p!==null?p+"Capture":null:p;A=[];for(var E=c,x;E!==null;){x=E;var T=x.stateNode;if(x.tag===5&&T!==null&&(x=T,g!==null&&(T=rg(E,g),T!=null&&A.push(ug(E,T,x)))),_)break;E=E.return}0<A.length&&(p=new m(p,y,null,t,u),f.push({event:p,listeners:A}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",p&&t!==CS&&(y=t.relatedTarget||t.fromElement)&&(Lu(y)||y[_l]))break e;if((m||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,m?(y=t.relatedTarget||t.toElement,m=c,y=y?Lu(y):null,y!==null&&(_=xh(y),y!==_||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=c),m!==y)){if(A=KP,T="onMouseLeave",g="onMouseEnter",E="mouse",(n==="pointerout"||n==="pointerover")&&(A=YP,T="onPointerLeave",g="onPointerEnter",E="pointer"),_=m==null?p:Nf(m),x=y==null?p:Nf(y),p=new A(T,E+"leave",m,t,u),p.target=_,p.relatedTarget=x,T=null,Lu(u)===c&&(A=new A(g,E+"enter",y,t,u),A.target=x,A.relatedTarget=_,T=A),_=T,m&&y)t:{for(A=m,g=y,E=0,x=A;x;x=Jh(x))E++;for(x=0,T=g;T;T=Jh(T))x++;for(;0<E-x;)A=Jh(A),E--;for(;0<x-E;)g=Jh(g),x--;for(;E--;){if(A===g||g!==null&&A===g.alternate)break t;A=Jh(A),g=Jh(g)}A=null}else A=null;m!==null&&a2(f,p,m,A,!1),y!==null&&_!==null&&a2(f,_,y,A,!0)}}e:{if(p=c?Nf(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var O=B6;else if(ZP(p))if(Wk)O=U6;else{O=k6;var I=N6}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(O=F6);if(O&&(O=O(n,c))){Gk(f,O,t,u);break e}I&&I(n,p,c),n==="focusout"&&(I=p._wrapperState)&&I.controlled&&p.type==="number"&&xS(p,"number",p.value)}switch(I=c?Nf(c):window,n){case"focusin":(ZP(I)||I.contentEditable==="true")&&(Of=I,LS=c,Om=null);break;case"focusout":Om=LS=Of=null;break;case"mousedown":OS=!0;break;case"contextmenu":case"mouseup":case"dragend":OS=!1,i2(f,t,u);break;case"selectionchange":if(V6)break;case"keydown":case"keyup":i2(f,t,u)}var b;if(yb)e:{switch(n){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Lf?Hk(n,t)&&(R="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(R="onCompositionStart");R&&(zk&&t.locale!=="ko"&&(Lf||R!=="onCompositionStart"?R==="onCompositionEnd"&&Lf&&(b=Uk()):(pc=u,pb="value"in pc?pc.value:pc.textContent,Lf=!0)),I=$_(c,R),0<I.length&&(R=new JP(R,n,null,t,u),f.push({event:R,listeners:I}),b?R.data=b:(b=Vk(t),b!==null&&(R.data=b)))),(b=I6?P6(n,t):D6(n,t))&&(c=$_(c,"onBeforeInput"),0<c.length&&(u=new JP("onBeforeInput","beforeinput",null,t,u),f.push({event:u,listeners:c}),u.data=b))}e3(f,e)})}function ug(n,e,t){return{instance:n,listener:e,currentTarget:t}}function $_(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=rg(n,t),s!=null&&r.unshift(ug(n,s,i)),s=rg(n,e),s!=null&&r.push(ug(n,s,i))),n=n.return}return r}function Jh(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function a2(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=rg(t,s),l!=null&&o.unshift(ug(t,l,a))):i||(l=rg(t,s),l!=null&&o.push(ug(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var j6=/\r\n?/g,X6=/\u0000|\uFFFD/g;function l2(n){return(typeof n=="string"?n:""+n).replace(j6,`
`).replace(X6,"")}function Ov(n,e,t){if(e=l2(e),l2(n)!==e&&t)throw Error(je(425))}function j_(){}var BS=null,NS=null;function kS(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var FS=typeof setTimeout=="function"?setTimeout:void 0,K6=typeof clearTimeout=="function"?clearTimeout:void 0,c2=typeof Promise=="function"?Promise:void 0,J6=typeof queueMicrotask=="function"?queueMicrotask:typeof c2<"u"?function(n){return c2.resolve(null).then(n).catch(Y6)}:FS;function Y6(n){setTimeout(function(){throw n})}function w1(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),og(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);og(e)}function Ec(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function u2(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var $d=Math.random().toString(36).slice(2),ga="__reactFiber$"+$d,hg="__reactProps$"+$d,_l="__reactContainer$"+$d,US="__reactEvents$"+$d,q6="__reactListeners$"+$d,Q6="__reactHandles$"+$d;function Lu(n){var e=n[ga];if(e)return e;for(var t=n.parentNode;t;){if(e=t[_l]||t[ga]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=u2(n);n!==null;){if(t=n[ga])return t;n=u2(n)}return e}n=t,t=n.parentNode}return null}function Yg(n){return n=n[ga]||n[_l],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Nf(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(je(33))}function rx(n){return n[hg]||null}var zS=[],kf=-1;function jc(n){return{current:n}}function qn(n){0>kf||(n.current=zS[kf],zS[kf]=null,kf--)}function $n(n,e){kf++,zS[kf]=n.current,n.current=e}var Pc={},Ui=jc(Pc),vs=jc(!1),nh=Pc;function md(n,e){var t=n.type.contextTypes;if(!t)return Pc;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function _s(n){return n=n.childContextTypes,n!=null}function X_(){qn(vs),qn(Ui)}function h2(n,e,t){if(Ui.current!==Pc)throw Error(je(168));$n(Ui,e),$n(vs,t)}function n3(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(je(108,NG(n)||"Unknown",i));return pr({},t,r)}function K_(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Pc,nh=Ui.current,$n(Ui,n),$n(vs,vs.current),!0}function f2(n,e,t){var r=n.stateNode;if(!r)throw Error(je(169));t?(n=n3(n,e,nh),r.__reactInternalMemoizedMergedChildContext=n,qn(vs),qn(Ui),$n(Ui,n)):qn(vs),$n(vs,t)}var Za=null,ix=!1,S1=!1;function r3(n){Za===null?Za=[n]:Za.push(n)}function Z6(n){ix=!0,r3(n)}function Xc(){if(!S1&&Za!==null){S1=!0;var n=0,e=Dn;try{var t=Za;for(Dn=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Za=null,ix=!1}catch(i){throw Za!==null&&(Za=Za.slice(n+1)),Mk(ub,Xc),i}finally{Dn=e,S1=!1}}return null}var Ff=[],Uf=0,J_=null,Y_=0,ao=[],lo=0,rh=null,rl=1,il="";function bu(n,e){Ff[Uf++]=Y_,Ff[Uf++]=J_,J_=n,Y_=e}function i3(n,e,t){ao[lo++]=rl,ao[lo++]=il,ao[lo++]=rh,rh=n;var r=rl;n=il;var i=32-$o(r)-1;r&=~(1<<i),t+=1;var s=32-$o(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,rl=1<<32-$o(e)+i|t<<i|r,il=s+n}else rl=1<<s|t<<i|r,il=n}function _b(n){n.return!==null&&(bu(n,1),i3(n,1,0))}function Eb(n){for(;n===J_;)J_=Ff[--Uf],Ff[Uf]=null,Y_=Ff[--Uf],Ff[Uf]=null;for(;n===rh;)rh=ao[--lo],ao[lo]=null,il=ao[--lo],ao[lo]=null,rl=ao[--lo],ao[lo]=null}var Fs=null,Ns=null,nr=!1,ko=null;function s3(n,e){var t=fo(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function d2(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Fs=n,Ns=Ec(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Fs=n,Ns=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=rh!==null?{id:rl,overflow:il}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=fo(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Fs=n,Ns=null,!0):!1;default:return!1}}function HS(n){return(n.mode&1)!==0&&(n.flags&128)===0}function VS(n){if(nr){var e=Ns;if(e){var t=e;if(!d2(n,e)){if(HS(n))throw Error(je(418));e=Ec(t.nextSibling);var r=Fs;e&&d2(n,e)?s3(r,t):(n.flags=n.flags&-4097|2,nr=!1,Fs=n)}}else{if(HS(n))throw Error(je(418));n.flags=n.flags&-4097|2,nr=!1,Fs=n}}}function p2(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Fs=n}function Bv(n){if(n!==Fs)return!1;if(!nr)return p2(n),nr=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!kS(n.type,n.memoizedProps)),e&&(e=Ns)){if(HS(n))throw o3(),Error(je(418));for(;e;)s3(n,e),e=Ec(e.nextSibling)}if(p2(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(je(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Ns=Ec(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Ns=null}}else Ns=Fs?Ec(n.stateNode.nextSibling):null;return!0}function o3(){for(var n=Ns;n;)n=Ec(n.nextSibling)}function gd(){Ns=Fs=null,nr=!1}function xb(n){ko===null?ko=[n]:ko.push(n)}var e8=Il.ReactCurrentBatchConfig;function Oo(n,e){if(n&&n.defaultProps){e=pr({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var q_=jc(null),Q_=null,zf=null,Ab=null;function wb(){Ab=zf=Q_=null}function Sb(n){var e=q_.current;qn(q_),n._currentValue=e}function GS(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function td(n,e){Q_=n,Ab=zf=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(gs=!0),n.firstContext=null)}function vo(n){var e=n._currentValue;if(Ab!==n)if(n={context:n,memoizedValue:e,next:null},zf===null){if(Q_===null)throw Error(je(308));zf=n,Q_.dependencies={lanes:0,firstContext:n}}else zf=zf.next=n;return e}var Ou=null;function Tb(n){Ou===null?Ou=[n]:Ou.push(n)}function a3(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,Tb(e)):(t.next=i.next,i.next=t),e.interleaved=t,El(n,r)}function El(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var ic=!1;function Cb(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function l3(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ul(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function xc(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,xn&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,El(n,t)}return i=r.interleaved,i===null?(e.next=e,Tb(r)):(e.next=i.next,i.next=e),r.interleaved=e,El(n,t)}function u_(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,hb(n,t)}}function m2(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Z_(n,e,t,r){var i=n.updateQueue;ic=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=n.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,u=c=l=null,a=s;do{var p=a.lane,m=a.eventTime;if((r&p)===p){u!==null&&(u=u.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=n,A=a;switch(p=e,m=t,A.tag){case 1:if(y=A.payload,typeof y=="function"){f=y.call(m,f,p);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=A.payload,p=typeof y=="function"?y.call(m,f,p):y,p==null)break e;f=pr({},f,p);break e;case 2:ic=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,p=i.effects,p===null?i.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=m,l=f):u=u.next=m,o|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;p=a,a=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(u===null&&(l=f),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);sh|=o,n.lanes=o,n.memoizedState=f}}function g2(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(je(191,i));i.call(r)}}}var c3=new ak.Component().refs;function WS(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:pr({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var sx={isMounted:function(n){return(n=n._reactInternals)?xh(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=es(),i=wc(n),s=ul(r,i);s.payload=e,t!=null&&(s.callback=t),e=xc(n,s,i),e!==null&&(jo(e,n,i,r),u_(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=es(),i=wc(n),s=ul(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=xc(n,s,i),e!==null&&(jo(e,n,i,r),u_(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=es(),r=wc(n),i=ul(t,r);i.tag=2,e!=null&&(i.callback=e),e=xc(n,i,r),e!==null&&(jo(e,n,r,t),u_(e,n,r))}};function y2(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!lg(t,r)||!lg(i,s):!0}function u3(n,e,t){var r=!1,i=Pc,s=e.contextType;return typeof s=="object"&&s!==null?s=vo(s):(i=_s(e)?nh:Ui.current,r=e.contextTypes,s=(r=r!=null)?md(n,i):Pc),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=sx,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function v2(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&sx.enqueueReplaceState(e,e.state,null)}function $S(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs=c3,Cb(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=vo(s):(s=_s(e)?nh:Ui.current,i.context=md(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(WS(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&sx.enqueueReplaceState(i,i.state,null),Z_(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function $p(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(je(309));var r=t.stateNode}if(!r)throw Error(je(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===c3&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(je(284));if(!t._owner)throw Error(je(290,n))}return n}function Nv(n,e){throw n=Object.prototype.toString.call(e),Error(je(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function _2(n){var e=n._init;return e(n._payload)}function h3(n){function e(g,E){if(n){var x=g.deletions;x===null?(g.deletions=[E],g.flags|=16):x.push(E)}}function t(g,E){if(!n)return null;for(;E!==null;)e(g,E),E=E.sibling;return null}function r(g,E){for(g=new Map;E!==null;)E.key!==null?g.set(E.key,E):g.set(E.index,E),E=E.sibling;return g}function i(g,E){return g=Sc(g,E),g.index=0,g.sibling=null,g}function s(g,E,x){return g.index=x,n?(x=g.alternate,x!==null?(x=x.index,x<E?(g.flags|=2,E):x):(g.flags|=2,E)):(g.flags|=1048576,E)}function o(g){return n&&g.alternate===null&&(g.flags|=2),g}function a(g,E,x,T){return E===null||E.tag!==6?(E=P1(x,g.mode,T),E.return=g,E):(E=i(E,x),E.return=g,E)}function l(g,E,x,T){var O=x.type;return O===Df?u(g,E,x.props.children,T,x.key):E!==null&&(E.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===rc&&_2(O)===E.type)?(T=i(E,x.props),T.ref=$p(g,E,x),T.return=g,T):(T=g_(x.type,x.key,x.props,null,g.mode,T),T.ref=$p(g,E,x),T.return=g,T)}function c(g,E,x,T){return E===null||E.tag!==4||E.stateNode.containerInfo!==x.containerInfo||E.stateNode.implementation!==x.implementation?(E=D1(x,g.mode,T),E.return=g,E):(E=i(E,x.children||[]),E.return=g,E)}function u(g,E,x,T,O){return E===null||E.tag!==7?(E=ju(x,g.mode,T,O),E.return=g,E):(E=i(E,x),E.return=g,E)}function f(g,E,x){if(typeof E=="string"&&E!==""||typeof E=="number")return E=P1(""+E,g.mode,x),E.return=g,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Tv:return x=g_(E.type,E.key,E.props,null,g.mode,x),x.ref=$p(g,null,E),x.return=g,x;case Pf:return E=D1(E,g.mode,x),E.return=g,E;case rc:var T=E._init;return f(g,T(E._payload),x)}if(Am(E)||zp(E))return E=ju(E,g.mode,x,null),E.return=g,E;Nv(g,E)}return null}function p(g,E,x,T){var O=E!==null?E.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return O!==null?null:a(g,E,""+x,T);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Tv:return x.key===O?l(g,E,x,T):null;case Pf:return x.key===O?c(g,E,x,T):null;case rc:return O=x._init,p(g,E,O(x._payload),T)}if(Am(x)||zp(x))return O!==null?null:u(g,E,x,T,null);Nv(g,x)}return null}function m(g,E,x,T,O){if(typeof T=="string"&&T!==""||typeof T=="number")return g=g.get(x)||null,a(E,g,""+T,O);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Tv:return g=g.get(T.key===null?x:T.key)||null,l(E,g,T,O);case Pf:return g=g.get(T.key===null?x:T.key)||null,c(E,g,T,O);case rc:var I=T._init;return m(g,E,x,I(T._payload),O)}if(Am(T)||zp(T))return g=g.get(x)||null,u(E,g,T,O,null);Nv(E,T)}return null}function y(g,E,x,T){for(var O=null,I=null,b=E,R=E=0,C=null;b!==null&&R<x.length;R++){b.index>R?(C=b,b=null):C=b.sibling;var M=p(g,b,x[R],T);if(M===null){b===null&&(b=C);break}n&&b&&M.alternate===null&&e(g,b),E=s(M,E,R),I===null?O=M:I.sibling=M,I=M,b=C}if(R===x.length)return t(g,b),nr&&bu(g,R),O;if(b===null){for(;R<x.length;R++)b=f(g,x[R],T),b!==null&&(E=s(b,E,R),I===null?O=b:I.sibling=b,I=b);return nr&&bu(g,R),O}for(b=r(g,b);R<x.length;R++)C=m(b,g,R,x[R],T),C!==null&&(n&&C.alternate!==null&&b.delete(C.key===null?R:C.key),E=s(C,E,R),I===null?O=C:I.sibling=C,I=C);return n&&b.forEach(function(B){return e(g,B)}),nr&&bu(g,R),O}function A(g,E,x,T){var O=zp(x);if(typeof O!="function")throw Error(je(150));if(x=O.call(x),x==null)throw Error(je(151));for(var I=O=null,b=E,R=E=0,C=null,M=x.next();b!==null&&!M.done;R++,M=x.next()){b.index>R?(C=b,b=null):C=b.sibling;var B=p(g,b,M.value,T);if(B===null){b===null&&(b=C);break}n&&b&&B.alternate===null&&e(g,b),E=s(B,E,R),I===null?O=B:I.sibling=B,I=B,b=C}if(M.done)return t(g,b),nr&&bu(g,R),O;if(b===null){for(;!M.done;R++,M=x.next())M=f(g,M.value,T),M!==null&&(E=s(M,E,R),I===null?O=M:I.sibling=M,I=M);return nr&&bu(g,R),O}for(b=r(g,b);!M.done;R++,M=x.next())M=m(b,g,R,M.value,T),M!==null&&(n&&M.alternate!==null&&b.delete(M.key===null?R:M.key),E=s(M,E,R),I===null?O=M:I.sibling=M,I=M);return n&&b.forEach(function(F){return e(g,F)}),nr&&bu(g,R),O}function _(g,E,x,T){if(typeof x=="object"&&x!==null&&x.type===Df&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Tv:e:{for(var O=x.key,I=E;I!==null;){if(I.key===O){if(O=x.type,O===Df){if(I.tag===7){t(g,I.sibling),E=i(I,x.props.children),E.return=g,g=E;break e}}else if(I.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===rc&&_2(O)===I.type){t(g,I.sibling),E=i(I,x.props),E.ref=$p(g,I,x),E.return=g,g=E;break e}t(g,I);break}else e(g,I);I=I.sibling}x.type===Df?(E=ju(x.props.children,g.mode,T,x.key),E.return=g,g=E):(T=g_(x.type,x.key,x.props,null,g.mode,T),T.ref=$p(g,E,x),T.return=g,g=T)}return o(g);case Pf:e:{for(I=x.key;E!==null;){if(E.key===I)if(E.tag===4&&E.stateNode.containerInfo===x.containerInfo&&E.stateNode.implementation===x.implementation){t(g,E.sibling),E=i(E,x.children||[]),E.return=g,g=E;break e}else{t(g,E);break}else e(g,E);E=E.sibling}E=D1(x,g.mode,T),E.return=g,g=E}return o(g);case rc:return I=x._init,_(g,E,I(x._payload),T)}if(Am(x))return y(g,E,x,T);if(zp(x))return A(g,E,x,T);Nv(g,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,E!==null&&E.tag===6?(t(g,E.sibling),E=i(E,x),E.return=g,g=E):(t(g,E),E=P1(x,g.mode,T),E.return=g,g=E),o(g)):t(g,E)}return _}var yd=h3(!0),f3=h3(!1),qg={},va=jc(qg),fg=jc(qg),dg=jc(qg);function Bu(n){if(n===qg)throw Error(je(174));return n}function bb(n,e){switch($n(dg,e),$n(fg,n),$n(va,qg),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:wS(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=wS(e,n)}qn(va),$n(va,e)}function vd(){qn(va),qn(fg),qn(dg)}function d3(n){Bu(dg.current);var e=Bu(va.current),t=wS(e,n.type);e!==t&&($n(fg,n),$n(va,t))}function Mb(n){fg.current===n&&(qn(va),qn(fg))}var ur=jc(0);function eE(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var T1=[];function Rb(){for(var n=0;n<T1.length;n++)T1[n]._workInProgressVersionPrimary=null;T1.length=0}var h_=Il.ReactCurrentDispatcher,C1=Il.ReactCurrentBatchConfig,ih=0,dr=null,zr=null,Qr=null,tE=!1,Bm=!1,pg=0,t8=0;function bi(){throw Error(je(321))}function Ib(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Xo(n[t],e[t]))return!1;return!0}function Pb(n,e,t,r,i,s){if(ih=s,dr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,h_.current=n===null||n.memoizedState===null?s8:o8,n=t(r,i),Bm){s=0;do{if(Bm=!1,pg=0,25<=s)throw Error(je(301));s+=1,Qr=zr=null,e.updateQueue=null,h_.current=a8,n=t(r,i)}while(Bm)}if(h_.current=nE,e=zr!==null&&zr.next!==null,ih=0,Qr=zr=dr=null,tE=!1,e)throw Error(je(300));return n}function Db(){var n=pg!==0;return pg=0,n}function pa(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qr===null?dr.memoizedState=Qr=n:Qr=Qr.next=n,Qr}function _o(){if(zr===null){var n=dr.alternate;n=n!==null?n.memoizedState:null}else n=zr.next;var e=Qr===null?dr.memoizedState:Qr.next;if(e!==null)Qr=e,zr=n;else{if(n===null)throw Error(je(310));zr=n,n={memoizedState:zr.memoizedState,baseState:zr.baseState,baseQueue:zr.baseQueue,queue:zr.queue,next:null},Qr===null?dr.memoizedState=Qr=n:Qr=Qr.next=n}return Qr}function mg(n,e){return typeof e=="function"?e(n):e}function b1(n){var e=_o(),t=e.queue;if(t===null)throw Error(je(311));t.lastRenderedReducer=n;var r=zr,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((ih&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,dr.lanes|=u,sh|=u}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,Xo(r,e.memoizedState)||(gs=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,dr.lanes|=s,sh|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function M1(n){var e=_o(),t=e.queue;if(t===null)throw Error(je(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);Xo(s,e.memoizedState)||(gs=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function p3(){}function m3(n,e){var t=dr,r=_o(),i=e(),s=!Xo(r.memoizedState,i);if(s&&(r.memoizedState=i,gs=!0),r=r.queue,Lb(v3.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||Qr!==null&&Qr.memoizedState.tag&1){if(t.flags|=2048,gg(9,y3.bind(null,t,r,i,e),void 0,null),ti===null)throw Error(je(349));ih&30||g3(t,e,i)}return i}function g3(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=dr.updateQueue,e===null?(e={lastEffect:null,stores:null},dr.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function y3(n,e,t,r){e.value=t,e.getSnapshot=r,_3(e)&&E3(n)}function v3(n,e,t){return t(function(){_3(e)&&E3(n)})}function _3(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Xo(n,t)}catch{return!0}}function E3(n){var e=El(n,1);e!==null&&jo(e,n,1,-1)}function E2(n){var e=pa();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mg,lastRenderedState:n},e.queue=n,n=n.dispatch=i8.bind(null,dr,n),[e.memoizedState,n]}function gg(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=dr.updateQueue,e===null?(e={lastEffect:null,stores:null},dr.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function x3(){return _o().memoizedState}function f_(n,e,t,r){var i=pa();dr.flags|=n,i.memoizedState=gg(1|e,t,void 0,r===void 0?null:r)}function ox(n,e,t,r){var i=_o();r=r===void 0?null:r;var s=void 0;if(zr!==null){var o=zr.memoizedState;if(s=o.destroy,r!==null&&Ib(r,o.deps)){i.memoizedState=gg(e,t,s,r);return}}dr.flags|=n,i.memoizedState=gg(1|e,t,s,r)}function x2(n,e){return f_(8390656,8,n,e)}function Lb(n,e){return ox(2048,8,n,e)}function A3(n,e){return ox(4,2,n,e)}function w3(n,e){return ox(4,4,n,e)}function S3(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function T3(n,e,t){return t=t!=null?t.concat([n]):null,ox(4,4,S3.bind(null,e,n),t)}function Ob(){}function C3(n,e){var t=_o();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Ib(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function b3(n,e){var t=_o();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Ib(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function M3(n,e,t){return ih&21?(Xo(t,e)||(t=Pk(),dr.lanes|=t,sh|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,gs=!0),n.memoizedState=t)}function n8(n,e){var t=Dn;Dn=t!==0&&4>t?t:4,n(!0);var r=C1.transition;C1.transition={};try{n(!1),e()}finally{Dn=t,C1.transition=r}}function R3(){return _o().memoizedState}function r8(n,e,t){var r=wc(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},I3(n))P3(e,t);else if(t=a3(n,e,t,r),t!==null){var i=es();jo(t,n,r,i),D3(t,e,r)}}function i8(n,e,t){var r=wc(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(I3(n))P3(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(i.hasEagerState=!0,i.eagerState=a,Xo(a,o)){var l=e.interleaved;l===null?(i.next=i,Tb(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=a3(n,e,i,r),t!==null&&(i=es(),jo(t,n,r,i),D3(t,e,r))}}function I3(n){var e=n.alternate;return n===dr||e!==null&&e===dr}function P3(n,e){Bm=tE=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function D3(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,hb(n,t)}}var nE={readContext:vo,useCallback:bi,useContext:bi,useEffect:bi,useImperativeHandle:bi,useInsertionEffect:bi,useLayoutEffect:bi,useMemo:bi,useReducer:bi,useRef:bi,useState:bi,useDebugValue:bi,useDeferredValue:bi,useTransition:bi,useMutableSource:bi,useSyncExternalStore:bi,useId:bi,unstable_isNewReconciler:!1},s8={readContext:vo,useCallback:function(n,e){return pa().memoizedState=[n,e===void 0?null:e],n},useContext:vo,useEffect:x2,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,f_(4194308,4,S3.bind(null,e,n),t)},useLayoutEffect:function(n,e){return f_(4194308,4,n,e)},useInsertionEffect:function(n,e){return f_(4,2,n,e)},useMemo:function(n,e){var t=pa();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=pa();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=r8.bind(null,dr,n),[r.memoizedState,n]},useRef:function(n){var e=pa();return n={current:n},e.memoizedState=n},useState:E2,useDebugValue:Ob,useDeferredValue:function(n){return pa().memoizedState=n},useTransition:function(){var n=E2(!1),e=n[0];return n=n8.bind(null,n[1]),pa().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=dr,i=pa();if(nr){if(t===void 0)throw Error(je(407));t=t()}else{if(t=e(),ti===null)throw Error(je(349));ih&30||g3(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,x2(v3.bind(null,r,s,n),[n]),r.flags|=2048,gg(9,y3.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=pa(),e=ti.identifierPrefix;if(nr){var t=il,r=rl;t=(r&~(1<<32-$o(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=pg++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=t8++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},o8={readContext:vo,useCallback:C3,useContext:vo,useEffect:Lb,useImperativeHandle:T3,useInsertionEffect:A3,useLayoutEffect:w3,useMemo:b3,useReducer:b1,useRef:x3,useState:function(){return b1(mg)},useDebugValue:Ob,useDeferredValue:function(n){var e=_o();return M3(e,zr.memoizedState,n)},useTransition:function(){var n=b1(mg)[0],e=_o().memoizedState;return[n,e]},useMutableSource:p3,useSyncExternalStore:m3,useId:R3,unstable_isNewReconciler:!1},a8={readContext:vo,useCallback:C3,useContext:vo,useEffect:Lb,useImperativeHandle:T3,useInsertionEffect:A3,useLayoutEffect:w3,useMemo:b3,useReducer:M1,useRef:x3,useState:function(){return M1(mg)},useDebugValue:Ob,useDeferredValue:function(n){var e=_o();return zr===null?e.memoizedState=n:M3(e,zr.memoizedState,n)},useTransition:function(){var n=M1(mg)[0],e=_o().memoizedState;return[n,e]},useMutableSource:p3,useSyncExternalStore:m3,useId:R3,unstable_isNewReconciler:!1};function _d(n,e){try{var t="",r=e;do t+=BG(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function R1(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function jS(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var l8=typeof WeakMap=="function"?WeakMap:Map;function L3(n,e,t){t=ul(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){iE||(iE=!0,nT=r),jS(n,e)},t}function O3(n,e,t){t=ul(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){jS(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){jS(n,e),typeof r!="function"&&(Ac===null?Ac=new Set([this]):Ac.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function A2(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new l8;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=A8.bind(null,n,e,t),e.then(n,n))}function w2(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function S2(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=ul(-1,1),e.tag=2,xc(t,e,1))),t.lanes|=1),n)}var c8=Il.ReactCurrentOwner,gs=!1;function Yi(n,e,t,r){e.child=n===null?f3(e,null,t,r):yd(e,n.child,t,r)}function T2(n,e,t,r,i){t=t.render;var s=e.ref;return td(e,i),r=Pb(n,e,t,r,s,i),t=Db(),n!==null&&!gs?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,xl(n,e,i)):(nr&&t&&_b(e),e.flags|=1,Yi(n,e,r,i),e.child)}function C2(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!Vb(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,B3(n,e,s,r,i)):(n=g_(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:lg,t(o,r)&&n.ref===e.ref)return xl(n,e,i)}return e.flags|=1,n=Sc(s,r),n.ref=e.ref,n.return=e,e.child=n}function B3(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(lg(s,r)&&n.ref===e.ref)if(gs=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(gs=!0);else return e.lanes=n.lanes,xl(n,e,i)}return XS(n,e,t,r,i)}function N3(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},$n(Vf,Ps),Ps|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,$n(Vf,Ps),Ps|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,$n(Vf,Ps),Ps|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,$n(Vf,Ps),Ps|=r;return Yi(n,e,i,t),e.child}function k3(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function XS(n,e,t,r,i){var s=_s(t)?nh:Ui.current;return s=md(e,s),td(e,i),t=Pb(n,e,t,r,s,i),r=Db(),n!==null&&!gs?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,xl(n,e,i)):(nr&&r&&_b(e),e.flags|=1,Yi(n,e,t,i),e.child)}function b2(n,e,t,r,i){if(_s(t)){var s=!0;K_(e)}else s=!1;if(td(e,i),e.stateNode===null)d_(n,e),u3(e,t,r),$S(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=vo(c):(c=_s(t)?nh:Ui.current,c=md(e,c));var u=t.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&v2(e,o,r,c),ic=!1;var p=e.memoizedState;o.state=p,Z_(e,r,o,i),l=e.memoizedState,a!==r||p!==l||vs.current||ic?(typeof u=="function"&&(WS(e,t,u,r),l=e.memoizedState),(a=ic||y2(e,t,a,r,p,l,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,l3(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:Oo(e.type,a),o.props=c,f=e.pendingProps,p=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=vo(l):(l=_s(t)?nh:Ui.current,l=md(e,l));var m=t.getDerivedStateFromProps;(u=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||p!==l)&&v2(e,o,r,l),ic=!1,p=e.memoizedState,o.state=p,Z_(e,r,o,i);var y=e.memoizedState;a!==f||p!==y||vs.current||ic?(typeof m=="function"&&(WS(e,t,m,r),y=e.memoizedState),(c=ic||y2(e,t,c,r,p,y,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),o.props=r,o.state=y,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),r=!1)}return KS(n,e,t,r,s,i)}function KS(n,e,t,r,i,s){k3(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&f2(e,t,!1),xl(n,e,s);r=e.stateNode,c8.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=yd(e,n.child,null,s),e.child=yd(e,null,a,s)):Yi(n,e,a,s),e.memoizedState=r.state,i&&f2(e,t,!0),e.child}function F3(n){var e=n.stateNode;e.pendingContext?h2(n,e.pendingContext,e.pendingContext!==e.context):e.context&&h2(n,e.context,!1),bb(n,e.containerInfo)}function M2(n,e,t,r,i){return gd(),xb(i),e.flags|=256,Yi(n,e,t,r),e.child}var JS={dehydrated:null,treeContext:null,retryLane:0};function YS(n){return{baseLanes:n,cachePool:null,transitions:null}}function U3(n,e,t){var r=e.pendingProps,i=ur.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),$n(ur,i&1),n===null)return VS(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=cx(o,r,0,null),n=ju(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=YS(t),e.memoizedState=JS,n):Bb(e,o));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return u8(n,e,o,r,a,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Sc(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Sc(a,s):(s=ju(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?YS(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=JS,r}return s=n.child,n=s.sibling,r=Sc(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Bb(n,e){return e=cx({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function kv(n,e,t,r){return r!==null&&xb(r),yd(e,n.child,null,t),n=Bb(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function u8(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=R1(Error(je(422))),kv(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=cx({mode:"visible",children:r.children},i,0,null),s=ju(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&yd(e,n.child,null,o),e.child.memoizedState=YS(o),e.memoizedState=JS,s);if(!(e.mode&1))return kv(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(je(419)),r=R1(s,r,void 0),kv(n,e,o,r)}if(a=(o&n.childLanes)!==0,gs||a){if(r=ti,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,El(n,i),jo(r,n,i,-1))}return Hb(),r=R1(Error(je(421))),kv(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=w8.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,Ns=Ec(i.nextSibling),Fs=e,nr=!0,ko=null,n!==null&&(ao[lo++]=rl,ao[lo++]=il,ao[lo++]=rh,rl=n.id,il=n.overflow,rh=e),e=Bb(e,r.children),e.flags|=4096,e)}function R2(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),GS(n.return,e,t)}function I1(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function z3(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Yi(n,e,r.children,t),r=ur.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&R2(n,t,e);else if(n.tag===19)R2(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if($n(ur,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&eE(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),I1(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&eE(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}I1(e,!0,t,null,s);break;case"together":I1(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function d_(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function xl(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),sh|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(je(153));if(e.child!==null){for(n=e.child,t=Sc(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Sc(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function h8(n,e,t){switch(e.tag){case 3:F3(e),gd();break;case 5:d3(e);break;case 1:_s(e.type)&&K_(e);break;case 4:bb(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;$n(q_,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?($n(ur,ur.current&1),e.flags|=128,null):t&e.child.childLanes?U3(n,e,t):($n(ur,ur.current&1),n=xl(n,e,t),n!==null?n.sibling:null);$n(ur,ur.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return z3(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),$n(ur,ur.current),r)break;return null;case 22:case 23:return e.lanes=0,N3(n,e,t)}return xl(n,e,t)}var H3,qS,V3,G3;H3=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};qS=function(){};V3=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Bu(va.current);var s=null;switch(t){case"input":i=_S(n,i),r=_S(n,r),s=[];break;case"select":i=pr({},i,{value:void 0}),r=pr({},r,{value:void 0}),s=[];break;case"textarea":i=AS(n,i),r=AS(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=j_)}SS(t,r);var o;t=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(tg.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(tg.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Kn("scroll",n),s||a===l||(s=[])):(s=s||[]).push(c,l))}t&&(s=s||[]).push("style",t);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};G3=function(n,e,t,r){t!==r&&(e.flags|=4)};function jp(n,e){if(!nr)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Mi(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function f8(n,e,t){var r=e.pendingProps;switch(Eb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mi(e),null;case 1:return _s(e.type)&&X_(),Mi(e),null;case 3:return r=e.stateNode,vd(),qn(vs),qn(Ui),Rb(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Bv(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ko!==null&&(sT(ko),ko=null))),qS(n,e),Mi(e),null;case 5:Mb(e);var i=Bu(dg.current);if(t=e.type,n!==null&&e.stateNode!=null)V3(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(je(166));return Mi(e),null}if(n=Bu(va.current),Bv(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[ga]=e,r[hg]=s,n=(e.mode&1)!==0,t){case"dialog":Kn("cancel",r),Kn("close",r);break;case"iframe":case"object":case"embed":Kn("load",r);break;case"video":case"audio":for(i=0;i<Sm.length;i++)Kn(Sm[i],r);break;case"source":Kn("error",r);break;case"img":case"image":case"link":Kn("error",r),Kn("load",r);break;case"details":Kn("toggle",r);break;case"input":FP(r,s),Kn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Kn("invalid",r);break;case"textarea":zP(r,s),Kn("invalid",r)}SS(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Ov(r.textContent,a,n),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Ov(r.textContent,a,n),i=["children",""+a]):tg.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Kn("scroll",r)}switch(t){case"input":Cv(r),UP(r,s,!0);break;case"textarea":Cv(r),HP(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=j_)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=gk(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[ga]=e,n[hg]=r,H3(n,e,!1,!1),e.stateNode=n;e:{switch(o=TS(t,r),t){case"dialog":Kn("cancel",n),Kn("close",n),i=r;break;case"iframe":case"object":case"embed":Kn("load",n),i=r;break;case"video":case"audio":for(i=0;i<Sm.length;i++)Kn(Sm[i],n);i=r;break;case"source":Kn("error",n),i=r;break;case"img":case"image":case"link":Kn("error",n),Kn("load",n),i=r;break;case"details":Kn("toggle",n),i=r;break;case"input":FP(n,r),i=_S(n,r),Kn("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=pr({},r,{value:void 0}),Kn("invalid",n);break;case"textarea":zP(n,r),i=AS(n,r),Kn("invalid",n);break;default:i=r}SS(t,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?_k(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&yk(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&ng(n,l):typeof l=="number"&&ng(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(tg.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Kn("scroll",n):l!=null&&sb(n,s,l,o))}switch(t){case"input":Cv(n),UP(n,r,!1);break;case"textarea":Cv(n),HP(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Ic(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?qf(n,!!r.multiple,s,!1):r.defaultValue!=null&&qf(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=j_)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Mi(e),null;case 6:if(n&&e.stateNode!=null)G3(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(je(166));if(t=Bu(dg.current),Bu(va.current),Bv(e)){if(r=e.stateNode,t=e.memoizedProps,r[ga]=e,(s=r.nodeValue!==t)&&(n=Fs,n!==null))switch(n.tag){case 3:Ov(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Ov(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[ga]=e,e.stateNode=r}return Mi(e),null;case 13:if(qn(ur),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(nr&&Ns!==null&&e.mode&1&&!(e.flags&128))o3(),gd(),e.flags|=98560,s=!1;else if(s=Bv(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(je(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(je(317));s[ga]=e}else gd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Mi(e),s=!1}else ko!==null&&(sT(ko),ko=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||ur.current&1?Vr===0&&(Vr=3):Hb())),e.updateQueue!==null&&(e.flags|=4),Mi(e),null);case 4:return vd(),qS(n,e),n===null&&cg(e.stateNode.containerInfo),Mi(e),null;case 10:return Sb(e.type._context),Mi(e),null;case 17:return _s(e.type)&&X_(),Mi(e),null;case 19:if(qn(ur),s=e.memoizedState,s===null)return Mi(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)jp(s,!1);else{if(Vr!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=eE(n),o!==null){for(e.flags|=128,jp(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return $n(ur,ur.current&1|2),e.child}n=n.sibling}s.tail!==null&&Cr()>Ed&&(e.flags|=128,r=!0,jp(s,!1),e.lanes=4194304)}else{if(!r)if(n=eE(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),jp(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!nr)return Mi(e),null}else 2*Cr()-s.renderingStartTime>Ed&&t!==1073741824&&(e.flags|=128,r=!0,jp(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Cr(),e.sibling=null,t=ur.current,$n(ur,r?t&1|2:t&1),e):(Mi(e),null);case 22:case 23:return zb(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ps&1073741824&&(Mi(e),e.subtreeFlags&6&&(e.flags|=8192)):Mi(e),null;case 24:return null;case 25:return null}throw Error(je(156,e.tag))}function d8(n,e){switch(Eb(e),e.tag){case 1:return _s(e.type)&&X_(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return vd(),qn(vs),qn(Ui),Rb(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Mb(e),null;case 13:if(qn(ur),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(je(340));gd()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return qn(ur),null;case 4:return vd(),null;case 10:return Sb(e.type._context),null;case 22:case 23:return zb(),null;case 24:return null;default:return null}}var Fv=!1,Oi=!1,p8=typeof WeakSet=="function"?WeakSet:Set,dt=null;function Hf(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){yr(n,e,r)}else t.current=null}function QS(n,e,t){try{t()}catch(r){yr(n,e,r)}}var I2=!1;function m8(n,e){if(BS=G_,n=Xk(),vb(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,c=0,u=0,f=n,p=null;t:for(;;){for(var m;f!==t||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===n)break t;if(p===t&&++c===i&&(a=o),p===s&&++u===r&&(l=o),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(NS={focusedElem:n,selectionRange:t},G_=!1,dt=e;dt!==null;)if(e=dt,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,dt=n;else for(;dt!==null;){e=dt;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var A=y.memoizedProps,_=y.memoizedState,g=e.stateNode,E=g.getSnapshotBeforeUpdate(e.elementType===e.type?A:Oo(e.type,A),_);g.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(je(163))}}catch(T){yr(e,e.return,T)}if(n=e.sibling,n!==null){n.return=e.return,dt=n;break}dt=e.return}return y=I2,I2=!1,y}function Nm(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&QS(e,t,s)}i=i.next}while(i!==r)}}function ax(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function ZS(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function W3(n){var e=n.alternate;e!==null&&(n.alternate=null,W3(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[ga],delete e[hg],delete e[US],delete e[q6],delete e[Q6])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function $3(n){return n.tag===5||n.tag===3||n.tag===4}function P2(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||$3(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function eT(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=j_));else if(r!==4&&(n=n.child,n!==null))for(eT(n,e,t),n=n.sibling;n!==null;)eT(n,e,t),n=n.sibling}function tT(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(tT(n,e,t),n=n.sibling;n!==null;)tT(n,e,t),n=n.sibling}var ai=null,No=!1;function Wl(n,e,t){for(t=t.child;t!==null;)j3(n,e,t),t=t.sibling}function j3(n,e,t){if(ya&&typeof ya.onCommitFiberUnmount=="function")try{ya.onCommitFiberUnmount(ZE,t)}catch{}switch(t.tag){case 5:Oi||Hf(t,e);case 6:var r=ai,i=No;ai=null,Wl(n,e,t),ai=r,No=i,ai!==null&&(No?(n=ai,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):ai.removeChild(t.stateNode));break;case 18:ai!==null&&(No?(n=ai,t=t.stateNode,n.nodeType===8?w1(n.parentNode,t):n.nodeType===1&&w1(n,t),og(n)):w1(ai,t.stateNode));break;case 4:r=ai,i=No,ai=t.stateNode.containerInfo,No=!0,Wl(n,e,t),ai=r,No=i;break;case 0:case 11:case 14:case 15:if(!Oi&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&QS(t,e,o),i=i.next}while(i!==r)}Wl(n,e,t);break;case 1:if(!Oi&&(Hf(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){yr(t,e,a)}Wl(n,e,t);break;case 21:Wl(n,e,t);break;case 22:t.mode&1?(Oi=(r=Oi)||t.memoizedState!==null,Wl(n,e,t),Oi=r):Wl(n,e,t);break;default:Wl(n,e,t)}}function D2(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new p8),e.forEach(function(r){var i=S8.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Mo(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:ai=a.stateNode,No=!1;break e;case 3:ai=a.stateNode.containerInfo,No=!0;break e;case 4:ai=a.stateNode.containerInfo,No=!0;break e}a=a.return}if(ai===null)throw Error(je(160));j3(s,o,i),ai=null,No=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){yr(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)X3(e,n),e=e.sibling}function X3(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Mo(e,n),ua(n),r&4){try{Nm(3,n,n.return),ax(3,n)}catch(A){yr(n,n.return,A)}try{Nm(5,n,n.return)}catch(A){yr(n,n.return,A)}}break;case 1:Mo(e,n),ua(n),r&512&&t!==null&&Hf(t,t.return);break;case 5:if(Mo(e,n),ua(n),r&512&&t!==null&&Hf(t,t.return),n.flags&32){var i=n.stateNode;try{ng(i,"")}catch(A){yr(n,n.return,A)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&pk(i,s),TS(a,o);var c=TS(a,s);for(o=0;o<l.length;o+=2){var u=l[o],f=l[o+1];u==="style"?_k(i,f):u==="dangerouslySetInnerHTML"?yk(i,f):u==="children"?ng(i,f):sb(i,u,f,c)}switch(a){case"input":ES(i,s);break;case"textarea":mk(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?qf(i,!!s.multiple,m,!1):p!==!!s.multiple&&(s.defaultValue!=null?qf(i,!!s.multiple,s.defaultValue,!0):qf(i,!!s.multiple,s.multiple?[]:"",!1))}i[hg]=s}catch(A){yr(n,n.return,A)}}break;case 6:if(Mo(e,n),ua(n),r&4){if(n.stateNode===null)throw Error(je(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(A){yr(n,n.return,A)}}break;case 3:if(Mo(e,n),ua(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{og(e.containerInfo)}catch(A){yr(n,n.return,A)}break;case 4:Mo(e,n),ua(n);break;case 13:Mo(e,n),ua(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Fb=Cr())),r&4&&D2(n);break;case 22:if(u=t!==null&&t.memoizedState!==null,n.mode&1?(Oi=(c=Oi)||u,Mo(e,n),Oi=c):Mo(e,n),ua(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!u&&n.mode&1)for(dt=n,u=n.child;u!==null;){for(f=dt=u;dt!==null;){switch(p=dt,m=p.child,p.tag){case 0:case 11:case 14:case 15:Nm(4,p,p.return);break;case 1:Hf(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){r=p,t=p.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(A){yr(r,t,A)}}break;case 5:Hf(p,p.return);break;case 22:if(p.memoizedState!==null){O2(f);continue}}m!==null?(m.return=p,dt=m):O2(f)}u=u.sibling}e:for(u=null,f=n;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=vk("display",o))}catch(A){yr(n,n.return,A)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(A){yr(n,n.return,A)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Mo(e,n),ua(n),r&4&&D2(n);break;case 21:break;default:Mo(e,n),ua(n)}}function ua(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if($3(t)){var r=t;break e}t=t.return}throw Error(je(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ng(i,""),r.flags&=-33);var s=P2(n);tT(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=P2(n);eT(n,a,o);break;default:throw Error(je(161))}}catch(l){yr(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function g8(n,e,t){dt=n,K3(n)}function K3(n,e,t){for(var r=(n.mode&1)!==0;dt!==null;){var i=dt,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Fv;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Oi;a=Fv;var c=Oi;if(Fv=o,(Oi=l)&&!c)for(dt=i;dt!==null;)o=dt,l=o.child,o.tag===22&&o.memoizedState!==null?B2(i):l!==null?(l.return=o,dt=l):B2(i);for(;s!==null;)dt=s,K3(s),s=s.sibling;dt=i,Fv=a,Oi=c}L2(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,dt=s):L2(n)}}function L2(n){for(;dt!==null;){var e=dt;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Oi||ax(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Oi)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Oo(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&g2(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}g2(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&og(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(je(163))}Oi||e.flags&512&&ZS(e)}catch(p){yr(e,e.return,p)}}if(e===n){dt=null;break}if(t=e.sibling,t!==null){t.return=e.return,dt=t;break}dt=e.return}}function O2(n){for(;dt!==null;){var e=dt;if(e===n){dt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,dt=t;break}dt=e.return}}function B2(n){for(;dt!==null;){var e=dt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{ax(4,e)}catch(l){yr(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){yr(e,i,l)}}var s=e.return;try{ZS(e)}catch(l){yr(e,s,l)}break;case 5:var o=e.return;try{ZS(e)}catch(l){yr(e,o,l)}}}catch(l){yr(e,e.return,l)}if(e===n){dt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,dt=a;break}dt=e.return}}var y8=Math.ceil,rE=Il.ReactCurrentDispatcher,Nb=Il.ReactCurrentOwner,mo=Il.ReactCurrentBatchConfig,xn=0,ti=null,Br=null,di=0,Ps=0,Vf=jc(0),Vr=0,yg=null,sh=0,lx=0,kb=0,km=null,ds=null,Fb=0,Ed=1/0,Qa=null,iE=!1,nT=null,Ac=null,Uv=!1,mc=null,sE=0,Fm=0,rT=null,p_=-1,m_=0;function es(){return xn&6?Cr():p_!==-1?p_:p_=Cr()}function wc(n){return n.mode&1?xn&2&&di!==0?di&-di:e8.transition!==null?(m_===0&&(m_=Pk()),m_):(n=Dn,n!==0||(n=window.event,n=n===void 0?16:Fk(n.type)),n):1}function jo(n,e,t,r){if(50<Fm)throw Fm=0,rT=null,Error(je(185));Kg(n,t,r),(!(xn&2)||n!==ti)&&(n===ti&&(!(xn&2)&&(lx|=t),Vr===4&&lc(n,di)),Es(n,r),t===1&&xn===0&&!(e.mode&1)&&(Ed=Cr()+500,ix&&Xc()))}function Es(n,e){var t=n.callbackNode;e6(n,e);var r=V_(n,n===ti?di:0);if(r===0)t!==null&&WP(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&WP(t),e===1)n.tag===0?Z6(N2.bind(null,n)):r3(N2.bind(null,n)),J6(function(){!(xn&6)&&Xc()}),t=null;else{switch(Dk(r)){case 1:t=ub;break;case 4:t=Rk;break;case 16:t=H_;break;case 536870912:t=Ik;break;default:t=H_}t=nF(t,J3.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function J3(n,e){if(p_=-1,m_=0,xn&6)throw Error(je(327));var t=n.callbackNode;if(nd()&&n.callbackNode!==t)return null;var r=V_(n,n===ti?di:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=oE(n,r);else{e=r;var i=xn;xn|=2;var s=q3();(ti!==n||di!==e)&&(Qa=null,Ed=Cr()+500,$u(n,e));do try{E8();break}catch(a){Y3(n,a)}while(!0);wb(),rE.current=s,xn=i,Br!==null?e=0:(ti=null,di=0,e=Vr)}if(e!==0){if(e===2&&(i=IS(n),i!==0&&(r=i,e=iT(n,i))),e===1)throw t=yg,$u(n,0),lc(n,r),Es(n,Cr()),t;if(e===6)lc(n,r);else{if(i=n.current.alternate,!(r&30)&&!v8(i)&&(e=oE(n,r),e===2&&(s=IS(n),s!==0&&(r=s,e=iT(n,s))),e===1))throw t=yg,$u(n,0),lc(n,r),Es(n,Cr()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(je(345));case 2:Mu(n,ds,Qa);break;case 3:if(lc(n,r),(r&130023424)===r&&(e=Fb+500-Cr(),10<e)){if(V_(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){es(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=FS(Mu.bind(null,n,ds,Qa),e);break}Mu(n,ds,Qa);break;case 4:if(lc(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-$o(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Cr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*y8(r/1960))-r,10<r){n.timeoutHandle=FS(Mu.bind(null,n,ds,Qa),r);break}Mu(n,ds,Qa);break;case 5:Mu(n,ds,Qa);break;default:throw Error(je(329))}}}return Es(n,Cr()),n.callbackNode===t?J3.bind(null,n):null}function iT(n,e){var t=km;return n.current.memoizedState.isDehydrated&&($u(n,e).flags|=256),n=oE(n,e),n!==2&&(e=ds,ds=t,e!==null&&sT(e)),n}function sT(n){ds===null?ds=n:ds.push.apply(ds,n)}function v8(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!Xo(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function lc(n,e){for(e&=~kb,e&=~lx,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-$o(e),r=1<<t;n[t]=-1,e&=~r}}function N2(n){if(xn&6)throw Error(je(327));nd();var e=V_(n,0);if(!(e&1))return Es(n,Cr()),null;var t=oE(n,e);if(n.tag!==0&&t===2){var r=IS(n);r!==0&&(e=r,t=iT(n,r))}if(t===1)throw t=yg,$u(n,0),lc(n,e),Es(n,Cr()),t;if(t===6)throw Error(je(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Mu(n,ds,Qa),Es(n,Cr()),null}function Ub(n,e){var t=xn;xn|=1;try{return n(e)}finally{xn=t,xn===0&&(Ed=Cr()+500,ix&&Xc())}}function oh(n){mc!==null&&mc.tag===0&&!(xn&6)&&nd();var e=xn;xn|=1;var t=mo.transition,r=Dn;try{if(mo.transition=null,Dn=1,n)return n()}finally{Dn=r,mo.transition=t,xn=e,!(xn&6)&&Xc()}}function zb(){Ps=Vf.current,qn(Vf)}function $u(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,K6(t)),Br!==null)for(t=Br.return;t!==null;){var r=t;switch(Eb(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&X_();break;case 3:vd(),qn(vs),qn(Ui),Rb();break;case 5:Mb(r);break;case 4:vd();break;case 13:qn(ur);break;case 19:qn(ur);break;case 10:Sb(r.type._context);break;case 22:case 23:zb()}t=t.return}if(ti=n,Br=n=Sc(n.current,null),di=Ps=e,Vr=0,yg=null,kb=lx=sh=0,ds=km=null,Ou!==null){for(e=0;e<Ou.length;e++)if(t=Ou[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}Ou=null}return n}function Y3(n,e){do{var t=Br;try{if(wb(),h_.current=nE,tE){for(var r=dr.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}tE=!1}if(ih=0,Qr=zr=dr=null,Bm=!1,pg=0,Nb.current=null,t===null||t.return===null){Vr=1,yg=e,Br=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=di,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=w2(o);if(m!==null){m.flags&=-257,S2(m,o,a,s,e),m.mode&1&&A2(s,c,e),e=m,l=c;var y=e.updateQueue;if(y===null){var A=new Set;A.add(l),e.updateQueue=A}else y.add(l);break e}else{if(!(e&1)){A2(s,c,e),Hb();break e}l=Error(je(426))}}else if(nr&&a.mode&1){var _=w2(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),S2(_,o,a,s,e),xb(_d(l,a));break e}}s=l=_d(l,a),Vr!==4&&(Vr=2),km===null?km=[s]:km.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=L3(s,l,e);m2(s,g);break e;case 1:a=l;var E=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof E.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ac===null||!Ac.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var T=O3(s,a,e);m2(s,T);break e}}s=s.return}while(s!==null)}Z3(t)}catch(O){e=O,Br===t&&t!==null&&(Br=t=t.return);continue}break}while(!0)}function q3(){var n=rE.current;return rE.current=nE,n===null?nE:n}function Hb(){(Vr===0||Vr===3||Vr===2)&&(Vr=4),ti===null||!(sh&268435455)&&!(lx&268435455)||lc(ti,di)}function oE(n,e){var t=xn;xn|=2;var r=q3();(ti!==n||di!==e)&&(Qa=null,$u(n,e));do try{_8();break}catch(i){Y3(n,i)}while(!0);if(wb(),xn=t,rE.current=r,Br!==null)throw Error(je(261));return ti=null,di=0,Vr}function _8(){for(;Br!==null;)Q3(Br)}function E8(){for(;Br!==null&&!$G();)Q3(Br)}function Q3(n){var e=tF(n.alternate,n,Ps);n.memoizedProps=n.pendingProps,e===null?Z3(n):Br=e,Nb.current=null}function Z3(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=d8(t,e),t!==null){t.flags&=32767,Br=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Vr=6,Br=null;return}}else if(t=f8(t,e,Ps),t!==null){Br=t;return}if(e=e.sibling,e!==null){Br=e;return}Br=e=n}while(e!==null);Vr===0&&(Vr=5)}function Mu(n,e,t){var r=Dn,i=mo.transition;try{mo.transition=null,Dn=1,x8(n,e,t,r)}finally{mo.transition=i,Dn=r}return null}function x8(n,e,t,r){do nd();while(mc!==null);if(xn&6)throw Error(je(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(je(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(t6(n,s),n===ti&&(Br=ti=null,di=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Uv||(Uv=!0,nF(H_,function(){return nd(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=mo.transition,mo.transition=null;var o=Dn;Dn=1;var a=xn;xn|=4,Nb.current=null,m8(n,t),X3(t,n),H6(NS),G_=!!BS,NS=BS=null,n.current=t,g8(t),jG(),xn=a,Dn=o,mo.transition=s}else n.current=t;if(Uv&&(Uv=!1,mc=n,sE=i),s=n.pendingLanes,s===0&&(Ac=null),JG(t.stateNode),Es(n,Cr()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(iE)throw iE=!1,n=nT,nT=null,n;return sE&1&&n.tag!==0&&nd(),s=n.pendingLanes,s&1?n===rT?Fm++:(Fm=0,rT=n):Fm=0,Xc(),null}function nd(){if(mc!==null){var n=Dk(sE),e=mo.transition,t=Dn;try{if(mo.transition=null,Dn=16>n?16:n,mc===null)var r=!1;else{if(n=mc,mc=null,sE=0,xn&6)throw Error(je(331));var i=xn;for(xn|=4,dt=n.current;dt!==null;){var s=dt,o=s.child;if(dt.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(dt=c;dt!==null;){var u=dt;switch(u.tag){case 0:case 11:case 15:Nm(8,u,s)}var f=u.child;if(f!==null)f.return=u,dt=f;else for(;dt!==null;){u=dt;var p=u.sibling,m=u.return;if(W3(u),u===c){dt=null;break}if(p!==null){p.return=m,dt=p;break}dt=m}}}var y=s.alternate;if(y!==null){var A=y.child;if(A!==null){y.child=null;do{var _=A.sibling;A.sibling=null,A=_}while(A!==null)}}dt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,dt=o;else e:for(;dt!==null;){if(s=dt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Nm(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,dt=g;break e}dt=s.return}}var E=n.current;for(dt=E;dt!==null;){o=dt;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,dt=x;else e:for(o=E;dt!==null;){if(a=dt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ax(9,a)}}catch(O){yr(a,a.return,O)}if(a===o){dt=null;break e}var T=a.sibling;if(T!==null){T.return=a.return,dt=T;break e}dt=a.return}}if(xn=i,Xc(),ya&&typeof ya.onPostCommitFiberRoot=="function")try{ya.onPostCommitFiberRoot(ZE,n)}catch{}r=!0}return r}finally{Dn=t,mo.transition=e}}return!1}function k2(n,e,t){e=_d(t,e),e=L3(n,e,1),n=xc(n,e,1),e=es(),n!==null&&(Kg(n,1,e),Es(n,e))}function yr(n,e,t){if(n.tag===3)k2(n,n,t);else for(;e!==null;){if(e.tag===3){k2(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ac===null||!Ac.has(r))){n=_d(t,n),n=O3(e,n,1),e=xc(e,n,1),n=es(),e!==null&&(Kg(e,1,n),Es(e,n));break}}e=e.return}}function A8(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=es(),n.pingedLanes|=n.suspendedLanes&t,ti===n&&(di&t)===t&&(Vr===4||Vr===3&&(di&130023424)===di&&500>Cr()-Fb?$u(n,0):kb|=t),Es(n,e)}function eF(n,e){e===0&&(n.mode&1?(e=Rv,Rv<<=1,!(Rv&130023424)&&(Rv=4194304)):e=1);var t=es();n=El(n,e),n!==null&&(Kg(n,e,t),Es(n,t))}function w8(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),eF(n,t)}function S8(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(je(314))}r!==null&&r.delete(e),eF(n,t)}var tF;tF=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||vs.current)gs=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return gs=!1,h8(n,e,t);gs=!!(n.flags&131072)}else gs=!1,nr&&e.flags&1048576&&i3(e,Y_,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;d_(n,e),n=e.pendingProps;var i=md(e,Ui.current);td(e,t),i=Pb(null,e,r,n,i,t);var s=Db();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_s(r)?(s=!0,K_(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Cb(e),i.updater=sx,e.stateNode=i,i._reactInternals=e,$S(e,r,n,t),e=KS(null,e,r,!0,s,t)):(e.tag=0,nr&&s&&_b(e),Yi(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(d_(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=C8(r),n=Oo(r,n),i){case 0:e=XS(null,e,r,n,t);break e;case 1:e=b2(null,e,r,n,t);break e;case 11:e=T2(null,e,r,n,t);break e;case 14:e=C2(null,e,r,Oo(r.type,n),t);break e}throw Error(je(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Oo(r,i),XS(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Oo(r,i),b2(n,e,r,i,t);case 3:e:{if(F3(e),n===null)throw Error(je(387));r=e.pendingProps,s=e.memoizedState,i=s.element,l3(n,e),Z_(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=_d(Error(je(423)),e),e=M2(n,e,r,t,i);break e}else if(r!==i){i=_d(Error(je(424)),e),e=M2(n,e,r,t,i);break e}else for(Ns=Ec(e.stateNode.containerInfo.firstChild),Fs=e,nr=!0,ko=null,t=f3(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(gd(),r===i){e=xl(n,e,t);break e}Yi(n,e,r,t)}e=e.child}return e;case 5:return d3(e),n===null&&VS(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,kS(r,i)?o=null:s!==null&&kS(r,s)&&(e.flags|=32),k3(n,e),Yi(n,e,o,t),e.child;case 6:return n===null&&VS(e),null;case 13:return U3(n,e,t);case 4:return bb(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=yd(e,null,r,t):Yi(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Oo(r,i),T2(n,e,r,i,t);case 7:return Yi(n,e,e.pendingProps,t),e.child;case 8:return Yi(n,e,e.pendingProps.children,t),e.child;case 12:return Yi(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,$n(q_,r._currentValue),r._currentValue=o,s!==null)if(Xo(s.value,o)){if(s.children===i.children&&!vs.current){e=xl(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ul(-1,t&-t),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),GS(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(je(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),GS(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Yi(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,td(e,t),i=vo(i),r=r(i),e.flags|=1,Yi(n,e,r,t),e.child;case 14:return r=e.type,i=Oo(r,e.pendingProps),i=Oo(r.type,i),C2(n,e,r,i,t);case 15:return B3(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Oo(r,i),d_(n,e),e.tag=1,_s(r)?(n=!0,K_(e)):n=!1,td(e,t),u3(e,r,i),$S(e,r,i,t),KS(null,e,r,!0,n,t);case 19:return z3(n,e,t);case 22:return N3(n,e,t)}throw Error(je(156,e.tag))};function nF(n,e){return Mk(n,e)}function T8(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fo(n,e,t,r){return new T8(n,e,t,r)}function Vb(n){return n=n.prototype,!(!n||!n.isReactComponent)}function C8(n){if(typeof n=="function")return Vb(n)?1:0;if(n!=null){if(n=n.$$typeof,n===ab)return 11;if(n===lb)return 14}return 2}function Sc(n,e){var t=n.alternate;return t===null?(t=fo(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function g_(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")Vb(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Df:return ju(t.children,i,s,e);case ob:o=8,i|=8;break;case mS:return n=fo(12,t,e,i|2),n.elementType=mS,n.lanes=s,n;case gS:return n=fo(13,t,e,i),n.elementType=gS,n.lanes=s,n;case yS:return n=fo(19,t,e,i),n.elementType=yS,n.lanes=s,n;case hk:return cx(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ck:o=10;break e;case uk:o=9;break e;case ab:o=11;break e;case lb:o=14;break e;case rc:o=16,r=null;break e}throw Error(je(130,n==null?n:typeof n,""))}return e=fo(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function ju(n,e,t,r){return n=fo(7,n,r,e),n.lanes=t,n}function cx(n,e,t,r){return n=fo(22,n,r,e),n.elementType=hk,n.lanes=t,n.stateNode={isHidden:!1},n}function P1(n,e,t){return n=fo(6,n,null,e),n.lanes=t,n}function D1(n,e,t){return e=fo(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function b8(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=f1(0),this.expirationTimes=f1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=f1(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Gb(n,e,t,r,i,s,o,a,l){return n=new b8(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=fo(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cb(s),n}function M8(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pf,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function rF(n){if(!n)return Pc;n=n._reactInternals;e:{if(xh(n)!==n||n.tag!==1)throw Error(je(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_s(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(je(171))}if(n.tag===1){var t=n.type;if(_s(t))return n3(n,t,e)}return e}function iF(n,e,t,r,i,s,o,a,l){return n=Gb(t,r,!0,n,i,s,o,a,l),n.context=rF(null),t=n.current,r=es(),i=wc(t),s=ul(r,i),s.callback=e??null,xc(t,s,i),n.current.lanes=i,Kg(n,i,r),Es(n,r),n}function ux(n,e,t,r){var i=e.current,s=es(),o=wc(i);return t=rF(t),e.context===null?e.context=t:e.pendingContext=t,e=ul(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=xc(i,e,o),n!==null&&(jo(n,i,o,s),u_(n,i,o)),o}function aE(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function F2(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Wb(n,e){F2(n,e),(n=n.alternate)&&F2(n,e)}function R8(){return null}var sF=typeof reportError=="function"?reportError:function(n){console.error(n)};function $b(n){this._internalRoot=n}hx.prototype.render=$b.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(je(409));ux(n,e,null,null)};hx.prototype.unmount=$b.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;oh(function(){ux(null,n,null,null)}),e[_l]=null}};function hx(n){this._internalRoot=n}hx.prototype.unstable_scheduleHydration=function(n){if(n){var e=Bk();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ac.length&&e!==0&&e<ac[t].priority;t++);ac.splice(t,0,n),t===0&&kk(n)}};function jb(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function fx(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function U2(){}function I8(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=aE(o);s.call(c)}}var o=iF(e,r,n,0,null,!1,!1,"",U2);return n._reactRootContainer=o,n[_l]=o.current,cg(n.nodeType===8?n.parentNode:n),oh(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=aE(l);a.call(c)}}var l=Gb(n,0,!1,null,null,!1,!1,"",U2);return n._reactRootContainer=l,n[_l]=l.current,cg(n.nodeType===8?n.parentNode:n),oh(function(){ux(e,l,t,r)}),l}function dx(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=aE(o);a.call(l)}}ux(e,o,n,i)}else o=I8(t,e,n,i,r);return aE(o)}Lk=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=wm(e.pendingLanes);t!==0&&(hb(e,t|1),Es(e,Cr()),!(xn&6)&&(Ed=Cr()+500,Xc()))}break;case 13:oh(function(){var r=El(n,1);if(r!==null){var i=es();jo(r,n,1,i)}}),Wb(n,1)}};fb=function(n){if(n.tag===13){var e=El(n,134217728);if(e!==null){var t=es();jo(e,n,134217728,t)}Wb(n,134217728)}};Ok=function(n){if(n.tag===13){var e=wc(n),t=El(n,e);if(t!==null){var r=es();jo(t,n,e,r)}Wb(n,e)}};Bk=function(){return Dn};Nk=function(n,e){var t=Dn;try{return Dn=n,e()}finally{Dn=t}};bS=function(n,e,t){switch(e){case"input":if(ES(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=rx(r);if(!i)throw Error(je(90));dk(r),ES(r,i)}}}break;case"textarea":mk(n,t);break;case"select":e=t.value,e!=null&&qf(n,!!t.multiple,e,!1)}};Ak=Ub;wk=oh;var P8={usingClientEntryPoint:!1,Events:[Yg,Nf,rx,Ek,xk,Ub]},Xp={findFiberByHostInstance:Lu,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},D8={bundleType:Xp.bundleType,version:Xp.version,rendererPackageName:Xp.rendererPackageName,rendererConfig:Xp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Il.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Ck(n),n===null?null:n.stateNode},findFiberByHostInstance:Xp.findFiberByHostInstance||R8,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zv.isDisabled&&zv.supportsFiber)try{ZE=zv.inject(D8),ya=zv}catch{}}Ws.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P8;Ws.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jb(e))throw Error(je(200));return M8(n,e,null,t)};Ws.createRoot=function(n,e){if(!jb(n))throw Error(je(299));var t=!1,r="",i=sF;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Gb(n,1,!1,null,null,t,!1,r,i),n[_l]=e.current,cg(n.nodeType===8?n.parentNode:n),new $b(e)};Ws.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(je(188)):(n=Object.keys(n).join(","),Error(je(268,n)));return n=Ck(e),n=n===null?null:n.stateNode,n};Ws.flushSync=function(n){return oh(n)};Ws.hydrate=function(n,e,t){if(!fx(e))throw Error(je(200));return dx(null,n,e,!0,t)};Ws.hydrateRoot=function(n,e,t){if(!jb(n))throw Error(je(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=sF;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=iF(e,null,n,1,t??null,i,!1,s,o),n[_l]=e.current,cg(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new hx(e)};Ws.render=function(n,e,t){if(!fx(e))throw Error(je(200));return dx(null,n,e,!1,t)};Ws.unmountComponentAtNode=function(n){if(!fx(n))throw Error(je(40));return n._reactRootContainer?(oh(function(){dx(null,null,n,!1,function(){n._reactRootContainer=null,n[_l]=null})}),!0):!1};Ws.unstable_batchedUpdates=Ub;Ws.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!fx(t))throw Error(je(200));if(n==null||n._reactInternals===void 0)throw Error(je(38));return dx(n,e,t,!1,r)};Ws.version="18.2.0-next-9e3b772b8-20220608";function oF(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(oF)}catch(n){console.error(n)}}oF(),ik.exports=Ws;var Qg=ik.exports;const aF=Vd(Qg);var lF,z2=Qg;lF=dS.createRoot=z2.createRoot,dS.hydrateRoot=z2.hydrateRoot;const L8="modulepreload",O8=function(n){return"/"+n},H2={},B8=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){const s=document.getElementsByTagName("link");i=Promise.all(t.map(o=>{if(o=O8(o),o in H2)return;H2[o]=!0;const a=o.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(!!r)for(let f=s.length-1;f>=0;f--){const p=s[f];if(p.href===o&&(!a||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${l}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":L8,a||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),a)return new Promise((f,p)=>{u.addEventListener("load",f),u.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${o}`)))})}))}return i.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};var V2="popstate";function N8(n={}){function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return oT("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:vg(i)}return F8(e,t,null,n)}function ir(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Eo(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function k8(){return Math.random().toString(36).substring(2,10)}function G2(n,e){return{usr:n.state,key:n.key,idx:e}}function oT(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?jd(e):e,state:t,key:e&&e.key||r||k8()}}function vg({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function jd(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function F8(n,e,t,r={}){let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a="POP",l=null,c=u();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function u(){return(o.state||{idx:null}).idx}function f(){a="POP";let _=u(),g=_==null?null:_-c;c=_,l&&l({action:a,location:A.location,delta:g})}function p(_,g){a="PUSH";let E=oT(A.location,_,g);t&&t(E,_),c=u()+1;let x=G2(E,c),T=A.createHref(E);try{o.pushState(x,"",T)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;i.location.assign(T)}s&&l&&l({action:a,location:A.location,delta:1})}function m(_,g){a="REPLACE";let E=oT(A.location,_,g);t&&t(E,_),c=u();let x=G2(E,c),T=A.createHref(E);o.replaceState(x,"",T),s&&l&&l({action:a,location:A.location,delta:0})}function y(_){return U8(_)}let A={get action(){return a},get location(){return n(i,o)},listen(_){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(V2,f),l=_,()=>{i.removeEventListener(V2,f),l=null}},createHref(_){return e(i,_)},createURL:y,encodeLocation(_){let g=y(_);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:p,replace:m,go(_){return o.go(_)}};return A}function U8(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ir(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:vg(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function cF(n,e,t="/"){return z8(n,e,t,!1)}function z8(n,e,t,r){let i=typeof e=="string"?jd(e):e,s=Al(i.pathname||"/",t);if(s==null)return null;let o=uF(n);H8(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=Q8(s);a=Y8(o[l],c,r)}return a}function uF(n,e=[],t=[],r="",i=!1){let s=(o,a,l=i,c)=>{let u={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(r)&&l)return;ir(u.relativePath.startsWith(r),`Absolute route path "${u.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(r.length)}let f=hl([r,u.relativePath]),p=t.concat(u);o.children&&o.children.length>0&&(ir(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),uF(o.children,e,p,f,l)),!(o.path==null&&!o.index)&&e.push({path:f,score:K8(f,o.index),routesMeta:p})};return n.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))s(o,a);else for(let c of hF(o.path))s(o,a,!0,c)}),e}function hF(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=hF(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function H8(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:J8(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var V8=/^:[\w-]+$/,G8=3,W8=2,$8=1,j8=10,X8=-2,W2=n=>n==="*";function K8(n,e){let t=n.split("/"),r=t.length;return t.some(W2)&&(r+=X8),e&&(r+=W8),t.filter(i=>!W2(i)).reduce((i,s)=>i+(V8.test(s)?G8:s===""?$8:j8),r)}function J8(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function Y8(n,e,t=!1){let{routesMeta:r}=n,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=s==="/"?e:e.slice(s.length)||"/",f=lE({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),p=l.route;if(!f&&c&&t&&!r[r.length-1].route.index&&(f=lE({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:hl([s,f.pathname]),pathnameBase:rW(hl([s,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(s=hl([s,f.pathnameBase]))}return o}function lE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=q8(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((c,{paramName:u,isOptional:f},p)=>{if(u==="*"){let y=a[p]||"";o=s.slice(0,s.length-y.length).replace(/(.)\/+$/,"$1")}const m=a[p];return f&&!m?c[u]=void 0:c[u]=(m||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:n}}function q8(n,e=!1,t=!0){Eo(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function Q8(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Eo(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Al(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var Z8=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eW=n=>Z8.test(n);function tW(n,e="/"){let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?jd(n):n,s;if(t)if(eW(t))s=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),Eo(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${t}`)}t.startsWith("/")?s=$2(t.substring(1),"/"):s=$2(t,e)}else s=e;return{pathname:s,search:iW(r),hash:sW(i)}}function $2(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function L1(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function nW(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Xb(n){let e=nW(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function Kb(n,e,t,r=!1){let i;typeof n=="string"?i=jd(n):(i={...n},ir(!i.pathname||!i.pathname.includes("?"),L1("?","pathname","search",i)),ir(!i.pathname||!i.pathname.includes("#"),L1("#","pathname","hash",i)),ir(!i.search||!i.search.includes("#"),L1("#","search","hash",i)));let s=n===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=t;else{let f=e.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;i.pathname=p.join("/")}a=f>=0?e[f]:"/"}let l=tW(i,a),c=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var hl=n=>n.join("/").replace(/\/\/+/g,"/"),rW=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),iW=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,sW=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function oW(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var fF=["POST","PUT","PATCH","DELETE"];new Set(fF);var aW=["GET",...fF];new Set(aW);var Xd=D.createContext(null);Xd.displayName="DataRouter";var px=D.createContext(null);px.displayName="DataRouterState";D.createContext(!1);var dF=D.createContext({isTransitioning:!1});dF.displayName="ViewTransition";var lW=D.createContext(new Map);lW.displayName="Fetchers";var cW=D.createContext(null);cW.displayName="Await";var Zo=D.createContext(null);Zo.displayName="Navigation";var Zg=D.createContext(null);Zg.displayName="Location";var Oa=D.createContext({outlet:null,matches:[],isDataRoute:!1});Oa.displayName="Route";var Jb=D.createContext(null);Jb.displayName="RouteError";function uW(n,{relative:e}={}){ir(Kd(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=D.useContext(Zo),{hash:i,pathname:s,search:o}=ty(n,{relative:e}),a=s;return t!=="/"&&(a=s==="/"?t:hl([t,s])),r.createHref({pathname:a,search:o,hash:i})}function Kd(){return D.useContext(Zg)!=null}function Kc(){return ir(Kd(),"useLocation() may be used only in the context of a <Router> component."),D.useContext(Zg).location}var pF="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function mF(n){D.useContext(Zo).static||D.useLayoutEffect(n)}function ey(){let{isDataRoute:n}=D.useContext(Oa);return n?wW():hW()}function hW(){ir(Kd(),"useNavigate() may be used only in the context of a <Router> component.");let n=D.useContext(Xd),{basename:e,navigator:t}=D.useContext(Zo),{matches:r}=D.useContext(Oa),{pathname:i}=Kc(),s=JSON.stringify(Xb(r)),o=D.useRef(!1);return mF(()=>{o.current=!0}),D.useCallback((l,c={})=>{if(Eo(o.current,pF),!o.current)return;if(typeof l=="number"){t.go(l);return}let u=Kb(l,JSON.parse(s),i,c.relative==="path");n==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:hl([e,u.pathname])),(c.replace?t.replace:t.push)(u,c.state,c)},[e,t,s,i,n])}D.createContext(null);function ty(n,{relative:e}={}){let{matches:t}=D.useContext(Oa),{pathname:r}=Kc(),i=JSON.stringify(Xb(t));return D.useMemo(()=>Kb(n,JSON.parse(i),r,e==="path"),[n,i,r,e])}function fW(n,e){return gF(n,e)}function gF(n,e,t,r,i){var E;ir(Kd(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=D.useContext(Zo),{matches:o}=D.useContext(Oa),a=o[o.length-1],l=a?a.params:{},c=a?a.pathname:"/",u=a?a.pathnameBase:"/",f=a&&a.route;{let x=f&&f.path||"";yF(c,!f||x.endsWith("*")||x.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${x}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${x}"> to <Route path="${x==="/"?"*":`${x}/*`}">.`)}let p=Kc(),m;if(e){let x=typeof e=="string"?jd(e):e;ir(u==="/"||((E=x.pathname)==null?void 0:E.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${x.pathname}" was given in the \`location\` prop.`),m=x}else m=p;let y=m.pathname||"/",A=y;if(u!=="/"){let x=u.replace(/^\//,"").split("/");A="/"+y.replace(/^\//,"").split("/").slice(x.length).join("/")}let _=cF(n,{pathname:A});Eo(f||_!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),Eo(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let g=yW(_&&_.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:hl([u,s.encodeLocation?s.encodeLocation(x.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?u:hl([u,s.encodeLocation?s.encodeLocation(x.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:x.pathnameBase])})),o,t,r,i);return e&&g?D.createElement(Zg.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},g):g}function dW(){let n=AW(),e=oW(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=D.createElement(D.Fragment,null,D.createElement("p",null," Hey developer "),D.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",D.createElement("code",{style:s},"ErrorBoundary")," or"," ",D.createElement("code",{style:s},"errorElement")," prop on your route.")),D.createElement(D.Fragment,null,D.createElement("h2",null,"Unexpected Application Error!"),D.createElement("h3",{style:{fontStyle:"italic"}},e),t?D.createElement("pre",{style:i},t):null,o)}var pW=D.createElement(dW,null),mW=class extends D.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?D.createElement(Oa.Provider,{value:this.props.routeContext},D.createElement(Jb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function gW({routeContext:n,match:e,children:t}){let r=D.useContext(Xd);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),D.createElement(Oa.Provider,{value:n},t)}function yW(n,e=[],t=null,r=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let s=n,o=t==null?void 0:t.errors;if(o!=null){let u=s.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);ir(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,u+1))}let a=!1,l=-1;if(t)for(let u=0;u<s.length;u++){let f=s[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=u),f.route.id){let{loaderData:p,errors:m}=t,y=f.route.loader&&!p.hasOwnProperty(f.route.id)&&(!m||m[f.route.id]===void 0);if(f.route.lazy||y){a=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}let c=t&&r?(u,f)=>{var p,m;r(u,{location:t.location,params:((m=(p=t.matches)==null?void 0:p[0])==null?void 0:m.params)??{},errorInfo:f})}:void 0;return s.reduceRight((u,f,p)=>{let m,y=!1,A=null,_=null;t&&(m=o&&f.route.id?o[f.route.id]:void 0,A=f.route.errorElement||pW,a&&(l<0&&p===0?(yF("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,_=null):l===p&&(y=!0,_=f.route.hydrateFallbackElement||null)));let g=e.concat(s.slice(0,p+1)),E=()=>{let x;return m?x=A:y?x=_:f.route.Component?x=D.createElement(f.route.Component,null):f.route.element?x=f.route.element:x=u,D.createElement(gW,{match:f,routeContext:{outlet:u,matches:g,isDataRoute:t!=null},children:x})};return t&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?D.createElement(mW,{location:t.location,revalidation:t.revalidation,component:A,error:m,children:E(),routeContext:{outlet:null,matches:g,isDataRoute:!0},onError:c}):E()},null)}function Yb(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function vW(n){let e=D.useContext(Xd);return ir(e,Yb(n)),e}function _W(n){let e=D.useContext(px);return ir(e,Yb(n)),e}function EW(n){let e=D.useContext(Oa);return ir(e,Yb(n)),e}function qb(n){let e=EW(n),t=e.matches[e.matches.length-1];return ir(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function xW(){return qb("useRouteId")}function AW(){var r;let n=D.useContext(Jb),e=_W("useRouteError"),t=qb("useRouteError");return n!==void 0?n:(r=e.errors)==null?void 0:r[t]}function wW(){let{router:n}=vW("useNavigate"),e=qb("useNavigate"),t=D.useRef(!1);return mF(()=>{t.current=!0}),D.useCallback(async(i,s={})=>{Eo(t.current,pF),t.current&&(typeof i=="number"?n.navigate(i):await n.navigate(i,{fromRouteId:e,...s}))},[n,e])}var j2={};function yF(n,e,t){!e&&!j2[n]&&(j2[n]=!0,Eo(!1,t))}D.memo(SW);function SW({routes:n,future:e,state:t,unstable_onError:r}){return gF(n,void 0,t,r,e)}function TW({to:n,replace:e,state:t,relative:r}){ir(Kd(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=D.useContext(Zo);Eo(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=D.useContext(Oa),{pathname:o}=Kc(),a=ey(),l=Kb(n,Xb(s),o,r==="path"),c=JSON.stringify(l);return D.useEffect(()=>{a(JSON.parse(c),{replace:e,state:t,relative:r})},[a,c,r,e,t]),null}function y_(n){ir(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function CW({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:i,static:s=!1}){ir(!Kd(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=n.replace(/^\/*/,"/"),a=D.useMemo(()=>({basename:o,navigator:i,static:s,future:{}}),[o,i,s]);typeof t=="string"&&(t=jd(t));let{pathname:l="/",search:c="",hash:u="",state:f=null,key:p="default"}=t,m=D.useMemo(()=>{let y=Al(l,o);return y==null?null:{location:{pathname:y,search:c,hash:u,state:f,key:p},navigationType:r}},[o,l,c,u,f,p,r]);return Eo(m!=null,`<Router basename="${o}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),m==null?null:D.createElement(Zo.Provider,{value:a},D.createElement(Zg.Provider,{children:e,value:m}))}function bW({children:n,location:e}){return fW(aT(n),e)}function aT(n,e=[]){let t=[];return D.Children.forEach(n,(r,i)=>{if(!D.isValidElement(r))return;let s=[...e,i];if(r.type===D.Fragment){t.push.apply(t,aT(r.props.children,s));return}ir(r.type===y_,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ir(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=aT(r.props.children,s)),t.push(o)}),t}var v_="get",__="application/x-www-form-urlencoded";function mx(n){return n!=null&&typeof n.tagName=="string"}function MW(n){return mx(n)&&n.tagName.toLowerCase()==="button"}function RW(n){return mx(n)&&n.tagName.toLowerCase()==="form"}function IW(n){return mx(n)&&n.tagName.toLowerCase()==="input"}function PW(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function DW(n,e){return n.button===0&&(!e||e==="_self")&&!PW(n)}var Hv=null;function LW(){if(Hv===null)try{new FormData(document.createElement("form"),0),Hv=!1}catch{Hv=!0}return Hv}var OW=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function O1(n){return n!=null&&!OW.has(n)?(Eo(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${__}"`),null):n}function BW(n,e){let t,r,i,s,o;if(RW(n)){let a=n.getAttribute("action");r=a?Al(a,e):null,t=n.getAttribute("method")||v_,i=O1(n.getAttribute("enctype"))||__,s=new FormData(n)}else if(MW(n)||IW(n)&&(n.type==="submit"||n.type==="image")){let a=n.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||a.getAttribute("action");if(r=l?Al(l,e):null,t=n.getAttribute("formmethod")||a.getAttribute("method")||v_,i=O1(n.getAttribute("formenctype"))||O1(a.getAttribute("enctype"))||__,s=new FormData(a,n),!LW()){let{name:c,type:u,value:f}=n;if(u==="image"){let p=c?`${c}.`:"";s.append(`${p}x`,"0"),s.append(`${p}y`,"0")}else c&&s.append(c,f)}}else{if(mx(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=v_,r=null,i=__,o=n}return s&&i==="text/plain"&&(o=s,s=void 0),{action:r,method:t.toLowerCase(),encType:i,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Qb(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function NW(n,e,t){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&Al(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function kW(n,e){if(n.id in e)return e[n.id];try{let t=await B8(()=>import(n.module),__vite__mapDeps([]));return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function FW(n){return n!=null&&typeof n.page=="string"}function UW(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function zW(n,e,t){let r=await Promise.all(n.map(async i=>{let s=e.routes[i.route.id];if(s){let o=await kW(s,t);return o.links?o.links():[]}return[]}));return WW(r.flat(1).filter(UW).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function X2(n,e,t,r,i,s){let o=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,a=(l,c)=>{var u;return t[c].pathname!==l.pathname||((u=t[c].route.path)==null?void 0:u.endsWith("*"))&&t[c].params["*"]!==l.params["*"]};return s==="assets"?e.filter((l,c)=>o(l,c)||a(l,c)):s==="data"?e.filter((l,c)=>{var f;let u=r.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(o(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let p=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((f=t[0])==null?void 0:f.params)||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function HW(n,e,{includeHydrateFallback:t}={}){return VW(n.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function VW(n){return[...new Set(n)]}function GW(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function WW(n,e){let t=new Set,r=new Set(e);return n.reduce((i,s)=>{if(e&&!FW(s)&&s.as==="script"&&s.href&&r.has(s.href))return i;let a=JSON.stringify(GW(s));return t.has(a)||(t.add(a),i.push({key:a,link:s})),i},[])}function vF(){let n=D.useContext(Xd);return Qb(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function $W(){let n=D.useContext(px);return Qb(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Zb=D.createContext(void 0);Zb.displayName="FrameworkContext";function _F(){let n=D.useContext(Zb);return Qb(n,"You must render this element inside a <HydratedRouter> element"),n}function jW(n,e){let t=D.useContext(Zb),[r,i]=D.useState(!1),[s,o]=D.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:f}=e,p=D.useRef(null);D.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let A=g=>{g.forEach(E=>{o(E.isIntersecting)})},_=new IntersectionObserver(A,{threshold:.5});return p.current&&_.observe(p.current),()=>{_.disconnect()}}},[n]),D.useEffect(()=>{if(r){let A=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(A)}}},[r]);let m=()=>{i(!0)},y=()=>{i(!1),o(!1)};return t?n!=="intent"?[s,p,{}]:[s,p,{onFocus:Kp(a,m),onBlur:Kp(l,y),onMouseEnter:Kp(c,m),onMouseLeave:Kp(u,y),onTouchStart:Kp(f,m)}]:[!1,p,{}]}function Kp(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function XW({page:n,...e}){let{router:t}=vF(),r=D.useMemo(()=>cF(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?D.createElement(JW,{page:n,matches:r,...e}):null}function KW(n){let{manifest:e,routeModules:t}=_F(),[r,i]=D.useState([]);return D.useEffect(()=>{let s=!1;return zW(n,e,t).then(o=>{s||i(o)}),()=>{s=!0}},[n,e,t]),r}function JW({page:n,matches:e,...t}){let r=Kc(),{manifest:i,routeModules:s}=_F(),{basename:o}=vF(),{loaderData:a,matches:l}=$W(),c=D.useMemo(()=>X2(n,e,l,i,r,"data"),[n,e,l,i,r]),u=D.useMemo(()=>X2(n,e,l,i,r,"assets"),[n,e,l,i,r]),f=D.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let y=new Set,A=!1;if(e.forEach(g=>{var x;let E=i.routes[g.route.id];!E||!E.hasLoader||(!c.some(T=>T.route.id===g.route.id)&&g.route.id in a&&((x=s[g.route.id])!=null&&x.shouldRevalidate)||E.hasClientLoader?A=!0:y.add(g.route.id))}),y.size===0)return[];let _=NW(n,o,"data");return A&&y.size>0&&_.searchParams.set("_routes",e.filter(g=>y.has(g.route.id)).map(g=>g.route.id).join(",")),[_.pathname+_.search]},[o,a,r,i,c,e,n,s]),p=D.useMemo(()=>HW(u,i),[u,i]),m=KW(u);return D.createElement(D.Fragment,null,f.map(y=>D.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...t})),p.map(y=>D.createElement("link",{key:y,rel:"modulepreload",href:y,...t})),m.map(({key:y,link:A})=>D.createElement("link",{key:y,nonce:t.nonce,...A})))}function YW(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var EF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{EF&&(window.__reactRouterVersion="7.9.6")}catch{}function qW({basename:n,children:e,window:t}){let r=D.useRef();r.current==null&&(r.current=N8({window:t,v5Compat:!0}));let i=r.current,[s,o]=D.useState({action:i.action,location:i.location}),a=D.useCallback(l=>{D.startTransition(()=>o(l))},[o]);return D.useLayoutEffect(()=>i.listen(a),[i,a]),D.createElement(CW,{basename:n,children:e,location:s.location,navigationType:s.action,navigator:i})}var xF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gx=D.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:i,reloadDocument:s,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:f,...p},m){let{basename:y}=D.useContext(Zo),A=typeof c=="string"&&xF.test(c),_,g=!1;if(typeof c=="string"&&A&&(_=c,EF))try{let C=new URL(window.location.href),M=c.startsWith("//")?new URL(C.protocol+c):new URL(c),B=Al(M.pathname,y);M.origin===C.origin&&B!=null?c=B+M.search+M.hash:g=!0}catch{Eo(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=uW(c,{relative:i}),[x,T,O]=jW(r,p),I=t$(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:i,viewTransition:f});function b(C){e&&e(C),C.defaultPrevented||I(C)}let R=D.createElement("a",{...p,...O,href:_||E,onClick:g||s?e:b,ref:YW(m,T),target:l,"data-discover":!A&&t==="render"?"true":void 0});return x&&!A?D.createElement(D.Fragment,null,R,D.createElement(XW,{page:E})):R});gx.displayName="Link";var QW=D.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:i=!1,style:s,to:o,viewTransition:a,children:l,...c},u){let f=ty(o,{relative:c.relative}),p=Kc(),m=D.useContext(px),{navigator:y,basename:A}=D.useContext(Zo),_=m!=null&&o$(f)&&a===!0,g=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,E=p.pathname,x=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;t||(E=E.toLowerCase(),x=x?x.toLowerCase():null,g=g.toLowerCase()),x&&A&&(x=Al(x,A)||x);const T=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let O=E===g||!i&&E.startsWith(g)&&E.charAt(T)==="/",I=x!=null&&(x===g||!i&&x.startsWith(g)&&x.charAt(g.length)==="/"),b={isActive:O,isPending:I,isTransitioning:_},R=O?e:void 0,C;typeof r=="function"?C=r(b):C=[r,O?"active":null,I?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let M=typeof s=="function"?s(b):s;return D.createElement(gx,{...c,"aria-current":R,className:C,ref:u,style:M,to:o,viewTransition:a},typeof l=="function"?l(b):l)});QW.displayName="NavLink";var ZW=D.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:i,state:s,method:o=v_,action:a,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:f,...p},m)=>{let y=i$(),A=s$(a,{relative:c}),_=o.toLowerCase()==="get"?"get":"post",g=typeof a=="string"&&xF.test(a),E=x=>{if(l&&l(x),x.defaultPrevented)return;x.preventDefault();let T=x.nativeEvent.submitter,O=(T==null?void 0:T.getAttribute("formmethod"))||o;y(T||x.currentTarget,{fetcherKey:e,method:O,navigate:t,replace:i,state:s,relative:c,preventScrollReset:u,viewTransition:f})};return D.createElement("form",{ref:m,method:_,action:A,onSubmit:r?l:E,...p,"data-discover":!g&&n==="render"?"true":void 0})});ZW.displayName="Form";function e$(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function AF(n){let e=D.useContext(Xd);return ir(e,e$(n)),e}function t$(n,{target:e,replace:t,state:r,preventScrollReset:i,relative:s,viewTransition:o}={}){let a=ey(),l=Kc(),c=ty(n,{relative:s});return D.useCallback(u=>{if(DW(u,e)){u.preventDefault();let f=t!==void 0?t:vg(l)===vg(c);a(n,{replace:f,state:r,preventScrollReset:i,relative:s,viewTransition:o})}},[l,a,c,t,r,e,n,i,s,o])}var n$=0,r$=()=>`__${String(++n$)}__`;function i$(){let{router:n}=AF("useSubmit"),{basename:e}=D.useContext(Zo),t=xW();return D.useCallback(async(r,i={})=>{let{action:s,method:o,encType:a,formData:l,body:c}=BW(r,e);if(i.navigate===!1){let u=i.fetcherKey||r$();await n.fetch(u,t,i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||a,flushSync:i.flushSync})}else await n.navigate(i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[n,e,t])}function s$(n,{relative:e}={}){let{basename:t}=D.useContext(Zo),r=D.useContext(Oa);ir(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),s={...ty(n||".",{relative:e})},o=Kc();if(n==null){s.search=o.search;let a=new URLSearchParams(s.search),l=a.getAll("index");if(l.some(u=>u==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let u=a.toString();s.search=u?`?${u}`:""}}return(!n||n===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:hl([t,s.pathname])),vg(s)}function o$(n,{relative:e}={}){let t=D.useContext(dF);ir(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=AF("useViewTransitionState"),i=ty(n,{relative:e});if(!t.isTransitioning)return!1;let s=Al(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=Al(t.nextLocation.pathname,r)||t.nextLocation.pathname;return lE(i.pathname,o)!=null||lE(i.pathname,s)!=null}const a$=()=>{};var K2={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},l$=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],a=n[t++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},SF={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,a=o?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,u=s>>2,f=(s&3)<<4|a>>4;let p=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(p=64)),r.push(t[u],t[f],t[p],t[m])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(wF(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):l$(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const c=i<n.length?t[n.charAt(i)]:64;++i;const f=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||c==null||f==null)throw new c$;const p=s<<2|a>>4;if(r.push(p),c!==64){const m=a<<4&240|c>>2;if(r.push(m),f!==64){const y=c<<6&192|f;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class c$ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const u$=function(n){const e=wF(n);return SF.encodeByteArray(e,!0)},cE=function(n){return u$(n).replace(/\./g,"")},TF=function(n){try{return SF.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h$(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f$=()=>h$().__FIREBASE_DEFAULTS__,d$=()=>{if(typeof process>"u"||typeof K2>"u")return;const n=K2.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},p$=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&TF(n[1]);return e&&JSON.parse(e)},yx=()=>{try{return a$()||f$()||d$()||p$()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},CF=n=>{var e,t;return(t=(e=yx())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},m$=n=>{const e=CF(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},bF=()=>{var n;return(n=yx())==null?void 0:n.config},MF=n=>{var e;return(e=yx())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g${constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jd(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function RF(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y$(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[cE(JSON.stringify(t)),cE(JSON.stringify(o)),""].join(".")}const Um={};function v$(){const n={prod:[],emulator:[]};for(const e of Object.keys(Um))Um[e]?n.emulator.push(e):n.prod.push(e);return n}function _$(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let J2=!1;function IF(n,e){if(typeof window>"u"||typeof document>"u"||!Jd(window.location.host)||Um[n]===e||Um[n]||J2)return;Um[n]=e;function t(p){return`__firebase__banner__${p}`}const r="__firebase__banner",s=v$().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,m){p.setAttribute("width","24"),p.setAttribute("id",m),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function c(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{J2=!0,o()},p}function u(p,m){p.setAttribute("id",m),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function f(){const p=_$(r),m=t("text"),y=document.getElementById(m)||document.createElement("span"),A=t("learnmore"),_=document.getElementById(A)||document.createElement("a"),g=t("preprendIcon"),E=document.getElementById(g)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const x=p.element;a(x),u(_,A);const T=c();l(E,g),x.append(E,y,_,T),document.body.appendChild(x)}s?(y.innerText="Preview backend disconnected.",E.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(E.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function E$(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zi())}function x$(){var e;const n=(e=yx())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function A$(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function PF(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function w$(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function S$(){const n=zi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function T$(){return!x$()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function DF(){try{return typeof indexedDB=="object"}catch{return!1}}function LF(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(t){e(t)}})}function C$(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b$="FirebaseError";class ea extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=b$,Object.setPrototypeOf(this,ea.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ah.prototype.create)}}class Ah{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?M$(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ea(i,a,r)}}function M$(n,e){return n.replace(R$,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const R$=/\{\$([^}]+)}/g;function I$(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Dc(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(Y2(s)&&Y2(o)){if(!Dc(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Y2(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Tm(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Cm(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function P$(n,e){const t=new D$(n,e);return t.subscribe.bind(t)}class D${constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");L$(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=B1),i.error===void 0&&(i.error=B1),i.complete===void 0&&(i.complete=B1);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function L$(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function B1(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O$=1e3,B$=2,N$=4*60*60*1e3,k$=.5;function q2(n,e=O$,t=B$){const r=e*Math.pow(t,n),i=Math.round(k$*r*(Math.random()-.5)*2);return Math.min(N$,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vi(n){return n&&n._delegate?n._delegate:n}class Ko{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ru="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let F$=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new g$;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(z$(e))try{this.getOrInitializeService({instanceIdentifier:Ru})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ru){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ru){return this.instances.has(e)}getOptions(e=Ru){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:U$(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ru){return this.component?this.component.multipleInstances?e:Ru:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function U$(n){return n===Ru?void 0:n}function z$(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H${constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new F$(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(fn||(fn={}));const V$={debug:fn.DEBUG,verbose:fn.VERBOSE,info:fn.INFO,warn:fn.WARN,error:fn.ERROR,silent:fn.SILENT},G$=fn.INFO,W$={[fn.DEBUG]:"log",[fn.VERBOSE]:"log",[fn.INFO]:"info",[fn.WARN]:"warn",[fn.ERROR]:"error"},$$=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=W$[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class vx{constructor(e){this.name=e,this._logLevel=G$,this._logHandler=$$,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in fn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?V$[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,fn.DEBUG,...e),this._logHandler(this,fn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,fn.VERBOSE,...e),this._logHandler(this,fn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,fn.INFO,...e),this._logHandler(this,fn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,fn.WARN,...e),this._logHandler(this,fn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,fn.ERROR,...e),this._logHandler(this,fn.ERROR,...e)}}const j$=(n,e)=>e.some(t=>n instanceof t);let Q2,Z2;function X$(){return Q2||(Q2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function K$(){return Z2||(Z2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const OF=new WeakMap,lT=new WeakMap,BF=new WeakMap,N1=new WeakMap,eM=new WeakMap;function J$(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Tc(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&OF.set(t,n)}).catch(()=>{}),eM.set(e,n),e}function Y$(n){if(lT.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});lT.set(n,e)}let cT={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return lT.get(n);if(e==="objectStoreNames")return n.objectStoreNames||BF.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Tc(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function q$(n){cT=n(cT)}function Q$(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(k1(this),e,...t);return BF.set(r,e.sort?e.sort():[e]),Tc(r)}:K$().includes(n)?function(...e){return n.apply(k1(this),e),Tc(OF.get(this))}:function(...e){return Tc(n.apply(k1(this),e))}}function Z$(n){return typeof n=="function"?Q$(n):(n instanceof IDBTransaction&&Y$(n),j$(n,X$())?new Proxy(n,cT):n)}function Tc(n){if(n instanceof IDBRequest)return J$(n);if(N1.has(n))return N1.get(n);const e=Z$(n);return e!==n&&(N1.set(n,e),eM.set(e,n)),e}const k1=n=>eM.get(n);function NF(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),a=Tc(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Tc(o.result),l.oldVersion,l.newVersion,Tc(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const e7=["get","getKey","getAll","getAllKeys","count"],t7=["put","add","delete","clear"],F1=new Map;function eD(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(F1.get(e))return F1.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=t7.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||e7.includes(t)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),i&&l.done]))[0]};return F1.set(e,s),s}q$(n=>({...n,get:(e,t,r)=>eD(e,t)||n.get(e,t,r),has:(e,t)=>!!eD(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(r7(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function r7(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const uT="@firebase/app",tD="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl=new vx("@firebase/app"),i7="@firebase/app-compat",s7="@firebase/analytics-compat",o7="@firebase/analytics",a7="@firebase/app-check-compat",l7="@firebase/app-check",c7="@firebase/auth",u7="@firebase/auth-compat",h7="@firebase/database",f7="@firebase/data-connect",d7="@firebase/database-compat",p7="@firebase/functions",m7="@firebase/functions-compat",g7="@firebase/installations",y7="@firebase/installations-compat",v7="@firebase/messaging",_7="@firebase/messaging-compat",E7="@firebase/performance",x7="@firebase/performance-compat",A7="@firebase/remote-config",w7="@firebase/remote-config-compat",S7="@firebase/storage",T7="@firebase/storage-compat",C7="@firebase/firestore",b7="@firebase/ai",M7="@firebase/firestore-compat",R7="firebase",I7="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT="[DEFAULT]",P7={[uT]:"fire-core",[i7]:"fire-core-compat",[o7]:"fire-analytics",[s7]:"fire-analytics-compat",[l7]:"fire-app-check",[a7]:"fire-app-check-compat",[c7]:"fire-auth",[u7]:"fire-auth-compat",[h7]:"fire-rtdb",[f7]:"fire-data-connect",[d7]:"fire-rtdb-compat",[p7]:"fire-fn",[m7]:"fire-fn-compat",[g7]:"fire-iid",[y7]:"fire-iid-compat",[v7]:"fire-fcm",[_7]:"fire-fcm-compat",[E7]:"fire-perf",[x7]:"fire-perf-compat",[A7]:"fire-rc",[w7]:"fire-rc-compat",[S7]:"fire-gcs",[T7]:"fire-gcs-compat",[C7]:"fire-fst",[M7]:"fire-fst-compat",[b7]:"fire-vertex","fire-js":"fire-js",[R7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uE=new Map,D7=new Map,fT=new Map;function nD(n,e){try{n.container.addComponent(e)}catch(t){wl.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ta(n){const e=n.name;if(fT.has(e))return wl.debug(`There were multiple attempts to register component ${e}.`),!1;fT.set(e,n);for(const t of uE.values())nD(t,n);for(const t of D7.values())nD(t,n);return!0}function wh(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function uo(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Cc=new Ah("app","Firebase",L7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O7{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ko("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Cc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd=I7;function kF(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:hT,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Cc.create("bad-app-name",{appName:String(i)});if(t||(t=bF()),!t)throw Cc.create("no-options");const s=uE.get(i);if(s){if(Dc(t,s.options)&&Dc(r,s.config))return s;throw Cc.create("duplicate-app",{appName:i})}const o=new H$(i);for(const l of fT.values())o.addComponent(l);const a=new O7(t,r,o);return uE.set(i,a),a}function tM(n=hT){const e=uE.get(n);if(!e&&n===hT&&bF())return kF();if(!e)throw Cc.create("no-app",{appName:n});return e}function go(n,e,t){let r=P7[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wl.warn(o.join(" "));return}Ta(new Ko(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B7="firebase-heartbeat-database",N7=1,_g="firebase-heartbeat-store";let U1=null;function FF(){return U1||(U1=NF(B7,N7,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(_g)}catch(t){console.warn(t)}}}}).catch(n=>{throw Cc.create("idb-open",{originalErrorMessage:n.message})})),U1}async function k7(n){try{const t=(await FF()).transaction(_g),r=await t.objectStore(_g).get(UF(n));return await t.done,r}catch(e){if(e instanceof ea)wl.warn(e.message);else{const t=Cc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});wl.warn(t.message)}}}async function rD(n,e){try{const r=(await FF()).transaction(_g,"readwrite");await r.objectStore(_g).put(e,UF(n)),await r.done}catch(t){if(t instanceof ea)wl.warn(t.message);else{const r=Cc.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});wl.warn(r.message)}}}function UF(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F7=1024,U7=30;class z7{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new V7(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=iD();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>U7){const o=G7(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){wl.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=iD(),{heartbeatsToSend:r,unsentEntries:i}=H7(this._heartbeatsCache.heartbeats),s=cE(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return wl.warn(t),""}}}function iD(){return new Date().toISOString().substring(0,10)}function H7(n,e=F7){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),sD(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),sD(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class V7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return DF()?LF().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await k7(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return rD(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return rD(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function sD(n){return cE(JSON.stringify({version:2,heartbeats:n})).length}function G7(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W7(n){Ta(new Ko("platform-logger",e=>new n7(e),"PRIVATE")),Ta(new Ko("heartbeat",e=>new z7(e),"PRIVATE")),go(uT,tD,n),go(uT,tD,"esm2020"),go("fire-js","")}W7("");var $7="firebase",j7="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */go($7,j7,"app");const zF="@firebase/installations",nM="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HF=1e4,VF=`w:${nM}`,GF="FIS_v2",X7="https://firebaseinstallations.googleapis.com/v1",K7=60*60*1e3,J7="installations",Y7="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q7={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ah=new Ah(J7,Y7,q7);function WF(n){return n instanceof ea&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $F({projectId:n}){return`${X7}/projects/${n}/installations`}function jF(n){return{token:n.token,requestStatus:2,expiresIn:Z7(n.expiresIn),creationTime:Date.now()}}async function XF(n,e){const r=(await e.json()).error;return ah.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function KF({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function Q7(n,{refreshToken:e}){const t=KF(n);return t.append("Authorization",ej(e)),t}async function JF(n){const e=await n();return e.status>=500&&e.status<600?n():e}function Z7(n){return Number(n.replace("s","000"))}function ej(n){return`${GF} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tj({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=$F(n),i=KF(n),s=e.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const o={fid:t,authVersion:GF,appId:n.appId,sdkVersion:VF},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await JF(()=>fetch(r,a));if(l.ok){const c=await l.json();return{fid:c.fid||t,registrationStatus:2,refreshToken:c.refreshToken,authToken:jF(c.authToken)}}else throw await XF("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YF(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nj(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rj=/^[cdef][\w-]{21}$/,dT="";function ij(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=sj(n);return rj.test(t)?t:dT}catch{return dT}}function sj(n){return nj(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _x(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qF=new Map;function QF(n,e){const t=_x(n);ZF(t,e),oj(t,e)}function ZF(n,e){const t=qF.get(n);if(t)for(const r of t)r(e)}function oj(n,e){const t=aj();t&&t.postMessage({key:n,fid:e}),lj()}let Nu=null;function aj(){return!Nu&&"BroadcastChannel"in self&&(Nu=new BroadcastChannel("[Firebase] FID Change"),Nu.onmessage=n=>{ZF(n.data.key,n.data.fid)}),Nu}function lj(){qF.size===0&&Nu&&(Nu.close(),Nu=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cj="firebase-installations-database",uj=1,lh="firebase-installations-store";let z1=null;function rM(){return z1||(z1=NF(cj,uj,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(lh)}}})),z1}async function hE(n,e){const t=_x(n),i=(await rM()).transaction(lh,"readwrite"),s=i.objectStore(lh),o=await s.get(t);return await s.put(e,t),await i.done,(!o||o.fid!==e.fid)&&QF(n,e.fid),e}async function eU(n){const e=_x(n),r=(await rM()).transaction(lh,"readwrite");await r.objectStore(lh).delete(e),await r.done}async function Ex(n,e){const t=_x(n),i=(await rM()).transaction(lh,"readwrite"),s=i.objectStore(lh),o=await s.get(t),a=e(o);return a===void 0?await s.delete(t):await s.put(a,t),await i.done,a&&(!o||o.fid!==a.fid)&&QF(n,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iM(n){let e;const t=await Ex(n.appConfig,r=>{const i=hj(r),s=fj(n,i);return e=s.registrationPromise,s.installationEntry});return t.fid===dT?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function hj(n){const e=n||{fid:ij(),registrationStatus:0};return tU(e)}function fj(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(ah.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=dj(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:pj(n)}:{installationEntry:e}}async function dj(n,e){try{const t=await tj(n,e);return hE(n.appConfig,t)}catch(t){throw WF(t)&&t.customData.serverCode===409?await eU(n.appConfig):await hE(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function pj(n){let e=await oD(n.appConfig);for(;e.registrationStatus===1;)await YF(100),e=await oD(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await iM(n);return r||t}return e}function oD(n){return Ex(n,e=>{if(!e)throw ah.create("installation-not-found");return tU(e)})}function tU(n){return mj(n)?{fid:n.fid,registrationStatus:0}:n}function mj(n){return n.registrationStatus===1&&n.registrationTime+HF<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gj({appConfig:n,heartbeatServiceProvider:e},t){const r=yj(n,t),i=Q7(n,t),s=e.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const o={installation:{sdkVersion:VF,appId:n.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await JF(()=>fetch(r,a));if(l.ok){const c=await l.json();return jF(c)}else throw await XF("Generate Auth Token",l)}function yj(n,{fid:e}){return`${$F(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sM(n,e=!1){let t;const r=await Ex(n.appConfig,s=>{if(!nU(s))throw ah.create("not-registered");const o=s.authToken;if(!e&&Ej(o))return s;if(o.requestStatus===1)return t=vj(n,e),s;{if(!navigator.onLine)throw ah.create("app-offline");const a=Aj(s);return t=_j(n,a),a}});return t?await t:r.authToken}async function vj(n,e){let t=await aD(n.appConfig);for(;t.authToken.requestStatus===1;)await YF(100),t=await aD(n.appConfig);const r=t.authToken;return r.requestStatus===0?sM(n,e):r}function aD(n){return Ex(n,e=>{if(!nU(e))throw ah.create("not-registered");const t=e.authToken;return wj(t)?{...e,authToken:{requestStatus:0}}:e})}async function _j(n,e){try{const t=await gj(n,e),r={...e,authToken:t};return await hE(n.appConfig,r),t}catch(t){if(WF(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await eU(n.appConfig);else{const r={...e,authToken:{requestStatus:0}};await hE(n.appConfig,r)}throw t}}function nU(n){return n!==void 0&&n.registrationStatus===2}function Ej(n){return n.requestStatus===2&&!xj(n)}function xj(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+K7}function Aj(n){const e={requestStatus:1,requestTime:Date.now()};return{...n,authToken:e}}function wj(n){return n.requestStatus===1&&n.requestTime+HF<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sj(n){const e=n,{installationEntry:t,registrationPromise:r}=await iM(e);return r?r.catch(console.error):sM(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tj(n,e=!1){const t=n;return await Cj(t),(await sM(t,e)).token}async function Cj(n){const{registrationPromise:e}=await iM(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bj(n){if(!n||!n.options)throw H1("App Configuration");if(!n.name)throw H1("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw H1(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function H1(n){return ah.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rU="installations",Mj="installations-internal",Rj=n=>{const e=n.getProvider("app").getImmediate(),t=bj(e),r=wh(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Ij=n=>{const e=n.getProvider("app").getImmediate(),t=wh(e,rU).getImmediate();return{getId:()=>Sj(t),getToken:i=>Tj(t,i)}};function Pj(){Ta(new Ko(rU,Rj,"PUBLIC")),Ta(new Ko(Mj,Ij,"PRIVATE"))}Pj();go(zF,nM);go(zF,nM,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fE="analytics",Dj="firebase_id",Lj="origin",Oj=60*1e3,Bj="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",oM="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ts=new vx("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nj={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Us=new Ah("analytics","Analytics",Nj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kj(n){if(!n.startsWith(oM)){const e=Us.create("invalid-gtag-resource",{gtagURL:n});return ts.warn(e.message),""}return n}function iU(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function Fj(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function Uj(n,e){const t=Fj("firebase-js-sdk-policy",{createScriptURL:kj}),r=document.createElement("script"),i=`${oM}?l=${n}&id=${e}`;r.src=t?t==null?void 0:t.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function zj(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function Hj(n,e,t,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await iU(t)).find(c=>c.measurementId===i);l&&await e[l.appId]}}catch(a){ts.error(a)}n("config",i,s)}async function Vj(n,e,t,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await iU(t);for(const l of o){const c=a.find(f=>f.measurementId===l),u=c&&e[c.appId];if(u)s.push(u);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),n("event",r,i||{})}catch(s){ts.error(s)}}function Gj(n,e,t,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await Vj(n,e,t,a,l)}else if(s==="config"){const[a,l]=o;await Hj(n,e,t,r,a,l)}else if(s==="consent"){const[a,l]=o;n("consent",a,l)}else if(s==="get"){const[a,l,c]=o;n("get",a,l,c)}else if(s==="set"){const[a]=o;n("set",a)}else n(s,...o)}catch(a){ts.error(a)}}return i}function Wj(n,e,t,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=Gj(s,n,e,t),{gtagCore:s,wrappedGtag:window[i]}}function $j(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(oM)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jj=30,Xj=1e3;class Kj{constructor(e={},t=Xj){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const sU=new Kj;function Jj(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function Yj(n){var o;const{appId:e,apiKey:t}=n,r={method:"GET",headers:Jj(t)},i=Bj.replace("{app-id}",e),s=await fetch(i,r);if(s.status!==200&&s.status!==304){let a="";try{const l=await s.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw Us.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()}async function qj(n,e=sU,t){const{appId:r,apiKey:i,measurementId:s}=n.options;if(!r)throw Us.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Us.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new eX;return setTimeout(async()=>{a.abort()},t!==void 0?t:Oj),oU({appId:r,apiKey:i,measurementId:s},o,a,e)}async function oU(n,{throttleEndTimeMillis:e,backoffCount:t},r,i=sU){var a;const{appId:s,measurementId:o}=n;try{await Qj(r,e)}catch(l){if(o)return ts.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:s,measurementId:o};throw l}try{const l=await Yj(n);return i.deleteThrottleMetadata(s),l}catch(l){const c=l;if(!Zj(c)){if(i.deleteThrottleMetadata(s),o)return ts.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:s,measurementId:o};throw l}const u=Number((a=c==null?void 0:c.customData)==null?void 0:a.httpStatus)===503?q2(t,i.intervalMillis,jj):q2(t,i.intervalMillis),f={throttleEndTimeMillis:Date.now()+u,backoffCount:t+1};return i.setThrottleMetadata(s,f),ts.debug(`Calling attemptFetch again in ${u} millis`),oU(n,f,r,i)}}function Qj(n,e){return new Promise((t,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(s),r(Us.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Zj(n){if(!(n instanceof ea)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class eX{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function tX(n,e,t,r,i){if(i&&i.global){n("event",t,r);return}else{const s=await e,o={...r,send_to:s};n("event",t,o)}}async function nX(n,e,t,r){if(r&&r.global){const i={};for(const s of Object.keys(t))i[`user_properties.${s}`]=t[s];return n("set",i),Promise.resolve()}else{const i=await e;n("config",i,{update:!0,user_properties:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rX(){if(DF())try{await LF()}catch(n){return ts.warn(Us.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return ts.warn(Us.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function iX(n,e,t,r,i,s,o){const a=qj(n);a.then(p=>{t[p.measurementId]=p.appId,n.options.measurementId&&p.measurementId!==n.options.measurementId&&ts.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${p.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(p=>ts.error(p)),e.push(a);const l=rX().then(p=>{if(p)return r.getId()}),[c,u]=await Promise.all([a,l]);$j(s)||Uj(s,c.measurementId),i("js",new Date);const f=(o==null?void 0:o.config)??{};return f[Lj]="firebase",f.update=!0,u!=null&&(f[Dj]=u),i("config",c.measurementId,f),c.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sX{constructor(e){this.app=e}_delete(){return delete rd[this.app.options.appId],Promise.resolve()}}let rd={},lD=[];const cD={};let V1="dataLayer",oX="gtag",uD,aM,hD=!1;function aX(){const n=[];if(PF()&&n.push("This is a browser extension environment."),C$()||n.push("Cookies are not available."),n.length>0){const e=n.map((r,i)=>`(${i+1}) ${r}`).join(" "),t=Us.create("invalid-analytics-context",{errorInfo:e});ts.warn(t.message)}}function lX(n,e,t){aX();const r=n.options.appId;if(!r)throw Us.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)ts.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Us.create("no-api-key");if(rd[r]!=null)throw Us.create("already-exists",{id:r});if(!hD){zj(V1);const{wrappedGtag:s,gtagCore:o}=Wj(rd,lD,cD,V1,oX);aM=s,uD=o,hD=!0}return rd[r]=iX(n,lD,cD,e,uD,V1,t),new sX(n)}function cX(n=tM()){n=vi(n);const e=wh(n,fE);return e.isInitialized()?e.getImmediate():uX(n)}function uX(n,e={}){const t=wh(n,fE);if(t.isInitialized()){const i=t.getImmediate();if(Dc(e,t.getOptions()))return i;throw Us.create("already-initialized")}return t.initialize({options:e})}function hX(n,e,t){n=vi(n),nX(aM,rd[n.app.options.appId],e,t).catch(r=>ts.error(r))}function fX(n,e,t,r){n=vi(n),tX(aM,rd[n.app.options.appId],e,t,r).catch(i=>ts.error(i))}const fD="@firebase/analytics",dD="0.10.19";function dX(){Ta(new Ko(fE,(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return lX(r,i,t)},"PUBLIC")),Ta(new Ko("analytics-internal",n,"PRIVATE")),go(fD,dD),go(fD,dD,"esm2020");function n(e){try{const t=e.getProvider(fE).getImmediate();return{logEvent:(r,i,s)=>fX(t,r,i,s),setUserProperties:(r,i)=>hX(t,r,i)}}catch(t){throw Us.create("interop-component-reg-failed",{reason:t})}}}dX();function aU(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const pX=aU,lU=new Ah("auth","Firebase",aU());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE=new vx("@firebase/auth");function mX(n,...e){dE.logLevel<=fn.WARN&&dE.warn(`Auth (${Yd}): ${n}`,...e)}function E_(n,...e){dE.logLevel<=fn.ERROR&&dE.error(`Auth (${Yd}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jo(n,...e){throw lM(n,...e)}function _a(n,...e){return lM(n,...e)}function cU(n,e,t){const r={...pX(),[e]:t};return new Ah("auth","Firebase",r).create(e,{appName:n.name})}function fl(n){return cU(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function lM(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return lU.create(n,...e)}function zt(n,e,...t){if(!n)throw lM(e,...t)}function sl(n){const e="INTERNAL ASSERTION FAILED: "+n;throw E_(e),new Error(e)}function Sl(n,e){n||sl(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pT(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function gX(){return pD()==="http:"||pD()==="https:"}function pD(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yX(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(gX()||PF()||"connection"in navigator)?navigator.onLine:!0}function vX(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(e,t){this.shortDelay=e,this.longDelay=t,Sl(t>e,"Short delay should be less than long delay!"),this.isMobile=E$()||w$()}get(){return yX()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cM(n,e){Sl(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;sl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;sl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;sl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _X={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EX=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],xX=new ry(3e4,6e4);function Jc(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Pl(n,e,t,r,i={}){return hU(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=ny({key:n.config.apiKey,...o}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:l,...s};return A$()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&Jd(n.emulatorConfig.host)&&(c.credentials="include"),uU.fetch()(await fU(n,n.config.apiHost,t,a),c)})}async function hU(n,e,t){n._canInitEmulator=!1;const r={..._X,...e};try{const i=new wX(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Vv(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Vv(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Vv(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Vv(n,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw cU(n,u,c);Jo(n,u)}}catch(i){if(i instanceof ea)throw i;Jo(n,"network-request-failed",{message:String(i)})}}async function iy(n,e,t,r,i={}){const s=await Pl(n,e,t,r,i);return"mfaPendingCredential"in s&&Jo(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function fU(n,e,t,r){const i=`${e}${t}?${r}`,s=n,o=s.config.emulator?cM(n.config,i):`${n.config.apiScheme}://${i}`;return EX.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function AX(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class wX{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(_a(this.auth,"network-request-failed")),xX.get())})}}function Vv(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=_a(n,e,r);return i.customData._tokenResponse=t,i}function mD(n){return n!==void 0&&n.enterprise!==void 0}class SX{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return AX(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function TX(n,e){return Pl(n,"GET","/v2/recaptchaConfig",Jc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CX(n,e){return Pl(n,"POST","/v1/accounts:delete",e)}async function pE(n,e){return Pl(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bX(n,e=!1){const t=vi(n),r=await t.getIdToken(e),i=uM(r);zt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:zm(G1(i.auth_time)),issuedAtTime:zm(G1(i.iat)),expirationTime:zm(G1(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function G1(n){return Number(n)*1e3}function uM(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return E_("JWT malformed, contained fewer than 3 sections"),null;try{const i=TF(t);return i?JSON.parse(i):(E_("Failed to decode base64 JWT payload"),null)}catch(i){return E_("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function gD(n){const e=uM(n);return zt(e,"internal-error"),zt(typeof e.exp<"u","internal-error"),zt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xd(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof ea&&MX(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function MX({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RX{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=zm(this.lastLoginAt),this.creationTime=zm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mE(n){var f;const e=n.auth,t=await n.getIdToken(),r=await xd(n,pE(e,{idToken:t}));zt(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=(f=i.providerUserInfo)!=null&&f.length?dU(i.providerUserInfo):[],o=PX(n.providerData,s),a=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!(o!=null&&o.length),c=a?l:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new mT(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(n,u)}async function IX(n){const e=vi(n);await mE(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function PX(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function dU(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DX(n,e){const t=await hU(n,{},async()=>{const r=ny({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await fU(n,i,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return n.emulatorConfig&&Jd(n.emulatorConfig.host)&&(l.credentials="include"),uU.fetch()(o,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function LX(n,e){return Pl(n,"POST","/v2/accounts:revokeToken",Jc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){zt(e.idToken,"internal-error"),zt(typeof e.idToken<"u","internal-error"),zt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):gD(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){zt(e.length!==0,"internal-error");const t=gD(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(zt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await DX(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new id;return r&&(zt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(zt(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(zt(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new id,this.toJSON())}_performRefresh(){return sl("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $l(n,e){zt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Vo{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new RX(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new mT(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await xd(this,this.stsTokenManager.getToken(this.auth,e));return zt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return bX(this,e)}reload(){return IX(this)}_assign(e){this!==e&&(zt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Vo({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){zt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await mE(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(uo(this.auth.app))return Promise.reject(fl(this.auth));const e=await this.getIdToken();return await xd(this,CX(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,u=t.lastLoginAt??void 0,{uid:f,emailVerified:p,isAnonymous:m,providerData:y,stsTokenManager:A}=t;zt(f&&A,e,"internal-error");const _=id.fromJSON(this.name,A);zt(typeof f=="string",e,"internal-error"),$l(r,e.name),$l(i,e.name),zt(typeof p=="boolean",e,"internal-error"),zt(typeof m=="boolean",e,"internal-error"),$l(s,e.name),$l(o,e.name),$l(a,e.name),$l(l,e.name),$l(c,e.name),$l(u,e.name);const g=new Vo({uid:f,auth:e,email:i,emailVerified:p,displayName:r,isAnonymous:m,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:_,createdAt:c,lastLoginAt:u});return y&&Array.isArray(y)&&(g.providerData=y.map(E=>({...E}))),l&&(g._redirectEventId=l),g}static async _fromIdTokenResponse(e,t,r=!1){const i=new id;i.updateFromServerResponse(t);const s=new Vo({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await mE(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];zt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?dU(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new id;a.updateFromIdToken(r);const l=new Vo({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new mT(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD=new Map;function ol(n){Sl(n instanceof Function,"Expected a class definition");let e=yD.get(n);return e?(Sl(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,yD.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}pU.type="NONE";const vD=pU;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(n,e,t){return`firebase:${n}:${e}:${t}`}class sd{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=x_(this.userKey,i.apiKey,s),this.fullPersistenceKey=x_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await pE(this.auth,{idToken:e}).catch(()=>{});return t?Vo._fromGetAccountInfoResponse(this.auth,t,e):null}return Vo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new sd(ol(vD),e,r);const i=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||ol(vD);const o=x_(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){let f;if(typeof u=="string"){const p=await pE(e,{idToken:u}).catch(()=>{});if(!p)break;f=await Vo._fromGetAccountInfoResponse(e,p,u)}else f=Vo._fromJSON(e,u);c!==s&&(a=f),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new sd(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new sd(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _D(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(vU(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(mU(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(EU(e))return"Blackberry";if(xU(e))return"Webos";if(gU(e))return"Safari";if((e.includes("chrome/")||yU(e))&&!e.includes("edge/"))return"Chrome";if(_U(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function mU(n=zi()){return/firefox\//i.test(n)}function gU(n=zi()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function yU(n=zi()){return/crios\//i.test(n)}function vU(n=zi()){return/iemobile/i.test(n)}function _U(n=zi()){return/android/i.test(n)}function EU(n=zi()){return/blackberry/i.test(n)}function xU(n=zi()){return/webos/i.test(n)}function hM(n=zi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function OX(n=zi()){var e;return hM(n)&&!!((e=window.navigator)!=null&&e.standalone)}function BX(){return S$()&&document.documentMode===10}function AU(n=zi()){return hM(n)||_U(n)||xU(n)||EU(n)||/windows phone/i.test(n)||vU(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wU(n,e=[]){let t;switch(n){case"Browser":t=_D(zi());break;case"Worker":t=`${_D(zi())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Yd}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NX{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kX(n,e={}){return Pl(n,"GET","/v2/passwordPolicy",Jc(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FX=6;class UX{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??FX,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zX{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ED(this),this.idTokenSubscription=new ED(this),this.beforeStateQueue=new NX(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=lU,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ol(t)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await sd.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await pE(this,{idToken:e}),r=await Vo._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(uo(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return zt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await mE(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=vX()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(uo(this.app))return Promise.reject(fl(this));const t=e?vi(e):null;return t&&zt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&zt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return uo(this.app)?Promise.reject(fl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return uo(this.app)?Promise.reject(fl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ol(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await kX(this),t=new UX(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ah("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await LX(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ol(e)||this._popupRedirectResolver;zt(t,this,"argument-error"),this.redirectPersistenceManager=await sd.create(this,[ol(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(zt(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return zt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wU(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(uo(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&mX(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Sh(n){return vi(n)}class ED{constructor(e){this.auth=e,this.observer=null,this.addObserver=P$(t=>this.observer=t)}get next(){return zt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xx={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function HX(n){xx=n}function SU(n){return xx.loadJS(n)}function VX(){return xx.recaptchaEnterpriseScript}function GX(){return xx.gapiScript}function WX(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class $X{constructor(){this.enterprise=new jX}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class jX{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const XX="recaptcha-enterprise",TU="NO_RECAPTCHA";class KX{constructor(e){this.type=XX,this.auth=Sh(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{TX(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new SX(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;mD(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(c=>{o(c)}).catch(()=>{o(TU)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new $X().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&mD(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=VX();l.length!==0&&(l+=a),SU(l).then(()=>{i(a,s,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function Jp(n,e,t,r=!1,i=!1){const s=new KX(n);let o;if(i)o=TU;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const a={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function gT(n,e,t,r,i){var s,o;if(i==="EMAIL_PASSWORD_PROVIDER")if((s=n._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Jp(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await Jp(n,e,t,t==="getOobCode");return r(n,l)}else return Promise.reject(a)});else if(i==="PHONE_PROVIDER")if((o=n._getRecaptchaConfig())!=null&&o.isProviderEnabled("PHONE_PROVIDER")){const a=await Jp(n,e,t);return r(n,a).catch(async l=>{var c;if(((c=n._getRecaptchaConfig())==null?void 0:c.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(l.code==="auth/missing-recaptcha-token"||l.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const u=await Jp(n,e,t,!1,!0);return r(n,u)}return Promise.reject(l)})}else{const a=await Jp(n,e,t,!1,!0);return r(n,a)}else return Promise.reject(i+" provider is not supported.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JX(n,e){const t=wh(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(Dc(s,e??{}))return i;Jo(i,"already-initialized")}return t.initialize({options:e})}function YX(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(ol);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function qX(n,e,t){const r=Sh(n);zt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),s=CU(e),{host:o,port:a}=QX(e),l=a===null?"":`:${a}`,c={url:`${s}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){zt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),zt(Dc(c,r.config.emulator)&&Dc(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,Jd(o)?(RF(`${s}//${o}${l}`),IF("Auth",!0)):i||ZX()}function CU(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function QX(n){const e=CU(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:xD(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:xD(o)}}}function xD(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function ZX(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return sl("not implemented")}_getIdTokenResponse(e){return sl("not implemented")}_linkToIdToken(e,t){return sl("not implemented")}_getReauthenticationResolver(e){return sl("not implemented")}}async function eK(n,e){return Pl(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tK(n,e){return iy(n,"POST","/v1/accounts:signInWithPassword",Jc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nK(n,e){return iy(n,"POST","/v1/accounts:signInWithEmailLink",Jc(n,e))}async function rK(n,e){return iy(n,"POST","/v1/accounts:signInWithEmailLink",Jc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg extends fM{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Eg(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Eg(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gT(e,t,"signInWithPassword",tK,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return nK(e,{email:this._email,oobCode:this._password});default:Jo(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gT(e,r,"signUpPassword",eK,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return rK(e,{idToken:t,email:this._email,oobCode:this._password});default:Jo(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function od(n,e){return iy(n,"POST","/v1/accounts:signInWithIdp",Jc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iK="http://localhost";class ch extends fM{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ch(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Jo("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const o=new ch(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return od(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,od(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,od(e,t)}buildRequest(){const e={requestUri:iK,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ny(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sK(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function oK(n){const e=Tm(Cm(n)).link,t=e?Tm(Cm(e)).deep_link_id:null,r=Tm(Cm(n)).deep_link_id;return(r?Tm(Cm(r)).link:null)||r||t||e||n}class dM{constructor(e){const t=Tm(Cm(e)),r=t.apiKey??null,i=t.oobCode??null,s=sK(t.mode??null);zt(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=oK(e);try{return new dM(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd{constructor(){this.providerId=qd.PROVIDER_ID}static credential(e,t){return Eg._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=dM.parseLink(t);return zt(r,"argument-error"),Eg._fromEmailAndCode(e,r.code,r.tenantId)}}qd.PROVIDER_ID="password";qd.EMAIL_PASSWORD_SIGN_IN_METHOD="password";qd.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bU{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy extends bU{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc extends sy{constructor(){super("facebook.com")}static credential(e){return ch._fromParams({providerId:cc.PROVIDER_ID,signInMethod:cc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cc.credentialFromTaggedObject(e)}static credentialFromError(e){return cc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return cc.credential(e.oauthAccessToken)}catch{return null}}}cc.FACEBOOK_SIGN_IN_METHOD="facebook.com";cc.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc extends sy{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ch._fromParams({providerId:uc.PROVIDER_ID,signInMethod:uc.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return uc.credentialFromTaggedObject(e)}static credentialFromError(e){return uc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return uc.credential(t,r)}catch{return null}}}uc.GOOGLE_SIGN_IN_METHOD="google.com";uc.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc extends sy{constructor(){super("github.com")}static credential(e){return ch._fromParams({providerId:hc.PROVIDER_ID,signInMethod:hc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hc.credentialFromTaggedObject(e)}static credentialFromError(e){return hc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return hc.credential(e.oauthAccessToken)}catch{return null}}}hc.GITHUB_SIGN_IN_METHOD="github.com";hc.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc extends sy{constructor(){super("twitter.com")}static credential(e,t){return ch._fromParams({providerId:fc.PROVIDER_ID,signInMethod:fc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return fc.credentialFromTaggedObject(e)}static credentialFromError(e){return fc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return fc.credential(t,r)}catch{return null}}}fc.TWITTER_SIGN_IN_METHOD="twitter.com";fc.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aK(n,e){return iy(n,"POST","/v1/accounts:signUp",Jc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Vo._fromIdTokenResponse(e,r,i),o=AD(r);return new uh({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=AD(r);return new uh({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function AD(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE extends ea{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,gE.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new gE(e,t,r,i)}}function MU(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?gE._fromErrorAndOperation(n,s,e,r):s})}async function lK(n,e,t=!1){const r=await xd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return uh._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cK(n,e,t=!1){const{auth:r}=n;if(uo(r.app))return Promise.reject(fl(r));const i="reauthenticate";try{const s=await xd(n,MU(r,i,e,n),t);zt(s.idToken,r,"internal-error");const o=uM(s.idToken);zt(o,r,"internal-error");const{sub:a}=o;return zt(n.uid===a,r,"user-mismatch"),uh._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Jo(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RU(n,e,t=!1){if(uo(n.app))return Promise.reject(fl(n));const r="signIn",i=await MU(n,r,e),s=await uh._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function uK(n,e){return RU(Sh(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IU(n){const e=Sh(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function hK(n,e,t){if(uo(n.app))return Promise.reject(fl(n));const r=Sh(n),o=await gT(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",aK,"EMAIL_PASSWORD_PROVIDER").catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&IU(n),l}),a=await uh._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function fK(n,e,t){return uo(n.app)?Promise.reject(fl(n)):uK(vi(n),qd.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&IU(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dK(n,e){return Pl(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pK(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=vi(n),s={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await xd(r,dK(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function mK(n,e,t,r){return vi(n).onIdTokenChanged(e,t,r)}function gK(n,e,t){return vi(n).beforeAuthStateChanged(e,t)}function yK(n,e,t,r){return vi(n).onAuthStateChanged(e,t,r)}function vK(n){return vi(n).signOut()}const yE="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PU{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(yE,"1"),this.storage.removeItem(yE),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _K=1e3,EK=10;class DU extends PU{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=AU(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);BX()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,EK):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},_K)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}DU.type="LOCAL";const xK=DU;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LU extends PU{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}LU.type="SESSION";const OU=LU;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AK(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Ax(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(t.origin,s)),l=await AK(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ax.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pM(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wK{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=pM("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){const p=f;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ea(){return window}function SK(n){Ea().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BU(){return typeof Ea().WorkerGlobalScope<"u"&&typeof Ea().importScripts=="function"}async function TK(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function CK(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function bK(){return BU()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NU="firebaseLocalStorageDb",MK=1,vE="firebaseLocalStorage",kU="fbase_key";class oy{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function wx(n,e){return n.transaction([vE],e?"readwrite":"readonly").objectStore(vE)}function RK(){const n=indexedDB.deleteDatabase(NU);return new oy(n).toPromise()}function yT(){const n=indexedDB.open(NU,MK);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(vE,{keyPath:kU})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(vE)?e(r):(r.close(),await RK(),e(await yT()))})})}async function wD(n,e,t){const r=wx(n,!0).put({[kU]:e,value:t});return new oy(r).toPromise()}async function IK(n,e){const t=wx(n,!1).get(e),r=await new oy(t).toPromise();return r===void 0?null:r.value}function SD(n,e){const t=wx(n,!0).delete(e);return new oy(t).toPromise()}const PK=800,DK=3;class FU{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await yT(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>DK)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return BU()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ax._getInstance(bK()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await TK(),!this.activeServiceWorker)return;this.sender=new wK(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||CK()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await yT();return await wD(e,yE,"1"),await SD(e,yE),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>wD(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>IK(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>SD(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=wx(i,!1).getAll();return new oy(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),PK)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}FU.type="LOCAL";const LK=FU;new ry(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OK(n,e){return e?ol(e):(zt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM extends fM{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return od(e,this._buildIdpRequest())}_linkToIdToken(e,t){return od(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return od(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function BK(n){return RU(n.auth,new mM(n),n.bypassAuthState)}function NK(n){const{auth:e,user:t}=n;return zt(t,e,"internal-error"),cK(t,new mM(n),n.bypassAuthState)}async function kK(n){const{auth:e,user:t}=n;return zt(t,e,"internal-error"),lK(t,new mM(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return BK;case"linkViaPopup":case"linkViaRedirect":return kK;case"reauthViaPopup":case"reauthViaRedirect":return NK;default:Jo(this.auth,"internal-error")}}resolve(e){Sl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Sl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FK=new ry(2e3,1e4);class Gf extends UU{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Gf.currentPopupAction&&Gf.currentPopupAction.cancel(),Gf.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return zt(e,this.auth,"internal-error"),e}async onExecution(){Sl(this.filter.length===1,"Popup operations only handle one event");const e=pM();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(_a(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(_a(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Gf.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_a(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,FK.get())};e()}}Gf.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UK="pendingRedirect",A_=new Map;class zK extends UU{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=A_.get(this.auth._key());if(!e){try{const r=await HK(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}A_.set(this.auth._key(),e)}return this.bypassAuthState||A_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function HK(n,e){const t=WK(e),r=GK(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function VK(n,e){A_.set(n._key(),e)}function GK(n){return ol(n._redirectPersistence)}function WK(n){return x_(UK,n.config.apiKey,n.name)}async function $K(n,e,t=!1){if(uo(n.app))return Promise.reject(fl(n));const r=Sh(n),i=OK(r,e),o=await new zK(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jK=10*60*1e3;class XK{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!KK(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!zU(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(_a(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=jK&&this.cachedEventUids.clear(),this.cachedEventUids.has(TD(e))}saveEventToCache(e){this.cachedEventUids.add(TD(e)),this.lastProcessedEventTime=Date.now()}}function TD(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function zU({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function KK(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zU(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JK(n,e={}){return Pl(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YK=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qK=/^https?/;async function QK(n){if(n.config.emulator)return;const{authorizedDomains:e}=await JK(n);for(const t of e)try{if(ZK(t))return}catch{}Jo(n,"unauthorized-domain")}function ZK(n){const e=pT(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!qK.test(t))return!1;if(YK.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eJ=new ry(3e4,6e4);function CD(){const n=Ea().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function tJ(n){return new Promise((e,t)=>{var i,s,o;function r(){CD(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{CD(),t(_a(n,"network-request-failed"))},timeout:eJ.get()})}if((s=(i=Ea().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Ea().gapi)!=null&&o.load)r();else{const a=WX("iframefcb");return Ea()[a]=()=>{gapi.load?r():t(_a(n,"network-request-failed"))},SU(`${GX()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw w_=null,e})}let w_=null;function nJ(n){return w_=w_||tJ(n),w_}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rJ=new ry(5e3,15e3),iJ="__/auth/iframe",sJ="emulator/auth/iframe",oJ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},aJ=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function lJ(n){const e=n.config;zt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?cM(e,sJ):`https://${n.config.authDomain}/${iJ}`,r={apiKey:e.apiKey,appName:n.name,v:Yd},i=aJ.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${ny(r).slice(1)}`}async function cJ(n){const e=await nJ(n),t=Ea().gapi;return zt(t,n,"internal-error"),e.open({where:document.body,url:lJ(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:oJ,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=_a(n,"network-request-failed"),a=Ea().setTimeout(()=>{s(o)},rJ.get());function l(){Ea().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uJ={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},hJ=500,fJ=600,dJ="_blank",pJ="http://localhost";class bD{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function mJ(n,e,t,r=hJ,i=fJ){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...uJ,width:r.toString(),height:i.toString(),top:s,left:o},c=zi().toLowerCase();t&&(a=yU(c)?dJ:t),mU(c)&&(e=e||pJ,l.scrollbars="yes");const u=Object.entries(l).reduce((p,[m,y])=>`${p}${m}=${y},`,"");if(OX(c)&&a!=="_self")return gJ(e||"",a),new bD(null);const f=window.open(e||"",a,u);zt(f,n,"popup-blocked");try{f.focus()}catch{}return new bD(f)}function gJ(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yJ="__/auth/handler",vJ="emulator/auth/handler",_J=encodeURIComponent("fac");async function MD(n,e,t,r,i,s){zt(n.config.authDomain,n,"auth-domain-config-required"),zt(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Yd,eventId:i};if(e instanceof bU){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",I$(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,f]of Object.entries(s||{}))o[u]=f}if(e instanceof sy){const u=e.getScopes().filter(f=>f!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await n._getAppCheckToken(),c=l?`#${_J}=${encodeURIComponent(l)}`:"";return`${EJ(n)}?${ny(a).slice(1)}${c}`}function EJ({config:n}){return n.emulator?cM(n,vJ):`https://${n.authDomain}/${yJ}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W1="webStorageSupport";class xJ{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=OU,this._completeRedirectFn=$K,this._overrideRedirectResult=VK}async _openPopup(e,t,r,i){var o;Sl((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await MD(e,t,r,pT(),i);return mJ(e,s,pM())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await MD(e,t,r,pT(),i);return SK(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Sl(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await cJ(e),r=new XK(e);return t.register("authEvent",i=>(zt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(W1,{type:W1},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[W1];s!==void 0&&t(!!s),Jo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=QK(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return AU()||gU()||hM()}}const AJ=xJ;var RD="@firebase/auth",ID="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wJ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){zt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SJ(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function TJ(n){Ta(new Ko("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;zt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wU(n)},c=new zX(r,i,s,l);return YX(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ta(new Ko("auth-internal",e=>{const t=Sh(e.getProvider("auth").getImmediate());return(r=>new wJ(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),go(RD,ID,SJ(n)),go(RD,ID,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CJ=5*60,bJ=MF("authIdTokenMaxAge")||CJ;let PD=null;const MJ=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>bJ)return;const i=t==null?void 0:t.token;PD!==i&&(PD=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function RJ(n=tM()){const e=wh(n,"auth");if(e.isInitialized())return e.getImmediate();const t=JX(n,{popupRedirectResolver:AJ,persistence:[LK,xK,OU]}),r=MF("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=MJ(s.toString());gK(t,o,()=>o(t.currentUser)),mK(t,a=>o(a))}}const i=CF("auth");return i&&qX(t,`http://${i}`),t}function IJ(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}HX({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=_a("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",IJ().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});TJ("Browser");var DD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gM;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(b,R){function C(){}C.prototype=R.prototype,b.F=R.prototype,b.prototype=new C,b.prototype.constructor=b,b.D=function(M,B,F){for(var z=Array(arguments.length-2),j=2;j<arguments.length;j++)z[j-2]=arguments[j];return R.prototype[B].apply(M,z)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(b,R,C){C||(C=0);const M=Array(16);if(typeof R=="string")for(var B=0;B<16;++B)M[B]=R.charCodeAt(C++)|R.charCodeAt(C++)<<8|R.charCodeAt(C++)<<16|R.charCodeAt(C++)<<24;else for(B=0;B<16;++B)M[B]=R[C++]|R[C++]<<8|R[C++]<<16|R[C++]<<24;R=b.g[0],C=b.g[1],B=b.g[2];let F=b.g[3],z;z=R+(F^C&(B^F))+M[0]+3614090360&4294967295,R=C+(z<<7&4294967295|z>>>25),z=F+(B^R&(C^B))+M[1]+3905402710&4294967295,F=R+(z<<12&4294967295|z>>>20),z=B+(C^F&(R^C))+M[2]+606105819&4294967295,B=F+(z<<17&4294967295|z>>>15),z=C+(R^B&(F^R))+M[3]+3250441966&4294967295,C=B+(z<<22&4294967295|z>>>10),z=R+(F^C&(B^F))+M[4]+4118548399&4294967295,R=C+(z<<7&4294967295|z>>>25),z=F+(B^R&(C^B))+M[5]+1200080426&4294967295,F=R+(z<<12&4294967295|z>>>20),z=B+(C^F&(R^C))+M[6]+2821735955&4294967295,B=F+(z<<17&4294967295|z>>>15),z=C+(R^B&(F^R))+M[7]+4249261313&4294967295,C=B+(z<<22&4294967295|z>>>10),z=R+(F^C&(B^F))+M[8]+1770035416&4294967295,R=C+(z<<7&4294967295|z>>>25),z=F+(B^R&(C^B))+M[9]+2336552879&4294967295,F=R+(z<<12&4294967295|z>>>20),z=B+(C^F&(R^C))+M[10]+4294925233&4294967295,B=F+(z<<17&4294967295|z>>>15),z=C+(R^B&(F^R))+M[11]+2304563134&4294967295,C=B+(z<<22&4294967295|z>>>10),z=R+(F^C&(B^F))+M[12]+1804603682&4294967295,R=C+(z<<7&4294967295|z>>>25),z=F+(B^R&(C^B))+M[13]+4254626195&4294967295,F=R+(z<<12&4294967295|z>>>20),z=B+(C^F&(R^C))+M[14]+2792965006&4294967295,B=F+(z<<17&4294967295|z>>>15),z=C+(R^B&(F^R))+M[15]+1236535329&4294967295,C=B+(z<<22&4294967295|z>>>10),z=R+(B^F&(C^B))+M[1]+4129170786&4294967295,R=C+(z<<5&4294967295|z>>>27),z=F+(C^B&(R^C))+M[6]+3225465664&4294967295,F=R+(z<<9&4294967295|z>>>23),z=B+(R^C&(F^R))+M[11]+643717713&4294967295,B=F+(z<<14&4294967295|z>>>18),z=C+(F^R&(B^F))+M[0]+3921069994&4294967295,C=B+(z<<20&4294967295|z>>>12),z=R+(B^F&(C^B))+M[5]+3593408605&4294967295,R=C+(z<<5&4294967295|z>>>27),z=F+(C^B&(R^C))+M[10]+38016083&4294967295,F=R+(z<<9&4294967295|z>>>23),z=B+(R^C&(F^R))+M[15]+3634488961&4294967295,B=F+(z<<14&4294967295|z>>>18),z=C+(F^R&(B^F))+M[4]+3889429448&4294967295,C=B+(z<<20&4294967295|z>>>12),z=R+(B^F&(C^B))+M[9]+568446438&4294967295,R=C+(z<<5&4294967295|z>>>27),z=F+(C^B&(R^C))+M[14]+3275163606&4294967295,F=R+(z<<9&4294967295|z>>>23),z=B+(R^C&(F^R))+M[3]+4107603335&4294967295,B=F+(z<<14&4294967295|z>>>18),z=C+(F^R&(B^F))+M[8]+1163531501&4294967295,C=B+(z<<20&4294967295|z>>>12),z=R+(B^F&(C^B))+M[13]+2850285829&4294967295,R=C+(z<<5&4294967295|z>>>27),z=F+(C^B&(R^C))+M[2]+4243563512&4294967295,F=R+(z<<9&4294967295|z>>>23),z=B+(R^C&(F^R))+M[7]+1735328473&4294967295,B=F+(z<<14&4294967295|z>>>18),z=C+(F^R&(B^F))+M[12]+2368359562&4294967295,C=B+(z<<20&4294967295|z>>>12),z=R+(C^B^F)+M[5]+4294588738&4294967295,R=C+(z<<4&4294967295|z>>>28),z=F+(R^C^B)+M[8]+2272392833&4294967295,F=R+(z<<11&4294967295|z>>>21),z=B+(F^R^C)+M[11]+1839030562&4294967295,B=F+(z<<16&4294967295|z>>>16),z=C+(B^F^R)+M[14]+4259657740&4294967295,C=B+(z<<23&4294967295|z>>>9),z=R+(C^B^F)+M[1]+2763975236&4294967295,R=C+(z<<4&4294967295|z>>>28),z=F+(R^C^B)+M[4]+1272893353&4294967295,F=R+(z<<11&4294967295|z>>>21),z=B+(F^R^C)+M[7]+4139469664&4294967295,B=F+(z<<16&4294967295|z>>>16),z=C+(B^F^R)+M[10]+3200236656&4294967295,C=B+(z<<23&4294967295|z>>>9),z=R+(C^B^F)+M[13]+681279174&4294967295,R=C+(z<<4&4294967295|z>>>28),z=F+(R^C^B)+M[0]+3936430074&4294967295,F=R+(z<<11&4294967295|z>>>21),z=B+(F^R^C)+M[3]+3572445317&4294967295,B=F+(z<<16&4294967295|z>>>16),z=C+(B^F^R)+M[6]+76029189&4294967295,C=B+(z<<23&4294967295|z>>>9),z=R+(C^B^F)+M[9]+3654602809&4294967295,R=C+(z<<4&4294967295|z>>>28),z=F+(R^C^B)+M[12]+3873151461&4294967295,F=R+(z<<11&4294967295|z>>>21),z=B+(F^R^C)+M[15]+530742520&4294967295,B=F+(z<<16&4294967295|z>>>16),z=C+(B^F^R)+M[2]+3299628645&4294967295,C=B+(z<<23&4294967295|z>>>9),z=R+(B^(C|~F))+M[0]+4096336452&4294967295,R=C+(z<<6&4294967295|z>>>26),z=F+(C^(R|~B))+M[7]+1126891415&4294967295,F=R+(z<<10&4294967295|z>>>22),z=B+(R^(F|~C))+M[14]+2878612391&4294967295,B=F+(z<<15&4294967295|z>>>17),z=C+(F^(B|~R))+M[5]+4237533241&4294967295,C=B+(z<<21&4294967295|z>>>11),z=R+(B^(C|~F))+M[12]+1700485571&4294967295,R=C+(z<<6&4294967295|z>>>26),z=F+(C^(R|~B))+M[3]+2399980690&4294967295,F=R+(z<<10&4294967295|z>>>22),z=B+(R^(F|~C))+M[10]+4293915773&4294967295,B=F+(z<<15&4294967295|z>>>17),z=C+(F^(B|~R))+M[1]+2240044497&4294967295,C=B+(z<<21&4294967295|z>>>11),z=R+(B^(C|~F))+M[8]+1873313359&4294967295,R=C+(z<<6&4294967295|z>>>26),z=F+(C^(R|~B))+M[15]+4264355552&4294967295,F=R+(z<<10&4294967295|z>>>22),z=B+(R^(F|~C))+M[6]+2734768916&4294967295,B=F+(z<<15&4294967295|z>>>17),z=C+(F^(B|~R))+M[13]+1309151649&4294967295,C=B+(z<<21&4294967295|z>>>11),z=R+(B^(C|~F))+M[4]+4149444226&4294967295,R=C+(z<<6&4294967295|z>>>26),z=F+(C^(R|~B))+M[11]+3174756917&4294967295,F=R+(z<<10&4294967295|z>>>22),z=B+(R^(F|~C))+M[2]+718787259&4294967295,B=F+(z<<15&4294967295|z>>>17),z=C+(F^(B|~R))+M[9]+3951481745&4294967295,b.g[0]=b.g[0]+R&4294967295,b.g[1]=b.g[1]+(B+(z<<21&4294967295|z>>>11))&4294967295,b.g[2]=b.g[2]+B&4294967295,b.g[3]=b.g[3]+F&4294967295}r.prototype.v=function(b,R){R===void 0&&(R=b.length);const C=R-this.blockSize,M=this.C;let B=this.h,F=0;for(;F<R;){if(B==0)for(;F<=C;)i(this,b,F),F+=this.blockSize;if(typeof b=="string"){for(;F<R;)if(M[B++]=b.charCodeAt(F++),B==this.blockSize){i(this,M),B=0;break}}else for(;F<R;)if(M[B++]=b[F++],B==this.blockSize){i(this,M),B=0;break}}this.h=B,this.o+=R},r.prototype.A=function(){var b=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);b[0]=128;for(var R=1;R<b.length-8;++R)b[R]=0;R=this.o*8;for(var C=b.length-8;C<b.length;++C)b[C]=R&255,R/=256;for(this.v(b),b=Array(16),R=0,C=0;C<4;++C)for(let M=0;M<32;M+=8)b[R++]=this.g[C]>>>M&255;return b};function s(b,R){var C=a;return Object.prototype.hasOwnProperty.call(C,b)?C[b]:C[b]=R(b)}function o(b,R){this.h=R;const C=[];let M=!0;for(let B=b.length-1;B>=0;B--){const F=b[B]|0;M&&F==R||(C[B]=F,M=!1)}this.g=C}var a={};function l(b){return-128<=b&&b<128?s(b,function(R){return new o([R|0],R<0?-1:0)}):new o([b|0],b<0?-1:0)}function c(b){if(isNaN(b)||!isFinite(b))return f;if(b<0)return _(c(-b));const R=[];let C=1;for(let M=0;b>=C;M++)R[M]=b/C|0,C*=4294967296;return new o(R,0)}function u(b,R){if(b.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(b.charAt(0)=="-")return _(u(b.substring(1),R));if(b.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=c(Math.pow(R,8));let M=f;for(let F=0;F<b.length;F+=8){var B=Math.min(8,b.length-F);const z=parseInt(b.substring(F,F+B),R);B<8?(B=c(Math.pow(R,B)),M=M.j(B).add(c(z))):(M=M.j(C),M=M.add(c(z)))}return M}var f=l(0),p=l(1),m=l(16777216);n=o.prototype,n.m=function(){if(A(this))return-_(this).m();let b=0,R=1;for(let C=0;C<this.g.length;C++){const M=this.i(C);b+=(M>=0?M:4294967296+M)*R,R*=4294967296}return b},n.toString=function(b){if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(y(this))return"0";if(A(this))return"-"+_(this).toString(b);const R=c(Math.pow(b,6));var C=this;let M="";for(;;){const B=T(C,R).g;C=g(C,B.j(R));let F=((C.g.length>0?C.g[0]:C.h)>>>0).toString(b);if(C=B,y(C))return F+M;for(;F.length<6;)F="0"+F;M=F+M}},n.i=function(b){return b<0?0:b<this.g.length?this.g[b]:this.h};function y(b){if(b.h!=0)return!1;for(let R=0;R<b.g.length;R++)if(b.g[R]!=0)return!1;return!0}function A(b){return b.h==-1}n.l=function(b){return b=g(this,b),A(b)?-1:y(b)?0:1};function _(b){const R=b.g.length,C=[];for(let M=0;M<R;M++)C[M]=~b.g[M];return new o(C,~b.h).add(p)}n.abs=function(){return A(this)?_(this):this},n.add=function(b){const R=Math.max(this.g.length,b.g.length),C=[];let M=0;for(let B=0;B<=R;B++){let F=M+(this.i(B)&65535)+(b.i(B)&65535),z=(F>>>16)+(this.i(B)>>>16)+(b.i(B)>>>16);M=z>>>16,F&=65535,z&=65535,C[B]=z<<16|F}return new o(C,C[C.length-1]&-2147483648?-1:0)};function g(b,R){return b.add(_(R))}n.j=function(b){if(y(this)||y(b))return f;if(A(this))return A(b)?_(this).j(_(b)):_(_(this).j(b));if(A(b))return _(this.j(_(b)));if(this.l(m)<0&&b.l(m)<0)return c(this.m()*b.m());const R=this.g.length+b.g.length,C=[];for(var M=0;M<2*R;M++)C[M]=0;for(M=0;M<this.g.length;M++)for(let B=0;B<b.g.length;B++){const F=this.i(M)>>>16,z=this.i(M)&65535,j=b.i(B)>>>16,Y=b.i(B)&65535;C[2*M+2*B]+=z*Y,E(C,2*M+2*B),C[2*M+2*B+1]+=F*Y,E(C,2*M+2*B+1),C[2*M+2*B+1]+=z*j,E(C,2*M+2*B+1),C[2*M+2*B+2]+=F*j,E(C,2*M+2*B+2)}for(b=0;b<R;b++)C[b]=C[2*b+1]<<16|C[2*b];for(b=R;b<2*R;b++)C[b]=0;return new o(C,0)};function E(b,R){for(;(b[R]&65535)!=b[R];)b[R+1]+=b[R]>>>16,b[R]&=65535,R++}function x(b,R){this.g=b,this.h=R}function T(b,R){if(y(R))throw Error("division by zero");if(y(b))return new x(f,f);if(A(b))return R=T(_(b),R),new x(_(R.g),_(R.h));if(A(R))return R=T(b,_(R)),new x(_(R.g),R.h);if(b.g.length>30){if(A(b)||A(R))throw Error("slowDivide_ only works with positive integers.");for(var C=p,M=R;M.l(b)<=0;)C=O(C),M=O(M);var B=I(C,1),F=I(M,1);for(M=I(M,2),C=I(C,2);!y(M);){var z=F.add(M);z.l(b)<=0&&(B=B.add(C),F=z),M=I(M,1),C=I(C,1)}return R=g(b,B.j(R)),new x(B,R)}for(B=f;b.l(R)>=0;){for(C=Math.max(1,Math.floor(b.m()/R.m())),M=Math.ceil(Math.log(C)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),F=c(C),z=F.j(R);A(z)||z.l(b)>0;)C-=M,F=c(C),z=F.j(R);y(F)&&(F=p),B=B.add(F),b=g(b,z)}return new x(B,b)}n.B=function(b){return T(this,b).h},n.and=function(b){const R=Math.max(this.g.length,b.g.length),C=[];for(let M=0;M<R;M++)C[M]=this.i(M)&b.i(M);return new o(C,this.h&b.h)},n.or=function(b){const R=Math.max(this.g.length,b.g.length),C=[];for(let M=0;M<R;M++)C[M]=this.i(M)|b.i(M);return new o(C,this.h|b.h)},n.xor=function(b){const R=Math.max(this.g.length,b.g.length),C=[];for(let M=0;M<R;M++)C[M]=this.i(M)^b.i(M);return new o(C,this.h^b.h)};function O(b){const R=b.g.length+1,C=[];for(let M=0;M<R;M++)C[M]=b.i(M)<<1|b.i(M-1)>>>31;return new o(C,b.h)}function I(b,R){const C=R>>5;R%=32;const M=b.g.length-C,B=[];for(let F=0;F<M;F++)B[F]=R>0?b.i(F+C)>>>R|b.i(F+C+1)<<32-R:b.i(F+C);return new o(B,b.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,gM=o}).apply(typeof DD<"u"?DD:typeof self<"u"?self:typeof window<"u"?window:{});var Gv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var HU,bm,VU,S_,vT,GU,WU,$U;(function(){var n,e=Object.defineProperty;function t(v){v=[typeof globalThis=="object"&&globalThis,v,typeof window=="object"&&window,typeof self=="object"&&self,typeof Gv=="object"&&Gv];for(var L=0;L<v.length;++L){var k=v[L];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var r=t(this);function i(v,L){if(L)e:{var k=r;v=v.split(".");for(var W=0;W<v.length-1;W++){var ge=v[W];if(!(ge in k))break e;k=k[ge]}v=v[v.length-1],W=k[v],L=L(W),L!=W&&L!=null&&e(k,v,{configurable:!0,writable:!0,value:L})}}i("Symbol.dispose",function(v){return v||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(v){return v||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(v){return v||function(L){var k=[],W;for(W in L)Object.prototype.hasOwnProperty.call(L,W)&&k.push([W,L[W]]);return k}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(v){var L=typeof v;return L=="object"&&v!=null||L=="function"}function l(v,L,k){return v.call.apply(v.bind,arguments)}function c(v,L,k){return c=l,c.apply(null,arguments)}function u(v,L){var k=Array.prototype.slice.call(arguments,1);return function(){var W=k.slice();return W.push.apply(W,arguments),v.apply(this,W)}}function f(v,L){function k(){}k.prototype=L.prototype,v.Z=L.prototype,v.prototype=new k,v.prototype.constructor=v,v.Ob=function(W,ge,_e){for(var Je=Array(arguments.length-2),$t=2;$t<arguments.length;$t++)Je[$t-2]=arguments[$t];return L.prototype[ge].apply(W,Je)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?v=>v&&AsyncContext.Snapshot.wrap(v):v=>v;function m(v){const L=v.length;if(L>0){const k=Array(L);for(let W=0;W<L;W++)k[W]=v[W];return k}return[]}function y(v,L){for(let W=1;W<arguments.length;W++){const ge=arguments[W];var k=typeof ge;if(k=k!="object"?k:ge?Array.isArray(ge)?"array":k:"null",k=="array"||k=="object"&&typeof ge.length=="number"){k=v.length||0;const _e=ge.length||0;v.length=k+_e;for(let Je=0;Je<_e;Je++)v[k+Je]=ge[Je]}else v.push(ge)}}class A{constructor(L,k){this.i=L,this.j=k,this.h=0,this.g=null}get(){let L;return this.h>0?(this.h--,L=this.g,this.g=L.next,L.next=null):L=this.i(),L}}function _(v){o.setTimeout(()=>{throw v},0)}function g(){var v=b;let L=null;return v.g&&(L=v.g,v.g=v.g.next,v.g||(v.h=null),L.next=null),L}class E{constructor(){this.h=this.g=null}add(L,k){const W=x.get();W.set(L,k),this.h?this.h.next=W:this.g=W,this.h=W}}var x=new A(()=>new T,v=>v.reset());class T{constructor(){this.next=this.g=this.h=null}set(L,k){this.h=L,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let O,I=!1,b=new E,R=()=>{const v=Promise.resolve(void 0);O=()=>{v.then(C)}};function C(){for(var v;v=g();){try{v.h.call(v.g)}catch(k){_(k)}var L=x;L.j(v),L.h<100&&(L.h++,v.next=L.g,L.g=v)}I=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function B(v,L){this.type=v,this.g=this.target=L,this.defaultPrevented=!1}B.prototype.h=function(){this.defaultPrevented=!0};var F=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var v=!1,L=Object.defineProperty({},"passive",{get:function(){v=!0}});try{const k=()=>{};o.addEventListener("test",k,L),o.removeEventListener("test",k,L)}catch{}return v}();function z(v){return/^[\s\xa0]*$/.test(v)}function j(v,L){B.call(this,v?v.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,v&&this.init(v,L)}f(j,B),j.prototype.init=function(v,L){const k=this.type=v.type,W=v.changedTouches&&v.changedTouches.length?v.changedTouches[0]:null;this.target=v.target||v.srcElement,this.g=L,L=v.relatedTarget,L||(k=="mouseover"?L=v.fromElement:k=="mouseout"&&(L=v.toElement)),this.relatedTarget=L,W?(this.clientX=W.clientX!==void 0?W.clientX:W.pageX,this.clientY=W.clientY!==void 0?W.clientY:W.pageY,this.screenX=W.screenX||0,this.screenY=W.screenY||0):(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0),this.button=v.button,this.key=v.key||"",this.ctrlKey=v.ctrlKey,this.altKey=v.altKey,this.shiftKey=v.shiftKey,this.metaKey=v.metaKey,this.pointerId=v.pointerId||0,this.pointerType=v.pointerType,this.state=v.state,this.i=v,v.defaultPrevented&&j.Z.h.call(this)},j.prototype.h=function(){j.Z.h.call(this);const v=this.i;v.preventDefault?v.preventDefault():v.returnValue=!1};var Y="closure_listenable_"+(Math.random()*1e6|0),oe=0;function le(v,L,k,W,ge){this.listener=v,this.proxy=null,this.src=L,this.type=k,this.capture=!!W,this.ha=ge,this.key=++oe,this.da=this.fa=!1}function X(v){v.da=!0,v.listener=null,v.proxy=null,v.src=null,v.ha=null}function ee(v,L,k){for(const W in v)L.call(k,v[W],W,v)}function ie(v,L){for(const k in v)L.call(void 0,v[k],k,v)}function fe(v){const L={};for(const k in v)L[k]=v[k];return L}const me="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function he(v,L){let k,W;for(let ge=1;ge<arguments.length;ge++){W=arguments[ge];for(k in W)v[k]=W[k];for(let _e=0;_e<me.length;_e++)k=me[_e],Object.prototype.hasOwnProperty.call(W,k)&&(v[k]=W[k])}}function Ae(v){this.src=v,this.g={},this.h=0}Ae.prototype.add=function(v,L,k,W,ge){const _e=v.toString();v=this.g[_e],v||(v=this.g[_e]=[],this.h++);const Je=Ie(v,L,W,ge);return Je>-1?(L=v[Je],k||(L.fa=!1)):(L=new le(L,this.src,_e,!!W,ge),L.fa=k,v.push(L)),L};function De(v,L){const k=L.type;if(k in v.g){var W=v.g[k],ge=Array.prototype.indexOf.call(W,L,void 0),_e;(_e=ge>=0)&&Array.prototype.splice.call(W,ge,1),_e&&(X(L),v.g[k].length==0&&(delete v.g[k],v.h--))}}function Ie(v,L,k,W){for(let ge=0;ge<v.length;++ge){const _e=v[ge];if(!_e.da&&_e.listener==L&&_e.capture==!!k&&_e.ha==W)return ge}return-1}var He="closure_lm_"+(Math.random()*1e6|0),rt={};function vt(v,L,k,W,ge){if(W&&W.once)return te(v,L,k,W,ge);if(Array.isArray(L)){for(let _e=0;_e<L.length;_e++)vt(v,L[_e],k,W,ge);return null}return k=$(k),v&&v[Y]?v.J(L,k,a(W)?!!W.capture:!!W,ge):Qe(v,L,k,!1,W,ge)}function Qe(v,L,k,W,ge,_e){if(!L)throw Error("Invalid event type");const Je=a(ge)?!!ge.capture:!!ge;let $t=ot(v);if($t||(v[He]=$t=new Ae(v)),k=$t.add(L,k,W,Je,_e),k.proxy)return k;if(W=Xe(),k.proxy=W,W.src=v,W.listener=k,v.addEventListener)F||(ge=Je),ge===void 0&&(ge=!1),v.addEventListener(L.toString(),W,ge);else if(v.attachEvent)v.attachEvent(Ne(L.toString()),W);else if(v.addListener&&v.removeListener)v.addListener(W);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Xe(){function v(k){return L.call(v.src,v.listener,k)}const L=Me;return v}function te(v,L,k,W,ge){if(Array.isArray(L)){for(let _e=0;_e<L.length;_e++)te(v,L[_e],k,W,ge);return null}return k=$(k),v&&v[Y]?v.K(L,k,a(W)?!!W.capture:!!W,ge):Qe(v,L,k,!0,W,ge)}function Le(v,L,k,W,ge){if(Array.isArray(L))for(var _e=0;_e<L.length;_e++)Le(v,L[_e],k,W,ge);else W=a(W)?!!W.capture:!!W,k=$(k),v&&v[Y]?(v=v.i,_e=String(L).toString(),_e in v.g&&(L=v.g[_e],k=Ie(L,k,W,ge),k>-1&&(X(L[k]),Array.prototype.splice.call(L,k,1),L.length==0&&(delete v.g[_e],v.h--)))):v&&(v=ot(v))&&(L=v.g[L.toString()],v=-1,L&&(v=Ie(L,k,W,ge)),(k=v>-1?L[v]:null)&&be(k))}function be(v){if(typeof v!="number"&&v&&!v.da){var L=v.src;if(L&&L[Y])De(L.i,v);else{var k=v.type,W=v.proxy;L.removeEventListener?L.removeEventListener(k,W,v.capture):L.detachEvent?L.detachEvent(Ne(k),W):L.addListener&&L.removeListener&&L.removeListener(W),(k=ot(L))?(De(k,v),k.h==0&&(k.src=null,L[He]=null)):X(v)}}}function Ne(v){return v in rt?rt[v]:rt[v]="on"+v}function Me(v,L){if(v.da)v=!0;else{L=new j(L,this);const k=v.listener,W=v.ha||v.src;v.fa&&be(v),v=k.call(W,L)}return v}function ot(v){return v=v[He],v instanceof Ae?v:null}var Ze="__closure_events_fn_"+(Math.random()*1e9>>>0);function $(v){return typeof v=="function"?v:(v[Ze]||(v[Ze]=function(L){return v.handleEvent(L)}),v[Ze])}function V(){M.call(this),this.i=new Ae(this),this.M=this,this.G=null}f(V,M),V.prototype[Y]=!0,V.prototype.removeEventListener=function(v,L,k,W){Le(this,v,L,k,W)};function ce(v,L){var k,W=v.G;if(W)for(k=[];W;W=W.G)k.push(W);if(v=v.M,W=L.type||L,typeof L=="string")L=new B(L,v);else if(L instanceof B)L.target=L.target||v;else{var ge=L;L=new B(W,v),he(L,ge)}ge=!0;let _e,Je;if(k)for(Je=k.length-1;Je>=0;Je--)_e=L.g=k[Je],ge=ke(_e,W,!0,L)&&ge;if(_e=L.g=v,ge=ke(_e,W,!0,L)&&ge,ge=ke(_e,W,!1,L)&&ge,k)for(Je=0;Je<k.length;Je++)_e=L.g=k[Je],ge=ke(_e,W,!1,L)&&ge}V.prototype.N=function(){if(V.Z.N.call(this),this.i){var v=this.i;for(const L in v.g){const k=v.g[L];for(let W=0;W<k.length;W++)X(k[W]);delete v.g[L],v.h--}}this.G=null},V.prototype.J=function(v,L,k,W){return this.i.add(String(v),L,!1,k,W)},V.prototype.K=function(v,L,k,W){return this.i.add(String(v),L,!0,k,W)};function ke(v,L,k,W){if(L=v.i.g[String(L)],!L)return!0;L=L.concat();let ge=!0;for(let _e=0;_e<L.length;++_e){const Je=L[_e];if(Je&&!Je.da&&Je.capture==k){const $t=Je.listener,Zn=Je.ha||Je.src;Je.fa&&De(v.i,Je),ge=$t.call(Zn,W)!==!1&&ge}}return ge&&!W.defaultPrevented}function pe(v,L){if(typeof v!="function")if(v&&typeof v.handleEvent=="function")v=c(v.handleEvent,v);else throw Error("Invalid listener argument");return Number(L)>2147483647?-1:o.setTimeout(v,L||0)}function ye(v){v.g=pe(()=>{v.g=null,v.i&&(v.i=!1,ye(v))},v.l);const L=v.h;v.h=null,v.m.apply(null,L)}class qe extends M{constructor(L,k){super(),this.m=L,this.l=k,this.h=null,this.i=!1,this.g=null}j(L){this.h=arguments,this.g?this.i=!0:ye(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ge(v){M.call(this),this.h=v,this.g={}}f(Ge,M);var Ke=[];function yt(v){ee(v.g,function(L,k){this.g.hasOwnProperty(k)&&be(L)},v),v.g={}}Ge.prototype.N=function(){Ge.Z.N.call(this),yt(this)},Ge.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var At=o.JSON.stringify,Ue=o.JSON.parse,Qt=class{stringify(v){return o.JSON.stringify(v,void 0)}parse(v){return o.JSON.parse(v,void 0)}};function Ht(){}function wt(){}var it={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function at(){B.call(this,"d")}f(at,B);function Ct(){B.call(this,"c")}f(Ct,B);var bt={},Wt=null;function Gt(){return Wt=Wt||new V}bt.Ia="serverreachability";function Ee(v){B.call(this,bt.Ia,v)}f(Ee,B);function ae(v){const L=Gt();ce(L,new Ee(L))}bt.STAT_EVENT="statevent";function tt(v,L){B.call(this,bt.STAT_EVENT,v),this.stat=L}f(tt,B);function $e(v){const L=Gt();ce(L,new tt(L,v))}bt.Ja="timingevent";function Pt(v,L){B.call(this,bt.Ja,v),this.size=L}f(Pt,B);function xt(v,L){if(typeof v!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){v()},L)}function hn(){this.g=!0}hn.prototype.ua=function(){this.g=!1};function En(v,L,k,W,ge,_e){v.info(function(){if(v.g)if(_e){var Je="",$t=_e.split("&");for(let rn=0;rn<$t.length;rn++){var Zn=$t[rn].split("=");if(Zn.length>1){const Cn=Zn[0];Zn=Zn[1];const jr=Cn.split("_");Je=jr.length>=2&&jr[1]=="type"?Je+(Cn+"="+Zn+"&"):Je+(Cn+"=redacted&")}}}else Je=null;else Je=_e;return"XMLHTTP REQ ("+W+") [attempt "+ge+"]: "+L+`
`+k+`
`+Je})}function Xn(v,L,k,W,ge,_e,Je){v.info(function(){return"XMLHTTP RESP ("+W+") [ attempt "+ge+"]: "+L+`
`+k+`
`+_e+" "+Je})}function Fn(v,L,k,W){v.info(function(){return"XMLHTTP TEXT ("+L+"): "+Ar(v,k)+(W?" "+W:"")})}function An(v,L){v.info(function(){return"TIMEOUT: "+L})}hn.prototype.info=function(){};function Ar(v,L){if(!v.g)return L;if(!L)return null;try{const _e=JSON.parse(L);if(_e){for(v=0;v<_e.length;v++)if(Array.isArray(_e[v])){var k=_e[v];if(!(k.length<2)){var W=k[1];if(Array.isArray(W)&&!(W.length<1)){var ge=W[0];if(ge!="noop"&&ge!="stop"&&ge!="close")for(let Je=1;Je<W.length;Je++)W[Je]=""}}}}return At(_e)}catch{return L}}var Fr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},As={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},sa;function _i(){}f(_i,Ht),_i.prototype.g=function(){return new XMLHttpRequest},sa=new _i;function Ir(v){return encodeURIComponent(String(v))}function jt(v){var L=1;v=v.split(":");const k=[];for(;L>0&&v.length;)k.push(v.shift()),L--;return v.length&&k.push(v.join(":")),k}function Ei(v,L,k,W){this.j=v,this.i=L,this.l=k,this.S=W||1,this.V=new Ge(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Na}function Na(){this.i=null,this.g="",this.h=!1}var H={},G={};function se(v,L,k){v.M=1,v.A=On(nn(L)),v.u=k,v.R=!0,U(v,null)}function U(v,L){v.F=Date.now(),Z(v),v.B=nn(v.A);var k=v.B,W=v.S;Array.isArray(W)||(W=[String(W)]),Bh(k.i,"t",W),v.C=0,k=v.j.L,v.h=new Na,v.g=Co(v.j,k?L:null,!v.u),v.P>0&&(v.O=new qe(c(v.Y,v,v.g),v.P)),L=v.V,k=v.g,W=v.ba;var ge="readystatechange";Array.isArray(ge)||(ge&&(Ke[0]=ge.toString()),ge=Ke);for(let _e=0;_e<ge.length;_e++){const Je=vt(k,ge[_e],W||L.handleEvent,!1,L.h||L);if(!Je)break;L.g[Je.key]=Je}L=v.J?fe(v.J):{},v.u?(v.v||(v.v="POST"),L["Content-Type"]="application/x-www-form-urlencoded",v.g.ea(v.B,v.v,v.u,L)):(v.v="GET",v.g.ea(v.B,v.v,null,L)),ae(),En(v.i,v.v,v.B,v.l,v.S,v.u)}Ei.prototype.ba=function(v){v=v.target;const L=this.O;L&&qs(v)==3?L.j():this.Y(v)},Ei.prototype.Y=function(v){try{if(v==this.g)e:{const $t=qs(this.g),Zn=this.g.ya(),rn=this.g.ca();if(!($t<3)&&($t!=3||this.g&&(this.h.h||this.g.la()||vp(this.g)))){this.K||$t!=4||Zn==7||(Zn==8||rn<=0?ae(3):ae(2)),we(this);var L=this.g.ca();this.X=L;var k=K(this);if(this.o=L==200,Xn(this.i,this.v,this.B,this.l,this.S,$t,L),this.o){if(this.U&&!this.L){t:{if(this.g){var W,ge=this.g;if((W=ge.g?ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(W)){var _e=W;break t}}_e=null}if(v=_e)Fn(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ct(this,v);else{this.o=!1,this.m=3,$e(12),Se(this),Te(this);break e}}if(this.R){v=!0;let Cn;for(;!this.K&&this.C<k.length;)if(Cn=re(this,k),Cn==G){$t==4&&(this.m=4,$e(14),v=!1),Fn(this.i,this.l,null,"[Incomplete Response]");break}else if(Cn==H){this.m=4,$e(15),Fn(this.i,this.l,k,"[Invalid Chunk]"),v=!1;break}else Fn(this.i,this.l,Cn,null),ct(this,Cn);if(q(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),$t!=4||k.length!=0||this.h.h||(this.m=1,$e(16),v=!1),this.o=this.o&&v,!v)Fn(this.i,this.l,k,"[Invalid Chunked Response]"),Se(this),Te(this);else if(k.length>0&&!this.W){this.W=!0;var Je=this.j;Je.g==this&&Je.aa&&!Je.P&&(Je.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),nu(Je),Je.P=!0,$e(11))}}else Fn(this.i,this.l,k,null),ct(this,k);$t==4&&Se(this),this.o&&!this.K&&($t==4?Ss(this.j,this):(this.o=!1,Z(this)))}else yA(this.g),L==400&&k.indexOf("Unknown SID")>0?(this.m=3,$e(12)):(this.m=0,$e(13)),Se(this),Te(this)}}}catch{}finally{}};function K(v){if(!q(v))return v.g.la();const L=vp(v.g);if(L==="")return"";let k="";const W=L.length,ge=qs(v.g)==4;if(!v.h.i){if(typeof TextDecoder>"u")return Se(v),Te(v),"";v.h.i=new o.TextDecoder}for(let _e=0;_e<W;_e++)v.h.h=!0,k+=v.h.i.decode(L[_e],{stream:!(ge&&_e==W-1)});return L.length=0,v.h.g+=k,v.C=0,v.h.g}function q(v){return v.g?v.v=="GET"&&v.M!=2&&v.j.Aa:!1}function re(v,L){var k=v.C,W=L.indexOf(`
`,k);return W==-1?G:(k=Number(L.substring(k,W)),isNaN(k)?H:(W+=1,W+k>L.length?G:(L=L.slice(W,W+k),v.C=W+k,L)))}Ei.prototype.cancel=function(){this.K=!0,Se(this)};function Z(v){v.T=Date.now()+v.H,ve(v,v.H)}function ve(v,L){if(v.D!=null)throw Error("WatchDog timer not null");v.D=xt(c(v.aa,v),L)}function we(v){v.D&&(o.clearTimeout(v.D),v.D=null)}Ei.prototype.aa=function(){this.D=null;const v=Date.now();v-this.T>=0?(An(this.i,this.B),this.M!=2&&(ae(),$e(17)),Se(this),this.m=2,Te(this)):ve(this,this.T-v)};function Te(v){v.j.I==0||v.K||Ss(v.j,v)}function Se(v){we(v);var L=v.O;L&&typeof L.dispose=="function"&&L.dispose(),v.O=null,yt(v.V),v.g&&(L=v.g,v.g=null,L.abort(),L.dispose())}function ct(v,L){try{var k=v.j;if(k.I!=0&&(k.g==v||Mt(k.h,v))){if(!v.L&&Mt(k.h,v)&&k.I==3){try{var W=k.Ba.g.parse(L)}catch{W=null}if(Array.isArray(W)&&W.length==3){var ge=W;if(ge[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<v.F)ii(k),Fh(k);else break e;tu(k),$e(18)}}else k.xa=ge[1],0<k.xa-k.K&&ge[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=xt(c(k.Va,k),6e3));St(k.h)<=1&&k.ta&&(k.ta=void 0)}else To(k,11)}else if((v.L||k.g==v)&&ii(k),!z(L))for(ge=k.Ba.g.parse(L),L=0;L<ge.length;L++){let rn=ge[L];const Cn=rn[0];if(!(Cn<=k.K))if(k.K=Cn,rn=rn[1],k.I==2)if(rn[0]=="c"){k.M=rn[1],k.ba=rn[2];const jr=rn[3];jr!=null&&(k.ka=jr,k.j.info("VER="+k.ka));const si=rn[4];si!=null&&(k.za=si,k.j.info("SVER="+k.za));const Xr=rn[5];Xr!=null&&typeof Xr=="number"&&Xr>0&&(W=1.5*Xr,k.O=W,k.j.info("backChannelRequestTimeoutMs_="+W)),W=k;const Ai=v.g;if(Ai){const su=Ai.g?Ai.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(su){var _e=W.h;_e.g||su.indexOf("spdy")==-1&&su.indexOf("quic")==-1&&su.indexOf("h2")==-1||(_e.j=_e.l,_e.g=new Set,_e.h&&(Ft(_e,_e.h),_e.h=null))}if(W.G){const ou=Ai.g?Ai.g.getResponseHeader("X-HTTP-Session-Id"):null;ou&&(W.wa=ou,gt(W.J,W.G,ou))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-v.F,k.j.info("Handshake RTT: "+k.T+"ms")),W=k;var Je=v;if(W.na=Qs(W,W.L?W.ba:null,W.W),Je.L){ut(W.h,Je);var $t=Je,Zn=W.O;Zn&&($t.H=Zn),$t.D&&(we($t),Z($t)),W.g=Je}else _p(W);k.i.length>0&&Ua(k)}else rn[0]!="stop"&&rn[0]!="close"||To(k,7);else k.I==3&&(rn[0]=="stop"||rn[0]=="close"?rn[0]=="stop"?To(k,7):kl(k):rn[0]!="noop"&&k.l&&k.l.qa(rn),k.A=0)}}ae(4)}catch{}}var ze=class{constructor(v,L){this.g=v,this.map=L}};function Ve(v){this.l=v||10,o.PerformanceNavigationTiming?(v=o.performance.getEntriesByType("navigation"),v=v.length>0&&(v[0].nextHopProtocol=="hq"||v[0].nextHopProtocol=="h2")):v=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=v?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ft(v){return v.h?!0:v.g?v.g.size>=v.j:!1}function St(v){return v.h?1:v.g?v.g.size:0}function Mt(v,L){return v.h?v.h==L:v.g?v.g.has(L):!1}function Ft(v,L){v.g?v.g.add(L):v.h=L}function ut(v,L){v.h&&v.h==L?v.h=null:v.g&&v.g.has(L)&&v.g.delete(L)}Ve.prototype.cancel=function(){if(this.i=et(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const v of this.g.values())v.cancel();this.g.clear()}};function et(v){if(v.h!=null)return v.i.concat(v.h.G);if(v.g!=null&&v.g.size!==0){let L=v.i;for(const k of v.g.values())L=L.concat(k.G);return L}return m(v.i)}var Yt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Dt(v,L){if(v){v=v.split("&");for(let k=0;k<v.length;k++){const W=v[k].indexOf("=");let ge,_e=null;W>=0?(ge=v[k].substring(0,W),_e=v[k].substring(W+1)):ge=v[k],L(ge,_e?decodeURIComponent(_e.replace(/\+/g," ")):"")}}}function Rt(v){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let L;v instanceof Rt?(this.l=v.l,Ln(this,v.j),this.o=v.o,this.g=v.g,bn(this,v.u),this.h=v.h,un(this,Bl(v.i)),this.m=v.m):v&&(L=String(v).match(Yt))?(this.l=!1,Ln(this,L[1]||"",!0),this.o=Vt(L[2]||""),this.g=Vt(L[3]||"",!0),bn(this,L[4]),this.h=Vt(L[5]||"",!0),un(this,L[6]||"",!0),this.m=Vt(L[7]||"")):(this.l=!1,this.i=new wo(null,this.l))}Rt.prototype.toString=function(){const v=[];var L=this.j;L&&v.push(qt(L,Wi,!0),":");var k=this.g;return(k||L=="file")&&(v.push("//"),(L=this.o)&&v.push(qt(L,Wi,!0),"@"),v.push(Ir(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&v.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&v.push("/"),v.push(qt(k,k.charAt(0)=="/"?js:ri,!0))),(k=this.i.toString())&&v.push("?",k),(k=this.m)&&v.push("#",qt(k,Lh)),v.join("")},Rt.prototype.resolve=function(v){const L=nn(this);let k=!!v.j;k?Ln(L,v.j):k=!!v.o,k?L.o=v.o:k=!!v.g,k?L.g=v.g:k=v.u!=null;var W=v.h;if(k)bn(L,v.u);else if(k=!!v.h){if(W.charAt(0)!="/")if(this.g&&!this.h)W="/"+W;else{var ge=L.h.lastIndexOf("/");ge!=-1&&(W=L.h.slice(0,ge+1)+W)}if(ge=W,ge==".."||ge==".")W="";else if(ge.indexOf("./")!=-1||ge.indexOf("/.")!=-1){W=ge.lastIndexOf("/",0)==0,ge=ge.split("/");const _e=[];for(let Je=0;Je<ge.length;){const $t=ge[Je++];$t=="."?W&&Je==ge.length&&_e.push(""):$t==".."?((_e.length>1||_e.length==1&&_e[0]!="")&&_e.pop(),W&&Je==ge.length&&_e.push("")):(_e.push($t),W=!0)}W=_e.join("/")}else W=ge}return k?L.h=W:k=v.i.toString()!=="",k?un(L,Bl(v.i)):k=!!v.m,k&&(L.m=v.m),L};function nn(v){return new Rt(v)}function Ln(v,L,k){v.j=k?Vt(L,!0):L,v.j&&(v.j=v.j.replace(/:$/,""))}function bn(v,L){if(L){if(L=Number(L),isNaN(L)||L<0)throw Error("Bad port number "+L);v.u=L}else v.u=null}function un(v,L,k){L instanceof wo?(v.i=L,mp(v.i,v.l)):(k||(L=qt(L,Dh)),v.i=new wo(L,v.l))}function gt(v,L,k){v.i.set(L,k)}function On(v){return gt(v,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),v}function Vt(v,L){return v?L?decodeURI(v.replace(/%25/g,"%2525")):decodeURIComponent(v):""}function qt(v,L,k){return typeof v=="string"?(v=encodeURI(v).replace(L,Bn),k&&(v=v.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v):null}function Bn(v){return v=v.charCodeAt(0),"%"+(v>>4&15).toString(16)+(v&15).toString(16)}var Wi=/[#\/\?@]/g,ri=/[#\?:]/g,js=/[#\?]/g,Dh=/[#\?@]/g,Lh=/#/g;function wo(v,L){this.h=this.g=null,this.i=v||null,this.j=!!L}function Xs(v){v.g||(v.g=new Map,v.h=0,v.i&&Dt(v.i,function(L,k){v.add(decodeURIComponent(L.replace(/\+/g," ")),k)}))}n=wo.prototype,n.add=function(v,L){Xs(this),this.i=null,v=Nl(this,v);let k=this.g.get(v);return k||this.g.set(v,k=[]),k.push(L),this.h+=1,this};function Uy(v,L){Xs(v),L=Nl(v,L),v.g.has(L)&&(v.i=null,v.h-=v.g.get(L).length,v.g.delete(L))}function zy(v,L){return Xs(v),L=Nl(v,L),v.g.has(L)}n.forEach=function(v,L){Xs(this),this.g.forEach(function(k,W){k.forEach(function(ge){v.call(L,ge,W,this)},this)},this)};function Oh(v,L){Xs(v);let k=[];if(typeof L=="string")zy(v,L)&&(k=k.concat(v.g.get(Nl(v,L))));else for(v=Array.from(v.g.values()),L=0;L<v.length;L++)k=k.concat(v[L]);return k}n.set=function(v,L){return Xs(this),this.i=null,v=Nl(this,v),zy(this,v)&&(this.h-=this.g.get(v).length),this.g.set(v,[L]),this.h+=1,this},n.get=function(v,L){return v?(v=Oh(this,v),v.length>0?String(v[0]):L):L};function Bh(v,L,k){Uy(v,L),k.length>0&&(v.i=null,v.g.set(Nl(v,L),m(k)),v.h+=k.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const v=[],L=Array.from(this.g.keys());for(let W=0;W<L.length;W++){var k=L[W];const ge=Ir(k);k=Oh(this,k);for(let _e=0;_e<k.length;_e++){let Je=ge;k[_e]!==""&&(Je+="="+Ir(k[_e])),v.push(Je)}}return this.i=v.join("&")};function Bl(v){const L=new wo;return L.i=v.i,v.g&&(L.g=new Map(v.g),L.h=v.h),L}function Nl(v,L){return L=String(L),v.j&&(L=L.toLowerCase()),L}function mp(v,L){L&&!v.j&&(Xs(v),v.i=null,v.g.forEach(function(k,W){const ge=W.toLowerCase();W!=ge&&(Uy(this,W),Bh(this,ge,k))},v)),v.j=L}function gn(v,L){const k=new hn;if(o.Image){const W=new Image;W.onload=u(Ks,k,"TestLoadImage: loaded",!0,L,W),W.onerror=u(Ks,k,"TestLoadImage: error",!1,L,W),W.onabort=u(Ks,k,"TestLoadImage: abort",!1,L,W),W.ontimeout=u(Ks,k,"TestLoadImage: timeout",!1,L,W),o.setTimeout(function(){W.ontimeout&&W.ontimeout()},1e4),W.src=v}else L(!1)}function Hy(v,L){const k=new hn,W=new AbortController,ge=setTimeout(()=>{W.abort(),Ks(k,"TestPingServer: timeout",!1,L)},1e4);fetch(v,{signal:W.signal}).then(_e=>{clearTimeout(ge),_e.ok?Ks(k,"TestPingServer: ok",!0,L):Ks(k,"TestPingServer: server error",!1,L)}).catch(()=>{clearTimeout(ge),Ks(k,"TestPingServer: error",!1,L)})}function Ks(v,L,k,W,ge){try{ge&&(ge.onload=null,ge.onerror=null,ge.onabort=null,ge.ontimeout=null),W(k)}catch{}}function Vy(){this.g=new Qt}function gp(v){this.i=v.Sb||null,this.h=v.ab||!1}f(gp,Ht),gp.prototype.g=function(){return new Nh(this.i,this.h)};function Nh(v,L){V.call(this),this.H=v,this.o=L,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Nh,V),n=Nh.prototype,n.open=function(v,L){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=v,this.D=L,this.readyState=1,eu(this)},n.send=function(v){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const L={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};v&&(L.body=v),(this.H||o).fetch(new Request(this.D,L)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ka(this)),this.readyState=0},n.Pa=function(v){if(this.g&&(this.l=v,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=v.headers,this.readyState=2,eu(this)),this.g&&(this.readyState=3,eu(this),this.g)))if(this.responseType==="arraybuffer")v.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in v){if(this.j=v.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;wr(this)}else v.text().then(this.Oa.bind(this),this.ga.bind(this))};function wr(v){v.j.read().then(v.Ma.bind(v)).catch(v.ga.bind(v))}n.Ma=function(v){if(this.g){if(this.o&&v.value)this.response.push(v.value);else if(!this.o){var L=v.value?v.value:new Uint8Array(0);(L=this.B.decode(L,{stream:!v.done}))&&(this.response=this.responseText+=L)}v.done?ka(this):eu(this),this.readyState==3&&wr(this)}},n.Oa=function(v){this.g&&(this.response=this.responseText=v,ka(this))},n.Na=function(v){this.g&&(this.response=v,ka(this))},n.ga=function(){this.g&&ka(this)};function ka(v){v.readyState=4,v.l=null,v.j=null,v.B=null,eu(v)}n.setRequestHeader=function(v,L){this.A.append(v,L)},n.getResponseHeader=function(v){return this.h&&this.h.get(v.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const v=[],L=this.h.entries();for(var k=L.next();!k.done;)k=k.value,v.push(k[0]+": "+k[1]),k=L.next();return v.join(`\r
`)};function eu(v){v.onreadystatechange&&v.onreadystatechange.call(v)}Object.defineProperty(Nh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(v){this.m=v?"include":"same-origin"}});function kh(v){let L="";return ee(v,function(k,W){L+=W,L+=":",L+=k,L+=`\r
`}),L}function yp(v,L,k){e:{for(W in k){var W=!1;break e}W=!0}W||(k=kh(k),typeof v=="string"?k!=null&&Ir(k):gt(v,L,k))}function Un(v){V.call(this),this.headers=new Map,this.L=v||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(Un,V);var Js=/^https?$/i,gA=["POST","PUT"];n=Un.prototype,n.Fa=function(v){this.H=v},n.ea=function(v,L,k,W){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+v);L=L?L.toUpperCase():"GET",this.D=v,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():sa.g(),this.g.onreadystatechange=p(c(this.Ca,this));try{this.B=!0,this.g.open(L,String(v),!0),this.B=!1}catch(_e){Gy(this,_e);return}if(v=k||"",k=new Map(this.headers),W)if(Object.getPrototypeOf(W)===Object.prototype)for(var ge in W)k.set(ge,W[ge]);else if(typeof W.keys=="function"&&typeof W.get=="function")for(const _e of W.keys())k.set(_e,W.get(_e));else throw Error("Unknown input type for opt_headers: "+String(W));W=Array.from(k.keys()).find(_e=>_e.toLowerCase()=="content-type"),ge=o.FormData&&v instanceof o.FormData,!(Array.prototype.indexOf.call(gA,L,void 0)>=0)||W||ge||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[_e,Je]of k)this.g.setRequestHeader(_e,Je);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(v),this.v=!1}catch(_e){Gy(this,_e)}};function Gy(v,L){v.h=!1,v.g&&(v.j=!0,v.g.abort(),v.j=!1),v.l=L,v.o=5,ws(v),Fa(v)}function ws(v){v.A||(v.A=!0,ce(v,"complete"),ce(v,"error"))}n.abort=function(v){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=v||7,ce(this,"complete"),ce(this,"abort"),Fa(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Fa(this,!0)),Un.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ys(this):this.Xa())},n.Xa=function(){Ys(this)};function Ys(v){if(v.h&&typeof s<"u"){if(v.v&&qs(v)==4)setTimeout(v.Ca.bind(v),0);else if(ce(v,"readystatechange"),qs(v)==4){v.h=!1;try{const _e=v.ca();e:switch(_e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var L=!0;break e;default:L=!1}var k;if(!(k=L)){var W;if(W=_e===0){let Je=String(v.D).match(Yt)[1]||null;!Je&&o.self&&o.self.location&&(Je=o.self.location.protocol.slice(0,-1)),W=!Js.test(Je?Je.toLowerCase():"")}k=W}if(k)ce(v,"complete"),ce(v,"success");else{v.o=6;try{var ge=qs(v)>2?v.g.statusText:""}catch{ge=""}v.l=ge+" ["+v.ca()+"]",ws(v)}}finally{Fa(v)}}}}function Fa(v,L){if(v.g){v.m&&(clearTimeout(v.m),v.m=null);const k=v.g;v.g=null,L||ce(v,"ready");try{k.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function qs(v){return v.g?v.g.readyState:0}n.ca=function(){try{return qs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(v){if(this.g){var L=this.g.responseText;return v&&L.indexOf(v)==0&&(L=L.substring(v.length)),Ue(L)}};function vp(v){try{if(!v.g)return null;if("response"in v.g)return v.g.response;switch(v.F){case"":case"text":return v.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in v.g)return v.g.mozResponseArrayBuffer}return null}catch{return null}}function yA(v){const L={};v=(v.g&&qs(v)>=2&&v.g.getAllResponseHeaders()||"").split(`\r
`);for(let W=0;W<v.length;W++){if(z(v[W]))continue;var k=jt(v[W]);const ge=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const _e=L[ge]||[];L[ge]=_e,_e.push(k)}ie(L,function(W){return W.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function xi(v,L,k){return k&&k.internalChannelParams&&k.internalChannelParams[v]||L}function Wy(v){this.za=0,this.i=[],this.j=new hn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=xi("failFast",!1,v),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=xi("baseRetryDelayMs",5e3,v),this.Za=xi("retryDelaySeedMs",1e4,v),this.Ta=xi("forwardChannelMaxRetries",2,v),this.va=xi("forwardChannelRequestTimeoutMs",2e4,v),this.ma=v&&v.xmlHttpFactory||void 0,this.Ua=v&&v.Rb||void 0,this.Aa=v&&v.useFetchStreams||!1,this.O=void 0,this.L=v&&v.supportsCrossDomainXhr||!1,this.M="",this.h=new Ve(v&&v.concurrentRequestLimit),this.Ba=new Vy,this.S=v&&v.fastHandshake||!1,this.R=v&&v.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=v&&v.Pb||!1,v&&v.ua&&this.j.ua(),v&&v.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&v&&v.detectBufferingProxy||!1,this.ia=void 0,v&&v.longPollingTimeout&&v.longPollingTimeout>0&&(this.ia=v.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Wy.prototype,n.ka=8,n.I=1,n.connect=function(v,L,k,W){$e(0),this.W=v,this.H=L||{},k&&W!==void 0&&(this.H.OSID=k,this.H.OAID=W),this.F=this.X,this.J=Qs(this,null,this.W),Ua(this)};function kl(v){if(ss(v),v.I==3){var L=v.V++,k=nn(v.J);if(gt(k,"SID",v.M),gt(k,"RID",L),gt(k,"TYPE","terminate"),Ha(v,k),L=new Ei(v,v.j,L),L.M=2,L.A=On(nn(k)),k=!1,o.navigator&&o.navigator.sendBeacon)try{k=o.navigator.sendBeacon(L.A.toString(),"")}catch{}!k&&o.Image&&(new Image().src=L.A,k=!0),k||(L.g=Co(L.j,null),L.g.ea(L.A)),L.F=Date.now(),Z(L)}Ep(v)}function Fh(v){v.g&&(nu(v),v.g.cancel(),v.g=null)}function ss(v){Fh(v),v.v&&(o.clearTimeout(v.v),v.v=null),ii(v),v.h.cancel(),v.m&&(typeof v.m=="number"&&o.clearTimeout(v.m),v.m=null)}function Ua(v){if(!ft(v.h)&&!v.m){v.m=!0;var L=v.Ea;O||R(),I||(O(),I=!0),b.add(L,v),v.D=0}}function Uh(v,L){return St(v.h)>=v.h.j-(v.m?1:0)?!1:v.m?(v.i=L.G.concat(v.i),!0):v.I==1||v.I==2||v.D>=(v.Sa?0:v.Ta)?!1:(v.m=xt(c(v.Ea,v,L),So(v,v.D)),v.D++,!0)}n.Ea=function(v){if(this.m)if(this.m=null,this.I==1){if(!v){this.V=Math.floor(Math.random()*1e5),v=this.V++;const ge=new Ei(this,this.j,v);let _e=this.o;if(this.U&&(_e?(_e=fe(_e),he(_e,this.U)):_e=this.U),this.u!==null||this.R||(ge.J=_e,_e=null),this.S)e:{for(var L=0,k=0;k<this.i.length;k++){t:{var W=this.i[k];if("__data__"in W.map&&(W=W.map.__data__,typeof W=="string")){W=W.length;break t}W=void 0}if(W===void 0)break;if(L+=W,L>4096){L=k;break e}if(L===4096||k===this.i.length-1){L=k+1;break e}}L=1e3}else L=1e3;L=zh(this,ge,L),k=nn(this.J),gt(k,"RID",v),gt(k,"CVER",22),this.G&&gt(k,"X-HTTP-Session-Id",this.G),Ha(this,k),_e&&(this.R?L="headers="+Ir(kh(_e))+"&"+L:this.u&&yp(k,this.u,_e)),Ft(this.h,ge),this.Ra&&gt(k,"TYPE","init"),this.S?(gt(k,"$req",L),gt(k,"SID","null"),ge.U=!0,se(ge,k,null)):se(ge,k,L),this.I=2}}else this.I==3&&(v?za(this,v):this.i.length==0||ft(this.h)||za(this))};function za(v,L){var k;L?k=L.l:k=v.V++;const W=nn(v.J);gt(W,"SID",v.M),gt(W,"RID",k),gt(W,"AID",v.K),Ha(v,W),v.u&&v.o&&yp(W,v.u,v.o),k=new Ei(v,v.j,k,v.D+1),v.u===null&&(k.J=v.o),L&&(v.i=L.G.concat(v.i)),L=zh(v,k,1e3),k.H=Math.round(v.va*.5)+Math.round(v.va*.5*Math.random()),Ft(v.h,k),se(k,W,L)}function Ha(v,L){v.H&&ee(v.H,function(k,W){gt(L,W,k)}),v.l&&ee({},function(k,W){gt(L,W,k)})}function zh(v,L,k){k=Math.min(v.i.length,k);const W=v.l?c(v.l.Ka,v.l,v):null;e:{var ge=v.i;let $t=-1;for(;;){const Zn=["count="+k];$t==-1?k>0?($t=ge[0].g,Zn.push("ofs="+$t)):$t=0:Zn.push("ofs="+$t);let rn=!0;for(let Cn=0;Cn<k;Cn++){var _e=ge[Cn].g;const jr=ge[Cn].map;if(_e-=$t,_e<0)$t=Math.max(0,ge[Cn].g-100),rn=!1;else try{_e="req"+_e+"_"||"";try{var Je=jr instanceof Map?jr:Object.entries(jr);for(const[si,Xr]of Je){let Ai=Xr;a(Xr)&&(Ai=At(Xr)),Zn.push(_e+si+"="+encodeURIComponent(Ai))}}catch(si){throw Zn.push(_e+"type="+encodeURIComponent("_badmap")),si}}catch{W&&W(jr)}}if(rn){Je=Zn.join("&");break e}}Je=void 0}return v=v.i.splice(0,k),L.G=v,Je}function _p(v){if(!v.g&&!v.v){v.Y=1;var L=v.Da;O||R(),I||(O(),I=!0),b.add(L,v),v.A=0}}function tu(v){return v.g||v.v||v.A>=3?!1:(v.Y++,v.v=xt(c(v.Da,v),So(v,v.A)),v.A++,!0)}n.Da=function(){if(this.v=null,Va(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var v=4*this.T;this.j.info("BP detection timer enabled: "+v),this.B=xt(c(this.Wa,this),v)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,$e(10),Fh(this),Va(this))};function nu(v){v.B!=null&&(o.clearTimeout(v.B),v.B=null)}function Va(v){v.g=new Ei(v,v.j,"rpc",v.Y),v.u===null&&(v.g.J=v.o),v.g.P=0;var L=nn(v.na);gt(L,"RID","rpc"),gt(L,"SID",v.M),gt(L,"AID",v.K),gt(L,"CI",v.F?"0":"1"),!v.F&&v.ia&&gt(L,"TO",v.ia),gt(L,"TYPE","xmlhttp"),Ha(v,L),v.u&&v.o&&yp(L,v.u,v.o),v.O&&(v.g.H=v.O);var k=v.g;v=v.ba,k.M=1,k.A=On(nn(L)),k.u=null,k.R=!0,U(k,v)}n.Va=function(){this.C!=null&&(this.C=null,Fh(this),tu(this),$e(19))};function ii(v){v.C!=null&&(o.clearTimeout(v.C),v.C=null)}function Ss(v,L){var k=null;if(v.g==L){ii(v),nu(v),v.g=null;var W=2}else if(Mt(v.h,L))k=L.G,ut(v.h,L),W=1;else return;if(v.I!=0){if(L.o)if(W==1){k=L.u?L.u.length:0,L=Date.now()-L.F;var ge=v.D;W=Gt(),ce(W,new Pt(W,k)),Ua(v)}else _p(v);else if(ge=L.m,ge==3||ge==0&&L.X>0||!(W==1&&Uh(v,L)||W==2&&tu(v)))switch(k&&k.length>0&&(L=v.h,L.i=L.i.concat(k)),ge){case 1:To(v,5);break;case 4:To(v,10);break;case 3:To(v,6);break;default:To(v,2)}}}function So(v,L){let k=v.Qa+Math.floor(Math.random()*v.Za);return v.isActive()||(k*=2),k*L}function To(v,L){if(v.j.info("Error code "+L),L==2){var k=c(v.bb,v),W=v.Ua;const ge=!W;W=new Rt(W||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ln(W,"https"),On(W),ge?gn(W.toString(),k):Hy(W.toString(),k)}else $e(2);v.I=0,v.l&&v.l.pa(L),Ep(v),ss(v)}n.bb=function(v){v?(this.j.info("Successfully pinged google.com"),$e(2)):(this.j.info("Failed to ping google.com"),$e(1))};function Ep(v){if(v.I=0,v.ja=[],v.l){const L=et(v.h);(L.length!=0||v.i.length!=0)&&(y(v.ja,L),y(v.ja,v.i),v.h.i.length=0,m(v.i),v.i.length=0),v.l.oa()}}function Qs(v,L,k){var W=k instanceof Rt?nn(k):new Rt(k);if(W.g!="")L&&(W.g=L+"."+W.g),bn(W,W.u);else{var ge=o.location;W=ge.protocol,L=L?L+"."+ge.hostname:ge.hostname,ge=+ge.port;const _e=new Rt(null);W&&Ln(_e,W),L&&(_e.g=L),ge&&bn(_e,ge),k&&(_e.h=k),W=_e}return k=v.G,L=v.wa,k&&L&&gt(W,k,L),gt(W,"VER",v.ka),Ha(v,W),W}function Co(v,L,k){if(L&&!v.L)throw Error("Can't create secondary domain capable XhrIo object.");return L=v.Aa&&!v.ma?new Un(new gp({ab:k})):new Un(v.ma),L.Fa(v.L),L}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ru(){}n=ru.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function iu(){}iu.prototype.g=function(v,L){return new $r(v,L)};function $r(v,L){V.call(this),this.g=new Wy(L),this.l=v,this.h=L&&L.messageUrlParams||null,v=L&&L.messageHeaders||null,L&&L.clientProtocolHeaderRequired&&(v?v["X-Client-Protocol"]="webchannel":v={"X-Client-Protocol":"webchannel"}),this.g.o=v,v=L&&L.initMessageHeaders||null,L&&L.messageContentType&&(v?v["X-WebChannel-Content-Type"]=L.messageContentType:v={"X-WebChannel-Content-Type":L.messageContentType}),L&&L.sa&&(v?v["X-WebChannel-Client-Profile"]=L.sa:v={"X-WebChannel-Client-Profile":L.sa}),this.g.U=v,(v=L&&L.Qb)&&!z(v)&&(this.g.u=v),this.A=L&&L.supportsCrossDomainXhr||!1,this.v=L&&L.sendRawJson||!1,(L=L&&L.httpSessionIdParam)&&!z(L)&&(this.g.G=L,v=this.h,v!==null&&L in v&&(v=this.h,L in v&&delete v[L])),this.j=new oa(this)}f($r,V),$r.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},$r.prototype.close=function(){kl(this.g)},$r.prototype.o=function(v){var L=this.g;if(typeof v=="string"){var k={};k.__data__=v,v=k}else this.v&&(k={},k.__data__=At(v),v=k);L.i.push(new ze(L.Ya++,v)),L.I==3&&Ua(L)},$r.prototype.N=function(){this.g.l=null,delete this.j,kl(this.g),delete this.g,$r.Z.N.call(this)};function xp(v){at.call(this),v.__headers__&&(this.headers=v.__headers__,this.statusCode=v.__status__,delete v.__headers__,delete v.__status__);var L=v.__sm__;if(L){e:{for(const k in L){v=k;break e}v=void 0}(this.i=v)&&(v=this.i,L=L!==null&&v in L?L[v]:void 0),this.data=L}else this.data=v}f(xp,at);function Ap(){Ct.call(this),this.status=1}f(Ap,Ct);function oa(v){this.g=v}f(oa,ru),oa.prototype.ra=function(){ce(this.g,"a")},oa.prototype.qa=function(v){ce(this.g,new xp(v))},oa.prototype.pa=function(v){ce(this.g,new Ap)},oa.prototype.oa=function(){ce(this.g,"b")},iu.prototype.createWebChannel=iu.prototype.g,$r.prototype.send=$r.prototype.o,$r.prototype.open=$r.prototype.m,$r.prototype.close=$r.prototype.close,$U=function(){return new iu},WU=function(){return Gt()},GU=bt,vT={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Fr.NO_ERROR=0,Fr.TIMEOUT=8,Fr.HTTP_ERROR=6,S_=Fr,As.COMPLETE="complete",VU=As,wt.EventType=it,it.OPEN="a",it.CLOSE="b",it.ERROR="c",it.MESSAGE="d",V.prototype.listen=V.prototype.J,bm=wt,Un.prototype.listenOnce=Un.prototype.K,Un.prototype.getLastError=Un.prototype.Ha,Un.prototype.getLastErrorCode=Un.prototype.ya,Un.prototype.getStatus=Un.prototype.ca,Un.prototype.getResponseJson=Un.prototype.La,Un.prototype.getResponseText=Un.prototype.la,Un.prototype.send=Un.prototype.ea,Un.prototype.setWithCredentials=Un.prototype.Fa,HU=Un}).apply(typeof Gv<"u"?Gv:typeof self<"u"?self:typeof window<"u"?window:{});const LD="@firebase/firestore",OD="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Li.UNAUTHENTICATED=new Li(null),Li.GOOGLE_CREDENTIALS=new Li("google-credentials-uid"),Li.FIRST_PARTY=new Li("first-party-uid"),Li.MOCK_USER=new Li("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qd="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh=new vx("@firebase/firestore");function bf(){return hh.logLevel}function _t(n,...e){if(hh.logLevel<=fn.DEBUG){const t=e.map(yM);hh.debug(`Firestore (${Qd}): ${n}`,...t)}}function fh(n,...e){if(hh.logLevel<=fn.ERROR){const t=e.map(yM);hh.error(`Firestore (${Qd}): ${n}`,...t)}}function Sx(n,...e){if(hh.logLevel<=fn.WARN){const t=e.map(yM);hh.warn(`Firestore (${Qd}): ${n}`,...t)}}function yM(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,jU(n,r,t)}function jU(n,e,t){let r=`FIRESTORE (${Qd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw fh(r),new Error(r)}function Er(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||jU(e,i,r)}function jn(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const We={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ot extends ea{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class PJ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Li.UNAUTHENTICATED))}shutdown(){}}class DJ{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class LJ{constructor(e){this.t=e,this.currentUser=Li.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Er(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new Xu;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Xu,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{_t("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(_t("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Xu)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(_t("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Er(typeof r.accessToken=="string",31837,{l:r}),new XU(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Er(e===null||typeof e=="string",2055,{h:e}),new Li(e)}}class OJ{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Li.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class BJ{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new OJ(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Li.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class BD{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class NJ{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,uo(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Er(this.o===void 0,3512);const r=s=>{s.error!=null&&_t("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,_t("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{_t("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):_t("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new BD(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Er(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new BD(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kJ(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=kJ(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function Rn(n,e){return n<e?-1:n>e?1:0}function _T(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return $1(i)===$1(s)?Rn(i,s):$1(i)?1:-1}return Rn(n.length,e.length)}const FJ=55296,UJ=57343;function $1(n){const e=n.charCodeAt(0);return e>=FJ&&e<=UJ}function Ad(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND="__name__";class ma{constructor(e,t,r){t===void 0?t=0:t>e.length&&cn(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&cn(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return ma.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ma?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=ma.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Rn(e.length,t.length)}static compareSegments(e,t){const r=ma.isNumericId(e),i=ma.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?ma.extractNumericId(e).compare(ma.extractNumericId(t)):_T(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return gM.fromString(e.substring(4,e.length-2))}}class br extends ma{construct(e,t,r){return new br(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ot(We.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new br(t)}static emptyPath(){return new br([])}}const zJ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ui extends ma{construct(e,t,r){return new ui(e,t,r)}static isValidIdentifier(e){return zJ.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ui.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ND}static keyField(){return new ui([ND])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new Ot(We.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new Ot(We.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ot(We.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new Ot(We.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ui(t)}static emptyPath(){return new ui([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.path=e}static fromPath(e){return new an(br.fromString(e))}static fromName(e){return new an(br.fromString(e).popFirst(5))}static empty(){return new an(br.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&br.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return br.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new an(new br(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HJ(n,e,t){if(!t)throw new Ot(We.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function VJ(n,e,t,r){if(e===!0&&r===!0)throw new Ot(We.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function kD(n){if(!an.isDocumentKey(n))throw new Ot(We.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function KU(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function _M(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":cn(12329,{type:typeof n})}function ET(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ot(We.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=_M(n);throw new Ot(We.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(n,e){const t={typeString:n};return e&&(t.value=e),t}function ay(n,e){if(!KU(n))throw new Ot(We.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new Ot(We.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FD=-62135596800,UD=1e6;class rr{static now(){return rr.fromMillis(Date.now())}static fromDate(e){return rr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*UD);return new rr(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ot(We.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ot(We.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<FD)throw new Ot(We.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ot(We.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/UD}_compareTo(e){return this.seconds===e.seconds?Rn(this.nanoseconds,e.nanoseconds):Rn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:rr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ay(e,rr._jsonSchema))return new rr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-FD;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}rr._jsonSchemaVersion="firestore/timestamp/1.0",rr._jsonSchema={type:Nr("string",rr._jsonSchemaVersion),seconds:Nr("number"),nanoseconds:Nr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{static fromTimestamp(e){return new tr(e)}static min(){return new tr(new rr(0,0))}static max(){return new tr(new rr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xg=-1;function GJ(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=tr.fromTimestamp(r===1e9?new rr(t+1,0):new rr(t,r));return new Lc(i,an.empty(),e)}function WJ(n){return new Lc(n.readTime,n.key,xg)}class Lc{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Lc(tr.min(),an.empty(),xg)}static max(){return new Lc(tr.max(),an.empty(),xg)}}function $J(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=an.comparator(n.documentKey,e.documentKey),t!==0?t:Rn(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jJ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class XJ{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EM(n){if(n.code!==We.FAILED_PRECONDITION||n.message!==jJ)throw n;_t("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&cn(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Fe((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Fe?t:Fe.resolve(t)}catch(t){return Fe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Fe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Fe.reject(t)}static resolve(e){return new Fe((t,r)=>{t(e)})}static reject(e){return new Fe((t,r)=>{r(e)})}static waitFor(e){return new Fe((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},l=>r(l))}),o=!0,s===i&&t()})}static or(e){let t=Fe.resolve(!1);for(const r of e)t=t.next(i=>i?Fe.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new Fe((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;t(e[c]).next(u=>{o[c]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,t){return new Fe((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}function KJ(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ly(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}xM.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AM=-1;function wM(n){return n==null}function _E(n){return n===0&&1/n==-1/0}function JJ(n){return typeof n=="number"&&Number.isInteger(n)&&!_E(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JU="";function YJ(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=zD(e)),e=qJ(n.get(t),e);return zD(e)}function qJ(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case JU:t+="";break;default:t+=s}}return t}function zD(n){return n+JU+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HD(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Zd(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function YU(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e,t){this.comparator=e,this.root=t||li.EMPTY}insert(e,t){return new xs(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,li.BLACK,null,null))}remove(e){return new xs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,li.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Wv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Wv(this.root,e,this.comparator,!1)}getReverseIterator(){return new Wv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Wv(this.root,e,this.comparator,!0)}}class Wv{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class li{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??li.RED,this.left=i??li.EMPTY,this.right=s??li.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new li(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return li.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return li.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,li.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,li.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw cn(43730,{key:this.key,value:this.value});if(this.right.isRed())throw cn(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw cn(27949);return e+(this.isRed()?0:1)}}li.EMPTY=null,li.RED=!0,li.BLACK=!1;li.EMPTY=new class{constructor(){this.size=0}get key(){throw cn(57766)}get value(){throw cn(16141)}get color(){throw cn(16727)}get left(){throw cn(29726)}get right(){throw cn(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new li(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e){this.comparator=e,this.data=new xs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new VD(this.data.getIterator())}getIteratorFrom(e){return new VD(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof pi)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new pi(this.comparator);return t.data=e,t}}class VD{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e){this.fields=e,e.sort(ui.comparator)}static empty(){return new Go([])}unionWith(e){let t=new pi(ui.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Go(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ad(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QJ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new QJ("Invalid base64 string: "+s):s}}(e);return new Ca(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Ca(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Rn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ca.EMPTY_BYTE_STRING=new Ca("");const ZJ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function dh(n){if(Er(!!n,39018),typeof n=="string"){let e=0;const t=ZJ.exec(n);if(Er(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ci(n.seconds),nanos:ci(n.nanos)}}function ci(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wd(n){return typeof n=="string"?Ca.fromBase64String(n):Ca.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qU="server_timestamp",QU="__type__",ZU="__previous_value__",e4="__local_write_time__";function SM(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[QU])==null?void 0:r.stringValue)===qU}function TM(n){const e=n.mapValue.fields[ZU];return SM(e)?TM(e):e}function EE(n){const e=dh(n.mapValue.fields[e4].timestampValue);return new rr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eY{constructor(e,t,r,i,s,o,a,l,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const xE="(default)";class AE{constructor(e,t){this.projectId=e,this.database=t||xE}static empty(){return new AE("","")}get isDefaultDatabase(){return this.database===xE}isEqual(e){return e instanceof AE&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t4="__type__",n4="__max__",$v={mapValue:{fields:{__type__:{stringValue:n4}}}},r4="__vector__",xT="value";function ph(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?SM(n)?4:nY(n)?9007199254740991:tY(n)?10:11:cn(28295,{value:n})}function ba(n,e){if(n===e)return!0;const t=ph(n);if(t!==ph(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return EE(n).isEqual(EE(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=dh(i.timestampValue),a=dh(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return wd(i.bytesValue).isEqual(wd(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return ci(i.geoPointValue.latitude)===ci(s.geoPointValue.latitude)&&ci(i.geoPointValue.longitude)===ci(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ci(i.integerValue)===ci(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=ci(i.doubleValue),a=ci(s.doubleValue);return o===a?_E(o)===_E(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Ad(n.arrayValue.values||[],e.arrayValue.values||[],ba);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(HD(o)!==HD(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!ba(o[l],a[l])))return!1;return!0}(n,e);default:return cn(52216,{left:n})}}function Ag(n,e){return(n.values||[]).find(t=>ba(t,e))!==void 0}function Sd(n,e){if(n===e)return 0;const t=ph(n),r=ph(e);if(t!==r)return Rn(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Rn(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=ci(s.integerValue||s.doubleValue),l=ci(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return GD(n.timestampValue,e.timestampValue);case 4:return GD(EE(n),EE(e));case 5:return _T(n.stringValue,e.stringValue);case 6:return function(s,o){const a=wd(s),l=wd(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=Rn(a[c],l[c]);if(u!==0)return u}return Rn(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Rn(ci(s.latitude),ci(o.latitude));return a!==0?a:Rn(ci(s.longitude),ci(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return WD(n.arrayValue,e.arrayValue);case 10:return function(s,o){var p,m,y,A;const a=s.fields||{},l=o.fields||{},c=(p=a[xT])==null?void 0:p.arrayValue,u=(m=l[xT])==null?void 0:m.arrayValue,f=Rn(((y=c==null?void 0:c.values)==null?void 0:y.length)||0,((A=u==null?void 0:u.values)==null?void 0:A.length)||0);return f!==0?f:WD(c,u)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===$v.mapValue&&o===$v.mapValue)return 0;if(s===$v.mapValue)return 1;if(o===$v.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let f=0;f<l.length&&f<u.length;++f){const p=_T(l[f],u[f]);if(p!==0)return p;const m=Sd(a[l[f]],c[u[f]]);if(m!==0)return m}return Rn(l.length,u.length)}(n.mapValue,e.mapValue);default:throw cn(23264,{he:t})}}function GD(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Rn(n,e);const t=dh(n),r=dh(e),i=Rn(t.seconds,r.seconds);return i!==0?i:Rn(t.nanos,r.nanos)}function WD(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Sd(t[i],r[i]);if(s)return s}return Rn(t.length,r.length)}function Td(n){return AT(n)}function AT(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=dh(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return wd(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return an.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=AT(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${AT(t.fields[o])}`;return i+"}"}(n.mapValue):cn(61005,{value:n})}function T_(n){switch(ph(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=TM(n);return e?16+T_(e):16;case 5:return 2*n.stringValue.length;case 6:return wd(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+T_(s),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Zd(r.fields,(s,o)=>{i+=s.length+T_(o)}),i}(n.mapValue);default:throw cn(13486,{value:n})}}function wT(n){return!!n&&"integerValue"in n}function CM(n){return!!n&&"arrayValue"in n}function C_(n){return!!n&&"mapValue"in n}function tY(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[t4])==null?void 0:r.stringValue)===r4}function Hm(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Zd(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Hm(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Hm(n.arrayValue.values[t]);return e}return{...n}}function nY(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===n4}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e){this.value=e}static empty(){return new zo({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!C_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Hm(t)}setAll(e){let t=ui.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Hm(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());C_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ba(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];C_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Zd(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new zo(Hm(this.value))}}function i4(n){const e=[];return Zd(n.fields,(t,r)=>{const i=new ui([t]);if(C_(r)){const s=i4(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Go(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Fo(e,0,tr.min(),tr.min(),tr.min(),zo.empty(),0)}static newFoundDocument(e,t,r,i){return new Fo(e,1,t,tr.min(),r,i,0)}static newNoDocument(e,t){return new Fo(e,2,t,tr.min(),tr.min(),zo.empty(),0)}static newUnknownDocument(e,t){return new Fo(e,3,t,tr.min(),tr.min(),zo.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(tr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zo.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=tr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Fo&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Fo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(e,t){this.position=e,this.inclusive=t}}function $D(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=an.comparator(an.fromName(o.referenceValue),t.key):r=Sd(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function jD(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ba(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e,t="asc"){this.field=e,this.dir=t}}function rY(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s4{}class ei extends s4{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new sY(e,t,r):t==="array-contains"?new lY(e,r):t==="in"?new cY(e,r):t==="not-in"?new uY(e,r):t==="array-contains-any"?new hY(e,r):new ei(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new oY(e,r):new aY(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Sd(t,this.value)):t!==null&&ph(this.value)===ph(t)&&this.matchesComparison(Sd(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return cn(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Oc extends s4{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Oc(e,t)}matches(e){return o4(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function o4(n){return n.op==="and"}function a4(n){return iY(n)&&o4(n)}function iY(n){for(const e of n.filters)if(e instanceof Oc)return!1;return!0}function ST(n){if(n instanceof ei)return n.field.canonicalString()+n.op.toString()+Td(n.value);if(a4(n))return n.filters.map(e=>ST(e)).join(",");{const e=n.filters.map(t=>ST(t)).join(",");return`${n.op}(${e})`}}function l4(n,e){return n instanceof ei?function(r,i){return i instanceof ei&&r.op===i.op&&r.field.isEqual(i.field)&&ba(r.value,i.value)}(n,e):n instanceof Oc?function(r,i){return i instanceof Oc&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&l4(o,i.filters[a]),!0):!1}(n,e):void cn(19439)}function c4(n){return n instanceof ei?function(t){return`${t.field.canonicalString()} ${t.op} ${Td(t.value)}`}(n):n instanceof Oc?function(t){return t.op.toString()+" {"+t.getFilters().map(c4).join(" ,")+"}"}(n):"Filter"}class sY extends ei{constructor(e,t,r){super(e,t,r),this.key=an.fromName(r.referenceValue)}matches(e){const t=an.comparator(e.key,this.key);return this.matchesComparison(t)}}class oY extends ei{constructor(e,t){super(e,"in",t),this.keys=u4("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class aY extends ei{constructor(e,t){super(e,"not-in",t),this.keys=u4("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function u4(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(r=>an.fromName(r.referenceValue))}class lY extends ei{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return CM(t)&&Ag(t.arrayValue,this.value)}}class cY extends ei{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ag(this.value.arrayValue,t)}}class uY extends ei{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ag(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ag(this.value.arrayValue,t)}}class hY extends ei{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!CM(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ag(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fY{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function XD(n,e=null,t=[],r=[],i=null,s=null,o=null){return new fY(n,e,t,r,i,s,o)}function bM(n){const e=jn(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>ST(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),wM(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Td(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Td(r)).join(",")),e.Te=t}return e.Te}function MM(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!rY(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!l4(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!jD(n.startAt,e.startAt)&&jD(n.endAt,e.endAt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function dY(n,e,t,r,i,s,o,a){return new Tx(n,e,t,r,i,s,o,a)}function pY(n){return new Tx(n)}function KD(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function mY(n){return n.collectionGroup!==null}function Vm(n){const e=jn(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new pi(ui.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new SE(s,r))}),t.has(ui.keyField().canonicalString())||e.Ie.push(new SE(ui.keyField(),r))}return e.Ie}function Ku(n){const e=jn(n);return e.Ee||(e.Ee=gY(e,Vm(n))),e.Ee}function gY(n,e){if(n.limitType==="F")return XD(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new SE(i.field,s)});const t=n.endAt?new wE(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new wE(n.startAt.position,n.startAt.inclusive):null;return XD(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function TT(n,e,t){return new Tx(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function h4(n,e){return MM(Ku(n),Ku(e))&&n.limitType===e.limitType}function f4(n){return`${bM(Ku(n))}|lt:${n.limitType}`}function Yp(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>c4(i)).join(", ")}]`),wM(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Td(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Td(i)).join(",")),`Target(${r})`}(Ku(n))}; limitType=${n.limitType})`}function RM(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):an.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of Vm(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const c=$D(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Vm(r),i)||r.endAt&&!function(o,a,l){const c=$D(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Vm(r),i))}(n,e)}function yY(n){return(e,t)=>{let r=!1;for(const i of Vm(n)){const s=vY(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function vY(n,e,t){const r=n.field.isKeyField()?an.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?Sd(l,c):cn(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return cn(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Zd(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return YU(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _Y=new xs(an.comparator);function TE(){return _Y}const d4=new xs(an.comparator);function jv(...n){let e=d4;for(const t of n)e=e.insert(t.key,t);return e}function p4(n){let e=d4;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function ku(){return Gm()}function m4(){return Gm()}function Gm(){return new Th(n=>n.toString(),(n,e)=>n.isEqual(e))}const EY=new xs(an.comparator),xY=new pi(an.comparator);function Bi(...n){let e=xY;for(const t of n)e=e.add(t);return e}const AY=new pi(Rn);function wY(){return AY}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IM(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_E(e)?"-0":e}}function g4(n){return{integerValue:""+n}}function SY(n,e){return JJ(e)?g4(e):IM(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(){this._=void 0}}function TY(n,e,t){return n instanceof CE?function(i,s){const o={fields:{[QU]:{stringValue:qU},[e4]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&SM(s)&&(s=TM(s)),s&&(o.fields[ZU]=s),{mapValue:o}}(t,e):n instanceof wg?v4(n,e):n instanceof Sg?_4(n,e):function(i,s){const o=y4(i,s),a=JD(o)+JD(i.Ae);return wT(o)&&wT(i.Ae)?g4(a):IM(i.serializer,a)}(n,e)}function CY(n,e,t){return n instanceof wg?v4(n,e):n instanceof Sg?_4(n,e):t}function y4(n,e){return n instanceof bE?function(r){return wT(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class CE extends Cx{}class wg extends Cx{constructor(e){super(),this.elements=e}}function v4(n,e){const t=E4(e);for(const r of n.elements)t.some(i=>ba(i,r))||t.push(r);return{arrayValue:{values:t}}}class Sg extends Cx{constructor(e){super(),this.elements=e}}function _4(n,e){let t=E4(e);for(const r of n.elements)t=t.filter(i=>!ba(i,r));return{arrayValue:{values:t}}}class bE extends Cx{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function JD(n){return ci(n.integerValue||n.doubleValue)}function E4(n){return CM(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function bY(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof wg&&i instanceof wg||r instanceof Sg&&i instanceof Sg?Ad(r.elements,i.elements,ba):r instanceof bE&&i instanceof bE?ba(r.Ae,i.Ae):r instanceof CE&&i instanceof CE}(n.transform,e.transform)}class MY{constructor(e,t){this.version=e,this.transformResults=t}}class dl{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new dl}static exists(e){return new dl(void 0,e)}static updateTime(e){return new dl(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function b_(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class bx{}function x4(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new w4(n.key,dl.none()):new cy(n.key,n.data,dl.none());{const t=n.data,r=zo.empty();let i=new pi(ui.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Ch(n.key,r,new Go(i.toArray()),dl.none())}}function RY(n,e,t){n instanceof cy?function(i,s,o){const a=i.value.clone(),l=qD(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Ch?function(i,s,o){if(!b_(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=qD(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(A4(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Wm(n,e,t,r){return n instanceof cy?function(s,o,a,l){if(!b_(s.precondition,o))return a;const c=s.value.clone(),u=QD(s.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof Ch?function(s,o,a,l){if(!b_(s.precondition,o))return a;const c=QD(s.fieldTransforms,l,o),u=o.data;return u.setAll(A4(s)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(s,o,a){return b_(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function IY(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=y4(r.transform,i||null);s!=null&&(t===null&&(t=zo.empty()),t.set(r.field,s))}return t||null}function YD(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ad(r,i,(s,o)=>bY(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class cy extends bx{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ch extends bx{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function A4(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function qD(n,e,t){const r=new Map;Er(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,CY(o,a,t[i]))}return r}function QD(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,TY(s,o,e))}return r}class w4 extends bx{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class PY extends bx{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DY{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&RY(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Wm(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Wm(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=m4();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const l=x4(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(tr.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Bi())}isEqual(e){return this.batchId===e.batchId&&Ad(this.mutations,e.mutations,(t,r)=>YD(t,r))&&Ad(this.baseMutations,e.baseMutations,(t,r)=>YD(t,r))}}class PM{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Er(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return EY}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new PM(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let LY=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Or,yn;function OY(n){switch(n){case We.OK:return cn(64938);case We.CANCELLED:case We.UNKNOWN:case We.DEADLINE_EXCEEDED:case We.RESOURCE_EXHAUSTED:case We.INTERNAL:case We.UNAVAILABLE:case We.UNAUTHENTICATED:return!1;case We.INVALID_ARGUMENT:case We.NOT_FOUND:case We.ALREADY_EXISTS:case We.PERMISSION_DENIED:case We.FAILED_PRECONDITION:case We.ABORTED:case We.OUT_OF_RANGE:case We.UNIMPLEMENTED:case We.DATA_LOSS:return!0;default:return cn(15467,{code:n})}}function BY(n){if(n===void 0)return fh("GRPC error has no .code"),We.UNKNOWN;switch(n){case Or.OK:return We.OK;case Or.CANCELLED:return We.CANCELLED;case Or.UNKNOWN:return We.UNKNOWN;case Or.DEADLINE_EXCEEDED:return We.DEADLINE_EXCEEDED;case Or.RESOURCE_EXHAUSTED:return We.RESOURCE_EXHAUSTED;case Or.INTERNAL:return We.INTERNAL;case Or.UNAVAILABLE:return We.UNAVAILABLE;case Or.UNAUTHENTICATED:return We.UNAUTHENTICATED;case Or.INVALID_ARGUMENT:return We.INVALID_ARGUMENT;case Or.NOT_FOUND:return We.NOT_FOUND;case Or.ALREADY_EXISTS:return We.ALREADY_EXISTS;case Or.PERMISSION_DENIED:return We.PERMISSION_DENIED;case Or.FAILED_PRECONDITION:return We.FAILED_PRECONDITION;case Or.ABORTED:return We.ABORTED;case Or.OUT_OF_RANGE:return We.OUT_OF_RANGE;case Or.UNIMPLEMENTED:return We.UNIMPLEMENTED;case Or.DATA_LOSS:return We.DATA_LOSS;default:return cn(39323,{code:n})}}(yn=Or||(Or={}))[yn.OK=0]="OK",yn[yn.CANCELLED=1]="CANCELLED",yn[yn.UNKNOWN=2]="UNKNOWN",yn[yn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yn[yn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yn[yn.NOT_FOUND=5]="NOT_FOUND",yn[yn.ALREADY_EXISTS=6]="ALREADY_EXISTS",yn[yn.PERMISSION_DENIED=7]="PERMISSION_DENIED",yn[yn.UNAUTHENTICATED=16]="UNAUTHENTICATED",yn[yn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yn[yn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yn[yn.ABORTED=10]="ABORTED",yn[yn.OUT_OF_RANGE=11]="OUT_OF_RANGE",yn[yn.UNIMPLEMENTED=12]="UNIMPLEMENTED",yn[yn.INTERNAL=13]="INTERNAL",yn[yn.UNAVAILABLE=14]="UNAVAILABLE",yn[yn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new gM([4294967295,4294967295],0);class NY{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function CT(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kY(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function FY(n,e){return CT(n,e.toTimestamp())}function ad(n){return Er(!!n,49232),tr.fromTimestamp(function(t){const r=dh(t);return new rr(r.seconds,r.nanos)}(n))}function S4(n,e){return bT(n,e).canonicalString()}function bT(n,e){const t=function(i){return new br(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function UY(n){const e=br.fromString(n);return Er(XY(e),10190,{key:e.toString()}),e}function MT(n,e){return S4(n.databaseId,e.path)}function zY(n){const e=UY(n);return e.length===4?br.emptyPath():VY(e)}function HY(n){return new br(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function VY(n){return Er(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function ZD(n,e,t){return{name:MT(n,e),fields:t.value.mapValue.fields}}function GY(n,e){let t;if(e instanceof cy)t={update:ZD(n,e.key,e.value)};else if(e instanceof w4)t={delete:MT(n,e.key)};else if(e instanceof Ch)t={update:ZD(n,e.key,e.data),updateMask:jY(e.fieldMask)};else{if(!(e instanceof PY))return cn(16599,{Vt:e.type});t={verify:MT(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof CE)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof wg)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Sg)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof bE)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw cn(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:FY(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:cn(27497)}(n,e.precondition)),t}function WY(n,e){return n&&n.length>0?(Er(e!==void 0,14353),n.map(t=>function(i,s){let o=i.updateTime?ad(i.updateTime):ad(s);return o.isEqual(tr.min())&&(o=ad(s)),new MY(o,i.transformResults||[])}(t,e))):[]}function $Y(n){let e=zY(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Er(r===1,65062);const u=t.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=function(f){const p=T4(f);return p instanceof Oc&&a4(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(p=>function(y){return new SE(Mf(y.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(f){let p;return p=typeof f=="object"?f.value:f,wM(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(f){const p=!!f.before,m=f.values||[];return new wE(m,p)}(t.startAt));let c=null;return t.endAt&&(c=function(f){const p=!f.before,m=f.values||[];return new wE(m,p)}(t.endAt)),dY(e,i,o,s,a,"F",l,c)}function T4(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Mf(t.unaryFilter.field);return ei.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Mf(t.unaryFilter.field);return ei.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Mf(t.unaryFilter.field);return ei.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Mf(t.unaryFilter.field);return ei.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return cn(61313);default:return cn(60726)}}(n):n.fieldFilter!==void 0?function(t){return ei.create(Mf(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return cn(58110);default:return cn(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Oc.create(t.compositeFilter.filters.map(r=>T4(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return cn(1026)}}(t.compositeFilter.op))}(n):cn(30097,{filter:n})}function Mf(n){return ui.fromServerFormat(n.fieldPath)}function jY(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function XY(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KY{constructor(e){this.yt=e}}function JY(n){const e=$Y({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?TT(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YY{constructor(){this.Cn=new qY}addToCollectionParentIndex(e,t){return this.Cn.add(t),Fe.resolve()}getCollectionParents(e,t){return Fe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Fe.resolve()}deleteFieldIndex(e,t){return Fe.resolve()}deleteAllFieldIndexes(e){return Fe.resolve()}createTargetIndexes(e,t){return Fe.resolve()}getDocumentsMatchingTarget(e,t){return Fe.resolve(null)}getIndexType(e,t){return Fe.resolve(0)}getFieldIndexes(e,t){return Fe.resolve([])}getNextCollectionGroupToUpdate(e){return Fe.resolve(null)}getMinOffset(e,t){return Fe.resolve(Lc.min())}getMinOffsetFromCollectionGroup(e,t){return Fe.resolve(Lc.min())}updateCollectionGroup(e,t,r){return Fe.resolve()}updateIndexEntries(e,t){return Fe.resolve()}}class qY{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new pi(br.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new pi(br.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eL={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},C4=41943040;class fs{static withCacheSize(e){return new fs(e,fs.DEFAULT_COLLECTION_PERCENTILE,fs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fs.DEFAULT_COLLECTION_PERCENTILE=10,fs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,fs.DEFAULT=new fs(C4,fs.DEFAULT_COLLECTION_PERCENTILE,fs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),fs.DISABLED=new fs(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Cd(0)}static cr(){return new Cd(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tL="LruGarbageCollector",QY=1048576;function nL([n,e],[t,r]){const i=Rn(n,t);return i===0?Rn(e,r):i}class ZY{constructor(e){this.Ir=e,this.buffer=new pi(nL),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();nL(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class eq{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){_t(tL,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ly(t)?_t(tL,"Ignoring IndexedDB error during garbage collection: ",t):await EM(t)}await this.Vr(3e5)})}}class tq{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return Fe.resolve(xM.ce);const r=new ZY(t);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(_t("LruGarbageCollector","Garbage collection skipped; disabled"),Fe.resolve(eL)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(_t("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),eL):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(_t("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(c=Date.now(),bf()<=fn.DEBUG&&_t("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),Fe.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function nq(n,e){return new tq(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rq{constructor(){this.changes=new Th(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Fo.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?Fe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iq{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sq{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Wm(r.mutation,i,Go.empty(),rr.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Bi()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Bi()){const i=ku();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=jv();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=ku();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Bi()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=TE();const o=Gm(),a=function(){return Gm()}();return t.forEach((l,c)=>{const u=r.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof Ch)?s=s.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),Wm(u.mutation,c,u.mutation.getFieldMask(),rr.now())):o.set(c.key,Go.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,u)=>o.set(c,u)),t.forEach((c,u)=>a.set(c,new iq(u,o.get(c)??null))),a))}recalculateAndSaveOverlays(e,t){const r=Gm();let i=new xs((o,a)=>o-a),s=Bi();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let u=r.get(l)||Go.empty();u=a.applyToLocalView(c,u),r.set(l,u);const f=(i.get(a.batchId)||Bi()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,f=m4();u.forEach(p=>{if(!s.has(p)){const m=x4(t.get(p),r.get(p));m!==null&&f.set(p,m),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return Fe.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return an.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):mY(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):Fe.resolve(ku());let a=xg,l=s;return o.next(c=>Fe.forEach(c,(u,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(u)?Fe.resolve():this.remoteDocumentCache.getEntry(e,u).next(p=>{l=l.insert(u,p)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Bi())).next(u=>({batchId:a,changes:p4(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new an(t)).next(r=>{let i=jv();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=jv();return this.indexManager.getCollectionParents(e,s).next(a=>Fe.forEach(a,l=>{const c=function(f,p){return new Tx(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(u=>{u.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,Fo.newInvalidDocument(u)))});let a=jv();return o.forEach((l,c)=>{const u=s.get(l);u!==void 0&&Wm(u.mutation,c,Go.empty(),rr.now()),RM(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oq{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Fe.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:ad(i.createTime)}}(t)),Fe.resolve()}getNamedQuery(e,t){return Fe.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(i){return{name:i.name,query:JY(i.bundledQuery),readTime:ad(i.readTime)}}(t)),Fe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aq{constructor(){this.overlays=new xs(an.comparator),this.qr=new Map}getOverlay(e,t){return Fe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ku();return Fe.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.St(e,t,s)}),Fe.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),Fe.resolve()}getOverlaysForCollection(e,t,r){const i=ku(),s=t.length+1,o=new an(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return Fe.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new xs((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let u=s.get(c.largestBatchId);u===null&&(u=ku(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=ku(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=i)););return Fe.resolve(a)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new LY(t,r));let s=this.qr.get(t);s===void 0&&(s=Bi(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lq{constructor(){this.sessionToken=Ca.EMPTY_BYTE_STRING}getSessionToken(e){return Fe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Fe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(){this.Qr=new pi(qr.$r),this.Ur=new pi(qr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new qr(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new qr(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){const t=new an(new br([])),r=new qr(t,e),i=new qr(t,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new an(new br([])),r=new qr(t,e),i=new qr(t,e+1);let s=Bi();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new qr(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class qr{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return an.comparator(e.key,t.key)||Rn(e.Yr,t.Yr)}static Kr(e,t){return Rn(e.Yr,t.Yr)||an.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cq{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new pi(qr.$r)}checkEmpty(e){return Fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new DY(s,t,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new qr(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Fe.resolve(o)}lookupMutationBatch(e,t){return Fe.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return Fe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Fe.resolve(this.mutationQueue.length===0?AM:this.tr-1)}getAllMutationBatches(e){return Fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new qr(t,0),i=new qr(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),Fe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pi(Rn);return t.forEach(i=>{const s=new qr(i,0),o=new qr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),Fe.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;an.isDocumentKey(s)||(s=s.child(""));const o=new qr(new an(s),0);let a=new pi(Rn);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.Yr)),!0)},o),Fe.resolve(this.ti(a))}ti(e){const t=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Er(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return Fe.forEach(t.mutations,i=>{const s=new qr(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){const r=new qr(t,0),i=this.Zr.firstAfterOrEqual(r);return Fe.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Fe.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uq{constructor(e){this.ri=e,this.docs=function(){return new xs(an.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return Fe.resolve(r?r.document.mutableCopy():Fo.newInvalidDocument(t))}getEntries(e,t){let r=TE();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Fo.newInvalidDocument(i))}),Fe.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=TE();const o=t.path,a=new an(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||$J(WJ(u),r)<=0||(i.has(u.key)||RM(t,u))&&(s=s.insert(u.key,u.mutableCopy()))}return Fe.resolve(s)}getAllFromCollectionGroup(e,t,r,i){cn(9500)}ii(e,t){return Fe.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new hq(this)}getSize(e){return Fe.resolve(this.size)}}class hq extends rq{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),Fe.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fq{constructor(e){this.persistence=e,this.si=new Th(t=>bM(t),MM),this.lastRemoteSnapshotVersion=tr.min(),this.highestTargetId=0,this.oi=0,this._i=new DM,this.targetCount=0,this.ai=Cd.ur()}forEachTarget(e,t){return this.si.forEach((r,i)=>t(i)),Fe.resolve()}getLastRemoteSnapshotVersion(e){return Fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Fe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Fe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),Fe.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Cd(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Fe.resolve()}updateTargetData(e,t){return this.Pr(t),Fe.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Fe.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),Fe.waitFor(s).next(()=>i)}getTargetCount(e){return Fe.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return Fe.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),Fe.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),Fe.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Fe.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return Fe.resolve(r)}containsKey(e,t){return Fe.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(e,t){this.ui={},this.overlays={},this.ci=new xM(0),this.li=!1,this.li=!0,this.hi=new lq,this.referenceDelegate=e(this),this.Pi=new fq(this),this.indexManager=new YY,this.remoteDocumentCache=function(i){return new uq(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new KY(t),this.Ii=new oq(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new aq,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new cq(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){_t("MemoryPersistence","Starting transaction:",e);const i=new dq(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,t){return Fe.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}}class dq extends XJ{constructor(e){super(),this.currentSequenceNumber=e}}class LM{constructor(e){this.persistence=e,this.Ri=new DM,this.Vi=null}static mi(e){return new LM(e)}get fi(){if(this.Vi)return this.Vi;throw cn(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),Fe.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),Fe.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Fe.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Fe.forEach(this.fi,r=>{const i=an.fromPath(r);return this.gi(e,i).next(s=>{s||t.removeEntry(i,tr.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Fe.or([()=>Fe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class ME{constructor(e,t){this.persistence=e,this.pi=new Th(r=>YJ(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=nq(this,t)}static mi(e,t){return new ME(e,t)}Ei(){}di(e){return Fe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return Fe.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?Fe.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,t).next(a=>{a||(r++,s.removeEntry(o,tr.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Fe.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),Fe.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),Fe.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Fe.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=T_(e.data.value)),t}br(e,t,r){return Fe.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return Fe.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=Bi(),i=Bi();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new OM(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pq{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mq{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return T$()?8:KJ(zi())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new pq;return this.Ss(e,t,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,t,o,a.size)})}).next(()=>s.result)}bs(e,t,r,i){return r.documentReadCount<this.fs?(bf()<=fn.DEBUG&&_t("QueryEngine","SDK will not create cache indexes for query:",Yp(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Fe.resolve()):(bf()<=fn.DEBUG&&_t("QueryEngine","Query:",Yp(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(bf()<=fn.DEBUG&&_t("QueryEngine","The SDK decides to create cache indexes for query:",Yp(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ku(t))):Fe.resolve())}ys(e,t){if(KD(t))return Fe.resolve(null);let r=Ku(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=TT(t,null,"F"),r=Ku(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Bi(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.Ds(t,a);return this.Cs(t,c,o,l.readTime)?this.ys(e,TT(t,null,"F")):this.vs(e,c,t,l)}))})))}ws(e,t,r,i){return KD(t)||i.isEqual(tr.min())?Fe.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(t,s);return this.Cs(t,o,r,i)?Fe.resolve(null):(bf()<=fn.DEBUG&&_t("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Yp(t)),this.vs(e,o,t,GJ(i,xg)).next(a=>a))})}Ds(e,t){let r=new pi(yY(e));return t.forEach((i,s)=>{RM(e,s)&&(r=r.add(s))}),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return bf()<=fn.DEBUG&&_t("QueryEngine","Using full collection scan to execute query:",Yp(t)),this.ps.getDocumentsMatchingQuery(e,t,Lc.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gq="LocalStore";class yq{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new xs(Rn),this.xs=new Th(s=>bM(s),MM),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sq(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function vq(n,e,t,r){return new yq(n,e,t,r)}async function M4(n,e){const t=jn(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Bi();for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(r,l).next(c=>({Ls:c,removedBatchIds:o,addedBatchIds:a}))})})}function _q(n,e){const t=jn(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const f=c.batch,p=f.keys();let m=Fe.resolve();return p.forEach(y=>{m=m.next(()=>u.getEntry(l,y)).next(A=>{const _=c.docVersions.get(y);Er(_!==null,48541),A.version.compareTo(_)<0&&(f.applyToRemoteDocument(A,c),A.isValidDocument()&&(A.setReadTime(c.commitVersion),u.addEntry(A)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Bi();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Eq(n){const e=jn(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function xq(n,e){const t=jn(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=AM),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}class rL{constructor(){this.activeTargetIds=wY()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Aq{constructor(){this.Mo=new rL,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new rL,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wq{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iL="ConnectivityMonitor";class sL{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){_t(iL,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){_t(iL,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xv=null;function RT(){return Xv===null?Xv=function(){return 268435456+Math.round(2147483648*Math.random())}():Xv++,"0x"+Xv.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1="RestConnection",Sq={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Tq{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===xE?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const o=RT(),a=this.zo(e,t.toUriEncodedString());_t(j1,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:c}=new URL(a),u=Jd(c);return this.Jo(e,a,l,r,u).then(f=>(_t(j1,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Sx(j1,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,t,r,i,s,o){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Qd}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,t){const r=Sq[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cq{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri="WebChannelConnection";class bq extends Tq{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const o=RT();return new Promise((a,l)=>{const c=new HU;c.setWithCredentials(!0),c.listenOnce(VU.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case S_.NO_ERROR:const f=c.getResponseJson();_t(Ri,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case S_.TIMEOUT:_t(Ri,`RPC '${e}' ${o} timed out`),l(new Ot(We.DEADLINE_EXCEEDED,"Request time out"));break;case S_.HTTP_ERROR:const p=c.getStatus();if(_t(Ri,`RPC '${e}' ${o} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m==null?void 0:m.error;if(y&&y.status&&y.message){const A=function(g){const E=g.toLowerCase().replace(/_/g,"-");return Object.values(We).indexOf(E)>=0?E:We.UNKNOWN}(y.status);l(new Ot(A,y.message))}else l(new Ot(We.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Ot(We.UNAVAILABLE,"Connection failed."));break;default:cn(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{_t(Ri,`RPC '${e}' ${o} completed.`)}});const u=JSON.stringify(i);_t(Ri,`RPC '${e}' ${o} sending request:`,i),c.send(t,"POST",u,r,15)})}T_(e,t,r){const i=RT(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=$U(),a=WU(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const u=s.join("");_t(Ri,`Creating RPC '${e}' stream ${i}: ${u}`,l);const f=o.createWebChannel(u,l);this.I_(f);let p=!1,m=!1;const y=new Cq({Yo:_=>{m?_t(Ri,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(p||(_t(Ri,`Opening RPC '${e}' stream ${i} transport.`),f.open(),p=!0),_t(Ri,`RPC '${e}' stream ${i} sending:`,_),f.send(_))},Zo:()=>f.close()}),A=(_,g,E)=>{_.listen(g,x=>{try{E(x)}catch(T){setTimeout(()=>{throw T},0)}})};return A(f,bm.EventType.OPEN,()=>{m||(_t(Ri,`RPC '${e}' stream ${i} transport opened.`),y.o_())}),A(f,bm.EventType.CLOSE,()=>{m||(m=!0,_t(Ri,`RPC '${e}' stream ${i} transport closed`),y.a_(),this.E_(f))}),A(f,bm.EventType.ERROR,_=>{m||(m=!0,Sx(Ri,`RPC '${e}' stream ${i} transport errored. Name:`,_.name,"Message:",_.message),y.a_(new Ot(We.UNAVAILABLE,"The operation could not be completed")))}),A(f,bm.EventType.MESSAGE,_=>{var g;if(!m){const E=_.data[0];Er(!!E,16349);const x=E,T=(x==null?void 0:x.error)||((g=x[0])==null?void 0:g.error);if(T){_t(Ri,`RPC '${e}' stream ${i} received error:`,T);const O=T.status;let I=function(C){const M=Or[C];if(M!==void 0)return BY(M)}(O),b=T.message;I===void 0&&(I=We.INTERNAL,b="Unknown error status: "+O+" with message "+T.message),m=!0,y.a_(new Ot(I,b)),f.close()}else _t(Ri,`RPC '${e}' stream ${i} received:`,E),y.u_(E)}}),A(a,GU.STAT_EVENT,_=>{_.stat===vT.PROXY?_t(Ri,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===vT.NOPROXY&&_t(Ri,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.__()},0),y}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function X1(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mx(n){return new NY(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&_t("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL="PersistentStream";class Mq{constructor(e,t,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new R4(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===We.RESOURCE_EXHAUSTED?(fh(t.toString()),fh("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===We.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{const i=new Ot(We.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return _t(oL,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(_t(oL,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Rq extends Mq{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Er(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Er(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Er(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=WY(e.writeResults,e.commitTime),r=ad(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=HY(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>GY(this.serializer,r))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iq{}class Pq extends Iq{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Ot(We.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,bT(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===We.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ot(We.UNKNOWN,s.toString())})}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,bT(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===We.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ot(We.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Dq{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(fh(t),this.aa=!1):_t("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy="RemoteStore";class Lq{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{fy(this)&&(_t(uy,"Restarting streams for network reachability change."),await async function(l){const c=jn(l);c.Ea.add(4),await hy(c),c.Ra.set("Unknown"),c.Ea.delete(4),await Rx(c)}(this))})}),this.Ra=new Dq(r,i)}}async function Rx(n){if(fy(n))for(const e of n.da)await e(!0)}async function hy(n){for(const e of n.da)await e(!1)}function fy(n){return jn(n).Ea.size===0}async function I4(n,e,t){if(!ly(e))throw e;n.Ea.add(1),await hy(n),n.Ra.set("Offline"),t||(t=()=>Eq(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{_t(uy,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Rx(n)})}function P4(n,e){return e().catch(t=>I4(n,t,e))}async function Ix(n){const e=jn(n),t=Bc(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:AM;for(;Oq(e);)try{const i=await xq(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,Bq(e,i)}catch(i){await I4(e,i)}D4(e)&&L4(e)}function Oq(n){return fy(n)&&n.Ta.length<10}function Bq(n,e){n.Ta.push(e);const t=Bc(n);t.O_()&&t.X_&&t.ea(e.mutations)}function D4(n){return fy(n)&&!Bc(n).x_()&&n.Ta.length>0}function L4(n){Bc(n).start()}async function Nq(n){Bc(n).ra()}async function kq(n){const e=Bc(n);for(const t of n.Ta)e.ea(t.mutations)}async function Fq(n,e,t){const r=n.Ta.shift(),i=PM.from(r,e,t);await P4(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Ix(n)}async function Uq(n,e){e&&Bc(n).X_&&await async function(r,i){if(function(o){return OY(o)&&o!==We.ABORTED}(i.code)){const s=r.Ta.shift();Bc(r).B_(),await P4(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Ix(r)}}(n,e),D4(n)&&L4(n)}async function aL(n,e){const t=jn(n);t.asyncQueue.verifyOperationInProgress(),_t(uy,"RemoteStore received new credentials");const r=fy(t);t.Ea.add(3),await hy(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Rx(t)}async function zq(n,e){const t=jn(n);e?(t.Ea.delete(2),await Rx(t)):e||(t.Ea.add(2),await hy(t),t.Ra.set("Unknown"))}function Bc(n){return n.fa||(n.fa=function(t,r,i){const s=jn(t);return s.sa(),new Rq(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Nq.bind(null,n),r_:Uq.bind(null,n),ta:kq.bind(null,n),na:Fq.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await Ix(n)):(await n.fa.stop(),n.Ta.length>0&&(_t(uy,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BM{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Xu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,a=new BM(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ot(We.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function O4(n,e){if(fh("AsyncQueue",`${e}: ${n}`),ly(n))return new Ot(We.UNAVAILABLE,`${e}: ${n}`);throw n}class Hq{constructor(){this.queries=lL(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=jn(t),s=i.queries;i.queries=lL(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new Ot(We.ABORTED,"Firestore shutting down"))}}function lL(){return new Th(n=>f4(n),h4)}function Vq(n){n.Ca.forEach(e=>{e.next()})}var cL,uL;(uL=cL||(cL={})).Ma="default",uL.Cache="cache";const Gq="SyncEngine";class Wq{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Th(a=>f4(a),h4),this.Iu=new Map,this.Eu=new Set,this.du=new xs(an.comparator),this.Au=new Map,this.Ru=new DM,this.Vu={},this.mu=new Map,this.fu=Cd.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function $q(n,e,t){const r=Jq(n);try{const i=await function(o,a){const l=jn(o),c=rr.now(),u=a.reduce((m,y)=>m.add(y.key),Bi());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=TE(),A=Bi();return l.Ns.getEntries(m,u).next(_=>{y=_,y.forEach((g,E)=>{E.isValidDocument()||(A=A.add(g))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(_=>{f=_;const g=[];for(const E of a){const x=IY(E,f.get(E.key).overlayedDocument);x!=null&&g.push(new Ch(E.key,x,i4(x.value.mapValue),dl.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,g,a)}).next(_=>{p=_;const g=_.applyToLocalDocumentSet(f,A);return l.documentOverlayCache.saveOverlays(m,_.batchId,g)})}).then(()=>({batchId:p.batchId,changes:p4(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.Vu[o.currentUser.toKey()];c||(c=new xs(Rn)),c=c.insert(a,l),o.Vu[o.currentUser.toKey()]=c}(r,i.batchId,t),await Px(r,i.changes),await Ix(r.remoteStore)}catch(i){const s=O4(i,"Failed to persist write");t.reject(s)}}function hL(n,e,t){const r=jn(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=jn(o);l.onlineState=a;let c=!1;l.queries.forEach((u,f)=>{for(const p of f.Sa)p.va(a)&&(c=!0)}),c&&Vq(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function jq(n,e){const t=jn(n),r=e.batch.batchId;try{const i=await _q(t.localStore,e);N4(t,r,null),B4(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Px(t,i)}catch(i){await EM(i)}}async function Xq(n,e,t){const r=jn(n);try{const i=await function(o,a){const l=jn(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(f=>(Er(f!==null,37113),u=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,e);N4(r,e,t),B4(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Px(r,i)}catch(i){await EM(i)}}function B4(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function N4(n,e,t){const r=jn(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}async function Px(n,e,t){const r=jn(n),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,t).then(c=>{var u;if((c||t)&&r.isPrimaryClient){const f=c?!c.fromCache:(u=t==null?void 0:t.targetChanges.get(l.targetId))==null?void 0:u.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){i.push(c);const f=OM.As(l.targetId,c);s.push(f)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,c){const u=jn(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Fe.forEach(c,p=>Fe.forEach(p.Es,m=>u.persistence.referenceDelegate.addReference(f,p.targetId,m)).next(()=>Fe.forEach(p.ds,m=>u.persistence.referenceDelegate.removeReference(f,p.targetId,m)))))}catch(f){if(!ly(f))throw f;_t(gq,"Failed to update sequence numbers: "+f)}for(const f of c){const p=f.targetId;if(!f.fromCache){const m=u.Ms.get(p),y=m.snapshotVersion,A=m.withLastLimboFreeSnapshotVersion(y);u.Ms=u.Ms.insert(p,A)}}}(r.localStore,s))}async function Kq(n,e){const t=jn(n);if(!t.currentUser.isEqual(e)){_t(Gq,"User change. New user:",e.toKey());const r=await M4(t.localStore,e);t.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new Ot(We.CANCELLED,o))})}),s.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Px(t,r.Ls)}}function Jq(n){const e=jn(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jq.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Xq.bind(null,e),e}class RE{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Mx(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return vq(this.persistence,new mq,e.initialUser,this.serializer)}Cu(e){return new b4(LM.mi,this.serializer)}Du(e){return new Aq}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}RE.provider={build:()=>new RE};class Yq extends RE{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Er(this.persistence.referenceDelegate instanceof ME,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new eq(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?fs.withCacheSize(this.cacheSizeBytes):fs.DEFAULT;return new b4(r=>ME.mi(r,t),this.serializer)}}class IT{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>hL(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Kq.bind(null,this.syncEngine),await zq(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Hq}()}createDatastore(e){const t=Mx(e.databaseInfo.databaseId),r=function(s){return new bq(s)}(e.databaseInfo);return function(s,o,a,l){return new Pq(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new Lq(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>hL(this.syncEngine,t,0),function(){return sL.v()?new sL:new wq}())}createSyncEngine(e,t){return function(i,s,o,a,l,c,u){const f=new Wq(i,s,o,a,l,c);return u&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=jn(i);_t(uy,"RemoteStore shutting down."),s.Ea.add(5),await hy(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}IT.provider={build:()=>new IT};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc="FirestoreClient";class qq{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Li.UNAUTHENTICATED,this.clientId=vM.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{_t(Nc,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(_t(Nc,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=O4(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function K1(n,e){n.asyncQueue.verifyOperationInProgress(),_t(Nc,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await M4(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function fL(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Qq(n);_t(Nc,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>aL(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>aL(e.remoteStore,i)),n._onlineComponents=e}async function Qq(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){_t(Nc,"Using user provided OfflineComponentProvider");try{await K1(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===We.FAILED_PRECONDITION||i.code===We.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Sx("Error using user provided cache. Falling back to memory cache: "+t),await K1(n,new RE)}}else _t(Nc,"Using default OfflineComponentProvider"),await K1(n,new Yq(void 0));return n._offlineComponents}async function Zq(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(_t(Nc,"Using user provided OnlineComponentProvider"),await fL(n,n._uninitializedComponentsProvider._online)):(_t(Nc,"Using default OnlineComponentProvider"),await fL(n,new IT))),n._onlineComponents}function eQ(n){return Zq(n).then(e=>e.syncEngine)}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k4(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F4="firestore.googleapis.com",pL=!0;class mL{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ot(We.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=F4,this.ssl=pL}else this.host=e.host,this.ssl=e.ssl??pL;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=C4;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<QY)throw new Ot(We.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VJ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=k4(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ot(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ot(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ot(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class NM{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mL({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ot(We.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ot(We.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mL(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new PJ;switch(r.type){case"firstParty":return new BJ(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ot(We.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=dL.get(t);r&&(_t("ComponentProvider","Removing Datastore"),dL.delete(t),r.terminate())}(this),Promise.resolve()}}function tQ(n,e,t,r={}){var c;n=ET(n,NM);const i=Jd(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;i&&(RF(`https://${a}`),IF("Firestore",!0)),s.host!==F4&&s.host!==a&&Sx("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!Dc(l,o)&&(n._setSettings(l),r.mockUserToken)){let u,f;if(typeof r.mockUserToken=="string")u=r.mockUserToken,f=Li.MOCK_USER;else{u=y$(r.mockUserToken,(c=n._app)==null?void 0:c.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new Ot(We.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Li(p)}n._authCredentials=new DJ(new XU(u,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new kM(this.firestore,e,this._query)}}class ki{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Tg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ki(this.firestore,e,this._key)}toJSON(){return{type:ki._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(ay(t,ki._jsonSchema))return new ki(e,r||null,new an(br.fromString(t.referencePath)))}}ki._jsonSchemaVersion="firestore/documentReference/1.0",ki._jsonSchema={type:Nr("string",ki._jsonSchemaVersion),referencePath:Nr("string")};class Tg extends kM{constructor(e,t,r){super(e,t,pY(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ki(this.firestore,null,new an(e))}withConverter(e){return new Tg(this.firestore,e,this._path)}}function nQ(n,e,...t){if(n=vi(n),arguments.length===1&&(e=vM.newId()),HJ("doc","path",e),n instanceof NM){const r=br.fromString(e,...t);return kD(r),new ki(n,null,new an(r))}{if(!(n instanceof ki||n instanceof Tg))throw new Ot(We.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(br.fromString(e,...t));return kD(r),new ki(n.firestore,n instanceof Tg?n.converter:null,new an(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gL="AsyncQueue";class yL{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new R4(this,"async_queue_retry"),this._c=()=>{const r=X1();r&&_t(gL,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=X1();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=X1();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Xu;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ly(e))throw e;_t(gL,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,fh("INTERNAL UNHANDLED ERROR: ",vL(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=BM.createAndSchedule(this,e,t,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&cn(47125,{Pc:vL(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function vL(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class U4 extends NM{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new yL,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new yL(e),this._firestoreClient=void 0,await e}}}function rQ(n,e){const t=typeof n=="object"?n:tM(),r=typeof n=="string"?n:e||xE,i=wh(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=m$("firestore");s&&tQ(i,...s)}return i}function iQ(n){if(n._terminated)throw new Ot(We.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||sQ(n),n._firestoreClient}function sQ(n){var r,i,s;const e=n._freezeSettings(),t=function(a,l,c,u){return new eY(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,k4(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)}(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new qq(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ho(Ca.fromBase64String(e))}catch(t){throw new Ot(We.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ho(Ca.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ho._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ay(e,Ho._jsonSchema))return Ho.fromBase64String(e.bytes)}}Ho._jsonSchemaVersion="firestore/bytes/1.0",Ho._jsonSchema={type:Nr("string",Ho._jsonSchemaVersion),bytes:Nr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FM{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ot(We.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ui(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ot(We.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ot(We.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Rn(this._lat,e._lat)||Rn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:pl._jsonSchemaVersion}}static fromJSON(e){if(ay(e,pl._jsonSchema))return new pl(e.latitude,e.longitude)}}pl._jsonSchemaVersion="firestore/geoPoint/1.0",pl._jsonSchema={type:Nr("string",pl._jsonSchemaVersion),latitude:Nr("number"),longitude:Nr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ml._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ay(e,ml._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new ml(e.vectorValues);throw new Ot(We.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ml._jsonSchemaVersion="firestore/vectorValue/1.0",ml._jsonSchema={type:Nr("string",ml._jsonSchemaVersion),vectorValues:Nr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oQ=/^__.*__$/;class aQ{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ch(e,this.data,this.fieldMask,t,this.fieldTransforms):new cy(e,this.data,t,this.fieldTransforms)}}function H4(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw cn(40011,{Ac:n})}}class UM{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new UM({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return IE(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(H4(this.Ac)&&oQ.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class lQ{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Mx(e)}Cc(e,t,r,i=!1){return new UM({Ac:e,methodName:t,Dc:r,path:ui.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function cQ(n){const e=n._freezeSettings(),t=Mx(n._databaseId);return new lQ(n._databaseId,!!e.ignoreUndefinedProperties,t)}function uQ(n,e,t,r,i,s={}){const o=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);$4("Data must be an object, but it was:",o,r);const a=G4(r,o);let l,c;if(s.merge)l=new Go(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const f of s.mergeFields){const p=hQ(e,f,t);if(!o.contains(p))throw new Ot(We.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);dQ(u,p)||u.push(p)}l=new Go(u),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new aQ(new zo(a),l,c)}function V4(n,e){if(W4(n=vi(n)))return $4("Unsupported field value:",e,n),G4(n,e);if(n instanceof z4)return function(r,i){if(!H4(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=V4(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=vi(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return SY(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=rr.fromDate(r);return{timestampValue:CT(i.serializer,s)}}if(r instanceof rr){const s=new rr(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:CT(i.serializer,s)}}if(r instanceof pl)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ho)return{bytesValue:kY(i.serializer,r._byteString)};if(r instanceof ki){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:S4(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ml)return function(o,a){return{mapValue:{fields:{[t4]:{stringValue:r4},[xT]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return IM(a.serializer,c)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${_M(r)}`)}(n,e)}function G4(n,e){const t={};return YU(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zd(n,(r,i)=>{const s=V4(i,e.mc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function W4(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof rr||n instanceof pl||n instanceof Ho||n instanceof ki||n instanceof z4||n instanceof ml)}function $4(n,e,t){if(!W4(t)||!KU(t)){const r=_M(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function hQ(n,e,t){if((e=vi(e))instanceof FM)return e._internalPath;if(typeof e=="string")return j4(n,e);throw IE("Field path arguments must be of type string or ",n,!1,void 0,t)}const fQ=new RegExp("[~\\*/\\[\\]]");function j4(n,e,t){if(e.search(fQ)>=0)throw IE(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new FM(...e.split("."))._internalPath}catch{throw IE(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function IE(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new Ot(We.INVALID_ARGUMENT,a+n+l)}function dQ(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ki(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new pQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(K4("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class pQ extends X4{data(){return super.data()}}function K4(n,e){return typeof e=="string"?j4(n,e):e instanceof FM?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mQ(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Kv{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ld extends X4{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new M_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(K4("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ot(We.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ld._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ld._jsonSchemaVersion="firestore/documentSnapshot/1.0",ld._jsonSchema={type:Nr("string",ld._jsonSchemaVersion),bundleSource:Nr("string","DocumentSnapshot"),bundleName:Nr("string"),bundle:Nr("string")};class M_ extends ld{data(e={}){return super.data(e)}}class $m{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Kv(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new M_(this._firestore,this._userDataWriter,r.key,r,new Kv(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ot(We.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new M_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Kv(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new M_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Kv(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:gQ(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ot(We.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=$m._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=vM.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function gQ(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return cn(61501,{type:n})}}$m._jsonSchemaVersion="firestore/querySnapshot/1.0",$m._jsonSchema={type:Nr("string",$m._jsonSchemaVersion),bundleSource:Nr("string","QuerySnapshot"),bundleName:Nr("string"),bundle:Nr("string")};function yQ(n,e,t){n=ET(n,ki);const r=ET(n.firestore,U4),i=mQ(n.converter,e,t);return vQ(r,[uQ(cQ(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,dl.none())])}function vQ(n,e){return function(r,i){const s=new Xu;return r.asyncQueue.enqueueAndForget(async()=>$q(await eQ(r),i,s)),s.promise}(iQ(n),e)}(function(e,t=!0){(function(i){Qd=i})(Yd),Ta(new Ko("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new U4(new LJ(r.getProvider("auth-internal")),new NJ(o,r.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ot(We.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new AE(c.options.projectId,u)}(o,i),o);return s={useFetchStreams:t,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),go(LD,OD,e),go(LD,OD,"esm2020")})();const _Q={apiKey:"AIzaSyCpitXOIAZKZ8udAE6UreUR7vN-czFs39M",authDomain:"healbot-36975.firebaseapp.com",projectId:"healbot-36975",storageBucket:"healbot-36975.firebasestorage.app",messagingSenderId:"676007096034",appId:"1:676007096034:web:b00240a300f1ef205638bb",measurementId:"G-M0JKZB5BC2"},zM=kF(_Q);cX(zM);const Jv=RJ(zM),EQ=rQ(zM),J4=ne.createContext();function Dx(){return D.useContext(J4)}function xQ({children:n}){const[e,t]=D.useState(),[r,i]=D.useState(!0);async function s(c,u,f,p){const m=await hK(Jv,c,u),y=m.user;await pK(y,{displayName:f});try{await yQ(nQ(EQ,"users",y.uid),{uid:y.uid,name:f,username:p,email:c,createdAt:new Date().toISOString()})}catch(A){console.error("Error writing user document: ",A)}return m}function o(c,u){return fK(Jv,c,u)}function a(){return vK(Jv)}D.useEffect(()=>yK(Jv,u=>{t(u),i(!1)}),[]);const l={currentUser:e,login:o,signup:s,logout:a};return Oe.jsx(J4.Provider,{value:l,children:!r&&n})}function AQ({children:n}){const{currentUser:e}=Dx();return e?n:Oe.jsx(TW,{to:"/login"})}function sr(){return sr=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},sr.apply(this,arguments)}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const ep="160",wQ={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},SQ={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Y4=0,PT=1,q4=2,TQ=3,Q4=0,Lx=1,jm=2,Bo=3,Ma=0,ns=1,Os=2,CQ=2,gl=0,Ju=1,DT=2,LT=3,OT=4,Z4=5,dc=100,ez=101,tz=102,BT=103,NT=104,nz=200,rz=201,iz=202,sz=203,PE=204,DE=205,oz=206,az=207,lz=208,cz=209,uz=210,hz=211,fz=212,dz=213,pz=214,mz=0,gz=1,yz=2,Cg=3,vz=4,_z=5,Ez=6,xz=7,dy=0,Az=1,wz=2,xa=0,Sz=1,Tz=2,Cz=3,HM=4,bz=5,Mz=6,kT="attached",Rz="detached",Ox=300,Ra=301,kc=302,bd=303,bg=304,tp=306,Fc=1e3,hi=1001,Md=1002,vr=1003,Mg=1004,bQ=1004,cd=1005,MQ=1005,Hn=1006,Bx=1007,RQ=1007,Ia=1008,IQ=1008,Aa=1009,Iz=1010,Pz=1011,Nx=1012,VM=1013,al=1014,fi=1015,Qi=1016,GM=1017,WM=1018,bc=1020,Dz=1021,Ni=1023,Lz=1024,Oz=1025,Mc=1026,mh=1027,$M=1028,jM=1029,Bz=1030,XM=1031,KM=1033,R_=33776,I_=33777,P_=33778,D_=33779,FT=35840,UT=35841,zT=35842,HT=35843,JM=36196,VT=37492,GT=37496,WT=37808,$T=37809,jT=37810,XT=37811,KT=37812,JT=37813,YT=37814,qT=37815,QT=37816,ZT=37817,eC=37818,tC=37819,nC=37820,rC=37821,L_=36492,iC=36494,sC=36495,Nz=36283,oC=36284,aC=36285,lC=36286,kz=2200,Fz=2201,Uz=2202,Rd=2300,gh=2301,O_=2302,Fu=2400,Uu=2401,Rg=2402,kx=2500,YM=2501,zz=0,qM=1,LE=2,QM=3e3,Rc=3001,Hz=3200,Vz=3201,Yc=0,Gz=1,Bs="",Hr="srgb",Pa="srgb-linear",Fx="display-p3",py="display-p3-linear",Ig="linear",Wn="srgb",Pg="rec709",Dg="p3",PQ=0,Iu=7680,DQ=7681,LQ=7682,OQ=7683,BQ=34055,NQ=34056,kQ=5386,FQ=512,UQ=513,zQ=514,HQ=515,VQ=516,GQ=517,WQ=518,cC=519,Wz=512,$z=513,jz=514,ZM=515,Xz=516,Kz=517,Jz=518,Yz=519,Lg=35044,$Q=35048,jQ=35040,XQ=35045,KQ=35049,JQ=35041,YQ=35046,qQ=35050,QQ=35042,ZQ="100",uC="300 es",OE=1035,Wo=2e3,Id=2001;let Dl=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}};const Ii=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _L=1234567;const Yu=Math.PI/180,Pd=180/Math.PI;function zs(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Ii[n&255]+Ii[n>>8&255]+Ii[n>>16&255]+Ii[n>>24&255]+"-"+Ii[e&255]+Ii[e>>8&255]+"-"+Ii[e>>16&15|64]+Ii[e>>24&255]+"-"+Ii[t&63|128]+Ii[t>>8&255]+"-"+Ii[t>>16&255]+Ii[t>>24&255]+Ii[r&255]+Ii[r>>8&255]+Ii[r>>16&255]+Ii[r>>24&255]).toLowerCase()}function _r(n,e,t){return Math.max(e,Math.min(t,n))}function eR(n,e){return(n%e+e)%e}function eZ(n,e,t,r,i){return r+(n-e)*(i-r)/(t-e)}function tZ(n,e,t){return n!==e?(t-n)/(e-n):0}function Xm(n,e,t){return(1-t)*n+t*e}function nZ(n,e,t,r){return Xm(n,e,1-Math.exp(-t*r))}function rZ(n,e=1){return e-Math.abs(eR(n,e*2)-e)}function iZ(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function sZ(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function oZ(n,e){return n+Math.floor(Math.random()*(e-n+1))}function aZ(n,e){return n+Math.random()*(e-n)}function lZ(n){return n*(.5-Math.random())}function cZ(n){n!==void 0&&(_L=n);let e=_L+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function uZ(n){return n*Yu}function hZ(n){return n*Pd}function hC(n){return(n&n-1)===0&&n!==0}function fZ(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function BE(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function dZ(n,e,t,r,i){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+r)/2),u=o((e+r)/2),f=s((e-r)/2),p=o((e-r)/2),m=s((r-e)/2),y=o((r-e)/2);switch(i){case"XYX":n.set(a*u,l*f,l*p,a*c);break;case"YZY":n.set(l*p,a*u,l*f,a*c);break;case"ZXZ":n.set(l*f,l*p,a*u,a*c);break;case"XZX":n.set(a*u,l*y,l*m,a*c);break;case"YXY":n.set(l*m,a*u,l*y,a*c);break;case"ZYZ":n.set(l*y,l*m,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function ms(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function tn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const Ux={DEG2RAD:Yu,RAD2DEG:Pd,generateUUID:zs,clamp:_r,euclideanModulo:eR,mapLinear:eZ,inverseLerp:tZ,lerp:Xm,damp:nZ,pingpong:rZ,smoothstep:iZ,smootherstep:sZ,randInt:oZ,randFloat:aZ,randFloatSpread:lZ,seededRandom:cZ,degToRad:uZ,radToDeg:hZ,isPowerOfTwo:hC,ceilPowerOfTwo:fZ,floorPowerOfTwo:BE,setQuaternionFromProperEuler:dZ,normalize:tn,denormalize:ms};class Be{constructor(e=0,t=0){Be.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(_r(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*r-o*i+e.x,this.y=s*i+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class on{constructor(e,t,r,i,s,o,a,l,c){on.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,o,a,l,c)}set(e,t,r,i,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=i,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=r,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[3],l=r[6],c=r[1],u=r[4],f=r[7],p=r[2],m=r[5],y=r[8],A=i[0],_=i[3],g=i[6],E=i[1],x=i[4],T=i[7],O=i[2],I=i[5],b=i[8];return s[0]=o*A+a*E+l*O,s[3]=o*_+a*x+l*I,s[6]=o*g+a*T+l*b,s[1]=c*A+u*E+f*O,s[4]=c*_+u*x+f*I,s[7]=c*g+u*T+f*b,s[2]=p*A+m*E+y*O,s[5]=p*_+m*x+y*I,s[8]=p*g+m*T+y*b,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-r*s*u+r*a*l+i*s*c-i*o*l}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],f=u*o-a*c,p=a*l-u*s,m=c*s-o*l,y=t*f+r*p+i*m;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const A=1/y;return e[0]=f*A,e[1]=(i*c-u*r)*A,e[2]=(a*r-i*o)*A,e[3]=p*A,e[4]=(u*t-i*l)*A,e[5]=(i*s-a*t)*A,e[6]=m*A,e[7]=(r*l-c*t)*A,e[8]=(o*t-r*s)*A,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(r*l,r*c,-r*(l*o+c*a)+o+e,-i*c,i*l,-i*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(J1.makeScale(e,t)),this}rotate(e){return this.premultiply(J1.makeRotation(-e)),this}translate(e,t){return this.premultiply(J1.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const J1=new on;function qz(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const pZ={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Wf(n,e){return new pZ[n](e)}function Og(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Qz(){const n=Og("canvas");return n.style.display="block",n}const EL={};function Km(n){n in EL||(EL[n]=!0,console.warn(n))}const xL=new on().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),AL=new on().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Yv={[Pa]:{transfer:Ig,primaries:Pg,toReference:n=>n,fromReference:n=>n},[Hr]:{transfer:Wn,primaries:Pg,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[py]:{transfer:Ig,primaries:Dg,toReference:n=>n.applyMatrix3(AL),fromReference:n=>n.applyMatrix3(xL)},[Fx]:{transfer:Wn,primaries:Dg,toReference:n=>n.convertSRGBToLinear().applyMatrix3(AL),fromReference:n=>n.applyMatrix3(xL).convertLinearToSRGB()}},mZ=new Set([Pa,py]),Pn={enabled:!0,_workingColorSpace:Pa,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!mZ.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const r=Yv[e].toReference,i=Yv[t].fromReference;return i(r(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return Yv[n].primaries},getTransfer:function(n){return n===Bs?Ig:Yv[n].transfer}};function ud(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Y1(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Yh;class tR{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Yh===void 0&&(Yh=Og("canvas")),Yh.width=e.width,Yh.height=e.height;const r=Yh.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Yh}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Og("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=ud(s[o]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(ud(t[r]/255)*255):t[r]=ud(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let gZ=0;class zu{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:gZ++}),this.uuid=zs(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?s.push(q1(i[o].image)):s.push(q1(i[o]))}else s=q1(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function q1(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?tR.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let yZ=0;class Qn extends Dl{constructor(e=Qn.DEFAULT_IMAGE,t=Qn.DEFAULT_MAPPING,r=hi,i=hi,s=Hn,o=Ia,a=Ni,l=Aa,c=Qn.DEFAULT_ANISOTROPY,u=Bs){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:yZ++}),this.uuid=zs(),this.name="",this.source=new zu(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Be(0,0),this.repeat=new Be(1,1),this.center=new Be(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new on,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof u=="string"?this.colorSpace=u:(Km("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===Rc?Hr:Bs),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Ox)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Fc:e.x=e.x-Math.floor(e.x);break;case hi:e.x=e.x<0?0:1;break;case Md:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Fc:e.y=e.y-Math.floor(e.y);break;case hi:e.y=e.y<0?0:1;break;case Md:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Km("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Hr?Rc:QM}set encoding(e){Km("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Rc?Hr:Bs}}Qn.DEFAULT_IMAGE=null;Qn.DEFAULT_MAPPING=Ox;Qn.DEFAULT_ANISOTROPY=1;class In{constructor(e=0,t=0,r=0,i=1){In.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*i+o[12]*s,this.y=o[1]*t+o[5]*r+o[9]*i+o[13]*s,this.z=o[2]*t+o[6]*r+o[10]*i+o[14]*s,this.w=o[3]*t+o[7]*r+o[11]*i+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const l=e.elements,c=l[0],u=l[4],f=l[8],p=l[1],m=l[5],y=l[9],A=l[2],_=l[6],g=l[10];if(Math.abs(u-p)<.01&&Math.abs(f-A)<.01&&Math.abs(y-_)<.01){if(Math.abs(u+p)<.1&&Math.abs(f+A)<.1&&Math.abs(y+_)<.1&&Math.abs(c+m+g-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const x=(c+1)/2,T=(m+1)/2,O=(g+1)/2,I=(u+p)/4,b=(f+A)/4,R=(y+_)/4;return x>T&&x>O?x<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(x),i=I/r,s=b/r):T>O?T<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(T),r=I/i,s=R/i):O<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(O),r=b/s,i=R/s),this.set(r,i,s,t),this}let E=Math.sqrt((_-y)*(_-y)+(f-A)*(f-A)+(p-u)*(p-u));return Math.abs(E)<.001&&(E=1),this.x=(_-y)/E,this.y=(f-A)/E,this.z=(p-u)/E,this.w=Math.acos((c+m+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Zz extends Dl{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new In(0,0,e,t),this.scissorTest=!1,this.viewport=new In(0,0,e,t);const i={width:e,height:t,depth:1};r.encoding!==void 0&&(Km("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===Rc?Hr:Bs),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Hn,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},r),this.texture=new Qn(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps,this.texture.internalFormat=r.internalFormat,this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new zu(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Yo extends Zz{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class zx extends Qn{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=vr,this.minFilter=vr,this.wrapR=hi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class vZ extends Yo{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new zx(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class nR extends Qn{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=vr,this.minFilter=vr,this.wrapR=hi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class _Z extends Yo{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new nR(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class EZ extends Yo{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<r;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,s=this.texture.length;i<s;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class mi{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,o,a){let l=r[i+0],c=r[i+1],u=r[i+2],f=r[i+3];const p=s[o+0],m=s[o+1],y=s[o+2],A=s[o+3];if(a===0){e[t+0]=l,e[t+1]=c,e[t+2]=u,e[t+3]=f;return}if(a===1){e[t+0]=p,e[t+1]=m,e[t+2]=y,e[t+3]=A;return}if(f!==A||l!==p||c!==m||u!==y){let _=1-a;const g=l*p+c*m+u*y+f*A,E=g>=0?1:-1,x=1-g*g;if(x>Number.EPSILON){const O=Math.sqrt(x),I=Math.atan2(O,g*E);_=Math.sin(_*I)/O,a=Math.sin(a*I)/O}const T=a*E;if(l=l*_+p*T,c=c*_+m*T,u=u*_+y*T,f=f*_+A*T,_===1-a){const O=1/Math.sqrt(l*l+c*c+u*u+f*f);l*=O,c*=O,u*=O,f*=O}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=f}static multiplyQuaternionsFlat(e,t,r,i,s,o){const a=r[i],l=r[i+1],c=r[i+2],u=r[i+3],f=s[o],p=s[o+1],m=s[o+2],y=s[o+3];return e[t]=a*y+u*f+l*m-c*p,e[t+1]=l*y+u*p+c*f-a*m,e[t+2]=c*y+u*m+a*p-l*f,e[t+3]=u*y-a*f-l*p-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(r/2),u=a(i/2),f=a(s/2),p=l(r/2),m=l(i/2),y=l(s/2);switch(o){case"XYZ":this._x=p*u*f+c*m*y,this._y=c*m*f-p*u*y,this._z=c*u*y+p*m*f,this._w=c*u*f-p*m*y;break;case"YXZ":this._x=p*u*f+c*m*y,this._y=c*m*f-p*u*y,this._z=c*u*y-p*m*f,this._w=c*u*f+p*m*y;break;case"ZXY":this._x=p*u*f-c*m*y,this._y=c*m*f+p*u*y,this._z=c*u*y+p*m*f,this._w=c*u*f-p*m*y;break;case"ZYX":this._x=p*u*f-c*m*y,this._y=c*m*f+p*u*y,this._z=c*u*y-p*m*f,this._w=c*u*f+p*m*y;break;case"YZX":this._x=p*u*f+c*m*y,this._y=c*m*f+p*u*y,this._z=c*u*y-p*m*f,this._w=c*u*f-p*m*y;break;case"XZY":this._x=p*u*f-c*m*y,this._y=c*m*f-p*u*y,this._z=c*u*y+p*m*f,this._w=c*u*f+p*m*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],f=t[10],p=r+a+f;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(u-l)*m,this._y=(s-c)*m,this._z=(o-i)*m}else if(r>a&&r>f){const m=2*Math.sqrt(1+r-a-f);this._w=(u-l)/m,this._x=.25*m,this._y=(i+o)/m,this._z=(s+c)/m}else if(a>f){const m=2*Math.sqrt(1+a-r-f);this._w=(s-c)/m,this._x=(i+o)/m,this._y=.25*m,this._z=(l+u)/m}else{const m=2*Math.sqrt(1+f-r-a);this._w=(o-i)/m,this._x=(s+c)/m,this._y=(l+u)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(_r(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=r*u+o*a+i*c-s*l,this._y=i*u+o*l+s*a-r*c,this._z=s*u+o*c+r*l-i*a,this._w=o*u-r*a-i*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+r*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-t;return this._w=m*o+t*this._w,this._x=m*r+t*this._x,this._y=m*i+t*this._y,this._z=m*s+t*this._z,this.normalize(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),f=Math.sin((1-t)*u)/c,p=Math.sin(t*u)/c;return this._w=o*f+this._w*p,this._x=r*f+this._x*p,this._y=i*f+this._y*p,this._z=s*f+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(s),r*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class J{constructor(e=0,t=0,r=0){J.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(wL.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(wL.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,o=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*i-a*r),u=2*(a*t-s*i),f=2*(s*r-o*t);return this.x=t+l*c+o*f-a*u,this.y=r+l*u+a*c-s*f,this.z=i+l*f+s*u-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=i*l-s*a,this.y=s*o-r*l,this.z=r*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return Q1.copy(this).projectOnVector(e),this.sub(Q1)}reflect(e){return this.sub(Q1.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(_r(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Q1=new J,wL=new mi;class gi{constructor(e=new J(1/0,1/0,1/0),t=new J(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(Ro.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(Ro.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Ro.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Ro):Ro.fromBufferAttribute(s,o),Ro.applyMatrix4(e.matrixWorld),this.expandByPoint(Ro);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),qv.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),qv.copy(r.boundingBox)),qv.applyMatrix4(e.matrixWorld),this.union(qv)}const i=e.children;for(let s=0,o=i.length;s<o;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ro),Ro.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(qp),Qv.subVectors(this.max,qp),qh.subVectors(e.a,qp),Qh.subVectors(e.b,qp),Zh.subVectors(e.c,qp),jl.subVectors(Qh,qh),Xl.subVectors(Zh,Qh),pu.subVectors(qh,Zh);let t=[0,-jl.z,jl.y,0,-Xl.z,Xl.y,0,-pu.z,pu.y,jl.z,0,-jl.x,Xl.z,0,-Xl.x,pu.z,0,-pu.x,-jl.y,jl.x,0,-Xl.y,Xl.x,0,-pu.y,pu.x,0];return!Z1(t,qh,Qh,Zh,Qv)||(t=[1,0,0,0,1,0,0,0,1],!Z1(t,qh,Qh,Zh,Qv))?!1:(Zv.crossVectors(jl,Xl),t=[Zv.x,Zv.y,Zv.z],Z1(t,qh,Qh,Zh,Qv))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ro).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ro).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:($a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),$a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),$a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),$a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),$a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),$a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),$a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),$a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints($a),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const $a=[new J,new J,new J,new J,new J,new J,new J,new J],Ro=new J,qv=new gi,qh=new J,Qh=new J,Zh=new J,jl=new J,Xl=new J,pu=new J,qp=new J,Qv=new J,Zv=new J,mu=new J;function Z1(n,e,t,r,i){for(let s=0,o=n.length-3;s<=o;s+=3){mu.fromArray(n,s);const a=i.x*Math.abs(mu.x)+i.y*Math.abs(mu.y)+i.z*Math.abs(mu.z),l=e.dot(mu),c=t.dot(mu),u=r.dot(mu);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const xZ=new gi,Qp=new J,ew=new J;class ni{constructor(e=new J,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):xZ.setFromPoints(e).getCenter(r);let i=0;for(let s=0,o=e.length;s<o;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Qp.subVectors(e,this.center);const t=Qp.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(Qp,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(ew.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Qp.copy(e.center).add(ew)),this.expandByPoint(Qp.copy(e.center).sub(ew))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const ja=new J,tw=new J,e0=new J,Kl=new J,nw=new J,t0=new J,rw=new J;class np{constructor(e=new J,t=new J(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ja)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ja.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ja.copy(this.origin).addScaledVector(this.direction,t),ja.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){tw.copy(e).add(t).multiplyScalar(.5),e0.copy(t).sub(e).normalize(),Kl.copy(this.origin).sub(tw);const s=e.distanceTo(t)*.5,o=-this.direction.dot(e0),a=Kl.dot(this.direction),l=-Kl.dot(e0),c=Kl.lengthSq(),u=Math.abs(1-o*o);let f,p,m,y;if(u>0)if(f=o*l-a,p=o*a-l,y=s*u,f>=0)if(p>=-y)if(p<=y){const A=1/u;f*=A,p*=A,m=f*(f+o*p+2*a)+p*(o*f+p+2*l)+c}else p=s,f=Math.max(0,-(o*p+a)),m=-f*f+p*(p+2*l)+c;else p=-s,f=Math.max(0,-(o*p+a)),m=-f*f+p*(p+2*l)+c;else p<=-y?(f=Math.max(0,-(-o*s+a)),p=f>0?-s:Math.min(Math.max(-s,-l),s),m=-f*f+p*(p+2*l)+c):p<=y?(f=0,p=Math.min(Math.max(-s,-l),s),m=p*(p+2*l)+c):(f=Math.max(0,-(o*s+a)),p=f>0?s:Math.min(Math.max(-s,-l),s),m=-f*f+p*(p+2*l)+c);else p=o>0?-s:s,f=Math.max(0,-(o*p+a)),m=-f*f+p*(p+2*l)+c;return r&&r.copy(this.origin).addScaledVector(this.direction,f),i&&i.copy(tw).addScaledVector(e0,p),m}intersectSphere(e,t){ja.subVectors(e.center,this.origin);const r=ja.dot(this.direction),i=ja.dot(ja)-r*r,s=e.radius*e.radius;if(i>s)return null;const o=Math.sqrt(s-i),a=r-o,l=r+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,f=1/this.direction.z,p=this.origin;return c>=0?(r=(e.min.x-p.x)*c,i=(e.max.x-p.x)*c):(r=(e.max.x-p.x)*c,i=(e.min.x-p.x)*c),u>=0?(s=(e.min.y-p.y)*u,o=(e.max.y-p.y)*u):(s=(e.max.y-p.y)*u,o=(e.min.y-p.y)*u),r>o||s>i||((s>r||isNaN(r))&&(r=s),(o<i||isNaN(i))&&(i=o),f>=0?(a=(e.min.z-p.z)*f,l=(e.max.z-p.z)*f):(a=(e.max.z-p.z)*f,l=(e.min.z-p.z)*f),r>l||a>i)||((a>r||r!==r)&&(r=a),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,ja)!==null}intersectTriangle(e,t,r,i,s){nw.subVectors(t,e),t0.subVectors(r,e),rw.crossVectors(nw,t0);let o=this.direction.dot(rw),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Kl.subVectors(this.origin,e);const l=a*this.direction.dot(t0.crossVectors(Kl,t0));if(l<0)return null;const c=a*this.direction.dot(nw.cross(Kl));if(c<0||l+c>o)return null;const u=-a*Kl.dot(rw);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Bt{constructor(e,t,r,i,s,o,a,l,c,u,f,p,m,y,A,_){Bt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,o,a,l,c,u,f,p,m,y,A,_)}set(e,t,r,i,s,o,a,l,c,u,f,p,m,y,A,_){const g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=i,g[1]=s,g[5]=o,g[9]=a,g[13]=l,g[2]=c,g[6]=u,g[10]=f,g[14]=p,g[3]=m,g[7]=y,g[11]=A,g[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Bt().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/ef.setFromMatrixColumn(e,0).length(),s=1/ef.setFromMatrixColumn(e,1).length(),o=1/ef.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),l=Math.cos(i),c=Math.sin(i),u=Math.cos(s),f=Math.sin(s);if(e.order==="XYZ"){const p=o*u,m=o*f,y=a*u,A=a*f;t[0]=l*u,t[4]=-l*f,t[8]=c,t[1]=m+y*c,t[5]=p-A*c,t[9]=-a*l,t[2]=A-p*c,t[6]=y+m*c,t[10]=o*l}else if(e.order==="YXZ"){const p=l*u,m=l*f,y=c*u,A=c*f;t[0]=p+A*a,t[4]=y*a-m,t[8]=o*c,t[1]=o*f,t[5]=o*u,t[9]=-a,t[2]=m*a-y,t[6]=A+p*a,t[10]=o*l}else if(e.order==="ZXY"){const p=l*u,m=l*f,y=c*u,A=c*f;t[0]=p-A*a,t[4]=-o*f,t[8]=y+m*a,t[1]=m+y*a,t[5]=o*u,t[9]=A-p*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const p=o*u,m=o*f,y=a*u,A=a*f;t[0]=l*u,t[4]=y*c-m,t[8]=p*c+A,t[1]=l*f,t[5]=A*c+p,t[9]=m*c-y,t[2]=-c,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const p=o*l,m=o*c,y=a*l,A=a*c;t[0]=l*u,t[4]=A-p*f,t[8]=y*f+m,t[1]=f,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=m*f+y,t[10]=p-A*f}else if(e.order==="XZY"){const p=o*l,m=o*c,y=a*l,A=a*c;t[0]=l*u,t[4]=-f,t[8]=c*u,t[1]=p*f+A,t[5]=o*u,t[9]=m*f-y,t[2]=y*f-m,t[6]=a*u,t[10]=A*f+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(AZ,e,wZ)}lookAt(e,t,r){const i=this.elements;return Rs.subVectors(e,t),Rs.lengthSq()===0&&(Rs.z=1),Rs.normalize(),Jl.crossVectors(r,Rs),Jl.lengthSq()===0&&(Math.abs(r.z)===1?Rs.x+=1e-4:Rs.z+=1e-4,Rs.normalize(),Jl.crossVectors(r,Rs)),Jl.normalize(),n0.crossVectors(Rs,Jl),i[0]=Jl.x,i[4]=n0.x,i[8]=Rs.x,i[1]=Jl.y,i[5]=n0.y,i[9]=Rs.y,i[2]=Jl.z,i[6]=n0.z,i[10]=Rs.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[4],l=r[8],c=r[12],u=r[1],f=r[5],p=r[9],m=r[13],y=r[2],A=r[6],_=r[10],g=r[14],E=r[3],x=r[7],T=r[11],O=r[15],I=i[0],b=i[4],R=i[8],C=i[12],M=i[1],B=i[5],F=i[9],z=i[13],j=i[2],Y=i[6],oe=i[10],le=i[14],X=i[3],ee=i[7],ie=i[11],fe=i[15];return s[0]=o*I+a*M+l*j+c*X,s[4]=o*b+a*B+l*Y+c*ee,s[8]=o*R+a*F+l*oe+c*ie,s[12]=o*C+a*z+l*le+c*fe,s[1]=u*I+f*M+p*j+m*X,s[5]=u*b+f*B+p*Y+m*ee,s[9]=u*R+f*F+p*oe+m*ie,s[13]=u*C+f*z+p*le+m*fe,s[2]=y*I+A*M+_*j+g*X,s[6]=y*b+A*B+_*Y+g*ee,s[10]=y*R+A*F+_*oe+g*ie,s[14]=y*C+A*z+_*le+g*fe,s[3]=E*I+x*M+T*j+O*X,s[7]=E*b+x*B+T*Y+O*ee,s[11]=E*R+x*F+T*oe+O*ie,s[15]=E*C+x*z+T*le+O*fe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],f=e[6],p=e[10],m=e[14],y=e[3],A=e[7],_=e[11],g=e[15];return y*(+s*l*f-i*c*f-s*a*p+r*c*p+i*a*m-r*l*m)+A*(+t*l*m-t*c*p+s*o*p-i*o*m+i*c*u-s*l*u)+_*(+t*c*f-t*a*m-s*o*f+r*o*m+s*a*u-r*c*u)+g*(-i*a*u-t*l*f+t*a*p+i*o*f-r*o*p+r*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],f=e[9],p=e[10],m=e[11],y=e[12],A=e[13],_=e[14],g=e[15],E=f*_*c-A*p*c+A*l*m-a*_*m-f*l*g+a*p*g,x=y*p*c-u*_*c-y*l*m+o*_*m+u*l*g-o*p*g,T=u*A*c-y*f*c+y*a*m-o*A*m-u*a*g+o*f*g,O=y*f*l-u*A*l-y*a*p+o*A*p+u*a*_-o*f*_,I=t*E+r*x+i*T+s*O;if(I===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const b=1/I;return e[0]=E*b,e[1]=(A*p*s-f*_*s-A*i*m+r*_*m+f*i*g-r*p*g)*b,e[2]=(a*_*s-A*l*s+A*i*c-r*_*c-a*i*g+r*l*g)*b,e[3]=(f*l*s-a*p*s-f*i*c+r*p*c+a*i*m-r*l*m)*b,e[4]=x*b,e[5]=(u*_*s-y*p*s+y*i*m-t*_*m-u*i*g+t*p*g)*b,e[6]=(y*l*s-o*_*s-y*i*c+t*_*c+o*i*g-t*l*g)*b,e[7]=(o*p*s-u*l*s+u*i*c-t*p*c-o*i*m+t*l*m)*b,e[8]=T*b,e[9]=(y*f*s-u*A*s-y*r*m+t*A*m+u*r*g-t*f*g)*b,e[10]=(o*A*s-y*a*s+y*r*c-t*A*c-o*r*g+t*a*g)*b,e[11]=(u*a*s-o*f*s-u*r*c+t*f*c+o*r*m-t*a*m)*b,e[12]=O*b,e[13]=(u*A*i-y*f*i+y*r*p-t*A*p-u*r*_+t*f*_)*b,e[14]=(y*a*i-o*A*i-y*r*l+t*A*l+o*r*_-t*a*_)*b,e[15]=(o*f*i-u*a*i+u*r*l-t*f*l-o*r*p+t*a*p)*b,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+r,c*a-i*l,c*l+i*a,0,c*a+i*l,u*a+r,u*l-i*o,0,c*l-i*a,u*l+i*o,s*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,o){return this.set(1,r,s,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,f=a+a,p=s*c,m=s*u,y=s*f,A=o*u,_=o*f,g=a*f,E=l*c,x=l*u,T=l*f,O=r.x,I=r.y,b=r.z;return i[0]=(1-(A+g))*O,i[1]=(m+T)*O,i[2]=(y-x)*O,i[3]=0,i[4]=(m-T)*I,i[5]=(1-(p+g))*I,i[6]=(_+E)*I,i[7]=0,i[8]=(y+x)*b,i[9]=(_-E)*b,i[10]=(1-(p+A))*b,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=ef.set(i[0],i[1],i[2]).length();const o=ef.set(i[4],i[5],i[6]).length(),a=ef.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],Io.copy(this);const c=1/s,u=1/o,f=1/a;return Io.elements[0]*=c,Io.elements[1]*=c,Io.elements[2]*=c,Io.elements[4]*=u,Io.elements[5]*=u,Io.elements[6]*=u,Io.elements[8]*=f,Io.elements[9]*=f,Io.elements[10]*=f,t.setFromRotationMatrix(Io),r.x=s,r.y=o,r.z=a,this}makePerspective(e,t,r,i,s,o,a=Wo){const l=this.elements,c=2*s/(t-e),u=2*s/(r-i),f=(t+e)/(t-e),p=(r+i)/(r-i);let m,y;if(a===Wo)m=-(o+s)/(o-s),y=-2*o*s/(o-s);else if(a===Id)m=-o/(o-s),y=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=u,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=y,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,r,i,s,o,a=Wo){const l=this.elements,c=1/(t-e),u=1/(r-i),f=1/(o-s),p=(t+e)*c,m=(r+i)*u;let y,A;if(a===Wo)y=(o+s)*f,A=-2*f;else if(a===Id)y=s*f,A=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=A,l[14]=-y,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const ef=new J,Io=new Bt,AZ=new J(0,0,0),wZ=new J(1,1,1),Jl=new J,n0=new J,Rs=new J,SL=new Bt,TL=new mi;class my{constructor(e=0,t=0,r=0,i=my.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],l=i[1],c=i[5],u=i[9],f=i[2],p=i[6],m=i[10];switch(t){case"XYZ":this._y=Math.asin(_r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(p,c),this._z=0);break;case"YXZ":this._x=Math.asin(-_r(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(_r(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-f,m),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-_r(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(p,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(_r(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-_r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return SL.makeRotationFromQuaternion(e),this.setFromRotationMatrix(SL,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return TL.setFromEuler(this),this.setFromQuaternion(TL,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}my.DEFAULT_ORDER="XYZ";class qu{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let SZ=0;const CL=new J,tf=new mi,Xa=new Bt,r0=new J,Zp=new J,TZ=new J,CZ=new mi,bL=new J(1,0,0),ML=new J(0,1,0),RL=new J(0,0,1),bZ={type:"added"},MZ={type:"removed"};class dn extends Dl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:SZ++}),this.uuid=zs(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=dn.DEFAULT_UP.clone();const e=new J,t=new my,r=new mi,i=new J(1,1,1);function s(){r.setFromEuler(t,!1)}function o(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Bt},normalMatrix:{value:new on}}),this.matrix=new Bt,this.matrixWorld=new Bt,this.matrixAutoUpdate=dn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=dn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new qu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return tf.setFromAxisAngle(e,t),this.quaternion.multiply(tf),this}rotateOnWorldAxis(e,t){return tf.setFromAxisAngle(e,t),this.quaternion.premultiply(tf),this}rotateX(e){return this.rotateOnAxis(bL,e)}rotateY(e){return this.rotateOnAxis(ML,e)}rotateZ(e){return this.rotateOnAxis(RL,e)}translateOnAxis(e,t){return CL.copy(e).applyQuaternion(this.quaternion),this.position.add(CL.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(bL,e)}translateY(e){return this.translateOnAxis(ML,e)}translateZ(e){return this.translateOnAxis(RL,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Xa.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?r0.copy(e):r0.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),Zp.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Xa.lookAt(Zp,r0,this.up):Xa.lookAt(r0,Zp,this.up),this.quaternion.setFromRotationMatrix(Xa),i&&(Xa.extractRotation(i.matrixWorld),tf.setFromRotationMatrix(Xa),this.quaternion.premultiply(tf.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(bZ)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(MZ)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Xa.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Xa.multiply(e.parent.matrixWorld)),e.applyMatrix4(Xa),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const o=this.children[r].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Zp,e,TZ),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Zp,CZ,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++){const s=t[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++){const a=i[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const f=l[c];s(e.shapes,f)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));i.material=a}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];i.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),f=o(e.shapes),p=o(e.skeletons),m=o(e.animations),y=o(e.nodes);a.length>0&&(r.geometries=a),l.length>0&&(r.materials=l),c.length>0&&(r.textures=c),u.length>0&&(r.images=u),f.length>0&&(r.shapes=f),p.length>0&&(r.skeletons=p),m.length>0&&(r.animations=m),y.length>0&&(r.nodes=y)}return r.object=i,r;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}dn.DEFAULT_UP=new J(0,1,0);dn.DEFAULT_MATRIX_AUTO_UPDATE=!0;dn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Po=new J,Ka=new J,iw=new J,Ja=new J,nf=new J,rf=new J,IL=new J,sw=new J,ow=new J,aw=new J;let i0=!1;class ps{constructor(e=new J,t=new J,r=new J){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),Po.subVectors(e,t),i.cross(Po);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){Po.subVectors(i,t),Ka.subVectors(r,t),iw.subVectors(e,t);const o=Po.dot(Po),a=Po.dot(Ka),l=Po.dot(iw),c=Ka.dot(Ka),u=Ka.dot(iw),f=o*c-a*a;if(f===0)return s.set(0,0,0),null;const p=1/f,m=(c*l-a*u)*p,y=(o*u-a*l)*p;return s.set(1-m-y,y,m)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,Ja)===null?!1:Ja.x>=0&&Ja.y>=0&&Ja.x+Ja.y<=1}static getUV(e,t,r,i,s,o,a,l){return i0===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),i0=!0),this.getInterpolation(e,t,r,i,s,o,a,l)}static getInterpolation(e,t,r,i,s,o,a,l){return this.getBarycoord(e,t,r,i,Ja)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,Ja.x),l.addScaledVector(o,Ja.y),l.addScaledVector(a,Ja.z),l)}static isFrontFacing(e,t,r,i){return Po.subVectors(r,t),Ka.subVectors(e,t),Po.cross(Ka).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Po.subVectors(this.c,this.b),Ka.subVectors(this.a,this.b),Po.cross(Ka).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ps.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ps.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,s){return i0===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),i0=!0),ps.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}getInterpolation(e,t,r,i,s){return ps.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return ps.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ps.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let o,a;nf.subVectors(i,r),rf.subVectors(s,r),sw.subVectors(e,r);const l=nf.dot(sw),c=rf.dot(sw);if(l<=0&&c<=0)return t.copy(r);ow.subVectors(e,i);const u=nf.dot(ow),f=rf.dot(ow);if(u>=0&&f<=u)return t.copy(i);const p=l*f-u*c;if(p<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(r).addScaledVector(nf,o);aw.subVectors(e,s);const m=nf.dot(aw),y=rf.dot(aw);if(y>=0&&m<=y)return t.copy(s);const A=m*c-l*y;if(A<=0&&c>=0&&y<=0)return a=c/(c-y),t.copy(r).addScaledVector(rf,a);const _=u*y-m*f;if(_<=0&&f-u>=0&&m-y>=0)return IL.subVectors(s,i),a=(f-u)/(f-u+(m-y)),t.copy(i).addScaledVector(IL,a);const g=1/(_+A+p);return o=A*g,a=p*g,t.copy(r).addScaledVector(nf,o).addScaledVector(rf,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const eH={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Yl={h:0,s:0,l:0},s0={h:0,s:0,l:0};function lw(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}let st=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Hr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Pn.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=Pn.workingColorSpace){return this.r=e,this.g=t,this.b=r,Pn.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=Pn.workingColorSpace){if(e=eR(e,1),t=_r(t,0,1),r=_r(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,o=2*r-s;this.r=lw(o,s,e+1/3),this.g=lw(o,s,e),this.b=lw(o,s,e-1/3)}return Pn.toWorkingColorSpace(this,i),this}setStyle(e,t=Hr){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Hr){const r=eH[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ud(e.r),this.g=ud(e.g),this.b=ud(e.b),this}copyLinearToSRGB(e){return this.r=Y1(e.r),this.g=Y1(e.g),this.b=Y1(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Hr){return Pn.fromWorkingColorSpace(Pi.copy(this),e),Math.round(_r(Pi.r*255,0,255))*65536+Math.round(_r(Pi.g*255,0,255))*256+Math.round(_r(Pi.b*255,0,255))}getHexString(e=Hr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Pn.workingColorSpace){Pn.fromWorkingColorSpace(Pi.copy(this),t);const r=Pi.r,i=Pi.g,s=Pi.b,o=Math.max(r,i,s),a=Math.min(r,i,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const f=o-a;switch(c=u<=.5?f/(o+a):f/(2-o-a),o){case r:l=(i-s)/f+(i<s?6:0);break;case i:l=(s-r)/f+2;break;case s:l=(r-i)/f+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=Pn.workingColorSpace){return Pn.fromWorkingColorSpace(Pi.copy(this),t),e.r=Pi.r,e.g=Pi.g,e.b=Pi.b,e}getStyle(e=Hr){Pn.fromWorkingColorSpace(Pi.copy(this),e);const t=Pi.r,r=Pi.g,i=Pi.b;return e!==Hr?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(Yl),this.setHSL(Yl.h+e,Yl.s+t,Yl.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Yl),e.getHSL(s0);const r=Xm(Yl.h,s0.h,t),i=Xm(Yl.s,s0.s,t),s=Xm(Yl.l,s0.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Pi=new st;st.NAMES=eH;let RZ=0;class kr extends Dl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:RZ++}),this.uuid=zs(),this.name="",this.type="Material",this.blending=Ju,this.side=Ma,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=PE,this.blendDst=DE,this.blendEquation=dc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new st(0,0,0),this.blendAlpha=0,this.depthFunc=Cg,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=cC,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Iu,this.stencilZFail=Iu,this.stencilZPass=Iu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Ju&&(r.blending=this.blending),this.side!==Ma&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==PE&&(r.blendSrc=this.blendSrc),this.blendDst!==DE&&(r.blendDst=this.blendDst),this.blendEquation!==dc&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==Cg&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==cC&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Iu&&(r.stencilFail=this.stencilFail),this.stencilZFail!==Iu&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==Iu&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=i(e.textures),o=i(e.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class ks extends kr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new st(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=dy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const tl=IZ();function IZ(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(r[l]=0,r[l|256]=32768,i[l]=24,i[l|256]=24):c<-14?(r[l]=1024>>-c-14,r[l|256]=1024>>-c-14|32768,i[l]=-c-1,i[l|256]=-c-1):c<=15?(r[l]=c+15<<10,r[l|256]=c+15<<10|32768,i[l]=13,i[l|256]=13):c<128?(r[l]=31744,r[l|256]=64512,i[l]=24,i[l|256]=24):(r[l]=31744,r[l|256]=64512,i[l]=13,i[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;!(c&8388608);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:o,offsetTable:a}}function us(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=_r(n,-65504,65504),tl.floatView[0]=n;const e=tl.uint32View[0],t=e>>23&511;return tl.baseTable[t]+((e&8388607)>>tl.shiftTable[t])}function Mm(n){const e=n>>10;return tl.uint32View[0]=tl.mantissaTable[tl.offsetTable[e]+(n&1023)]+tl.exponentTable[e],tl.floatView[0]}const Hu={toHalfFloat:us,fromHalfFloat:Mm},Lr=new J,o0=new Be;class _n{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=Lg,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=fi,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)o0.fromBufferAttribute(this,t),o0.applyMatrix3(e),this.setXY(t,o0.x,o0.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Lr.fromBufferAttribute(this,t),Lr.applyMatrix3(e),this.setXYZ(t,Lr.x,Lr.y,Lr.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Lr.fromBufferAttribute(this,t),Lr.applyMatrix4(e),this.setXYZ(t,Lr.x,Lr.y,Lr.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Lr.fromBufferAttribute(this,t),Lr.applyNormalMatrix(e),this.setXYZ(t,Lr.x,Lr.y,Lr.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Lr.fromBufferAttribute(this,t),Lr.transformDirection(e),this.setXYZ(t,Lr.x,Lr.y,Lr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=ms(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=tn(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ms(t,this.array)),t}setX(e,t){return this.normalized&&(t=tn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ms(t,this.array)),t}setY(e,t){return this.normalized&&(t=tn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ms(t,this.array)),t}setZ(e,t){return this.normalized&&(t=tn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ms(t,this.array)),t}setW(e,t){return this.normalized&&(t=tn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=tn(t,this.array),r=tn(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=tn(t,this.array),r=tn(r,this.array),i=tn(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=tn(t,this.array),r=tn(r,this.array),i=tn(i,this.array),s=tn(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Lg&&(e.usage=this.usage),e}}class PZ extends _n{constructor(e,t,r){super(new Int8Array(e),t,r)}}class DZ extends _n{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class LZ extends _n{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class OZ extends _n{constructor(e,t,r){super(new Int16Array(e),t,r)}}class rR extends _n{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class BZ extends _n{constructor(e,t,r){super(new Int32Array(e),t,r)}}class iR extends _n{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class NZ extends _n{constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}getX(e){let t=Mm(this.array[e*this.itemSize]);return this.normalized&&(t=ms(t,this.array)),t}setX(e,t){return this.normalized&&(t=tn(t,this.array)),this.array[e*this.itemSize]=us(t),this}getY(e){let t=Mm(this.array[e*this.itemSize+1]);return this.normalized&&(t=ms(t,this.array)),t}setY(e,t){return this.normalized&&(t=tn(t,this.array)),this.array[e*this.itemSize+1]=us(t),this}getZ(e){let t=Mm(this.array[e*this.itemSize+2]);return this.normalized&&(t=ms(t,this.array)),t}setZ(e,t){return this.normalized&&(t=tn(t,this.array)),this.array[e*this.itemSize+2]=us(t),this}getW(e){let t=Mm(this.array[e*this.itemSize+3]);return this.normalized&&(t=ms(t,this.array)),t}setW(e,t){return this.normalized&&(t=tn(t,this.array)),this.array[e*this.itemSize+3]=us(t),this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=tn(t,this.array),r=tn(r,this.array)),this.array[e+0]=us(t),this.array[e+1]=us(r),this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=tn(t,this.array),r=tn(r,this.array),i=tn(i,this.array)),this.array[e+0]=us(t),this.array[e+1]=us(r),this.array[e+2]=us(i),this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=tn(t,this.array),r=tn(r,this.array),i=tn(i,this.array),s=tn(s,this.array)),this.array[e+0]=us(t),this.array[e+1]=us(r),this.array[e+2]=us(i),this.array[e+3]=us(s),this}}class Et extends _n{constructor(e,t,r){super(new Float32Array(e),t,r)}}class kZ extends _n{constructor(e,t,r){super(new Float64Array(e),t,r)}}let FZ=0;const io=new Bt,cw=new dn,sf=new J,Is=new gi,em=new gi,Yr=new J;class Jt extends Dl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:FZ++}),this.uuid=zs(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(qz(e)?iR:rR)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new on().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return io.makeRotationFromQuaternion(e),this.applyMatrix4(io),this}rotateX(e){return io.makeRotationX(e),this.applyMatrix4(io),this}rotateY(e){return io.makeRotationY(e),this.applyMatrix4(io),this}rotateZ(e){return io.makeRotationZ(e),this.applyMatrix4(io),this}translate(e,t,r){return io.makeTranslation(e,t,r),this.applyMatrix4(io),this}scale(e,t,r){return io.makeScale(e,t,r),this.applyMatrix4(io),this}lookAt(e){return cw.lookAt(e),cw.updateMatrix(),this.applyMatrix4(cw.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(sf).negate(),this.translate(sf.x,sf.y,sf.z),this}setFromPoints(e){const t=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Et(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new J(-1/0,-1/0,-1/0),new J(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];Is.setFromBufferAttribute(s),this.morphTargetsRelative?(Yr.addVectors(this.boundingBox.min,Is.min),this.boundingBox.expandByPoint(Yr),Yr.addVectors(this.boundingBox.max,Is.max),this.boundingBox.expandByPoint(Yr)):(this.boundingBox.expandByPoint(Is.min),this.boundingBox.expandByPoint(Is.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ni);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new J,1/0);return}if(e){const r=this.boundingSphere.center;if(Is.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];em.setFromBufferAttribute(a),this.morphTargetsRelative?(Yr.addVectors(Is.min,em.min),Is.expandByPoint(Yr),Yr.addVectors(Is.max,em.max),Is.expandByPoint(Yr)):(Is.expandByPoint(em.min),Is.expandByPoint(em.max))}Is.getCenter(r);let i=0;for(let s=0,o=e.count;s<o;s++)Yr.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(Yr));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)Yr.fromBufferAttribute(a,c),l&&(sf.fromBufferAttribute(e,c),Yr.add(sf)),i=Math.max(i,r.distanceToSquared(Yr))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,i=t.position.array,s=t.normal.array,o=t.uv.array,a=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new _n(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let M=0;M<a;M++)c[M]=new J,u[M]=new J;const f=new J,p=new J,m=new J,y=new Be,A=new Be,_=new Be,g=new J,E=new J;function x(M,B,F){f.fromArray(i,M*3),p.fromArray(i,B*3),m.fromArray(i,F*3),y.fromArray(o,M*2),A.fromArray(o,B*2),_.fromArray(o,F*2),p.sub(f),m.sub(f),A.sub(y),_.sub(y);const z=1/(A.x*_.y-_.x*A.y);isFinite(z)&&(g.copy(p).multiplyScalar(_.y).addScaledVector(m,-A.y).multiplyScalar(z),E.copy(m).multiplyScalar(A.x).addScaledVector(p,-_.x).multiplyScalar(z),c[M].add(g),c[B].add(g),c[F].add(g),u[M].add(E),u[B].add(E),u[F].add(E))}let T=this.groups;T.length===0&&(T=[{start:0,count:r.length}]);for(let M=0,B=T.length;M<B;++M){const F=T[M],z=F.start,j=F.count;for(let Y=z,oe=z+j;Y<oe;Y+=3)x(r[Y+0],r[Y+1],r[Y+2])}const O=new J,I=new J,b=new J,R=new J;function C(M){b.fromArray(s,M*3),R.copy(b);const B=c[M];O.copy(B),O.sub(b.multiplyScalar(b.dot(B))).normalize(),I.crossVectors(R,B);const z=I.dot(u[M])<0?-1:1;l[M*4]=O.x,l[M*4+1]=O.y,l[M*4+2]=O.z,l[M*4+3]=z}for(let M=0,B=T.length;M<B;++M){const F=T[M],z=F.start,j=F.count;for(let Y=z,oe=z+j;Y<oe;Y+=3)C(r[Y+0]),C(r[Y+1]),C(r[Y+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new _n(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let p=0,m=r.count;p<m;p++)r.setXYZ(p,0,0,0);const i=new J,s=new J,o=new J,a=new J,l=new J,c=new J,u=new J,f=new J;if(e)for(let p=0,m=e.count;p<m;p+=3){const y=e.getX(p+0),A=e.getX(p+1),_=e.getX(p+2);i.fromBufferAttribute(t,y),s.fromBufferAttribute(t,A),o.fromBufferAttribute(t,_),u.subVectors(o,s),f.subVectors(i,s),u.cross(f),a.fromBufferAttribute(r,y),l.fromBufferAttribute(r,A),c.fromBufferAttribute(r,_),a.add(u),l.add(u),c.add(u),r.setXYZ(y,a.x,a.y,a.z),r.setXYZ(A,l.x,l.y,l.z),r.setXYZ(_,c.x,c.y,c.z)}else for(let p=0,m=t.count;p<m;p+=3)i.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),u.subVectors(o,s),f.subVectors(i,s),u.cross(f),r.setXYZ(p+0,u.x,u.y,u.z),r.setXYZ(p+1,u.x,u.y,u.z),r.setXYZ(p+2,u.x,u.y,u.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Yr.fromBufferAttribute(e,t),Yr.normalize(),e.setXYZ(t,Yr.x,Yr.y,Yr.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,f=a.normalized,p=new c.constructor(l.length*u);let m=0,y=0;for(let A=0,_=l.length;A<_;A++){a.isInterleavedBufferAttribute?m=l[A]*a.data.stride+a.offset:m=l[A]*u;for(let g=0;g<u;g++)p[y++]=c[m++]}return new _n(p,u,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Jt,r=this.index.array,i=this.attributes;for(const a in i){const l=i[a],c=e(l,r);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,f=c.length;u<f;u++){const p=c[u],m=e(p,r);l.push(m)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const l in r){const c=r[l];e.data.attributes[l]=c.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let f=0,p=c.length;f<p;f++){const m=c[f];u.push(m.toJSON(e.data))}u.length>0&&(i[l]=u,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const i=e.attributes;for(const c in i){const u=i[c];this.setAttribute(c,u.clone(t))}const s=e.morphAttributes;for(const c in s){const u=[],f=s[c];for(let p=0,m=f.length;p<m;p++)u.push(f[p].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const f=o[c];this.addGroup(f.start,f.count,f.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const PL=new Bt,gu=new np,a0=new ni,DL=new J,of=new J,af=new J,lf=new J,uw=new J,l0=new J,c0=new Be,u0=new Be,h0=new Be,LL=new J,OL=new J,BL=new J,f0=new J,d0=new J;class Rr extends dn{constructor(e=new Jt,t=new ks){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,o=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const a=this.morphTargetInfluences;if(s&&a){l0.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l],f=s[l];u!==0&&(uw.fromBufferAttribute(f,e),o?l0.addScaledVector(uw,u):l0.addScaledVector(uw.sub(t),u))}t.add(l0)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),a0.copy(r.boundingSphere),a0.applyMatrix4(s),gu.copy(e.ray).recast(e.near),!(a0.containsPoint(gu.origin)===!1&&(gu.intersectSphere(a0,DL)===null||gu.origin.distanceToSquared(DL)>(e.far-e.near)**2))&&(PL.copy(s).invert(),gu.copy(e.ray).applyMatrix4(PL),!(r.boundingBox!==null&&gu.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,gu)))}_computeIntersections(e,t,r){let i;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,f=s.attributes.normal,p=s.groups,m=s.drawRange;if(a!==null)if(Array.isArray(o))for(let y=0,A=p.length;y<A;y++){const _=p[y],g=o[_.materialIndex],E=Math.max(_.start,m.start),x=Math.min(a.count,Math.min(_.start+_.count,m.start+m.count));for(let T=E,O=x;T<O;T+=3){const I=a.getX(T),b=a.getX(T+1),R=a.getX(T+2);i=p0(this,g,e,r,c,u,f,I,b,R),i&&(i.faceIndex=Math.floor(T/3),i.face.materialIndex=_.materialIndex,t.push(i))}}else{const y=Math.max(0,m.start),A=Math.min(a.count,m.start+m.count);for(let _=y,g=A;_<g;_+=3){const E=a.getX(_),x=a.getX(_+1),T=a.getX(_+2);i=p0(this,o,e,r,c,u,f,E,x,T),i&&(i.faceIndex=Math.floor(_/3),t.push(i))}}else if(l!==void 0)if(Array.isArray(o))for(let y=0,A=p.length;y<A;y++){const _=p[y],g=o[_.materialIndex],E=Math.max(_.start,m.start),x=Math.min(l.count,Math.min(_.start+_.count,m.start+m.count));for(let T=E,O=x;T<O;T+=3){const I=T,b=T+1,R=T+2;i=p0(this,g,e,r,c,u,f,I,b,R),i&&(i.faceIndex=Math.floor(T/3),i.face.materialIndex=_.materialIndex,t.push(i))}}else{const y=Math.max(0,m.start),A=Math.min(l.count,m.start+m.count);for(let _=y,g=A;_<g;_+=3){const E=_,x=_+1,T=_+2;i=p0(this,o,e,r,c,u,f,E,x,T),i&&(i.faceIndex=Math.floor(_/3),t.push(i))}}}}function UZ(n,e,t,r,i,s,o,a){let l;if(e.side===ns?l=r.intersectTriangle(o,s,i,!0,a):l=r.intersectTriangle(i,s,o,e.side===Ma,a),l===null)return null;d0.copy(a),d0.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(d0);return c<t.near||c>t.far?null:{distance:c,point:d0.clone(),object:n}}function p0(n,e,t,r,i,s,o,a,l,c){n.getVertexPosition(a,of),n.getVertexPosition(l,af),n.getVertexPosition(c,lf);const u=UZ(n,e,t,r,of,af,lf,f0);if(u){i&&(c0.fromBufferAttribute(i,a),u0.fromBufferAttribute(i,l),h0.fromBufferAttribute(i,c),u.uv=ps.getInterpolation(f0,of,af,lf,c0,u0,h0,new Be)),s&&(c0.fromBufferAttribute(s,a),u0.fromBufferAttribute(s,l),h0.fromBufferAttribute(s,c),u.uv1=ps.getInterpolation(f0,of,af,lf,c0,u0,h0,new Be),u.uv2=u.uv1),o&&(LL.fromBufferAttribute(o,a),OL.fromBufferAttribute(o,l),BL.fromBufferAttribute(o,c),u.normal=ps.getInterpolation(f0,of,af,lf,LL,OL,BL,new J),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const f={a,b:l,c,normal:new J,materialIndex:0};ps.getNormal(of,af,lf,f.normal),u.face=f}return u}class bh extends Jt{constructor(e=1,t=1,r=1,i=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:o};const a=this;i=Math.floor(i),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],f=[];let p=0,m=0;y("z","y","x",-1,-1,r,t,e,o,s,0),y("z","y","x",1,-1,r,t,-e,o,s,1),y("x","z","y",1,1,e,r,t,i,o,2),y("x","z","y",1,-1,e,r,-t,i,o,3),y("x","y","z",1,-1,e,t,r,i,s,4),y("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(l),this.setAttribute("position",new Et(c,3)),this.setAttribute("normal",new Et(u,3)),this.setAttribute("uv",new Et(f,2));function y(A,_,g,E,x,T,O,I,b,R,C){const M=T/b,B=O/R,F=T/2,z=O/2,j=I/2,Y=b+1,oe=R+1;let le=0,X=0;const ee=new J;for(let ie=0;ie<oe;ie++){const fe=ie*B-z;for(let me=0;me<Y;me++){const he=me*M-F;ee[A]=he*E,ee[_]=fe*x,ee[g]=j,c.push(ee.x,ee.y,ee.z),ee[A]=0,ee[_]=0,ee[g]=I>0?1:-1,u.push(ee.x,ee.y,ee.z),f.push(me/b),f.push(1-ie/R),le+=1}}for(let ie=0;ie<R;ie++)for(let fe=0;fe<b;fe++){const me=p+fe+Y*ie,he=p+fe+Y*(ie+1),Ae=p+(fe+1)+Y*(ie+1),De=p+(fe+1)+Y*ie;l.push(me,he,De),l.push(he,Ae,De),X+=6}a.addGroup(m,X,C),m+=X,p+=le}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bh(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Dd(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function Ji(n){const e={};for(let t=0;t<n.length;t++){const r=Dd(n[t]);for(const i in r)e[i]=r[i]}return e}function zZ(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function tH(n){return n.getRenderTarget()===null?n.outputColorSpace:Pn.workingColorSpace}const nH={clone:Dd,merge:Ji};var HZ=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,VZ=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class qo extends kr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=HZ,this.fragmentShader=VZ,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Dd(e.uniforms),this.uniformsGroups=zZ(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class gy extends dn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Bt,this.projectionMatrix=new Bt,this.projectionMatrixInverse=new Bt,this.coordinateSystem=Wo}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Mr extends gy{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Pd*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Yu*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Pd*2*Math.atan(Math.tan(Yu*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Yu*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*i/l,t-=o.offsetY*r/c,i*=o.width/l,r*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const cf=-90,uf=1;class rH extends dn{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Mr(cf,uf,e,t);i.layers=this.layers,this.add(i);const s=new Mr(cf,uf,e,t);s.layers=this.layers,this.add(s);const o=new Mr(cf,uf,e,t);o.layers=this.layers,this.add(o);const a=new Mr(cf,uf,e,t);a.layers=this.layers,this.add(a);const l=new Mr(cf,uf,e,t);l.layers=this.layers,this.add(l);const c=new Mr(cf,uf,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===Wo)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Id)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,u]=this.children,f=e.getRenderTarget(),p=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),y=e.xr.enabled;e.xr.enabled=!1;const A=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,o),e.setRenderTarget(r,2,i),e.render(t,a),e.setRenderTarget(r,3,i),e.render(t,l),e.setRenderTarget(r,4,i),e.render(t,c),r.texture.generateMipmaps=A,e.setRenderTarget(r,5,i),e.render(t,u),e.setRenderTarget(f,p,m),e.xr.enabled=y,r.texture.needsPMREMUpdate=!0}}class yy extends Qn{constructor(e,t,r,i,s,o,a,l,c,u){e=e!==void 0?e:[],t=t!==void 0?t:Ra,super(e,t,r,i,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class sR extends Yo{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];t.encoding!==void 0&&(Km("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Rc?Hr:Bs),this.texture=new yy(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Hn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new bh(5,5,5),s=new qo({name:"CubemapFromEquirect",uniforms:Dd(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:ns,blending:gl});s.uniforms.tEquirect.value=t;const o=new Rr(i,s),a=t.minFilter;return t.minFilter===Ia&&(t.minFilter=Hn),new rH(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,r,i){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,r,i);e.setRenderTarget(s)}}const hw=new J,GZ=new J,WZ=new on;class sc{constructor(e=new J(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=hw.subVectors(r,t).cross(GZ.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(hw),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||WZ.getNormalMatrix(e),i=this.coplanarPoint(hw).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const yu=new ni,m0=new J;class vy{constructor(e=new sc,t=new sc,r=new sc,i=new sc,s=new sc,o=new sc){this.planes=[e,t,r,i,s,o]}set(e,t,r,i,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(i),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=Wo){const r=this.planes,i=e.elements,s=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],f=i[6],p=i[7],m=i[8],y=i[9],A=i[10],_=i[11],g=i[12],E=i[13],x=i[14],T=i[15];if(r[0].setComponents(l-s,p-c,_-m,T-g).normalize(),r[1].setComponents(l+s,p+c,_+m,T+g).normalize(),r[2].setComponents(l+o,p+u,_+y,T+E).normalize(),r[3].setComponents(l-o,p-u,_-y,T-E).normalize(),r[4].setComponents(l-a,p-f,_-A,T-x).normalize(),t===Wo)r[5].setComponents(l+a,p+f,_+A,T+x).normalize();else if(t===Id)r[5].setComponents(a,f,A,x).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),yu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),yu.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(yu)}intersectsSprite(e){return yu.center.set(0,0,0),yu.radius=.7071067811865476,yu.applyMatrix4(e.matrixWorld),this.intersectsSphere(yu)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(m0.x=i.normal.x>0?e.max.x:e.min.x,m0.y=i.normal.y>0?e.max.y:e.min.y,m0.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(m0)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function iH(){let n=null,e=!1,t=null,r=null;function i(s,o){t(s,o),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function $Z(n,e){const t=e.isWebGL2,r=new WeakMap;function i(c,u){const f=c.array,p=c.usage,m=f.byteLength,y=n.createBuffer();n.bindBuffer(u,y),n.bufferData(u,f,p),c.onUploadCallback();let A;if(f instanceof Float32Array)A=n.FLOAT;else if(f instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(t)A=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else A=n.UNSIGNED_SHORT;else if(f instanceof Int16Array)A=n.SHORT;else if(f instanceof Uint32Array)A=n.UNSIGNED_INT;else if(f instanceof Int32Array)A=n.INT;else if(f instanceof Int8Array)A=n.BYTE;else if(f instanceof Uint8Array)A=n.UNSIGNED_BYTE;else if(f instanceof Uint8ClampedArray)A=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);return{buffer:y,type:A,bytesPerElement:f.BYTES_PER_ELEMENT,version:c.version,size:m}}function s(c,u,f){const p=u.array,m=u._updateRange,y=u.updateRanges;if(n.bindBuffer(f,c),m.count===-1&&y.length===0&&n.bufferSubData(f,0,p),y.length!==0){for(let A=0,_=y.length;A<_;A++){const g=y[A];t?n.bufferSubData(f,g.start*p.BYTES_PER_ELEMENT,p,g.start,g.count):n.bufferSubData(f,g.start*p.BYTES_PER_ELEMENT,p.subarray(g.start,g.start+g.count))}u.clearUpdateRanges()}m.count!==-1&&(t?n.bufferSubData(f,m.offset*p.BYTES_PER_ELEMENT,p,m.offset,m.count):n.bufferSubData(f,m.offset*p.BYTES_PER_ELEMENT,p.subarray(m.offset,m.offset+m.count)),m.count=-1),u.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),r.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=r.get(c);u&&(n.deleteBuffer(u.buffer),r.delete(c))}function l(c,u){if(c.isGLBufferAttribute){const p=r.get(c);(!p||p.version<c.version)&&r.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const f=r.get(c);if(f===void 0)r.set(c,i(c,u));else if(f.version<c.version){if(f.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(f.buffer,c,u),f.version=c.version}}return{get:o,remove:a,update:l}}class _y extends Jt{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,o=t/2,a=Math.floor(r),l=Math.floor(i),c=a+1,u=l+1,f=e/a,p=t/l,m=[],y=[],A=[],_=[];for(let g=0;g<u;g++){const E=g*p-o;for(let x=0;x<c;x++){const T=x*f-s;y.push(T,-E,0),A.push(0,0,1),_.push(x/a),_.push(1-g/l)}}for(let g=0;g<l;g++)for(let E=0;E<a;E++){const x=E+c*g,T=E+c*(g+1),O=E+1+c*(g+1),I=E+1+c*g;m.push(x,T,I),m.push(T,O,I)}this.setIndex(m),this.setAttribute("position",new Et(y,3)),this.setAttribute("normal",new Et(A,3)),this.setAttribute("uv",new Et(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _y(e.width,e.height,e.widthSegments,e.heightSegments)}}var jZ=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,XZ=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,KZ=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,JZ=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,YZ=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,qZ=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,QZ=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,ZZ=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,eee=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,tee=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,nee=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,ree=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,iee=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,see=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,oee=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,aee=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,lee=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,cee=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,uee=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,hee=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,fee=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,dee=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,pee=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,mee=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,gee=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,yee=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,vee=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,_ee=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Eee=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,xee=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Aee="gl_FragColor = linearToOutputTexel( gl_FragColor );",wee=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,See=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Tee=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Cee=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,bee=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Mee=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Ree=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Iee=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Pee=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Dee=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Lee=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Oee=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Bee=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Nee=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,kee=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Fee=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Uee=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,zee=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Hee=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Vee=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Gee=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Wee=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,$ee=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,jee=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Xee=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Kee=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Jee=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Yee=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,qee=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Qee=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Zee=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,ete=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,tte=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,nte=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,rte=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,ite=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,ste=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,ote=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,ate=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,lte=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,cte=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,ute=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,hte=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,fte=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,dte=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,pte=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,mte=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,gte=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,yte=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,vte=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,_te=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Ete=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,xte=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Ate=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,wte=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Ste=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Tte=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Cte=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,bte=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Mte=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Rte=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Ite=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Pte=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Dte=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Lte=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Ote=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Bte=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Nte=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,kte=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Fte=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color *= toneMappingExposure;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Ute=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,zte=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Hte=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Vte=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Gte=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Wte=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const $te=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,jte=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Xte=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Kte=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Jte=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Yte=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,qte=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Qte=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Zte=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,ene=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,tne=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,nne=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,rne=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ine=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,sne=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,one=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ane=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,lne=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,cne=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,une=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,hne=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fne=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,dne=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,pne=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mne=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,gne=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yne=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vne=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_ne=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Ene=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,xne=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ane=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,wne=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Sne=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,en={alphahash_fragment:jZ,alphahash_pars_fragment:XZ,alphamap_fragment:KZ,alphamap_pars_fragment:JZ,alphatest_fragment:YZ,alphatest_pars_fragment:qZ,aomap_fragment:QZ,aomap_pars_fragment:ZZ,batching_pars_vertex:eee,batching_vertex:tee,begin_vertex:nee,beginnormal_vertex:ree,bsdfs:iee,iridescence_fragment:see,bumpmap_pars_fragment:oee,clipping_planes_fragment:aee,clipping_planes_pars_fragment:lee,clipping_planes_pars_vertex:cee,clipping_planes_vertex:uee,color_fragment:hee,color_pars_fragment:fee,color_pars_vertex:dee,color_vertex:pee,common:mee,cube_uv_reflection_fragment:gee,defaultnormal_vertex:yee,displacementmap_pars_vertex:vee,displacementmap_vertex:_ee,emissivemap_fragment:Eee,emissivemap_pars_fragment:xee,colorspace_fragment:Aee,colorspace_pars_fragment:wee,envmap_fragment:See,envmap_common_pars_fragment:Tee,envmap_pars_fragment:Cee,envmap_pars_vertex:bee,envmap_physical_pars_fragment:Uee,envmap_vertex:Mee,fog_vertex:Ree,fog_pars_vertex:Iee,fog_fragment:Pee,fog_pars_fragment:Dee,gradientmap_pars_fragment:Lee,lightmap_fragment:Oee,lightmap_pars_fragment:Bee,lights_lambert_fragment:Nee,lights_lambert_pars_fragment:kee,lights_pars_begin:Fee,lights_toon_fragment:zee,lights_toon_pars_fragment:Hee,lights_phong_fragment:Vee,lights_phong_pars_fragment:Gee,lights_physical_fragment:Wee,lights_physical_pars_fragment:$ee,lights_fragment_begin:jee,lights_fragment_maps:Xee,lights_fragment_end:Kee,logdepthbuf_fragment:Jee,logdepthbuf_pars_fragment:Yee,logdepthbuf_pars_vertex:qee,logdepthbuf_vertex:Qee,map_fragment:Zee,map_pars_fragment:ete,map_particle_fragment:tte,map_particle_pars_fragment:nte,metalnessmap_fragment:rte,metalnessmap_pars_fragment:ite,morphcolor_vertex:ste,morphnormal_vertex:ote,morphtarget_pars_vertex:ate,morphtarget_vertex:lte,normal_fragment_begin:cte,normal_fragment_maps:ute,normal_pars_fragment:hte,normal_pars_vertex:fte,normal_vertex:dte,normalmap_pars_fragment:pte,clearcoat_normal_fragment_begin:mte,clearcoat_normal_fragment_maps:gte,clearcoat_pars_fragment:yte,iridescence_pars_fragment:vte,opaque_fragment:_te,packing:Ete,premultiplied_alpha_fragment:xte,project_vertex:Ate,dithering_fragment:wte,dithering_pars_fragment:Ste,roughnessmap_fragment:Tte,roughnessmap_pars_fragment:Cte,shadowmap_pars_fragment:bte,shadowmap_pars_vertex:Mte,shadowmap_vertex:Rte,shadowmask_pars_fragment:Ite,skinbase_vertex:Pte,skinning_pars_vertex:Dte,skinning_vertex:Lte,skinnormal_vertex:Ote,specularmap_fragment:Bte,specularmap_pars_fragment:Nte,tonemapping_fragment:kte,tonemapping_pars_fragment:Fte,transmission_fragment:Ute,transmission_pars_fragment:zte,uv_pars_fragment:Hte,uv_pars_vertex:Vte,uv_vertex:Gte,worldpos_vertex:Wte,background_vert:$te,background_frag:jte,backgroundCube_vert:Xte,backgroundCube_frag:Kte,cube_vert:Jte,cube_frag:Yte,depth_vert:qte,depth_frag:Qte,distanceRGBA_vert:Zte,distanceRGBA_frag:ene,equirect_vert:tne,equirect_frag:nne,linedashed_vert:rne,linedashed_frag:ine,meshbasic_vert:sne,meshbasic_frag:one,meshlambert_vert:ane,meshlambert_frag:lne,meshmatcap_vert:cne,meshmatcap_frag:une,meshnormal_vert:hne,meshnormal_frag:fne,meshphong_vert:dne,meshphong_frag:pne,meshphysical_vert:mne,meshphysical_frag:gne,meshtoon_vert:yne,meshtoon_frag:vne,points_vert:_ne,points_frag:Ene,shadow_vert:xne,shadow_frag:Ane,sprite_vert:wne,sprite_frag:Sne},nt={common:{diffuse:{value:new st(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new on},alphaMap:{value:null},alphaMapTransform:{value:new on},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new on}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new on}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new on}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new on},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new on},normalScale:{value:new Be(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new on},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new on}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new on}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new on}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new st(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new st(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new on},alphaTest:{value:0},uvTransform:{value:new on}},sprite:{diffuse:{value:new st(16777215)},opacity:{value:1},center:{value:new Be(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new on},alphaMap:{value:null},alphaMapTransform:{value:new on},alphaTest:{value:0}}},Uo={basic:{uniforms:Ji([nt.common,nt.specularmap,nt.envmap,nt.aomap,nt.lightmap,nt.fog]),vertexShader:en.meshbasic_vert,fragmentShader:en.meshbasic_frag},lambert:{uniforms:Ji([nt.common,nt.specularmap,nt.envmap,nt.aomap,nt.lightmap,nt.emissivemap,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.fog,nt.lights,{emissive:{value:new st(0)}}]),vertexShader:en.meshlambert_vert,fragmentShader:en.meshlambert_frag},phong:{uniforms:Ji([nt.common,nt.specularmap,nt.envmap,nt.aomap,nt.lightmap,nt.emissivemap,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.fog,nt.lights,{emissive:{value:new st(0)},specular:{value:new st(1118481)},shininess:{value:30}}]),vertexShader:en.meshphong_vert,fragmentShader:en.meshphong_frag},standard:{uniforms:Ji([nt.common,nt.envmap,nt.aomap,nt.lightmap,nt.emissivemap,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.roughnessmap,nt.metalnessmap,nt.fog,nt.lights,{emissive:{value:new st(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:en.meshphysical_vert,fragmentShader:en.meshphysical_frag},toon:{uniforms:Ji([nt.common,nt.aomap,nt.lightmap,nt.emissivemap,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.gradientmap,nt.fog,nt.lights,{emissive:{value:new st(0)}}]),vertexShader:en.meshtoon_vert,fragmentShader:en.meshtoon_frag},matcap:{uniforms:Ji([nt.common,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.fog,{matcap:{value:null}}]),vertexShader:en.meshmatcap_vert,fragmentShader:en.meshmatcap_frag},points:{uniforms:Ji([nt.points,nt.fog]),vertexShader:en.points_vert,fragmentShader:en.points_frag},dashed:{uniforms:Ji([nt.common,nt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:en.linedashed_vert,fragmentShader:en.linedashed_frag},depth:{uniforms:Ji([nt.common,nt.displacementmap]),vertexShader:en.depth_vert,fragmentShader:en.depth_frag},normal:{uniforms:Ji([nt.common,nt.bumpmap,nt.normalmap,nt.displacementmap,{opacity:{value:1}}]),vertexShader:en.meshnormal_vert,fragmentShader:en.meshnormal_frag},sprite:{uniforms:Ji([nt.sprite,nt.fog]),vertexShader:en.sprite_vert,fragmentShader:en.sprite_frag},background:{uniforms:{uvTransform:{value:new on},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:en.background_vert,fragmentShader:en.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:en.backgroundCube_vert,fragmentShader:en.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:en.cube_vert,fragmentShader:en.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:en.equirect_vert,fragmentShader:en.equirect_frag},distanceRGBA:{uniforms:Ji([nt.common,nt.displacementmap,{referencePosition:{value:new J},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:en.distanceRGBA_vert,fragmentShader:en.distanceRGBA_frag},shadow:{uniforms:Ji([nt.lights,nt.fog,{color:{value:new st(0)},opacity:{value:1}}]),vertexShader:en.shadow_vert,fragmentShader:en.shadow_frag}};Uo.physical={uniforms:Ji([Uo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new on},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new on},clearcoatNormalScale:{value:new Be(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new on},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new on},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new on},sheen:{value:0},sheenColor:{value:new st(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new on},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new on},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new on},transmissionSamplerSize:{value:new Be},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new on},attenuationDistance:{value:0},attenuationColor:{value:new st(0)},specularColor:{value:new st(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new on},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new on},anisotropyVector:{value:new Be},anisotropyMap:{value:null},anisotropyMapTransform:{value:new on}}]),vertexShader:en.meshphysical_vert,fragmentShader:en.meshphysical_frag};const g0={r:0,b:0,g:0};function Tne(n,e,t,r,i,s,o){const a=new st(0);let l=s===!0?0:1,c,u,f=null,p=0,m=null;function y(_,g){let E=!1,x=g.isScene===!0?g.background:null;x&&x.isTexture&&(x=(g.backgroundBlurriness>0?t:e).get(x)),x===null?A(a,l):x&&x.isColor&&(A(x,1),E=!0);const T=n.xr.getEnvironmentBlendMode();T==="additive"?r.buffers.color.setClear(0,0,0,1,o):T==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,o),(n.autoClear||E)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),x&&(x.isCubeTexture||x.mapping===tp)?(u===void 0&&(u=new Rr(new bh(1,1,1),new qo({name:"BackgroundCubeMaterial",uniforms:Dd(Uo.backgroundCube.uniforms),vertexShader:Uo.backgroundCube.vertexShader,fragmentShader:Uo.backgroundCube.fragmentShader,side:ns,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(O,I,b){this.matrixWorld.copyPosition(b.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),u.material.uniforms.envMap.value=x,u.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=g.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,u.material.toneMapped=Pn.getTransfer(x.colorSpace)!==Wn,(f!==x||p!==x.version||m!==n.toneMapping)&&(u.material.needsUpdate=!0,f=x,p=x.version,m=n.toneMapping),u.layers.enableAll(),_.unshift(u,u.geometry,u.material,0,0,null)):x&&x.isTexture&&(c===void 0&&(c=new Rr(new _y(2,2),new qo({name:"BackgroundMaterial",uniforms:Dd(Uo.background.uniforms),vertexShader:Uo.background.vertexShader,fragmentShader:Uo.background.fragmentShader,side:Ma,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=x,c.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,c.material.toneMapped=Pn.getTransfer(x.colorSpace)!==Wn,x.matrixAutoUpdate===!0&&x.updateMatrix(),c.material.uniforms.uvTransform.value.copy(x.matrix),(f!==x||p!==x.version||m!==n.toneMapping)&&(c.material.needsUpdate=!0,f=x,p=x.version,m=n.toneMapping),c.layers.enableAll(),_.unshift(c,c.geometry,c.material,0,0,null))}function A(_,g){_.getRGB(g0,tH(n)),r.buffers.color.setClear(g0.r,g0.g,g0.b,g,o)}return{getClearColor:function(){return a},setClearColor:function(_,g=1){a.set(_),l=g,A(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(_){l=_,A(a,l)},render:y}}function Cne(n,e,t,r){const i=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||s!==null,a={},l=_(null);let c=l,u=!1;function f(j,Y,oe,le,X){let ee=!1;if(o){const ie=A(le,oe,Y);c!==ie&&(c=ie,m(c.object)),ee=g(j,le,oe,X),ee&&E(j,le,oe,X)}else{const ie=Y.wireframe===!0;(c.geometry!==le.id||c.program!==oe.id||c.wireframe!==ie)&&(c.geometry=le.id,c.program=oe.id,c.wireframe=ie,ee=!0)}X!==null&&t.update(X,n.ELEMENT_ARRAY_BUFFER),(ee||u)&&(u=!1,R(j,Y,oe,le),X!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(X).buffer))}function p(){return r.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function m(j){return r.isWebGL2?n.bindVertexArray(j):s.bindVertexArrayOES(j)}function y(j){return r.isWebGL2?n.deleteVertexArray(j):s.deleteVertexArrayOES(j)}function A(j,Y,oe){const le=oe.wireframe===!0;let X=a[j.id];X===void 0&&(X={},a[j.id]=X);let ee=X[Y.id];ee===void 0&&(ee={},X[Y.id]=ee);let ie=ee[le];return ie===void 0&&(ie=_(p()),ee[le]=ie),ie}function _(j){const Y=[],oe=[],le=[];for(let X=0;X<i;X++)Y[X]=0,oe[X]=0,le[X]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Y,enabledAttributes:oe,attributeDivisors:le,object:j,attributes:{},index:null}}function g(j,Y,oe,le){const X=c.attributes,ee=Y.attributes;let ie=0;const fe=oe.getAttributes();for(const me in fe)if(fe[me].location>=0){const Ae=X[me];let De=ee[me];if(De===void 0&&(me==="instanceMatrix"&&j.instanceMatrix&&(De=j.instanceMatrix),me==="instanceColor"&&j.instanceColor&&(De=j.instanceColor)),Ae===void 0||Ae.attribute!==De||De&&Ae.data!==De.data)return!0;ie++}return c.attributesNum!==ie||c.index!==le}function E(j,Y,oe,le){const X={},ee=Y.attributes;let ie=0;const fe=oe.getAttributes();for(const me in fe)if(fe[me].location>=0){let Ae=ee[me];Ae===void 0&&(me==="instanceMatrix"&&j.instanceMatrix&&(Ae=j.instanceMatrix),me==="instanceColor"&&j.instanceColor&&(Ae=j.instanceColor));const De={};De.attribute=Ae,Ae&&Ae.data&&(De.data=Ae.data),X[me]=De,ie++}c.attributes=X,c.attributesNum=ie,c.index=le}function x(){const j=c.newAttributes;for(let Y=0,oe=j.length;Y<oe;Y++)j[Y]=0}function T(j){O(j,0)}function O(j,Y){const oe=c.newAttributes,le=c.enabledAttributes,X=c.attributeDivisors;oe[j]=1,le[j]===0&&(n.enableVertexAttribArray(j),le[j]=1),X[j]!==Y&&((r.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](j,Y),X[j]=Y)}function I(){const j=c.newAttributes,Y=c.enabledAttributes;for(let oe=0,le=Y.length;oe<le;oe++)Y[oe]!==j[oe]&&(n.disableVertexAttribArray(oe),Y[oe]=0)}function b(j,Y,oe,le,X,ee,ie){ie===!0?n.vertexAttribIPointer(j,Y,oe,X,ee):n.vertexAttribPointer(j,Y,oe,le,X,ee)}function R(j,Y,oe,le){if(r.isWebGL2===!1&&(j.isInstancedMesh||le.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;x();const X=le.attributes,ee=oe.getAttributes(),ie=Y.defaultAttributeValues;for(const fe in ee){const me=ee[fe];if(me.location>=0){let he=X[fe];if(he===void 0&&(fe==="instanceMatrix"&&j.instanceMatrix&&(he=j.instanceMatrix),fe==="instanceColor"&&j.instanceColor&&(he=j.instanceColor)),he!==void 0){const Ae=he.normalized,De=he.itemSize,Ie=t.get(he);if(Ie===void 0)continue;const He=Ie.buffer,rt=Ie.type,vt=Ie.bytesPerElement,Qe=r.isWebGL2===!0&&(rt===n.INT||rt===n.UNSIGNED_INT||he.gpuType===VM);if(he.isInterleavedBufferAttribute){const Xe=he.data,te=Xe.stride,Le=he.offset;if(Xe.isInstancedInterleavedBuffer){for(let be=0;be<me.locationSize;be++)O(me.location+be,Xe.meshPerAttribute);j.isInstancedMesh!==!0&&le._maxInstanceCount===void 0&&(le._maxInstanceCount=Xe.meshPerAttribute*Xe.count)}else for(let be=0;be<me.locationSize;be++)T(me.location+be);n.bindBuffer(n.ARRAY_BUFFER,He);for(let be=0;be<me.locationSize;be++)b(me.location+be,De/me.locationSize,rt,Ae,te*vt,(Le+De/me.locationSize*be)*vt,Qe)}else{if(he.isInstancedBufferAttribute){for(let Xe=0;Xe<me.locationSize;Xe++)O(me.location+Xe,he.meshPerAttribute);j.isInstancedMesh!==!0&&le._maxInstanceCount===void 0&&(le._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let Xe=0;Xe<me.locationSize;Xe++)T(me.location+Xe);n.bindBuffer(n.ARRAY_BUFFER,He);for(let Xe=0;Xe<me.locationSize;Xe++)b(me.location+Xe,De/me.locationSize,rt,Ae,De*vt,De/me.locationSize*Xe*vt,Qe)}}else if(ie!==void 0){const Ae=ie[fe];if(Ae!==void 0)switch(Ae.length){case 2:n.vertexAttrib2fv(me.location,Ae);break;case 3:n.vertexAttrib3fv(me.location,Ae);break;case 4:n.vertexAttrib4fv(me.location,Ae);break;default:n.vertexAttrib1fv(me.location,Ae)}}}}I()}function C(){F();for(const j in a){const Y=a[j];for(const oe in Y){const le=Y[oe];for(const X in le)y(le[X].object),delete le[X];delete Y[oe]}delete a[j]}}function M(j){if(a[j.id]===void 0)return;const Y=a[j.id];for(const oe in Y){const le=Y[oe];for(const X in le)y(le[X].object),delete le[X];delete Y[oe]}delete a[j.id]}function B(j){for(const Y in a){const oe=a[Y];if(oe[j.id]===void 0)continue;const le=oe[j.id];for(const X in le)y(le[X].object),delete le[X];delete oe[j.id]}}function F(){z(),u=!0,c!==l&&(c=l,m(c.object))}function z(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:f,reset:F,resetDefaultState:z,dispose:C,releaseStatesOfGeometry:M,releaseStatesOfProgram:B,initAttributes:x,enableAttribute:T,disableUnusedAttributes:I}}function bne(n,e,t,r){const i=r.isWebGL2;let s;function o(u){s=u}function a(u,f){n.drawArrays(s,u,f),t.update(f,s,1)}function l(u,f,p){if(p===0)return;let m,y;if(i)m=n,y="drawArraysInstanced";else if(m=e.get("ANGLE_instanced_arrays"),y="drawArraysInstancedANGLE",m===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[y](s,u,f,p),t.update(f,s,p)}function c(u,f,p){if(p===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let y=0;y<p;y++)this.render(u[y],f[y]);else{m.multiDrawArraysWEBGL(s,u,0,f,0,p);let y=0;for(let A=0;A<p;A++)y+=f[A];t.update(y,s,1)}}this.setMode=o,this.render=a,this.renderInstances=l,this.renderMultiDraw=c}function Mne(n,e,t){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const b=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(b){if(b==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";b="mediump"}return b==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=t.logarithmicDepthBuffer===!0,f=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_TEXTURE_SIZE),y=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),A=n.getParameter(n.MAX_VERTEX_ATTRIBS),_=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),g=n.getParameter(n.MAX_VARYING_VECTORS),E=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),x=p>0,T=o||e.has("OES_texture_float"),O=x&&T,I=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:i,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:f,maxVertexTextures:p,maxTextureSize:m,maxCubemapSize:y,maxAttributes:A,maxVertexUniforms:_,maxVaryings:g,maxFragmentUniforms:E,vertexTextures:x,floatFragmentTextures:T,floatVertexTextures:O,maxSamples:I}}function Rne(n){const e=this;let t=null,r=0,i=!1,s=!1;const o=new sc,a=new on,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,p){const m=f.length!==0||p||r!==0||i;return i=p,r=f.length,m},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,p){t=u(f,p,0)},this.setState=function(f,p,m){const y=f.clippingPlanes,A=f.clipIntersection,_=f.clipShadows,g=n.get(f);if(!i||y===null||y.length===0||s&&!_)s?u(null):c();else{const E=s?0:r,x=E*4;let T=g.clippingState||null;l.value=T,T=u(y,p,x,m);for(let O=0;O!==x;++O)T[O]=t[O];g.clippingState=T,this.numIntersection=A?this.numPlanes:0,this.numPlanes+=E}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(f,p,m,y){const A=f!==null?f.length:0;let _=null;if(A!==0){if(_=l.value,y!==!0||_===null){const g=m+A*4,E=p.matrixWorldInverse;a.getNormalMatrix(E),(_===null||_.length<g)&&(_=new Float32Array(g));for(let x=0,T=m;x!==A;++x,T+=4)o.copy(f[x]).applyMatrix4(E,a),o.normal.toArray(_,T),_[T+3]=o.constant}l.value=_,l.needsUpdate=!0}return e.numPlanes=A,e.numIntersection=0,_}}function Ine(n){let e=new WeakMap;function t(o,a){return a===bd?o.mapping=Ra:a===bg&&(o.mapping=kc),o}function r(o){if(o&&o.isTexture){const a=o.mapping;if(a===bd||a===bg)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new sR(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",i),t(c.texture,o.mapping)}else return null}}return o}function i(o){const a=o.target;a.removeEventListener("dispose",i);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class qc extends gy{constructor(e=-1,t=1,r=1,i=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,o=r+e,a=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const $f=4,NL=[.125,.215,.35,.446,.526,.582],Du=20,fw=new qc,kL=new st;let dw=null,pw=0,mw=0;const Pu=(1+Math.sqrt(5))/2,hf=1/Pu,FL=[new J(1,1,1),new J(-1,1,1),new J(1,1,-1),new J(-1,1,-1),new J(0,Pu,hf),new J(0,Pu,-hf),new J(hf,0,Pu),new J(-hf,0,Pu),new J(Pu,hf,0),new J(-Pu,hf,0)];class fC{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){dw=this._renderer.getRenderTarget(),pw=this._renderer.getActiveCubeFace(),mw=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=HL(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=zL(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(dw,pw,mw),e.scissorTest=!1,y0(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ra||e.mapping===kc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),dw=this._renderer.getRenderTarget(),pw=this._renderer.getActiveCubeFace(),mw=this._renderer.getActiveMipmapLevel();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Hn,minFilter:Hn,generateMipmaps:!1,type:Qi,format:Ni,colorSpace:Pa,depthBuffer:!1},i=UL(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=UL(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Pne(s)),this._blurMaterial=Dne(s,e,t)}return i}_compileMaterial(e){const t=new Rr(this._lodPlanes[0],e);this._renderer.compile(t,fw)}_sceneToCubeUV(e,t,r,i){const a=new Mr(90,1,t,r),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,f=u.autoClear,p=u.toneMapping;u.getClearColor(kL),u.toneMapping=xa,u.autoClear=!1;const m=new ks({name:"PMREM.Background",side:ns,depthWrite:!1,depthTest:!1}),y=new Rr(new bh,m);let A=!1;const _=e.background;_?_.isColor&&(m.color.copy(_),e.background=null,A=!0):(m.color.copy(kL),A=!0);for(let g=0;g<6;g++){const E=g%3;E===0?(a.up.set(0,l[g],0),a.lookAt(c[g],0,0)):E===1?(a.up.set(0,0,l[g]),a.lookAt(0,c[g],0)):(a.up.set(0,l[g],0),a.lookAt(0,0,c[g]));const x=this._cubeSize;y0(i,E*x,g>2?x:0,x,x),u.setRenderTarget(i),A&&u.render(y,a),u.render(e,a)}y.geometry.dispose(),y.material.dispose(),u.toneMapping=p,u.autoClear=f,e.background=_}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===Ra||e.mapping===kc;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=HL()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=zL());const s=i?this._cubemapMaterial:this._equirectMaterial,o=new Rr(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;y0(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(o,fw)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const s=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),o=FL[(i-1)%FL.length];this._blur(e,i-1,i,s,o)}t.autoClear=r}_blur(e,t,r,i,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,r,i,"latitudinal",s),this._halfBlur(o,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,f=new Rr(this._lodPlanes[i],c),p=c.uniforms,m=this._sizeLods[r]-1,y=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*Du-1),A=s/y,_=isFinite(s)?1+Math.floor(u*A):Du;_>Du&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${_} samples when the maximum is set to ${Du}`);const g=[];let E=0;for(let b=0;b<Du;++b){const R=b/A,C=Math.exp(-R*R/2);g.push(C),b===0?E+=C:b<_&&(E+=2*C)}for(let b=0;b<g.length;b++)g[b]=g[b]/E;p.envMap.value=e.texture,p.samples.value=_,p.weights.value=g,p.latitudinal.value=o==="latitudinal",a&&(p.poleAxis.value=a);const{_lodMax:x}=this;p.dTheta.value=y,p.mipInt.value=x-r;const T=this._sizeLods[i],O=3*T*(i>x-$f?i-x+$f:0),I=4*(this._cubeSize-T);y0(t,O,I,3*T,2*T),l.setRenderTarget(t),l.render(f,fw)}}function Pne(n){const e=[],t=[],r=[];let i=n;const s=n-$f+1+NL.length;for(let o=0;o<s;o++){const a=Math.pow(2,i);t.push(a);let l=1/a;o>n-$f?l=NL[o-n+$f-1]:o===0&&(l=0),r.push(l);const c=1/(a-2),u=-c,f=1+c,p=[u,u,f,u,f,f,u,u,f,f,u,f],m=6,y=6,A=3,_=2,g=1,E=new Float32Array(A*y*m),x=new Float32Array(_*y*m),T=new Float32Array(g*y*m);for(let I=0;I<m;I++){const b=I%3*2/3-1,R=I>2?0:-1,C=[b,R,0,b+2/3,R,0,b+2/3,R+1,0,b,R,0,b+2/3,R+1,0,b,R+1,0];E.set(C,A*y*I),x.set(p,_*y*I);const M=[I,I,I,I,I,I];T.set(M,g*y*I)}const O=new Jt;O.setAttribute("position",new _n(E,A)),O.setAttribute("uv",new _n(x,_)),O.setAttribute("faceIndex",new _n(T,g)),e.push(O),i>$f&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function UL(n,e,t){const r=new Yo(n,e,t);return r.texture.mapping=tp,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function y0(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function Dne(n,e,t){const r=new Float32Array(Du),i=new J(0,1,0);return new qo({name:"SphericalGaussianBlur",defines:{n:Du,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:oR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:gl,depthTest:!1,depthWrite:!1})}function zL(){return new qo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:oR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:gl,depthTest:!1,depthWrite:!1})}function HL(){return new qo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:oR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:gl,depthTest:!1,depthWrite:!1})}function oR(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Lne(n){let e=new WeakMap,t=null;function r(a){if(a&&a.isTexture){const l=a.mapping,c=l===bd||l===bg,u=l===Ra||l===kc;if(c||u)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let f=e.get(a);return t===null&&(t=new fC(n)),f=c?t.fromEquirectangular(a,f):t.fromCubemap(a,f),e.set(a,f),f.texture}else{if(e.has(a))return e.get(a).texture;{const f=a.image;if(c&&f&&f.height>0||u&&f&&i(f)){t===null&&(t=new fC(n));const p=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,p),a.addEventListener("dispose",s),p.texture}else return null}}}return a}function i(a){let l=0;const c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:o}}function One(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const i=t(r);return i===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function Bne(n,e,t,r){const i={},s=new WeakMap;function o(f){const p=f.target;p.index!==null&&e.remove(p.index);for(const y in p.attributes)e.remove(p.attributes[y]);for(const y in p.morphAttributes){const A=p.morphAttributes[y];for(let _=0,g=A.length;_<g;_++)e.remove(A[_])}p.removeEventListener("dispose",o),delete i[p.id];const m=s.get(p);m&&(e.remove(m),s.delete(p)),r.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function a(f,p){return i[p.id]===!0||(p.addEventListener("dispose",o),i[p.id]=!0,t.memory.geometries++),p}function l(f){const p=f.attributes;for(const y in p)e.update(p[y],n.ARRAY_BUFFER);const m=f.morphAttributes;for(const y in m){const A=m[y];for(let _=0,g=A.length;_<g;_++)e.update(A[_],n.ARRAY_BUFFER)}}function c(f){const p=[],m=f.index,y=f.attributes.position;let A=0;if(m!==null){const E=m.array;A=m.version;for(let x=0,T=E.length;x<T;x+=3){const O=E[x+0],I=E[x+1],b=E[x+2];p.push(O,I,I,b,b,O)}}else if(y!==void 0){const E=y.array;A=y.version;for(let x=0,T=E.length/3-1;x<T;x+=3){const O=x+0,I=x+1,b=x+2;p.push(O,I,I,b,b,O)}}else return;const _=new(qz(p)?iR:rR)(p,1);_.version=A;const g=s.get(f);g&&e.remove(g),s.set(f,_)}function u(f){const p=s.get(f);if(p){const m=f.index;m!==null&&p.version<m.version&&c(f)}else c(f);return s.get(f)}return{get:a,update:l,getWireframeAttribute:u}}function Nne(n,e,t,r){const i=r.isWebGL2;let s;function o(m){s=m}let a,l;function c(m){a=m.type,l=m.bytesPerElement}function u(m,y){n.drawElements(s,y,a,m*l),t.update(y,s,1)}function f(m,y,A){if(A===0)return;let _,g;if(i)_=n,g="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",_===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}_[g](s,y,a,m*l,A),t.update(y,s,A)}function p(m,y,A){if(A===0)return;const _=e.get("WEBGL_multi_draw");if(_===null)for(let g=0;g<A;g++)this.render(m[g]/l,y[g]);else{_.multiDrawElementsWEBGL(s,y,0,a,m,0,A);let g=0;for(let E=0;E<A;E++)g+=y[E];t.update(g,s,1)}}this.setMode=o,this.setIndex=c,this.render=u,this.renderInstances=f,this.renderMultiDraw=p}function kne(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function Fne(n,e){return n[0]-e[0]}function Une(n,e){return Math.abs(e[1])-Math.abs(n[1])}function zne(n,e,t){const r={},i=new Float32Array(8),s=new WeakMap,o=new In,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,u,f){const p=c.morphTargetInfluences;if(e.isWebGL2===!0){const y=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,A=y!==void 0?y.length:0;let _=s.get(u);if(_===void 0||_.count!==A){let Y=function(){z.dispose(),s.delete(u),u.removeEventListener("dispose",Y)};var m=Y;_!==void 0&&_.texture.dispose();const x=u.morphAttributes.position!==void 0,T=u.morphAttributes.normal!==void 0,O=u.morphAttributes.color!==void 0,I=u.morphAttributes.position||[],b=u.morphAttributes.normal||[],R=u.morphAttributes.color||[];let C=0;x===!0&&(C=1),T===!0&&(C=2),O===!0&&(C=3);let M=u.attributes.position.count*C,B=1;M>e.maxTextureSize&&(B=Math.ceil(M/e.maxTextureSize),M=e.maxTextureSize);const F=new Float32Array(M*B*4*A),z=new zx(F,M,B,A);z.type=fi,z.needsUpdate=!0;const j=C*4;for(let oe=0;oe<A;oe++){const le=I[oe],X=b[oe],ee=R[oe],ie=M*B*4*oe;for(let fe=0;fe<le.count;fe++){const me=fe*j;x===!0&&(o.fromBufferAttribute(le,fe),F[ie+me+0]=o.x,F[ie+me+1]=o.y,F[ie+me+2]=o.z,F[ie+me+3]=0),T===!0&&(o.fromBufferAttribute(X,fe),F[ie+me+4]=o.x,F[ie+me+5]=o.y,F[ie+me+6]=o.z,F[ie+me+7]=0),O===!0&&(o.fromBufferAttribute(ee,fe),F[ie+me+8]=o.x,F[ie+me+9]=o.y,F[ie+me+10]=o.z,F[ie+me+11]=ee.itemSize===4?o.w:1)}}_={count:A,texture:z,size:new Be(M,B)},s.set(u,_),u.addEventListener("dispose",Y)}let g=0;for(let x=0;x<p.length;x++)g+=p[x];const E=u.morphTargetsRelative?1:1-g;f.getUniforms().setValue(n,"morphTargetBaseInfluence",E),f.getUniforms().setValue(n,"morphTargetInfluences",p),f.getUniforms().setValue(n,"morphTargetsTexture",_.texture,t),f.getUniforms().setValue(n,"morphTargetsTextureSize",_.size)}else{const y=p===void 0?0:p.length;let A=r[u.id];if(A===void 0||A.length!==y){A=[];for(let T=0;T<y;T++)A[T]=[T,0];r[u.id]=A}for(let T=0;T<y;T++){const O=A[T];O[0]=T,O[1]=p[T]}A.sort(Une);for(let T=0;T<8;T++)T<y&&A[T][1]?(a[T][0]=A[T][0],a[T][1]=A[T][1]):(a[T][0]=Number.MAX_SAFE_INTEGER,a[T][1]=0);a.sort(Fne);const _=u.morphAttributes.position,g=u.morphAttributes.normal;let E=0;for(let T=0;T<8;T++){const O=a[T],I=O[0],b=O[1];I!==Number.MAX_SAFE_INTEGER&&b?(_&&u.getAttribute("morphTarget"+T)!==_[I]&&u.setAttribute("morphTarget"+T,_[I]),g&&u.getAttribute("morphNormal"+T)!==g[I]&&u.setAttribute("morphNormal"+T,g[I]),i[T]=b,E+=b):(_&&u.hasAttribute("morphTarget"+T)===!0&&u.deleteAttribute("morphTarget"+T),g&&u.hasAttribute("morphNormal"+T)===!0&&u.deleteAttribute("morphNormal"+T),i[T]=0)}const x=u.morphTargetsRelative?1:1-E;f.getUniforms().setValue(n,"morphTargetBaseInfluence",x),f.getUniforms().setValue(n,"morphTargetInfluences",i)}}return{update:l}}function Hne(n,e,t,r){let i=new WeakMap;function s(l){const c=r.render.frame,u=l.geometry,f=e.get(l,u);if(i.get(f)!==c&&(e.update(f),i.set(f,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),i.set(l,c))),l.isSkinnedMesh){const p=l.skeleton;i.get(p)!==c&&(p.update(),i.set(p,c))}return f}function o(){i=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:o}}class aR extends Qn{constructor(e,t,r,i,s,o,a,l,c,u){if(u=u!==void 0?u:Mc,u!==Mc&&u!==mh)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&u===Mc&&(r=al),r===void 0&&u===mh&&(r=bc),super(null,i,s,o,a,l,u,r,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:vr,this.minFilter=l!==void 0?l:vr,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const sH=new Qn,oH=new aR(1,1);oH.compareFunction=ZM;const aH=new zx,lH=new nR,cH=new yy,VL=[],GL=[],WL=new Float32Array(16),$L=new Float32Array(9),jL=new Float32Array(4);function rp(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=VL[i];if(s===void 0&&(s=new Float32Array(i),VL[i]=s),e!==0){r.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Gr(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function Wr(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function Hx(n,e){let t=GL[e];t===void 0&&(t=new Int32Array(e),GL[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function Vne(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Gne(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Gr(t,e))return;n.uniform2fv(this.addr,e),Wr(t,e)}}function Wne(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Gr(t,e))return;n.uniform3fv(this.addr,e),Wr(t,e)}}function $ne(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Gr(t,e))return;n.uniform4fv(this.addr,e),Wr(t,e)}}function jne(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Gr(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Wr(t,e)}else{if(Gr(t,r))return;jL.set(r),n.uniformMatrix2fv(this.addr,!1,jL),Wr(t,r)}}function Xne(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Gr(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Wr(t,e)}else{if(Gr(t,r))return;$L.set(r),n.uniformMatrix3fv(this.addr,!1,$L),Wr(t,r)}}function Kne(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Gr(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Wr(t,e)}else{if(Gr(t,r))return;WL.set(r),n.uniformMatrix4fv(this.addr,!1,WL),Wr(t,r)}}function Jne(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function Yne(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Gr(t,e))return;n.uniform2iv(this.addr,e),Wr(t,e)}}function qne(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Gr(t,e))return;n.uniform3iv(this.addr,e),Wr(t,e)}}function Qne(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Gr(t,e))return;n.uniform4iv(this.addr,e),Wr(t,e)}}function Zne(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function ere(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Gr(t,e))return;n.uniform2uiv(this.addr,e),Wr(t,e)}}function tre(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Gr(t,e))return;n.uniform3uiv(this.addr,e),Wr(t,e)}}function nre(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Gr(t,e))return;n.uniform4uiv(this.addr,e),Wr(t,e)}}function rre(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);const s=this.type===n.SAMPLER_2D_SHADOW?oH:sH;t.setTexture2D(e||s,i)}function ire(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||lH,i)}function sre(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||cH,i)}function ore(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||aH,i)}function are(n){switch(n){case 5126:return Vne;case 35664:return Gne;case 35665:return Wne;case 35666:return $ne;case 35674:return jne;case 35675:return Xne;case 35676:return Kne;case 5124:case 35670:return Jne;case 35667:case 35671:return Yne;case 35668:case 35672:return qne;case 35669:case 35673:return Qne;case 5125:return Zne;case 36294:return ere;case 36295:return tre;case 36296:return nre;case 35678:case 36198:case 36298:case 36306:case 35682:return rre;case 35679:case 36299:case 36307:return ire;case 35680:case 36300:case 36308:case 36293:return sre;case 36289:case 36303:case 36311:case 36292:return ore}}function lre(n,e){n.uniform1fv(this.addr,e)}function cre(n,e){const t=rp(e,this.size,2);n.uniform2fv(this.addr,t)}function ure(n,e){const t=rp(e,this.size,3);n.uniform3fv(this.addr,t)}function hre(n,e){const t=rp(e,this.size,4);n.uniform4fv(this.addr,t)}function fre(n,e){const t=rp(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function dre(n,e){const t=rp(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function pre(n,e){const t=rp(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function mre(n,e){n.uniform1iv(this.addr,e)}function gre(n,e){n.uniform2iv(this.addr,e)}function yre(n,e){n.uniform3iv(this.addr,e)}function vre(n,e){n.uniform4iv(this.addr,e)}function _re(n,e){n.uniform1uiv(this.addr,e)}function Ere(n,e){n.uniform2uiv(this.addr,e)}function xre(n,e){n.uniform3uiv(this.addr,e)}function Are(n,e){n.uniform4uiv(this.addr,e)}function wre(n,e,t){const r=this.cache,i=e.length,s=Hx(t,i);Gr(r,s)||(n.uniform1iv(this.addr,s),Wr(r,s));for(let o=0;o!==i;++o)t.setTexture2D(e[o]||sH,s[o])}function Sre(n,e,t){const r=this.cache,i=e.length,s=Hx(t,i);Gr(r,s)||(n.uniform1iv(this.addr,s),Wr(r,s));for(let o=0;o!==i;++o)t.setTexture3D(e[o]||lH,s[o])}function Tre(n,e,t){const r=this.cache,i=e.length,s=Hx(t,i);Gr(r,s)||(n.uniform1iv(this.addr,s),Wr(r,s));for(let o=0;o!==i;++o)t.setTextureCube(e[o]||cH,s[o])}function Cre(n,e,t){const r=this.cache,i=e.length,s=Hx(t,i);Gr(r,s)||(n.uniform1iv(this.addr,s),Wr(r,s));for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||aH,s[o])}function bre(n){switch(n){case 5126:return lre;case 35664:return cre;case 35665:return ure;case 35666:return hre;case 35674:return fre;case 35675:return dre;case 35676:return pre;case 5124:case 35670:return mre;case 35667:case 35671:return gre;case 35668:case 35672:return yre;case 35669:case 35673:return vre;case 5125:return _re;case 36294:return Ere;case 36295:return xre;case 36296:return Are;case 35678:case 36198:case 36298:case 36306:case 35682:return wre;case 35679:case 36299:case 36307:return Sre;case 35680:case 36300:case 36308:case 36293:return Tre;case 36289:case 36303:case 36311:case 36292:return Cre}}class Mre{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=are(t.type)}}class Rre{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=bre(t.type)}}class Ire{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,o=i.length;s!==o;++s){const a=i[s];a.setValue(e,t[a.id],r)}}}const gw=/(\w+)(\])?(\[|\.)?/g;function XL(n,e){n.seq.push(e),n.map[e.id]=e}function Pre(n,e,t){const r=n.name,i=r.length;for(gw.lastIndex=0;;){const s=gw.exec(r),o=gw.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===i){XL(t,c===void 0?new Mre(a,n,e):new Rre(a,n,e));break}else{let f=t.map[a];f===void 0&&(f=new Ire(a),XL(t,f)),t=f}}}class B_{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(t,i),o=e.getUniformLocation(t,s.name);Pre(s,o,this)}}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=r[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const o=e[i];o.id in t&&r.push(o)}return r}}function KL(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const Dre=37297;let Lre=0;function Ore(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=i;o<s;o++){const a=o+1;r.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return r.join(`
`)}function Bre(n){const e=Pn.getPrimaries(Pn.workingColorSpace),t=Pn.getPrimaries(n);let r;switch(e===t?r="":e===Dg&&t===Pg?r="LinearDisplayP3ToLinearSRGB":e===Pg&&t===Dg&&(r="LinearSRGBToLinearDisplayP3"),n){case Pa:case py:return[r,"LinearTransferOETF"];case Hr:case Fx:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[r,"LinearTransferOETF"]}}function JL(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+Ore(n.getShaderSource(e),o)}else return i}function Nre(n,e){const t=Bre(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function kre(n,e){let t;switch(e){case Sz:t="Linear";break;case Tz:t="Reinhard";break;case Cz:t="OptimizedCineon";break;case HM:t="ACESFilmic";break;case Mz:t="AgX";break;case bz:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Fre(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(jf).join(`
`)}function Ure(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(jf).join(`
`)}function zre(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function Hre(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function jf(n){return n!==""}function YL(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function qL(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Vre=/^[ \t]*#include +<([\w\d./]+)>/gm;function dC(n){return n.replace(Vre,Wre)}const Gre=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Wre(n,e){let t=en[e];if(t===void 0){const r=Gre.get(e);if(r!==void 0)t=en[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return dC(t)}const $re=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function QL(n){return n.replace($re,jre)}function jre(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function ZL(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Xre(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===Lx?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===jm?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Bo&&(e="SHADOWMAP_TYPE_VSM"),e}function Kre(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Ra:case kc:e="ENVMAP_TYPE_CUBE";break;case tp:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Jre(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case kc:e="ENVMAP_MODE_REFRACTION";break}return e}function Yre(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case dy:e="ENVMAP_BLENDING_MULTIPLY";break;case Az:e="ENVMAP_BLENDING_MIX";break;case wz:e="ENVMAP_BLENDING_ADD";break}return e}function qre(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function Qre(n,e,t,r){const i=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=Xre(t),c=Kre(t),u=Jre(t),f=Yre(t),p=qre(t),m=t.isWebGL2?"":Fre(t),y=Ure(t),A=zre(s),_=i.createProgram();let g,E,x=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(g=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A].filter(jf).join(`
`),g.length>0&&(g+=`
`),E=[m,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A].filter(jf).join(`
`),E.length>0&&(E+=`
`)):(g=[ZL(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(jf).join(`
`),E=[m,ZL(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==xa?"#define TONE_MAPPING":"",t.toneMapping!==xa?en.tonemapping_pars_fragment:"",t.toneMapping!==xa?kre("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",en.colorspace_pars_fragment,Nre("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(jf).join(`
`)),o=dC(o),o=YL(o,t),o=qL(o,t),a=dC(a),a=YL(a,t),a=qL(a,t),o=QL(o),a=QL(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(x=`#version 300 es
`,g=[y,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,E=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===uC?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===uC?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+E);const T=x+g+o,O=x+E+a,I=KL(i,i.VERTEX_SHADER,T),b=KL(i,i.FRAGMENT_SHADER,O);i.attachShader(_,I),i.attachShader(_,b),t.index0AttributeName!==void 0?i.bindAttribLocation(_,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(_,0,"position"),i.linkProgram(_);function R(F){if(n.debug.checkShaderErrors){const z=i.getProgramInfoLog(_).trim(),j=i.getShaderInfoLog(I).trim(),Y=i.getShaderInfoLog(b).trim();let oe=!0,le=!0;if(i.getProgramParameter(_,i.LINK_STATUS)===!1)if(oe=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,_,I,b);else{const X=JL(i,I,"vertex"),ee=JL(i,b,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(_,i.VALIDATE_STATUS)+`

Program Info Log: `+z+`
`+X+`
`+ee)}else z!==""?console.warn("THREE.WebGLProgram: Program Info Log:",z):(j===""||Y==="")&&(le=!1);le&&(F.diagnostics={runnable:oe,programLog:z,vertexShader:{log:j,prefix:g},fragmentShader:{log:Y,prefix:E}})}i.deleteShader(I),i.deleteShader(b),C=new B_(i,_),M=Hre(i,_)}let C;this.getUniforms=function(){return C===void 0&&R(this),C};let M;this.getAttributes=function(){return M===void 0&&R(this),M};let B=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return B===!1&&(B=i.getProgramParameter(_,Dre)),B},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(_),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Lre++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=I,this.fragmentShader=b,this}let Zre=0;class eie{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new tie(e),t.set(e,r)),r}}class tie{constructor(e){this.id=Zre++,this.code=e,this.usedTimes=0}}function nie(n,e,t,r,i,s,o){const a=new qu,l=new eie,c=[],u=i.isWebGL2,f=i.logarithmicDepthBuffer,p=i.vertexTextures;let m=i.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function A(C){return C===0?"uv":`uv${C}`}function _(C,M,B,F,z){const j=F.fog,Y=z.geometry,oe=C.isMeshStandardMaterial?F.environment:null,le=(C.isMeshStandardMaterial?t:e).get(C.envMap||oe),X=le&&le.mapping===tp?le.image.height:null,ee=y[C.type];C.precision!==null&&(m=i.getMaxPrecision(C.precision),m!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",m,"instead."));const ie=Y.morphAttributes.position||Y.morphAttributes.normal||Y.morphAttributes.color,fe=ie!==void 0?ie.length:0;let me=0;Y.morphAttributes.position!==void 0&&(me=1),Y.morphAttributes.normal!==void 0&&(me=2),Y.morphAttributes.color!==void 0&&(me=3);let he,Ae,De,Ie;if(ee){const Fn=Uo[ee];he=Fn.vertexShader,Ae=Fn.fragmentShader}else he=C.vertexShader,Ae=C.fragmentShader,l.update(C),De=l.getVertexShaderID(C),Ie=l.getFragmentShaderID(C);const He=n.getRenderTarget(),rt=z.isInstancedMesh===!0,vt=z.isBatchedMesh===!0,Qe=!!C.map,Xe=!!C.matcap,te=!!le,Le=!!C.aoMap,be=!!C.lightMap,Ne=!!C.bumpMap,Me=!!C.normalMap,ot=!!C.displacementMap,Ze=!!C.emissiveMap,$=!!C.metalnessMap,V=!!C.roughnessMap,ce=C.anisotropy>0,ke=C.clearcoat>0,pe=C.iridescence>0,ye=C.sheen>0,qe=C.transmission>0,Ge=ce&&!!C.anisotropyMap,Ke=ke&&!!C.clearcoatMap,yt=ke&&!!C.clearcoatNormalMap,At=ke&&!!C.clearcoatRoughnessMap,Ue=pe&&!!C.iridescenceMap,Qt=pe&&!!C.iridescenceThicknessMap,Ht=ye&&!!C.sheenColorMap,wt=ye&&!!C.sheenRoughnessMap,it=!!C.specularMap,at=!!C.specularColorMap,Ct=!!C.specularIntensityMap,bt=qe&&!!C.transmissionMap,Wt=qe&&!!C.thicknessMap,Gt=!!C.gradientMap,Ee=!!C.alphaMap,ae=C.alphaTest>0,tt=!!C.alphaHash,$e=!!C.extensions,Pt=!!Y.attributes.uv1,xt=!!Y.attributes.uv2,hn=!!Y.attributes.uv3;let En=xa;return C.toneMapped&&(He===null||He.isXRRenderTarget===!0)&&(En=n.toneMapping),{isWebGL2:u,shaderID:ee,shaderType:C.type,shaderName:C.name,vertexShader:he,fragmentShader:Ae,defines:C.defines,customVertexShaderID:De,customFragmentShaderID:Ie,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:m,batching:vt,instancing:rt,instancingColor:rt&&z.instanceColor!==null,supportsVertexTextures:p,outputColorSpace:He===null?n.outputColorSpace:He.isXRRenderTarget===!0?He.texture.colorSpace:Pa,map:Qe,matcap:Xe,envMap:te,envMapMode:te&&le.mapping,envMapCubeUVHeight:X,aoMap:Le,lightMap:be,bumpMap:Ne,normalMap:Me,displacementMap:p&&ot,emissiveMap:Ze,normalMapObjectSpace:Me&&C.normalMapType===Gz,normalMapTangentSpace:Me&&C.normalMapType===Yc,metalnessMap:$,roughnessMap:V,anisotropy:ce,anisotropyMap:Ge,clearcoat:ke,clearcoatMap:Ke,clearcoatNormalMap:yt,clearcoatRoughnessMap:At,iridescence:pe,iridescenceMap:Ue,iridescenceThicknessMap:Qt,sheen:ye,sheenColorMap:Ht,sheenRoughnessMap:wt,specularMap:it,specularColorMap:at,specularIntensityMap:Ct,transmission:qe,transmissionMap:bt,thicknessMap:Wt,gradientMap:Gt,opaque:C.transparent===!1&&C.blending===Ju,alphaMap:Ee,alphaTest:ae,alphaHash:tt,combine:C.combine,mapUv:Qe&&A(C.map.channel),aoMapUv:Le&&A(C.aoMap.channel),lightMapUv:be&&A(C.lightMap.channel),bumpMapUv:Ne&&A(C.bumpMap.channel),normalMapUv:Me&&A(C.normalMap.channel),displacementMapUv:ot&&A(C.displacementMap.channel),emissiveMapUv:Ze&&A(C.emissiveMap.channel),metalnessMapUv:$&&A(C.metalnessMap.channel),roughnessMapUv:V&&A(C.roughnessMap.channel),anisotropyMapUv:Ge&&A(C.anisotropyMap.channel),clearcoatMapUv:Ke&&A(C.clearcoatMap.channel),clearcoatNormalMapUv:yt&&A(C.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:At&&A(C.clearcoatRoughnessMap.channel),iridescenceMapUv:Ue&&A(C.iridescenceMap.channel),iridescenceThicknessMapUv:Qt&&A(C.iridescenceThicknessMap.channel),sheenColorMapUv:Ht&&A(C.sheenColorMap.channel),sheenRoughnessMapUv:wt&&A(C.sheenRoughnessMap.channel),specularMapUv:it&&A(C.specularMap.channel),specularColorMapUv:at&&A(C.specularColorMap.channel),specularIntensityMapUv:Ct&&A(C.specularIntensityMap.channel),transmissionMapUv:bt&&A(C.transmissionMap.channel),thicknessMapUv:Wt&&A(C.thicknessMap.channel),alphaMapUv:Ee&&A(C.alphaMap.channel),vertexTangents:!!Y.attributes.tangent&&(Me||ce),vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!Y.attributes.color&&Y.attributes.color.itemSize===4,vertexUv1s:Pt,vertexUv2s:xt,vertexUv3s:hn,pointsUvs:z.isPoints===!0&&!!Y.attributes.uv&&(Qe||Ee),fog:!!j,useFog:C.fog===!0,fogExp2:j&&j.isFogExp2,flatShading:C.flatShading===!0,sizeAttenuation:C.sizeAttenuation===!0,logarithmicDepthBuffer:f,skinning:z.isSkinnedMesh===!0,morphTargets:Y.morphAttributes.position!==void 0,morphNormals:Y.morphAttributes.normal!==void 0,morphColors:Y.morphAttributes.color!==void 0,morphTargetsCount:fe,morphTextureStride:me,numDirLights:M.directional.length,numPointLights:M.point.length,numSpotLights:M.spot.length,numSpotLightMaps:M.spotLightMap.length,numRectAreaLights:M.rectArea.length,numHemiLights:M.hemi.length,numDirLightShadows:M.directionalShadowMap.length,numPointLightShadows:M.pointShadowMap.length,numSpotLightShadows:M.spotShadowMap.length,numSpotLightShadowsWithMaps:M.numSpotLightShadowsWithMaps,numLightProbes:M.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:n.shadowMap.enabled&&B.length>0,shadowMapType:n.shadowMap.type,toneMapping:En,useLegacyLights:n._useLegacyLights,decodeVideoTexture:Qe&&C.map.isVideoTexture===!0&&Pn.getTransfer(C.map.colorSpace)===Wn,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===Os,flipSided:C.side===ns,useDepthPacking:C.depthPacking>=0,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:$e&&C.extensions.derivatives===!0,extensionFragDepth:$e&&C.extensions.fragDepth===!0,extensionDrawBuffers:$e&&C.extensions.drawBuffers===!0,extensionShaderTextureLOD:$e&&C.extensions.shaderTextureLOD===!0,extensionClipCullDistance:$e&&C.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:u||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||r.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:C.customProgramCacheKey()}}function g(C){const M=[];if(C.shaderID?M.push(C.shaderID):(M.push(C.customVertexShaderID),M.push(C.customFragmentShaderID)),C.defines!==void 0)for(const B in C.defines)M.push(B),M.push(C.defines[B]);return C.isRawShaderMaterial===!1&&(E(M,C),x(M,C),M.push(n.outputColorSpace)),M.push(C.customProgramCacheKey),M.join()}function E(C,M){C.push(M.precision),C.push(M.outputColorSpace),C.push(M.envMapMode),C.push(M.envMapCubeUVHeight),C.push(M.mapUv),C.push(M.alphaMapUv),C.push(M.lightMapUv),C.push(M.aoMapUv),C.push(M.bumpMapUv),C.push(M.normalMapUv),C.push(M.displacementMapUv),C.push(M.emissiveMapUv),C.push(M.metalnessMapUv),C.push(M.roughnessMapUv),C.push(M.anisotropyMapUv),C.push(M.clearcoatMapUv),C.push(M.clearcoatNormalMapUv),C.push(M.clearcoatRoughnessMapUv),C.push(M.iridescenceMapUv),C.push(M.iridescenceThicknessMapUv),C.push(M.sheenColorMapUv),C.push(M.sheenRoughnessMapUv),C.push(M.specularMapUv),C.push(M.specularColorMapUv),C.push(M.specularIntensityMapUv),C.push(M.transmissionMapUv),C.push(M.thicknessMapUv),C.push(M.combine),C.push(M.fogExp2),C.push(M.sizeAttenuation),C.push(M.morphTargetsCount),C.push(M.morphAttributeCount),C.push(M.numDirLights),C.push(M.numPointLights),C.push(M.numSpotLights),C.push(M.numSpotLightMaps),C.push(M.numHemiLights),C.push(M.numRectAreaLights),C.push(M.numDirLightShadows),C.push(M.numPointLightShadows),C.push(M.numSpotLightShadows),C.push(M.numSpotLightShadowsWithMaps),C.push(M.numLightProbes),C.push(M.shadowMapType),C.push(M.toneMapping),C.push(M.numClippingPlanes),C.push(M.numClipIntersection),C.push(M.depthPacking)}function x(C,M){a.disableAll(),M.isWebGL2&&a.enable(0),M.supportsVertexTextures&&a.enable(1),M.instancing&&a.enable(2),M.instancingColor&&a.enable(3),M.matcap&&a.enable(4),M.envMap&&a.enable(5),M.normalMapObjectSpace&&a.enable(6),M.normalMapTangentSpace&&a.enable(7),M.clearcoat&&a.enable(8),M.iridescence&&a.enable(9),M.alphaTest&&a.enable(10),M.vertexColors&&a.enable(11),M.vertexAlphas&&a.enable(12),M.vertexUv1s&&a.enable(13),M.vertexUv2s&&a.enable(14),M.vertexUv3s&&a.enable(15),M.vertexTangents&&a.enable(16),M.anisotropy&&a.enable(17),M.alphaHash&&a.enable(18),M.batching&&a.enable(19),C.push(a.mask),a.disableAll(),M.fog&&a.enable(0),M.useFog&&a.enable(1),M.flatShading&&a.enable(2),M.logarithmicDepthBuffer&&a.enable(3),M.skinning&&a.enable(4),M.morphTargets&&a.enable(5),M.morphNormals&&a.enable(6),M.morphColors&&a.enable(7),M.premultipliedAlpha&&a.enable(8),M.shadowMapEnabled&&a.enable(9),M.useLegacyLights&&a.enable(10),M.doubleSided&&a.enable(11),M.flipSided&&a.enable(12),M.useDepthPacking&&a.enable(13),M.dithering&&a.enable(14),M.transmission&&a.enable(15),M.sheen&&a.enable(16),M.opaque&&a.enable(17),M.pointsUvs&&a.enable(18),M.decodeVideoTexture&&a.enable(19),C.push(a.mask)}function T(C){const M=y[C.type];let B;if(M){const F=Uo[M];B=nH.clone(F.uniforms)}else B=C.uniforms;return B}function O(C,M){let B;for(let F=0,z=c.length;F<z;F++){const j=c[F];if(j.cacheKey===M){B=j,++B.usedTimes;break}}return B===void 0&&(B=new Qre(n,M,C,s),c.push(B)),B}function I(C){if(--C.usedTimes===0){const M=c.indexOf(C);c[M]=c[c.length-1],c.pop(),C.destroy()}}function b(C){l.remove(C)}function R(){l.dispose()}return{getParameters:_,getProgramCacheKey:g,getUniforms:T,acquireProgram:O,releaseProgram:I,releaseShaderCache:b,programs:c,dispose:R}}function rie(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function r(s,o,a){n.get(s)[o]=a}function i(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:i}}function iie(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function eO(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function tO(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function o(f,p,m,y,A,_){let g=n[e];return g===void 0?(g={id:f.id,object:f,geometry:p,material:m,groupOrder:y,renderOrder:f.renderOrder,z:A,group:_},n[e]=g):(g.id=f.id,g.object=f,g.geometry=p,g.material=m,g.groupOrder=y,g.renderOrder=f.renderOrder,g.z=A,g.group=_),e++,g}function a(f,p,m,y,A,_){const g=o(f,p,m,y,A,_);m.transmission>0?r.push(g):m.transparent===!0?i.push(g):t.push(g)}function l(f,p,m,y,A,_){const g=o(f,p,m,y,A,_);m.transmission>0?r.unshift(g):m.transparent===!0?i.unshift(g):t.unshift(g)}function c(f,p){t.length>1&&t.sort(f||iie),r.length>1&&r.sort(p||eO),i.length>1&&i.sort(p||eO)}function u(){for(let f=e,p=n.length;f<p;f++){const m=n[f];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:a,unshift:l,finish:u,sort:c}}function sie(){let n=new WeakMap;function e(r,i){const s=n.get(r);let o;return s===void 0?(o=new tO,n.set(r,[o])):i>=s.length?(o=new tO,s.push(o)):o=s[i],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function oie(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new J,color:new st};break;case"SpotLight":t={position:new J,direction:new J,color:new st,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new J,color:new st,distance:0,decay:0};break;case"HemisphereLight":t={direction:new J,skyColor:new st,groundColor:new st};break;case"RectAreaLight":t={color:new st,position:new J,halfWidth:new J,halfHeight:new J};break}return n[e.id]=t,t}}}function aie(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Be};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Be};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Be,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let lie=0;function cie(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function uie(n,e){const t=new oie,r=aie(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new J);const s=new J,o=new Bt,a=new Bt;function l(u,f){let p=0,m=0,y=0;for(let F=0;F<9;F++)i.probe[F].set(0,0,0);let A=0,_=0,g=0,E=0,x=0,T=0,O=0,I=0,b=0,R=0,C=0;u.sort(cie);const M=f===!0?Math.PI:1;for(let F=0,z=u.length;F<z;F++){const j=u[F],Y=j.color,oe=j.intensity,le=j.distance,X=j.shadow&&j.shadow.map?j.shadow.map.texture:null;if(j.isAmbientLight)p+=Y.r*oe*M,m+=Y.g*oe*M,y+=Y.b*oe*M;else if(j.isLightProbe){for(let ee=0;ee<9;ee++)i.probe[ee].addScaledVector(j.sh.coefficients[ee],oe);C++}else if(j.isDirectionalLight){const ee=t.get(j);if(ee.color.copy(j.color).multiplyScalar(j.intensity*M),j.castShadow){const ie=j.shadow,fe=r.get(j);fe.shadowBias=ie.bias,fe.shadowNormalBias=ie.normalBias,fe.shadowRadius=ie.radius,fe.shadowMapSize=ie.mapSize,i.directionalShadow[A]=fe,i.directionalShadowMap[A]=X,i.directionalShadowMatrix[A]=j.shadow.matrix,T++}i.directional[A]=ee,A++}else if(j.isSpotLight){const ee=t.get(j);ee.position.setFromMatrixPosition(j.matrixWorld),ee.color.copy(Y).multiplyScalar(oe*M),ee.distance=le,ee.coneCos=Math.cos(j.angle),ee.penumbraCos=Math.cos(j.angle*(1-j.penumbra)),ee.decay=j.decay,i.spot[g]=ee;const ie=j.shadow;if(j.map&&(i.spotLightMap[b]=j.map,b++,ie.updateMatrices(j),j.castShadow&&R++),i.spotLightMatrix[g]=ie.matrix,j.castShadow){const fe=r.get(j);fe.shadowBias=ie.bias,fe.shadowNormalBias=ie.normalBias,fe.shadowRadius=ie.radius,fe.shadowMapSize=ie.mapSize,i.spotShadow[g]=fe,i.spotShadowMap[g]=X,I++}g++}else if(j.isRectAreaLight){const ee=t.get(j);ee.color.copy(Y).multiplyScalar(oe),ee.halfWidth.set(j.width*.5,0,0),ee.halfHeight.set(0,j.height*.5,0),i.rectArea[E]=ee,E++}else if(j.isPointLight){const ee=t.get(j);if(ee.color.copy(j.color).multiplyScalar(j.intensity*M),ee.distance=j.distance,ee.decay=j.decay,j.castShadow){const ie=j.shadow,fe=r.get(j);fe.shadowBias=ie.bias,fe.shadowNormalBias=ie.normalBias,fe.shadowRadius=ie.radius,fe.shadowMapSize=ie.mapSize,fe.shadowCameraNear=ie.camera.near,fe.shadowCameraFar=ie.camera.far,i.pointShadow[_]=fe,i.pointShadowMap[_]=X,i.pointShadowMatrix[_]=j.shadow.matrix,O++}i.point[_]=ee,_++}else if(j.isHemisphereLight){const ee=t.get(j);ee.skyColor.copy(j.color).multiplyScalar(oe*M),ee.groundColor.copy(j.groundColor).multiplyScalar(oe*M),i.hemi[x]=ee,x++}}E>0&&(e.isWebGL2?n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=nt.LTC_FLOAT_1,i.rectAreaLTC2=nt.LTC_FLOAT_2):(i.rectAreaLTC1=nt.LTC_HALF_1,i.rectAreaLTC2=nt.LTC_HALF_2):n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=nt.LTC_FLOAT_1,i.rectAreaLTC2=nt.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=nt.LTC_HALF_1,i.rectAreaLTC2=nt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=p,i.ambient[1]=m,i.ambient[2]=y;const B=i.hash;(B.directionalLength!==A||B.pointLength!==_||B.spotLength!==g||B.rectAreaLength!==E||B.hemiLength!==x||B.numDirectionalShadows!==T||B.numPointShadows!==O||B.numSpotShadows!==I||B.numSpotMaps!==b||B.numLightProbes!==C)&&(i.directional.length=A,i.spot.length=g,i.rectArea.length=E,i.point.length=_,i.hemi.length=x,i.directionalShadow.length=T,i.directionalShadowMap.length=T,i.pointShadow.length=O,i.pointShadowMap.length=O,i.spotShadow.length=I,i.spotShadowMap.length=I,i.directionalShadowMatrix.length=T,i.pointShadowMatrix.length=O,i.spotLightMatrix.length=I+b-R,i.spotLightMap.length=b,i.numSpotLightShadowsWithMaps=R,i.numLightProbes=C,B.directionalLength=A,B.pointLength=_,B.spotLength=g,B.rectAreaLength=E,B.hemiLength=x,B.numDirectionalShadows=T,B.numPointShadows=O,B.numSpotShadows=I,B.numSpotMaps=b,B.numLightProbes=C,i.version=lie++)}function c(u,f){let p=0,m=0,y=0,A=0,_=0;const g=f.matrixWorldInverse;for(let E=0,x=u.length;E<x;E++){const T=u[E];if(T.isDirectionalLight){const O=i.directional[p];O.direction.setFromMatrixPosition(T.matrixWorld),s.setFromMatrixPosition(T.target.matrixWorld),O.direction.sub(s),O.direction.transformDirection(g),p++}else if(T.isSpotLight){const O=i.spot[y];O.position.setFromMatrixPosition(T.matrixWorld),O.position.applyMatrix4(g),O.direction.setFromMatrixPosition(T.matrixWorld),s.setFromMatrixPosition(T.target.matrixWorld),O.direction.sub(s),O.direction.transformDirection(g),y++}else if(T.isRectAreaLight){const O=i.rectArea[A];O.position.setFromMatrixPosition(T.matrixWorld),O.position.applyMatrix4(g),a.identity(),o.copy(T.matrixWorld),o.premultiply(g),a.extractRotation(o),O.halfWidth.set(T.width*.5,0,0),O.halfHeight.set(0,T.height*.5,0),O.halfWidth.applyMatrix4(a),O.halfHeight.applyMatrix4(a),A++}else if(T.isPointLight){const O=i.point[m];O.position.setFromMatrixPosition(T.matrixWorld),O.position.applyMatrix4(g),m++}else if(T.isHemisphereLight){const O=i.hemi[_];O.direction.setFromMatrixPosition(T.matrixWorld),O.direction.transformDirection(g),_++}}}return{setup:l,setupView:c,state:i}}function nO(n,e){const t=new uie(n,e),r=[],i=[];function s(){r.length=0,i.length=0}function o(f){r.push(f)}function a(f){i.push(f)}function l(f){t.setup(r,f)}function c(f){t.setupView(r,f)}return{init:s,state:{lightsArray:r,shadowsArray:i,lights:t},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function hie(n,e){let t=new WeakMap;function r(s,o=0){const a=t.get(s);let l;return a===void 0?(l=new nO(n,e),t.set(s,[l])):o>=a.length?(l=new nO(n,e),a.push(l)):l=a[o],l}function i(){t=new WeakMap}return{get:r,dispose:i}}class lR extends kr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Hz,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class cR extends kr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const fie=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,die=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function pie(n,e,t){let r=new vy;const i=new Be,s=new Be,o=new In,a=new lR({depthPacking:Vz}),l=new cR,c={},u=t.maxTextureSize,f={[Ma]:ns,[ns]:Ma,[Os]:Os},p=new qo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Be},radius:{value:4}},vertexShader:fie,fragmentShader:die}),m=p.clone();m.defines.HORIZONTAL_PASS=1;const y=new Jt;y.setAttribute("position",new _n(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const A=new Rr(y,p),_=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Lx;let g=this.type;this.render=function(I,b,R){if(_.enabled===!1||_.autoUpdate===!1&&_.needsUpdate===!1||I.length===0)return;const C=n.getRenderTarget(),M=n.getActiveCubeFace(),B=n.getActiveMipmapLevel(),F=n.state;F.setBlending(gl),F.buffers.color.setClear(1,1,1,1),F.buffers.depth.setTest(!0),F.setScissorTest(!1);const z=g!==Bo&&this.type===Bo,j=g===Bo&&this.type!==Bo;for(let Y=0,oe=I.length;Y<oe;Y++){const le=I[Y],X=le.shadow;if(X===void 0){console.warn("THREE.WebGLShadowMap:",le,"has no shadow.");continue}if(X.autoUpdate===!1&&X.needsUpdate===!1)continue;i.copy(X.mapSize);const ee=X.getFrameExtents();if(i.multiply(ee),s.copy(X.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/ee.x),i.x=s.x*ee.x,X.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/ee.y),i.y=s.y*ee.y,X.mapSize.y=s.y)),X.map===null||z===!0||j===!0){const fe=this.type!==Bo?{minFilter:vr,magFilter:vr}:{};X.map!==null&&X.map.dispose(),X.map=new Yo(i.x,i.y,fe),X.map.texture.name=le.name+".shadowMap",X.camera.updateProjectionMatrix()}n.setRenderTarget(X.map),n.clear();const ie=X.getViewportCount();for(let fe=0;fe<ie;fe++){const me=X.getViewport(fe);o.set(s.x*me.x,s.y*me.y,s.x*me.z,s.y*me.w),F.viewport(o),X.updateMatrices(le,fe),r=X.getFrustum(),T(b,R,X.camera,le,this.type)}X.isPointLightShadow!==!0&&this.type===Bo&&E(X,R),X.needsUpdate=!1}g=this.type,_.needsUpdate=!1,n.setRenderTarget(C,M,B)};function E(I,b){const R=e.update(A);p.defines.VSM_SAMPLES!==I.blurSamples&&(p.defines.VSM_SAMPLES=I.blurSamples,m.defines.VSM_SAMPLES=I.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),I.mapPass===null&&(I.mapPass=new Yo(i.x,i.y)),p.uniforms.shadow_pass.value=I.map.texture,p.uniforms.resolution.value=I.mapSize,p.uniforms.radius.value=I.radius,n.setRenderTarget(I.mapPass),n.clear(),n.renderBufferDirect(b,null,R,p,A,null),m.uniforms.shadow_pass.value=I.mapPass.texture,m.uniforms.resolution.value=I.mapSize,m.uniforms.radius.value=I.radius,n.setRenderTarget(I.map),n.clear(),n.renderBufferDirect(b,null,R,m,A,null)}function x(I,b,R,C){let M=null;const B=R.isPointLight===!0?I.customDistanceMaterial:I.customDepthMaterial;if(B!==void 0)M=B;else if(M=R.isPointLight===!0?l:a,n.localClippingEnabled&&b.clipShadows===!0&&Array.isArray(b.clippingPlanes)&&b.clippingPlanes.length!==0||b.displacementMap&&b.displacementScale!==0||b.alphaMap&&b.alphaTest>0||b.map&&b.alphaTest>0){const F=M.uuid,z=b.uuid;let j=c[F];j===void 0&&(j={},c[F]=j);let Y=j[z];Y===void 0&&(Y=M.clone(),j[z]=Y,b.addEventListener("dispose",O)),M=Y}if(M.visible=b.visible,M.wireframe=b.wireframe,C===Bo?M.side=b.shadowSide!==null?b.shadowSide:b.side:M.side=b.shadowSide!==null?b.shadowSide:f[b.side],M.alphaMap=b.alphaMap,M.alphaTest=b.alphaTest,M.map=b.map,M.clipShadows=b.clipShadows,M.clippingPlanes=b.clippingPlanes,M.clipIntersection=b.clipIntersection,M.displacementMap=b.displacementMap,M.displacementScale=b.displacementScale,M.displacementBias=b.displacementBias,M.wireframeLinewidth=b.wireframeLinewidth,M.linewidth=b.linewidth,R.isPointLight===!0&&M.isMeshDistanceMaterial===!0){const F=n.properties.get(M);F.light=R}return M}function T(I,b,R,C,M){if(I.visible===!1)return;if(I.layers.test(b.layers)&&(I.isMesh||I.isLine||I.isPoints)&&(I.castShadow||I.receiveShadow&&M===Bo)&&(!I.frustumCulled||r.intersectsObject(I))){I.modelViewMatrix.multiplyMatrices(R.matrixWorldInverse,I.matrixWorld);const z=e.update(I),j=I.material;if(Array.isArray(j)){const Y=z.groups;for(let oe=0,le=Y.length;oe<le;oe++){const X=Y[oe],ee=j[X.materialIndex];if(ee&&ee.visible){const ie=x(I,ee,C,M);I.onBeforeShadow(n,I,b,R,z,ie,X),n.renderBufferDirect(R,null,z,ie,I,X),I.onAfterShadow(n,I,b,R,z,ie,X)}}}else if(j.visible){const Y=x(I,j,C,M);I.onBeforeShadow(n,I,b,R,z,Y,null),n.renderBufferDirect(R,null,z,Y,I,null),I.onAfterShadow(n,I,b,R,z,Y,null)}}const F=I.children;for(let z=0,j=F.length;z<j;z++)T(F[z],b,R,C,M)}function O(I){I.target.removeEventListener("dispose",O);for(const R in c){const C=c[R],M=I.target.uuid;M in C&&(C[M].dispose(),delete C[M])}}}function mie(n,e,t){const r=t.isWebGL2;function i(){let ae=!1;const tt=new In;let $e=null;const Pt=new In(0,0,0,0);return{setMask:function(xt){$e!==xt&&!ae&&(n.colorMask(xt,xt,xt,xt),$e=xt)},setLocked:function(xt){ae=xt},setClear:function(xt,hn,En,Xn,Fn){Fn===!0&&(xt*=Xn,hn*=Xn,En*=Xn),tt.set(xt,hn,En,Xn),Pt.equals(tt)===!1&&(n.clearColor(xt,hn,En,Xn),Pt.copy(tt))},reset:function(){ae=!1,$e=null,Pt.set(-1,0,0,0)}}}function s(){let ae=!1,tt=null,$e=null,Pt=null;return{setTest:function(xt){xt?vt(n.DEPTH_TEST):Qe(n.DEPTH_TEST)},setMask:function(xt){tt!==xt&&!ae&&(n.depthMask(xt),tt=xt)},setFunc:function(xt){if($e!==xt){switch(xt){case mz:n.depthFunc(n.NEVER);break;case gz:n.depthFunc(n.ALWAYS);break;case yz:n.depthFunc(n.LESS);break;case Cg:n.depthFunc(n.LEQUAL);break;case vz:n.depthFunc(n.EQUAL);break;case _z:n.depthFunc(n.GEQUAL);break;case Ez:n.depthFunc(n.GREATER);break;case xz:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}$e=xt}},setLocked:function(xt){ae=xt},setClear:function(xt){Pt!==xt&&(n.clearDepth(xt),Pt=xt)},reset:function(){ae=!1,tt=null,$e=null,Pt=null}}}function o(){let ae=!1,tt=null,$e=null,Pt=null,xt=null,hn=null,En=null,Xn=null,Fn=null;return{setTest:function(An){ae||(An?vt(n.STENCIL_TEST):Qe(n.STENCIL_TEST))},setMask:function(An){tt!==An&&!ae&&(n.stencilMask(An),tt=An)},setFunc:function(An,Ar,Fr){($e!==An||Pt!==Ar||xt!==Fr)&&(n.stencilFunc(An,Ar,Fr),$e=An,Pt=Ar,xt=Fr)},setOp:function(An,Ar,Fr){(hn!==An||En!==Ar||Xn!==Fr)&&(n.stencilOp(An,Ar,Fr),hn=An,En=Ar,Xn=Fr)},setLocked:function(An){ae=An},setClear:function(An){Fn!==An&&(n.clearStencil(An),Fn=An)},reset:function(){ae=!1,tt=null,$e=null,Pt=null,xt=null,hn=null,En=null,Xn=null,Fn=null}}}const a=new i,l=new s,c=new o,u=new WeakMap,f=new WeakMap;let p={},m={},y=new WeakMap,A=[],_=null,g=!1,E=null,x=null,T=null,O=null,I=null,b=null,R=null,C=new st(0,0,0),M=0,B=!1,F=null,z=null,j=null,Y=null,oe=null;const le=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let X=!1,ee=0;const ie=n.getParameter(n.VERSION);ie.indexOf("WebGL")!==-1?(ee=parseFloat(/^WebGL (\d)/.exec(ie)[1]),X=ee>=1):ie.indexOf("OpenGL ES")!==-1&&(ee=parseFloat(/^OpenGL ES (\d)/.exec(ie)[1]),X=ee>=2);let fe=null,me={};const he=n.getParameter(n.SCISSOR_BOX),Ae=n.getParameter(n.VIEWPORT),De=new In().fromArray(he),Ie=new In().fromArray(Ae);function He(ae,tt,$e,Pt){const xt=new Uint8Array(4),hn=n.createTexture();n.bindTexture(ae,hn),n.texParameteri(ae,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(ae,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let En=0;En<$e;En++)r&&(ae===n.TEXTURE_3D||ae===n.TEXTURE_2D_ARRAY)?n.texImage3D(tt,0,n.RGBA,1,1,Pt,0,n.RGBA,n.UNSIGNED_BYTE,xt):n.texImage2D(tt+En,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,xt);return hn}const rt={};rt[n.TEXTURE_2D]=He(n.TEXTURE_2D,n.TEXTURE_2D,1),rt[n.TEXTURE_CUBE_MAP]=He(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(rt[n.TEXTURE_2D_ARRAY]=He(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),rt[n.TEXTURE_3D]=He(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),vt(n.DEPTH_TEST),l.setFunc(Cg),Ze(!1),$(PT),vt(n.CULL_FACE),Me(gl);function vt(ae){p[ae]!==!0&&(n.enable(ae),p[ae]=!0)}function Qe(ae){p[ae]!==!1&&(n.disable(ae),p[ae]=!1)}function Xe(ae,tt){return m[ae]!==tt?(n.bindFramebuffer(ae,tt),m[ae]=tt,r&&(ae===n.DRAW_FRAMEBUFFER&&(m[n.FRAMEBUFFER]=tt),ae===n.FRAMEBUFFER&&(m[n.DRAW_FRAMEBUFFER]=tt)),!0):!1}function te(ae,tt){let $e=A,Pt=!1;if(ae)if($e=y.get(tt),$e===void 0&&($e=[],y.set(tt,$e)),ae.isWebGLMultipleRenderTargets){const xt=ae.texture;if($e.length!==xt.length||$e[0]!==n.COLOR_ATTACHMENT0){for(let hn=0,En=xt.length;hn<En;hn++)$e[hn]=n.COLOR_ATTACHMENT0+hn;$e.length=xt.length,Pt=!0}}else $e[0]!==n.COLOR_ATTACHMENT0&&($e[0]=n.COLOR_ATTACHMENT0,Pt=!0);else $e[0]!==n.BACK&&($e[0]=n.BACK,Pt=!0);Pt&&(t.isWebGL2?n.drawBuffers($e):e.get("WEBGL_draw_buffers").drawBuffersWEBGL($e))}function Le(ae){return _!==ae?(n.useProgram(ae),_=ae,!0):!1}const be={[dc]:n.FUNC_ADD,[ez]:n.FUNC_SUBTRACT,[tz]:n.FUNC_REVERSE_SUBTRACT};if(r)be[BT]=n.MIN,be[NT]=n.MAX;else{const ae=e.get("EXT_blend_minmax");ae!==null&&(be[BT]=ae.MIN_EXT,be[NT]=ae.MAX_EXT)}const Ne={[nz]:n.ZERO,[rz]:n.ONE,[iz]:n.SRC_COLOR,[PE]:n.SRC_ALPHA,[uz]:n.SRC_ALPHA_SATURATE,[lz]:n.DST_COLOR,[oz]:n.DST_ALPHA,[sz]:n.ONE_MINUS_SRC_COLOR,[DE]:n.ONE_MINUS_SRC_ALPHA,[cz]:n.ONE_MINUS_DST_COLOR,[az]:n.ONE_MINUS_DST_ALPHA,[hz]:n.CONSTANT_COLOR,[fz]:n.ONE_MINUS_CONSTANT_COLOR,[dz]:n.CONSTANT_ALPHA,[pz]:n.ONE_MINUS_CONSTANT_ALPHA};function Me(ae,tt,$e,Pt,xt,hn,En,Xn,Fn,An){if(ae===gl){g===!0&&(Qe(n.BLEND),g=!1);return}if(g===!1&&(vt(n.BLEND),g=!0),ae!==Z4){if(ae!==E||An!==B){if((x!==dc||I!==dc)&&(n.blendEquation(n.FUNC_ADD),x=dc,I=dc),An)switch(ae){case Ju:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case DT:n.blendFunc(n.ONE,n.ONE);break;case LT:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case OT:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ae);break}else switch(ae){case Ju:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case DT:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case LT:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case OT:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ae);break}T=null,O=null,b=null,R=null,C.set(0,0,0),M=0,E=ae,B=An}return}xt=xt||tt,hn=hn||$e,En=En||Pt,(tt!==x||xt!==I)&&(n.blendEquationSeparate(be[tt],be[xt]),x=tt,I=xt),($e!==T||Pt!==O||hn!==b||En!==R)&&(n.blendFuncSeparate(Ne[$e],Ne[Pt],Ne[hn],Ne[En]),T=$e,O=Pt,b=hn,R=En),(Xn.equals(C)===!1||Fn!==M)&&(n.blendColor(Xn.r,Xn.g,Xn.b,Fn),C.copy(Xn),M=Fn),E=ae,B=!1}function ot(ae,tt){ae.side===Os?Qe(n.CULL_FACE):vt(n.CULL_FACE);let $e=ae.side===ns;tt&&($e=!$e),Ze($e),ae.blending===Ju&&ae.transparent===!1?Me(gl):Me(ae.blending,ae.blendEquation,ae.blendSrc,ae.blendDst,ae.blendEquationAlpha,ae.blendSrcAlpha,ae.blendDstAlpha,ae.blendColor,ae.blendAlpha,ae.premultipliedAlpha),l.setFunc(ae.depthFunc),l.setTest(ae.depthTest),l.setMask(ae.depthWrite),a.setMask(ae.colorWrite);const Pt=ae.stencilWrite;c.setTest(Pt),Pt&&(c.setMask(ae.stencilWriteMask),c.setFunc(ae.stencilFunc,ae.stencilRef,ae.stencilFuncMask),c.setOp(ae.stencilFail,ae.stencilZFail,ae.stencilZPass)),ce(ae.polygonOffset,ae.polygonOffsetFactor,ae.polygonOffsetUnits),ae.alphaToCoverage===!0?vt(n.SAMPLE_ALPHA_TO_COVERAGE):Qe(n.SAMPLE_ALPHA_TO_COVERAGE)}function Ze(ae){F!==ae&&(ae?n.frontFace(n.CW):n.frontFace(n.CCW),F=ae)}function $(ae){ae!==Y4?(vt(n.CULL_FACE),ae!==z&&(ae===PT?n.cullFace(n.BACK):ae===q4?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Qe(n.CULL_FACE),z=ae}function V(ae){ae!==j&&(X&&n.lineWidth(ae),j=ae)}function ce(ae,tt,$e){ae?(vt(n.POLYGON_OFFSET_FILL),(Y!==tt||oe!==$e)&&(n.polygonOffset(tt,$e),Y=tt,oe=$e)):Qe(n.POLYGON_OFFSET_FILL)}function ke(ae){ae?vt(n.SCISSOR_TEST):Qe(n.SCISSOR_TEST)}function pe(ae){ae===void 0&&(ae=n.TEXTURE0+le-1),fe!==ae&&(n.activeTexture(ae),fe=ae)}function ye(ae,tt,$e){$e===void 0&&(fe===null?$e=n.TEXTURE0+le-1:$e=fe);let Pt=me[$e];Pt===void 0&&(Pt={type:void 0,texture:void 0},me[$e]=Pt),(Pt.type!==ae||Pt.texture!==tt)&&(fe!==$e&&(n.activeTexture($e),fe=$e),n.bindTexture(ae,tt||rt[ae]),Pt.type=ae,Pt.texture=tt)}function qe(){const ae=me[fe];ae!==void 0&&ae.type!==void 0&&(n.bindTexture(ae.type,null),ae.type=void 0,ae.texture=void 0)}function Ge(){try{n.compressedTexImage2D.apply(n,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Ke(){try{n.compressedTexImage3D.apply(n,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function yt(){try{n.texSubImage2D.apply(n,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function At(){try{n.texSubImage3D.apply(n,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Ue(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Qt(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Ht(){try{n.texStorage2D.apply(n,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function wt(){try{n.texStorage3D.apply(n,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function it(){try{n.texImage2D.apply(n,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function at(){try{n.texImage3D.apply(n,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Ct(ae){De.equals(ae)===!1&&(n.scissor(ae.x,ae.y,ae.z,ae.w),De.copy(ae))}function bt(ae){Ie.equals(ae)===!1&&(n.viewport(ae.x,ae.y,ae.z,ae.w),Ie.copy(ae))}function Wt(ae,tt){let $e=f.get(tt);$e===void 0&&($e=new WeakMap,f.set(tt,$e));let Pt=$e.get(ae);Pt===void 0&&(Pt=n.getUniformBlockIndex(tt,ae.name),$e.set(ae,Pt))}function Gt(ae,tt){const Pt=f.get(tt).get(ae);u.get(tt)!==Pt&&(n.uniformBlockBinding(tt,Pt,ae.__bindingPointIndex),u.set(tt,Pt))}function Ee(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),r===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),p={},fe=null,me={},m={},y=new WeakMap,A=[],_=null,g=!1,E=null,x=null,T=null,O=null,I=null,b=null,R=null,C=new st(0,0,0),M=0,B=!1,F=null,z=null,j=null,Y=null,oe=null,De.set(0,0,n.canvas.width,n.canvas.height),Ie.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:vt,disable:Qe,bindFramebuffer:Xe,drawBuffers:te,useProgram:Le,setBlending:Me,setMaterial:ot,setFlipSided:Ze,setCullFace:$,setLineWidth:V,setPolygonOffset:ce,setScissorTest:ke,activeTexture:pe,bindTexture:ye,unbindTexture:qe,compressedTexImage2D:Ge,compressedTexImage3D:Ke,texImage2D:it,texImage3D:at,updateUBOMapping:Wt,uniformBlockBinding:Gt,texStorage2D:Ht,texStorage3D:wt,texSubImage2D:yt,texSubImage3D:At,compressedTexSubImage2D:Ue,compressedTexSubImage3D:Qt,scissor:Ct,viewport:bt,reset:Ee}}function gie(n,e,t,r,i,s,o){const a=i.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new WeakMap;let f;const p=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y($,V){return m?new OffscreenCanvas($,V):Og("canvas")}function A($,V,ce,ke){let pe=1;if(($.width>ke||$.height>ke)&&(pe=ke/Math.max($.width,$.height)),pe<1||V===!0)if(typeof HTMLImageElement<"u"&&$ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&$ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&$ instanceof ImageBitmap){const ye=V?BE:Math.floor,qe=ye(pe*$.width),Ge=ye(pe*$.height);f===void 0&&(f=y(qe,Ge));const Ke=ce?y(qe,Ge):f;return Ke.width=qe,Ke.height=Ge,Ke.getContext("2d").drawImage($,0,0,qe,Ge),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+$.width+"x"+$.height+") to ("+qe+"x"+Ge+")."),Ke}else return"data"in $&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+$.width+"x"+$.height+")."),$;return $}function _($){return hC($.width)&&hC($.height)}function g($){return a?!1:$.wrapS!==hi||$.wrapT!==hi||$.minFilter!==vr&&$.minFilter!==Hn}function E($,V){return $.generateMipmaps&&V&&$.minFilter!==vr&&$.minFilter!==Hn}function x($){n.generateMipmap($)}function T($,V,ce,ke,pe=!1){if(a===!1)return V;if($!==null){if(n[$]!==void 0)return n[$];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+$+"'")}let ye=V;if(V===n.RED&&(ce===n.FLOAT&&(ye=n.R32F),ce===n.HALF_FLOAT&&(ye=n.R16F),ce===n.UNSIGNED_BYTE&&(ye=n.R8)),V===n.RED_INTEGER&&(ce===n.UNSIGNED_BYTE&&(ye=n.R8UI),ce===n.UNSIGNED_SHORT&&(ye=n.R16UI),ce===n.UNSIGNED_INT&&(ye=n.R32UI),ce===n.BYTE&&(ye=n.R8I),ce===n.SHORT&&(ye=n.R16I),ce===n.INT&&(ye=n.R32I)),V===n.RG&&(ce===n.FLOAT&&(ye=n.RG32F),ce===n.HALF_FLOAT&&(ye=n.RG16F),ce===n.UNSIGNED_BYTE&&(ye=n.RG8)),V===n.RGBA){const qe=pe?Ig:Pn.getTransfer(ke);ce===n.FLOAT&&(ye=n.RGBA32F),ce===n.HALF_FLOAT&&(ye=n.RGBA16F),ce===n.UNSIGNED_BYTE&&(ye=qe===Wn?n.SRGB8_ALPHA8:n.RGBA8),ce===n.UNSIGNED_SHORT_4_4_4_4&&(ye=n.RGBA4),ce===n.UNSIGNED_SHORT_5_5_5_1&&(ye=n.RGB5_A1)}return(ye===n.R16F||ye===n.R32F||ye===n.RG16F||ye===n.RG32F||ye===n.RGBA16F||ye===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ye}function O($,V,ce){return E($,ce)===!0||$.isFramebufferTexture&&$.minFilter!==vr&&$.minFilter!==Hn?Math.log2(Math.max(V.width,V.height))+1:$.mipmaps!==void 0&&$.mipmaps.length>0?$.mipmaps.length:$.isCompressedTexture&&Array.isArray($.image)?V.mipmaps.length:1}function I($){return $===vr||$===Mg||$===cd?n.NEAREST:n.LINEAR}function b($){const V=$.target;V.removeEventListener("dispose",b),C(V),V.isVideoTexture&&u.delete(V)}function R($){const V=$.target;V.removeEventListener("dispose",R),B(V)}function C($){const V=r.get($);if(V.__webglInit===void 0)return;const ce=$.source,ke=p.get(ce);if(ke){const pe=ke[V.__cacheKey];pe.usedTimes--,pe.usedTimes===0&&M($),Object.keys(ke).length===0&&p.delete(ce)}r.remove($)}function M($){const V=r.get($);n.deleteTexture(V.__webglTexture);const ce=$.source,ke=p.get(ce);delete ke[V.__cacheKey],o.memory.textures--}function B($){const V=$.texture,ce=r.get($),ke=r.get(V);if(ke.__webglTexture!==void 0&&(n.deleteTexture(ke.__webglTexture),o.memory.textures--),$.depthTexture&&$.depthTexture.dispose(),$.isWebGLCubeRenderTarget)for(let pe=0;pe<6;pe++){if(Array.isArray(ce.__webglFramebuffer[pe]))for(let ye=0;ye<ce.__webglFramebuffer[pe].length;ye++)n.deleteFramebuffer(ce.__webglFramebuffer[pe][ye]);else n.deleteFramebuffer(ce.__webglFramebuffer[pe]);ce.__webglDepthbuffer&&n.deleteRenderbuffer(ce.__webglDepthbuffer[pe])}else{if(Array.isArray(ce.__webglFramebuffer))for(let pe=0;pe<ce.__webglFramebuffer.length;pe++)n.deleteFramebuffer(ce.__webglFramebuffer[pe]);else n.deleteFramebuffer(ce.__webglFramebuffer);if(ce.__webglDepthbuffer&&n.deleteRenderbuffer(ce.__webglDepthbuffer),ce.__webglMultisampledFramebuffer&&n.deleteFramebuffer(ce.__webglMultisampledFramebuffer),ce.__webglColorRenderbuffer)for(let pe=0;pe<ce.__webglColorRenderbuffer.length;pe++)ce.__webglColorRenderbuffer[pe]&&n.deleteRenderbuffer(ce.__webglColorRenderbuffer[pe]);ce.__webglDepthRenderbuffer&&n.deleteRenderbuffer(ce.__webglDepthRenderbuffer)}if($.isWebGLMultipleRenderTargets)for(let pe=0,ye=V.length;pe<ye;pe++){const qe=r.get(V[pe]);qe.__webglTexture&&(n.deleteTexture(qe.__webglTexture),o.memory.textures--),r.remove(V[pe])}r.remove(V),r.remove($)}let F=0;function z(){F=0}function j(){const $=F;return $>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+$+" texture units while this GPU supports only "+i.maxTextures),F+=1,$}function Y($){const V=[];return V.push($.wrapS),V.push($.wrapT),V.push($.wrapR||0),V.push($.magFilter),V.push($.minFilter),V.push($.anisotropy),V.push($.internalFormat),V.push($.format),V.push($.type),V.push($.generateMipmaps),V.push($.premultiplyAlpha),V.push($.flipY),V.push($.unpackAlignment),V.push($.colorSpace),V.join()}function oe($,V){const ce=r.get($);if($.isVideoTexture&&ot($),$.isRenderTargetTexture===!1&&$.version>0&&ce.__version!==$.version){const ke=$.image;if(ke===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ke.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{De(ce,$,V);return}}t.bindTexture(n.TEXTURE_2D,ce.__webglTexture,n.TEXTURE0+V)}function le($,V){const ce=r.get($);if($.version>0&&ce.__version!==$.version){De(ce,$,V);return}t.bindTexture(n.TEXTURE_2D_ARRAY,ce.__webglTexture,n.TEXTURE0+V)}function X($,V){const ce=r.get($);if($.version>0&&ce.__version!==$.version){De(ce,$,V);return}t.bindTexture(n.TEXTURE_3D,ce.__webglTexture,n.TEXTURE0+V)}function ee($,V){const ce=r.get($);if($.version>0&&ce.__version!==$.version){Ie(ce,$,V);return}t.bindTexture(n.TEXTURE_CUBE_MAP,ce.__webglTexture,n.TEXTURE0+V)}const ie={[Fc]:n.REPEAT,[hi]:n.CLAMP_TO_EDGE,[Md]:n.MIRRORED_REPEAT},fe={[vr]:n.NEAREST,[Mg]:n.NEAREST_MIPMAP_NEAREST,[cd]:n.NEAREST_MIPMAP_LINEAR,[Hn]:n.LINEAR,[Bx]:n.LINEAR_MIPMAP_NEAREST,[Ia]:n.LINEAR_MIPMAP_LINEAR},me={[Wz]:n.NEVER,[Yz]:n.ALWAYS,[$z]:n.LESS,[ZM]:n.LEQUAL,[jz]:n.EQUAL,[Jz]:n.GEQUAL,[Xz]:n.GREATER,[Kz]:n.NOTEQUAL};function he($,V,ce){if(ce?(n.texParameteri($,n.TEXTURE_WRAP_S,ie[V.wrapS]),n.texParameteri($,n.TEXTURE_WRAP_T,ie[V.wrapT]),($===n.TEXTURE_3D||$===n.TEXTURE_2D_ARRAY)&&n.texParameteri($,n.TEXTURE_WRAP_R,ie[V.wrapR]),n.texParameteri($,n.TEXTURE_MAG_FILTER,fe[V.magFilter]),n.texParameteri($,n.TEXTURE_MIN_FILTER,fe[V.minFilter])):(n.texParameteri($,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri($,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),($===n.TEXTURE_3D||$===n.TEXTURE_2D_ARRAY)&&n.texParameteri($,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(V.wrapS!==hi||V.wrapT!==hi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri($,n.TEXTURE_MAG_FILTER,I(V.magFilter)),n.texParameteri($,n.TEXTURE_MIN_FILTER,I(V.minFilter)),V.minFilter!==vr&&V.minFilter!==Hn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),V.compareFunction&&(n.texParameteri($,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri($,n.TEXTURE_COMPARE_FUNC,me[V.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const ke=e.get("EXT_texture_filter_anisotropic");if(V.magFilter===vr||V.minFilter!==cd&&V.minFilter!==Ia||V.type===fi&&e.has("OES_texture_float_linear")===!1||a===!1&&V.type===Qi&&e.has("OES_texture_half_float_linear")===!1)return;(V.anisotropy>1||r.get(V).__currentAnisotropy)&&(n.texParameterf($,ke.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(V.anisotropy,i.getMaxAnisotropy())),r.get(V).__currentAnisotropy=V.anisotropy)}}function Ae($,V){let ce=!1;$.__webglInit===void 0&&($.__webglInit=!0,V.addEventListener("dispose",b));const ke=V.source;let pe=p.get(ke);pe===void 0&&(pe={},p.set(ke,pe));const ye=Y(V);if(ye!==$.__cacheKey){pe[ye]===void 0&&(pe[ye]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,ce=!0),pe[ye].usedTimes++;const qe=pe[$.__cacheKey];qe!==void 0&&(pe[$.__cacheKey].usedTimes--,qe.usedTimes===0&&M(V)),$.__cacheKey=ye,$.__webglTexture=pe[ye].texture}return ce}function De($,V,ce){let ke=n.TEXTURE_2D;(V.isDataArrayTexture||V.isCompressedArrayTexture)&&(ke=n.TEXTURE_2D_ARRAY),V.isData3DTexture&&(ke=n.TEXTURE_3D);const pe=Ae($,V),ye=V.source;t.bindTexture(ke,$.__webglTexture,n.TEXTURE0+ce);const qe=r.get(ye);if(ye.version!==qe.__version||pe===!0){t.activeTexture(n.TEXTURE0+ce);const Ge=Pn.getPrimaries(Pn.workingColorSpace),Ke=V.colorSpace===Bs?null:Pn.getPrimaries(V.colorSpace),yt=V.colorSpace===Bs||Ge===Ke?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,V.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,V.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,yt);const At=g(V)&&_(V.image)===!1;let Ue=A(V.image,At,!1,i.maxTextureSize);Ue=Ze(V,Ue);const Qt=_(Ue)||a,Ht=s.convert(V.format,V.colorSpace);let wt=s.convert(V.type),it=T(V.internalFormat,Ht,wt,V.colorSpace,V.isVideoTexture);he(ke,V,Qt);let at;const Ct=V.mipmaps,bt=a&&V.isVideoTexture!==!0&&it!==JM,Wt=qe.__version===void 0||pe===!0,Gt=O(V,Ue,Qt);if(V.isDepthTexture)it=n.DEPTH_COMPONENT,a?V.type===fi?it=n.DEPTH_COMPONENT32F:V.type===al?it=n.DEPTH_COMPONENT24:V.type===bc?it=n.DEPTH24_STENCIL8:it=n.DEPTH_COMPONENT16:V.type===fi&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),V.format===Mc&&it===n.DEPTH_COMPONENT&&V.type!==Nx&&V.type!==al&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),V.type=al,wt=s.convert(V.type)),V.format===mh&&it===n.DEPTH_COMPONENT&&(it=n.DEPTH_STENCIL,V.type!==bc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),V.type=bc,wt=s.convert(V.type))),Wt&&(bt?t.texStorage2D(n.TEXTURE_2D,1,it,Ue.width,Ue.height):t.texImage2D(n.TEXTURE_2D,0,it,Ue.width,Ue.height,0,Ht,wt,null));else if(V.isDataTexture)if(Ct.length>0&&Qt){bt&&Wt&&t.texStorage2D(n.TEXTURE_2D,Gt,it,Ct[0].width,Ct[0].height);for(let Ee=0,ae=Ct.length;Ee<ae;Ee++)at=Ct[Ee],bt?t.texSubImage2D(n.TEXTURE_2D,Ee,0,0,at.width,at.height,Ht,wt,at.data):t.texImage2D(n.TEXTURE_2D,Ee,it,at.width,at.height,0,Ht,wt,at.data);V.generateMipmaps=!1}else bt?(Wt&&t.texStorage2D(n.TEXTURE_2D,Gt,it,Ue.width,Ue.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ue.width,Ue.height,Ht,wt,Ue.data)):t.texImage2D(n.TEXTURE_2D,0,it,Ue.width,Ue.height,0,Ht,wt,Ue.data);else if(V.isCompressedTexture)if(V.isCompressedArrayTexture){bt&&Wt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Gt,it,Ct[0].width,Ct[0].height,Ue.depth);for(let Ee=0,ae=Ct.length;Ee<ae;Ee++)at=Ct[Ee],V.format!==Ni?Ht!==null?bt?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ee,0,0,0,at.width,at.height,Ue.depth,Ht,at.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Ee,it,at.width,at.height,Ue.depth,0,at.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):bt?t.texSubImage3D(n.TEXTURE_2D_ARRAY,Ee,0,0,0,at.width,at.height,Ue.depth,Ht,wt,at.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Ee,it,at.width,at.height,Ue.depth,0,Ht,wt,at.data)}else{bt&&Wt&&t.texStorage2D(n.TEXTURE_2D,Gt,it,Ct[0].width,Ct[0].height);for(let Ee=0,ae=Ct.length;Ee<ae;Ee++)at=Ct[Ee],V.format!==Ni?Ht!==null?bt?t.compressedTexSubImage2D(n.TEXTURE_2D,Ee,0,0,at.width,at.height,Ht,at.data):t.compressedTexImage2D(n.TEXTURE_2D,Ee,it,at.width,at.height,0,at.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):bt?t.texSubImage2D(n.TEXTURE_2D,Ee,0,0,at.width,at.height,Ht,wt,at.data):t.texImage2D(n.TEXTURE_2D,Ee,it,at.width,at.height,0,Ht,wt,at.data)}else if(V.isDataArrayTexture)bt?(Wt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Gt,it,Ue.width,Ue.height,Ue.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Ue.width,Ue.height,Ue.depth,Ht,wt,Ue.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,it,Ue.width,Ue.height,Ue.depth,0,Ht,wt,Ue.data);else if(V.isData3DTexture)bt?(Wt&&t.texStorage3D(n.TEXTURE_3D,Gt,it,Ue.width,Ue.height,Ue.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Ue.width,Ue.height,Ue.depth,Ht,wt,Ue.data)):t.texImage3D(n.TEXTURE_3D,0,it,Ue.width,Ue.height,Ue.depth,0,Ht,wt,Ue.data);else if(V.isFramebufferTexture){if(Wt)if(bt)t.texStorage2D(n.TEXTURE_2D,Gt,it,Ue.width,Ue.height);else{let Ee=Ue.width,ae=Ue.height;for(let tt=0;tt<Gt;tt++)t.texImage2D(n.TEXTURE_2D,tt,it,Ee,ae,0,Ht,wt,null),Ee>>=1,ae>>=1}}else if(Ct.length>0&&Qt){bt&&Wt&&t.texStorage2D(n.TEXTURE_2D,Gt,it,Ct[0].width,Ct[0].height);for(let Ee=0,ae=Ct.length;Ee<ae;Ee++)at=Ct[Ee],bt?t.texSubImage2D(n.TEXTURE_2D,Ee,0,0,Ht,wt,at):t.texImage2D(n.TEXTURE_2D,Ee,it,Ht,wt,at);V.generateMipmaps=!1}else bt?(Wt&&t.texStorage2D(n.TEXTURE_2D,Gt,it,Ue.width,Ue.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ht,wt,Ue)):t.texImage2D(n.TEXTURE_2D,0,it,Ht,wt,Ue);E(V,Qt)&&x(ke),qe.__version=ye.version,V.onUpdate&&V.onUpdate(V)}$.__version=V.version}function Ie($,V,ce){if(V.image.length!==6)return;const ke=Ae($,V),pe=V.source;t.bindTexture(n.TEXTURE_CUBE_MAP,$.__webglTexture,n.TEXTURE0+ce);const ye=r.get(pe);if(pe.version!==ye.__version||ke===!0){t.activeTexture(n.TEXTURE0+ce);const qe=Pn.getPrimaries(Pn.workingColorSpace),Ge=V.colorSpace===Bs?null:Pn.getPrimaries(V.colorSpace),Ke=V.colorSpace===Bs||qe===Ge?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,V.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,V.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ke);const yt=V.isCompressedTexture||V.image[0].isCompressedTexture,At=V.image[0]&&V.image[0].isDataTexture,Ue=[];for(let Ee=0;Ee<6;Ee++)!yt&&!At?Ue[Ee]=A(V.image[Ee],!1,!0,i.maxCubemapSize):Ue[Ee]=At?V.image[Ee].image:V.image[Ee],Ue[Ee]=Ze(V,Ue[Ee]);const Qt=Ue[0],Ht=_(Qt)||a,wt=s.convert(V.format,V.colorSpace),it=s.convert(V.type),at=T(V.internalFormat,wt,it,V.colorSpace),Ct=a&&V.isVideoTexture!==!0,bt=ye.__version===void 0||ke===!0;let Wt=O(V,Qt,Ht);he(n.TEXTURE_CUBE_MAP,V,Ht);let Gt;if(yt){Ct&&bt&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Wt,at,Qt.width,Qt.height);for(let Ee=0;Ee<6;Ee++){Gt=Ue[Ee].mipmaps;for(let ae=0;ae<Gt.length;ae++){const tt=Gt[ae];V.format!==Ni?wt!==null?Ct?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,ae,0,0,tt.width,tt.height,wt,tt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,ae,at,tt.width,tt.height,0,tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ct?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,ae,0,0,tt.width,tt.height,wt,it,tt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,ae,at,tt.width,tt.height,0,wt,it,tt.data)}}}else{Gt=V.mipmaps,Ct&&bt&&(Gt.length>0&&Wt++,t.texStorage2D(n.TEXTURE_CUBE_MAP,Wt,at,Ue[0].width,Ue[0].height));for(let Ee=0;Ee<6;Ee++)if(At){Ct?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0,0,0,Ue[Ee].width,Ue[Ee].height,wt,it,Ue[Ee].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0,at,Ue[Ee].width,Ue[Ee].height,0,wt,it,Ue[Ee].data);for(let ae=0;ae<Gt.length;ae++){const $e=Gt[ae].image[Ee].image;Ct?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,ae+1,0,0,$e.width,$e.height,wt,it,$e.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,ae+1,at,$e.width,$e.height,0,wt,it,$e.data)}}else{Ct?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0,0,0,wt,it,Ue[Ee]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0,at,wt,it,Ue[Ee]);for(let ae=0;ae<Gt.length;ae++){const tt=Gt[ae];Ct?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,ae+1,0,0,wt,it,tt.image[Ee]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,ae+1,at,wt,it,tt.image[Ee])}}}E(V,Ht)&&x(n.TEXTURE_CUBE_MAP),ye.__version=pe.version,V.onUpdate&&V.onUpdate(V)}$.__version=V.version}function He($,V,ce,ke,pe,ye){const qe=s.convert(ce.format,ce.colorSpace),Ge=s.convert(ce.type),Ke=T(ce.internalFormat,qe,Ge,ce.colorSpace);if(!r.get(V).__hasExternalTextures){const At=Math.max(1,V.width>>ye),Ue=Math.max(1,V.height>>ye);pe===n.TEXTURE_3D||pe===n.TEXTURE_2D_ARRAY?t.texImage3D(pe,ye,Ke,At,Ue,V.depth,0,qe,Ge,null):t.texImage2D(pe,ye,Ke,At,Ue,0,qe,Ge,null)}t.bindFramebuffer(n.FRAMEBUFFER,$),Me(V)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ke,pe,r.get(ce).__webglTexture,0,Ne(V)):(pe===n.TEXTURE_2D||pe>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&pe<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,ke,pe,r.get(ce).__webglTexture,ye),t.bindFramebuffer(n.FRAMEBUFFER,null)}function rt($,V,ce){if(n.bindRenderbuffer(n.RENDERBUFFER,$),V.depthBuffer&&!V.stencilBuffer){let ke=a===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(ce||Me(V)){const pe=V.depthTexture;pe&&pe.isDepthTexture&&(pe.type===fi?ke=n.DEPTH_COMPONENT32F:pe.type===al&&(ke=n.DEPTH_COMPONENT24));const ye=Ne(V);Me(V)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ye,ke,V.width,V.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,ye,ke,V.width,V.height)}else n.renderbufferStorage(n.RENDERBUFFER,ke,V.width,V.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,$)}else if(V.depthBuffer&&V.stencilBuffer){const ke=Ne(V);ce&&Me(V)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,ke,n.DEPTH24_STENCIL8,V.width,V.height):Me(V)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ke,n.DEPTH24_STENCIL8,V.width,V.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,V.width,V.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,$)}else{const ke=V.isWebGLMultipleRenderTargets===!0?V.texture:[V.texture];for(let pe=0;pe<ke.length;pe++){const ye=ke[pe],qe=s.convert(ye.format,ye.colorSpace),Ge=s.convert(ye.type),Ke=T(ye.internalFormat,qe,Ge,ye.colorSpace),yt=Ne(V);ce&&Me(V)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,yt,Ke,V.width,V.height):Me(V)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,yt,Ke,V.width,V.height):n.renderbufferStorage(n.RENDERBUFFER,Ke,V.width,V.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function vt($,V){if(V&&V.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,$),!(V.depthTexture&&V.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(V.depthTexture).__webglTexture||V.depthTexture.image.width!==V.width||V.depthTexture.image.height!==V.height)&&(V.depthTexture.image.width=V.width,V.depthTexture.image.height=V.height,V.depthTexture.needsUpdate=!0),oe(V.depthTexture,0);const ke=r.get(V.depthTexture).__webglTexture,pe=Ne(V);if(V.depthTexture.format===Mc)Me(V)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ke,0,pe):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ke,0);else if(V.depthTexture.format===mh)Me(V)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ke,0,pe):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ke,0);else throw new Error("Unknown depthTexture format")}function Qe($){const V=r.get($),ce=$.isWebGLCubeRenderTarget===!0;if($.depthTexture&&!V.__autoAllocateDepthBuffer){if(ce)throw new Error("target.depthTexture not supported in Cube render targets");vt(V.__webglFramebuffer,$)}else if(ce){V.__webglDepthbuffer=[];for(let ke=0;ke<6;ke++)t.bindFramebuffer(n.FRAMEBUFFER,V.__webglFramebuffer[ke]),V.__webglDepthbuffer[ke]=n.createRenderbuffer(),rt(V.__webglDepthbuffer[ke],$,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,V.__webglFramebuffer),V.__webglDepthbuffer=n.createRenderbuffer(),rt(V.__webglDepthbuffer,$,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Xe($,V,ce){const ke=r.get($);V!==void 0&&He(ke.__webglFramebuffer,$,$.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),ce!==void 0&&Qe($)}function te($){const V=$.texture,ce=r.get($),ke=r.get(V);$.addEventListener("dispose",R),$.isWebGLMultipleRenderTargets!==!0&&(ke.__webglTexture===void 0&&(ke.__webglTexture=n.createTexture()),ke.__version=V.version,o.memory.textures++);const pe=$.isWebGLCubeRenderTarget===!0,ye=$.isWebGLMultipleRenderTargets===!0,qe=_($)||a;if(pe){ce.__webglFramebuffer=[];for(let Ge=0;Ge<6;Ge++)if(a&&V.mipmaps&&V.mipmaps.length>0){ce.__webglFramebuffer[Ge]=[];for(let Ke=0;Ke<V.mipmaps.length;Ke++)ce.__webglFramebuffer[Ge][Ke]=n.createFramebuffer()}else ce.__webglFramebuffer[Ge]=n.createFramebuffer()}else{if(a&&V.mipmaps&&V.mipmaps.length>0){ce.__webglFramebuffer=[];for(let Ge=0;Ge<V.mipmaps.length;Ge++)ce.__webglFramebuffer[Ge]=n.createFramebuffer()}else ce.__webglFramebuffer=n.createFramebuffer();if(ye)if(i.drawBuffers){const Ge=$.texture;for(let Ke=0,yt=Ge.length;Ke<yt;Ke++){const At=r.get(Ge[Ke]);At.__webglTexture===void 0&&(At.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&$.samples>0&&Me($)===!1){const Ge=ye?V:[V];ce.__webglMultisampledFramebuffer=n.createFramebuffer(),ce.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ce.__webglMultisampledFramebuffer);for(let Ke=0;Ke<Ge.length;Ke++){const yt=Ge[Ke];ce.__webglColorRenderbuffer[Ke]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ce.__webglColorRenderbuffer[Ke]);const At=s.convert(yt.format,yt.colorSpace),Ue=s.convert(yt.type),Qt=T(yt.internalFormat,At,Ue,yt.colorSpace,$.isXRRenderTarget===!0),Ht=Ne($);n.renderbufferStorageMultisample(n.RENDERBUFFER,Ht,Qt,$.width,$.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ke,n.RENDERBUFFER,ce.__webglColorRenderbuffer[Ke])}n.bindRenderbuffer(n.RENDERBUFFER,null),$.depthBuffer&&(ce.__webglDepthRenderbuffer=n.createRenderbuffer(),rt(ce.__webglDepthRenderbuffer,$,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(pe){t.bindTexture(n.TEXTURE_CUBE_MAP,ke.__webglTexture),he(n.TEXTURE_CUBE_MAP,V,qe);for(let Ge=0;Ge<6;Ge++)if(a&&V.mipmaps&&V.mipmaps.length>0)for(let Ke=0;Ke<V.mipmaps.length;Ke++)He(ce.__webglFramebuffer[Ge][Ke],$,V,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,Ke);else He(ce.__webglFramebuffer[Ge],$,V,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0);E(V,qe)&&x(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ye){const Ge=$.texture;for(let Ke=0,yt=Ge.length;Ke<yt;Ke++){const At=Ge[Ke],Ue=r.get(At);t.bindTexture(n.TEXTURE_2D,Ue.__webglTexture),he(n.TEXTURE_2D,At,qe),He(ce.__webglFramebuffer,$,At,n.COLOR_ATTACHMENT0+Ke,n.TEXTURE_2D,0),E(At,qe)&&x(n.TEXTURE_2D)}t.unbindTexture()}else{let Ge=n.TEXTURE_2D;if(($.isWebGL3DRenderTarget||$.isWebGLArrayRenderTarget)&&(a?Ge=$.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ge,ke.__webglTexture),he(Ge,V,qe),a&&V.mipmaps&&V.mipmaps.length>0)for(let Ke=0;Ke<V.mipmaps.length;Ke++)He(ce.__webglFramebuffer[Ke],$,V,n.COLOR_ATTACHMENT0,Ge,Ke);else He(ce.__webglFramebuffer,$,V,n.COLOR_ATTACHMENT0,Ge,0);E(V,qe)&&x(Ge),t.unbindTexture()}$.depthBuffer&&Qe($)}function Le($){const V=_($)||a,ce=$.isWebGLMultipleRenderTargets===!0?$.texture:[$.texture];for(let ke=0,pe=ce.length;ke<pe;ke++){const ye=ce[ke];if(E(ye,V)){const qe=$.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ge=r.get(ye).__webglTexture;t.bindTexture(qe,Ge),x(qe),t.unbindTexture()}}}function be($){if(a&&$.samples>0&&Me($)===!1){const V=$.isWebGLMultipleRenderTargets?$.texture:[$.texture],ce=$.width,ke=$.height;let pe=n.COLOR_BUFFER_BIT;const ye=[],qe=$.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ge=r.get($),Ke=$.isWebGLMultipleRenderTargets===!0;if(Ke)for(let yt=0;yt<V.length;yt++)t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+yt,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+yt,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ge.__webglFramebuffer);for(let yt=0;yt<V.length;yt++){ye.push(n.COLOR_ATTACHMENT0+yt),$.depthBuffer&&ye.push(qe);const At=Ge.__ignoreDepthValues!==void 0?Ge.__ignoreDepthValues:!1;if(At===!1&&($.depthBuffer&&(pe|=n.DEPTH_BUFFER_BIT),$.stencilBuffer&&(pe|=n.STENCIL_BUFFER_BIT)),Ke&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ge.__webglColorRenderbuffer[yt]),At===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[qe]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[qe])),Ke){const Ue=r.get(V[yt]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Ue,0)}n.blitFramebuffer(0,0,ce,ke,0,0,ce,ke,pe,n.NEAREST),c&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,ye)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Ke)for(let yt=0;yt<V.length;yt++){t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+yt,n.RENDERBUFFER,Ge.__webglColorRenderbuffer[yt]);const At=r.get(V[yt]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+yt,n.TEXTURE_2D,At,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ge.__webglMultisampledFramebuffer)}}function Ne($){return Math.min(i.maxSamples,$.samples)}function Me($){const V=r.get($);return a&&$.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&V.__useRenderToTexture!==!1}function ot($){const V=o.render.frame;u.get($)!==V&&(u.set($,V),$.update())}function Ze($,V){const ce=$.colorSpace,ke=$.format,pe=$.type;return $.isCompressedTexture===!0||$.isVideoTexture===!0||$.format===OE||ce!==Pa&&ce!==Bs&&(Pn.getTransfer(ce)===Wn?a===!1?e.has("EXT_sRGB")===!0&&ke===Ni?($.format=OE,$.minFilter=Hn,$.generateMipmaps=!1):V=tR.sRGBToLinear(V):(ke!==Ni||pe!==Aa)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ce)),V}this.allocateTextureUnit=j,this.resetTextureUnits=z,this.setTexture2D=oe,this.setTexture2DArray=le,this.setTexture3D=X,this.setTextureCube=ee,this.rebindTextures=Xe,this.setupRenderTarget=te,this.updateRenderTargetMipmap=Le,this.updateMultisampleRenderTarget=be,this.setupDepthRenderbuffer=Qe,this.setupFrameBufferTexture=He,this.useMultisampledRTT=Me}function uH(n,e,t){const r=t.isWebGL2;function i(s,o=Bs){let a;const l=Pn.getTransfer(o);if(s===Aa)return n.UNSIGNED_BYTE;if(s===GM)return n.UNSIGNED_SHORT_4_4_4_4;if(s===WM)return n.UNSIGNED_SHORT_5_5_5_1;if(s===Iz)return n.BYTE;if(s===Pz)return n.SHORT;if(s===Nx)return n.UNSIGNED_SHORT;if(s===VM)return n.INT;if(s===al)return n.UNSIGNED_INT;if(s===fi)return n.FLOAT;if(s===Qi)return r?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===Dz)return n.ALPHA;if(s===Ni)return n.RGBA;if(s===Lz)return n.LUMINANCE;if(s===Oz)return n.LUMINANCE_ALPHA;if(s===Mc)return n.DEPTH_COMPONENT;if(s===mh)return n.DEPTH_STENCIL;if(s===OE)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===$M)return n.RED;if(s===jM)return n.RED_INTEGER;if(s===Bz)return n.RG;if(s===XM)return n.RG_INTEGER;if(s===KM)return n.RGBA_INTEGER;if(s===R_||s===I_||s===P_||s===D_)if(l===Wn)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===R_)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===I_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===P_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===D_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===R_)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===I_)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===P_)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===D_)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===FT||s===UT||s===zT||s===HT)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===FT)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===UT)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===zT)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===HT)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===JM)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===VT||s===GT)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===VT)return l===Wn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===GT)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===WT||s===$T||s===jT||s===XT||s===KT||s===JT||s===YT||s===qT||s===QT||s===ZT||s===eC||s===tC||s===nC||s===rC)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===WT)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===$T)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===jT)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===XT)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===KT)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===JT)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===YT)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===qT)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===QT)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===ZT)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===eC)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===tC)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===nC)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===rC)return l===Wn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===L_||s===iC||s===sC)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===L_)return l===Wn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===iC)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===sC)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===Nz||s===oC||s===aC||s===lC)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===L_)return a.COMPRESSED_RED_RGTC1_EXT;if(s===oC)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===aC)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===lC)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===bc?r?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:i}}class hH extends Mr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class ll extends dn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const yie={type:"move"};class yw{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ll,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ll,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new J,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new J),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ll,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new J,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new J),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const A of e.hand.values()){const _=t.getJointPose(A,r),g=this._getHandJoint(c,A);_!==null&&(g.matrix.fromArray(_.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=_.radius),g.visible=_!==null}const u=c.joints["index-finger-tip"],f=c.joints["thumb-tip"],p=u.position.distanceTo(f.position),m=.02,y=.005;c.inputState.pinching&&p>m+y?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&p<=m-y&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(yie)))}return a!==null&&(a.visible=i!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new ll;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class vie extends Dl{constructor(e,t){super();const r=this;let i=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,f=null,p=null,m=null,y=null;const A=t.getContextAttributes();let _=null,g=null;const E=[],x=[],T=new Be;let O=null;const I=new Mr;I.layers.enable(1),I.viewport=new In;const b=new Mr;b.layers.enable(2),b.viewport=new In;const R=[I,b],C=new hH;C.layers.enable(1),C.layers.enable(2);let M=null,B=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(he){let Ae=E[he];return Ae===void 0&&(Ae=new yw,E[he]=Ae),Ae.getTargetRaySpace()},this.getControllerGrip=function(he){let Ae=E[he];return Ae===void 0&&(Ae=new yw,E[he]=Ae),Ae.getGripSpace()},this.getHand=function(he){let Ae=E[he];return Ae===void 0&&(Ae=new yw,E[he]=Ae),Ae.getHandSpace()};function F(he){const Ae=x.indexOf(he.inputSource);if(Ae===-1)return;const De=E[Ae];De!==void 0&&(De.update(he.inputSource,he.frame,c||o),De.dispatchEvent({type:he.type,data:he.inputSource}))}function z(){i.removeEventListener("select",F),i.removeEventListener("selectstart",F),i.removeEventListener("selectend",F),i.removeEventListener("squeeze",F),i.removeEventListener("squeezestart",F),i.removeEventListener("squeezeend",F),i.removeEventListener("end",z),i.removeEventListener("inputsourceschange",j);for(let he=0;he<E.length;he++){const Ae=x[he];Ae!==null&&(x[he]=null,E[he].disconnect(Ae))}M=null,B=null,e.setRenderTarget(_),m=null,p=null,f=null,i=null,g=null,me.stop(),r.isPresenting=!1,e.setPixelRatio(O),e.setSize(T.width,T.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(he){s=he,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(he){a=he,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(he){c=he},this.getBaseLayer=function(){return p!==null?p:m},this.getBinding=function(){return f},this.getFrame=function(){return y},this.getSession=function(){return i},this.setSession=async function(he){if(i=he,i!==null){if(_=e.getRenderTarget(),i.addEventListener("select",F),i.addEventListener("selectstart",F),i.addEventListener("selectend",F),i.addEventListener("squeeze",F),i.addEventListener("squeezestart",F),i.addEventListener("squeezeend",F),i.addEventListener("end",z),i.addEventListener("inputsourceschange",j),A.xrCompatible!==!0&&await t.makeXRCompatible(),O=e.getPixelRatio(),e.getSize(T),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Ae={antialias:i.renderState.layers===void 0?A.antialias:!0,alpha:!0,depth:A.depth,stencil:A.stencil,framebufferScaleFactor:s};m=new XRWebGLLayer(i,t,Ae),i.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),g=new Yo(m.framebufferWidth,m.framebufferHeight,{format:Ni,type:Aa,colorSpace:e.outputColorSpace,stencilBuffer:A.stencil})}else{let Ae=null,De=null,Ie=null;A.depth&&(Ie=A.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ae=A.stencil?mh:Mc,De=A.stencil?bc:al);const He={colorFormat:t.RGBA8,depthFormat:Ie,scaleFactor:s};f=new XRWebGLBinding(i,t),p=f.createProjectionLayer(He),i.updateRenderState({layers:[p]}),e.setPixelRatio(1),e.setSize(p.textureWidth,p.textureHeight,!1),g=new Yo(p.textureWidth,p.textureHeight,{format:Ni,type:Aa,depthTexture:new aR(p.textureWidth,p.textureHeight,De,void 0,void 0,void 0,void 0,void 0,void 0,Ae),stencilBuffer:A.stencil,colorSpace:e.outputColorSpace,samples:A.antialias?4:0});const rt=e.properties.get(g);rt.__ignoreDepthValues=p.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await i.requestReferenceSpace(a),me.setContext(i),me.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode};function j(he){for(let Ae=0;Ae<he.removed.length;Ae++){const De=he.removed[Ae],Ie=x.indexOf(De);Ie>=0&&(x[Ie]=null,E[Ie].disconnect(De))}for(let Ae=0;Ae<he.added.length;Ae++){const De=he.added[Ae];let Ie=x.indexOf(De);if(Ie===-1){for(let rt=0;rt<E.length;rt++)if(rt>=x.length){x.push(De),Ie=rt;break}else if(x[rt]===null){x[rt]=De,Ie=rt;break}if(Ie===-1)break}const He=E[Ie];He&&He.connect(De)}}const Y=new J,oe=new J;function le(he,Ae,De){Y.setFromMatrixPosition(Ae.matrixWorld),oe.setFromMatrixPosition(De.matrixWorld);const Ie=Y.distanceTo(oe),He=Ae.projectionMatrix.elements,rt=De.projectionMatrix.elements,vt=He[14]/(He[10]-1),Qe=He[14]/(He[10]+1),Xe=(He[9]+1)/He[5],te=(He[9]-1)/He[5],Le=(He[8]-1)/He[0],be=(rt[8]+1)/rt[0],Ne=vt*Le,Me=vt*be,ot=Ie/(-Le+be),Ze=ot*-Le;Ae.matrixWorld.decompose(he.position,he.quaternion,he.scale),he.translateX(Ze),he.translateZ(ot),he.matrixWorld.compose(he.position,he.quaternion,he.scale),he.matrixWorldInverse.copy(he.matrixWorld).invert();const $=vt+ot,V=Qe+ot,ce=Ne-Ze,ke=Me+(Ie-Ze),pe=Xe*Qe/V*$,ye=te*Qe/V*$;he.projectionMatrix.makePerspective(ce,ke,pe,ye,$,V),he.projectionMatrixInverse.copy(he.projectionMatrix).invert()}function X(he,Ae){Ae===null?he.matrixWorld.copy(he.matrix):he.matrixWorld.multiplyMatrices(Ae.matrixWorld,he.matrix),he.matrixWorldInverse.copy(he.matrixWorld).invert()}this.updateCamera=function(he){if(i===null)return;C.near=b.near=I.near=he.near,C.far=b.far=I.far=he.far,(M!==C.near||B!==C.far)&&(i.updateRenderState({depthNear:C.near,depthFar:C.far}),M=C.near,B=C.far);const Ae=he.parent,De=C.cameras;X(C,Ae);for(let Ie=0;Ie<De.length;Ie++)X(De[Ie],Ae);De.length===2?le(C,I,b):C.projectionMatrix.copy(I.projectionMatrix),ee(he,C,Ae)};function ee(he,Ae,De){De===null?he.matrix.copy(Ae.matrixWorld):(he.matrix.copy(De.matrixWorld),he.matrix.invert(),he.matrix.multiply(Ae.matrixWorld)),he.matrix.decompose(he.position,he.quaternion,he.scale),he.updateMatrixWorld(!0),he.projectionMatrix.copy(Ae.projectionMatrix),he.projectionMatrixInverse.copy(Ae.projectionMatrixInverse),he.isPerspectiveCamera&&(he.fov=Pd*2*Math.atan(1/he.projectionMatrix.elements[5]),he.zoom=1)}this.getCamera=function(){return C},this.getFoveation=function(){if(!(p===null&&m===null))return l},this.setFoveation=function(he){l=he,p!==null&&(p.fixedFoveation=he),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=he)};let ie=null;function fe(he,Ae){if(u=Ae.getViewerPose(c||o),y=Ae,u!==null){const De=u.views;m!==null&&(e.setRenderTargetFramebuffer(g,m.framebuffer),e.setRenderTarget(g));let Ie=!1;De.length!==C.cameras.length&&(C.cameras.length=0,Ie=!0);for(let He=0;He<De.length;He++){const rt=De[He];let vt=null;if(m!==null)vt=m.getViewport(rt);else{const Xe=f.getViewSubImage(p,rt);vt=Xe.viewport,He===0&&(e.setRenderTargetTextures(g,Xe.colorTexture,p.ignoreDepthValues?void 0:Xe.depthStencilTexture),e.setRenderTarget(g))}let Qe=R[He];Qe===void 0&&(Qe=new Mr,Qe.layers.enable(He),Qe.viewport=new In,R[He]=Qe),Qe.matrix.fromArray(rt.transform.matrix),Qe.matrix.decompose(Qe.position,Qe.quaternion,Qe.scale),Qe.projectionMatrix.fromArray(rt.projectionMatrix),Qe.projectionMatrixInverse.copy(Qe.projectionMatrix).invert(),Qe.viewport.set(vt.x,vt.y,vt.width,vt.height),He===0&&(C.matrix.copy(Qe.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),Ie===!0&&C.cameras.push(Qe)}}for(let De=0;De<E.length;De++){const Ie=x[De],He=E[De];Ie!==null&&He!==void 0&&He.update(Ie,Ae,c||o)}ie&&ie(he,Ae),Ae.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:Ae}),y=null}const me=new iH;me.setAnimationLoop(fe),this.setAnimationLoop=function(he){ie=he},this.dispose=function(){}}}function _ie(n,e){function t(_,g){_.matrixAutoUpdate===!0&&_.updateMatrix(),g.value.copy(_.matrix)}function r(_,g){g.color.getRGB(_.fogColor.value,tH(n)),g.isFog?(_.fogNear.value=g.near,_.fogFar.value=g.far):g.isFogExp2&&(_.fogDensity.value=g.density)}function i(_,g,E,x,T){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(_,g):g.isMeshToonMaterial?(s(_,g),f(_,g)):g.isMeshPhongMaterial?(s(_,g),u(_,g)):g.isMeshStandardMaterial?(s(_,g),p(_,g),g.isMeshPhysicalMaterial&&m(_,g,T)):g.isMeshMatcapMaterial?(s(_,g),y(_,g)):g.isMeshDepthMaterial?s(_,g):g.isMeshDistanceMaterial?(s(_,g),A(_,g)):g.isMeshNormalMaterial?s(_,g):g.isLineBasicMaterial?(o(_,g),g.isLineDashedMaterial&&a(_,g)):g.isPointsMaterial?l(_,g,E,x):g.isSpriteMaterial?c(_,g):g.isShadowMaterial?(_.color.value.copy(g.color),_.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function s(_,g){_.opacity.value=g.opacity,g.color&&_.diffuse.value.copy(g.color),g.emissive&&_.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(_.map.value=g.map,t(g.map,_.mapTransform)),g.alphaMap&&(_.alphaMap.value=g.alphaMap,t(g.alphaMap,_.alphaMapTransform)),g.bumpMap&&(_.bumpMap.value=g.bumpMap,t(g.bumpMap,_.bumpMapTransform),_.bumpScale.value=g.bumpScale,g.side===ns&&(_.bumpScale.value*=-1)),g.normalMap&&(_.normalMap.value=g.normalMap,t(g.normalMap,_.normalMapTransform),_.normalScale.value.copy(g.normalScale),g.side===ns&&_.normalScale.value.negate()),g.displacementMap&&(_.displacementMap.value=g.displacementMap,t(g.displacementMap,_.displacementMapTransform),_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias),g.emissiveMap&&(_.emissiveMap.value=g.emissiveMap,t(g.emissiveMap,_.emissiveMapTransform)),g.specularMap&&(_.specularMap.value=g.specularMap,t(g.specularMap,_.specularMapTransform)),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);const E=e.get(g).envMap;if(E&&(_.envMap.value=E,_.flipEnvMap.value=E.isCubeTexture&&E.isRenderTargetTexture===!1?-1:1,_.reflectivity.value=g.reflectivity,_.ior.value=g.ior,_.refractionRatio.value=g.refractionRatio),g.lightMap){_.lightMap.value=g.lightMap;const x=n._useLegacyLights===!0?Math.PI:1;_.lightMapIntensity.value=g.lightMapIntensity*x,t(g.lightMap,_.lightMapTransform)}g.aoMap&&(_.aoMap.value=g.aoMap,_.aoMapIntensity.value=g.aoMapIntensity,t(g.aoMap,_.aoMapTransform))}function o(_,g){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,g.map&&(_.map.value=g.map,t(g.map,_.mapTransform))}function a(_,g){_.dashSize.value=g.dashSize,_.totalSize.value=g.dashSize+g.gapSize,_.scale.value=g.scale}function l(_,g,E,x){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,_.size.value=g.size*E,_.scale.value=x*.5,g.map&&(_.map.value=g.map,t(g.map,_.uvTransform)),g.alphaMap&&(_.alphaMap.value=g.alphaMap,t(g.alphaMap,_.alphaMapTransform)),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest)}function c(_,g){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,_.rotation.value=g.rotation,g.map&&(_.map.value=g.map,t(g.map,_.mapTransform)),g.alphaMap&&(_.alphaMap.value=g.alphaMap,t(g.alphaMap,_.alphaMapTransform)),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest)}function u(_,g){_.specular.value.copy(g.specular),_.shininess.value=Math.max(g.shininess,1e-4)}function f(_,g){g.gradientMap&&(_.gradientMap.value=g.gradientMap)}function p(_,g){_.metalness.value=g.metalness,g.metalnessMap&&(_.metalnessMap.value=g.metalnessMap,t(g.metalnessMap,_.metalnessMapTransform)),_.roughness.value=g.roughness,g.roughnessMap&&(_.roughnessMap.value=g.roughnessMap,t(g.roughnessMap,_.roughnessMapTransform)),e.get(g).envMap&&(_.envMapIntensity.value=g.envMapIntensity)}function m(_,g,E){_.ior.value=g.ior,g.sheen>0&&(_.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),_.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(_.sheenColorMap.value=g.sheenColorMap,t(g.sheenColorMap,_.sheenColorMapTransform)),g.sheenRoughnessMap&&(_.sheenRoughnessMap.value=g.sheenRoughnessMap,t(g.sheenRoughnessMap,_.sheenRoughnessMapTransform))),g.clearcoat>0&&(_.clearcoat.value=g.clearcoat,_.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(_.clearcoatMap.value=g.clearcoatMap,t(g.clearcoatMap,_.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,t(g.clearcoatRoughnessMap,_.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(_.clearcoatNormalMap.value=g.clearcoatNormalMap,t(g.clearcoatNormalMap,_.clearcoatNormalMapTransform),_.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),g.side===ns&&_.clearcoatNormalScale.value.negate())),g.iridescence>0&&(_.iridescence.value=g.iridescence,_.iridescenceIOR.value=g.iridescenceIOR,_.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(_.iridescenceMap.value=g.iridescenceMap,t(g.iridescenceMap,_.iridescenceMapTransform)),g.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=g.iridescenceThicknessMap,t(g.iridescenceThicknessMap,_.iridescenceThicknessMapTransform))),g.transmission>0&&(_.transmission.value=g.transmission,_.transmissionSamplerMap.value=E.texture,_.transmissionSamplerSize.value.set(E.width,E.height),g.transmissionMap&&(_.transmissionMap.value=g.transmissionMap,t(g.transmissionMap,_.transmissionMapTransform)),_.thickness.value=g.thickness,g.thicknessMap&&(_.thicknessMap.value=g.thicknessMap,t(g.thicknessMap,_.thicknessMapTransform)),_.attenuationDistance.value=g.attenuationDistance,_.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(_.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(_.anisotropyMap.value=g.anisotropyMap,t(g.anisotropyMap,_.anisotropyMapTransform))),_.specularIntensity.value=g.specularIntensity,_.specularColor.value.copy(g.specularColor),g.specularColorMap&&(_.specularColorMap.value=g.specularColorMap,t(g.specularColorMap,_.specularColorMapTransform)),g.specularIntensityMap&&(_.specularIntensityMap.value=g.specularIntensityMap,t(g.specularIntensityMap,_.specularIntensityMapTransform))}function y(_,g){g.matcap&&(_.matcap.value=g.matcap)}function A(_,g){const E=e.get(g).light;_.referencePosition.value.setFromMatrixPosition(E.matrixWorld),_.nearDistance.value=E.shadow.camera.near,_.farDistance.value=E.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function Eie(n,e,t,r){let i={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(E,x){const T=x.program;r.uniformBlockBinding(E,T)}function c(E,x){let T=i[E.id];T===void 0&&(y(E),T=u(E),i[E.id]=T,E.addEventListener("dispose",_));const O=x.program;r.updateUBOMapping(E,O);const I=e.render.frame;s[E.id]!==I&&(p(E),s[E.id]=I)}function u(E){const x=f();E.__bindingPointIndex=x;const T=n.createBuffer(),O=E.__size,I=E.usage;return n.bindBuffer(n.UNIFORM_BUFFER,T),n.bufferData(n.UNIFORM_BUFFER,O,I),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,x,T),T}function f(){for(let E=0;E<a;E++)if(o.indexOf(E)===-1)return o.push(E),E;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(E){const x=i[E.id],T=E.uniforms,O=E.__cache;n.bindBuffer(n.UNIFORM_BUFFER,x);for(let I=0,b=T.length;I<b;I++){const R=Array.isArray(T[I])?T[I]:[T[I]];for(let C=0,M=R.length;C<M;C++){const B=R[C];if(m(B,I,C,O)===!0){const F=B.__offset,z=Array.isArray(B.value)?B.value:[B.value];let j=0;for(let Y=0;Y<z.length;Y++){const oe=z[Y],le=A(oe);typeof oe=="number"||typeof oe=="boolean"?(B.__data[0]=oe,n.bufferSubData(n.UNIFORM_BUFFER,F+j,B.__data)):oe.isMatrix3?(B.__data[0]=oe.elements[0],B.__data[1]=oe.elements[1],B.__data[2]=oe.elements[2],B.__data[3]=0,B.__data[4]=oe.elements[3],B.__data[5]=oe.elements[4],B.__data[6]=oe.elements[5],B.__data[7]=0,B.__data[8]=oe.elements[6],B.__data[9]=oe.elements[7],B.__data[10]=oe.elements[8],B.__data[11]=0):(oe.toArray(B.__data,j),j+=le.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,F,B.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function m(E,x,T,O){const I=E.value,b=x+"_"+T;if(O[b]===void 0)return typeof I=="number"||typeof I=="boolean"?O[b]=I:O[b]=I.clone(),!0;{const R=O[b];if(typeof I=="number"||typeof I=="boolean"){if(R!==I)return O[b]=I,!0}else if(R.equals(I)===!1)return R.copy(I),!0}return!1}function y(E){const x=E.uniforms;let T=0;const O=16;for(let b=0,R=x.length;b<R;b++){const C=Array.isArray(x[b])?x[b]:[x[b]];for(let M=0,B=C.length;M<B;M++){const F=C[M],z=Array.isArray(F.value)?F.value:[F.value];for(let j=0,Y=z.length;j<Y;j++){const oe=z[j],le=A(oe),X=T%O;X!==0&&O-X<le.boundary&&(T+=O-X),F.__data=new Float32Array(le.storage/Float32Array.BYTES_PER_ELEMENT),F.__offset=T,T+=le.storage}}}const I=T%O;return I>0&&(T+=O-I),E.__size=T,E.__cache={},this}function A(E){const x={boundary:0,storage:0};return typeof E=="number"||typeof E=="boolean"?(x.boundary=4,x.storage=4):E.isVector2?(x.boundary=8,x.storage=8):E.isVector3||E.isColor?(x.boundary=16,x.storage=12):E.isVector4?(x.boundary=16,x.storage=16):E.isMatrix3?(x.boundary=48,x.storage=48):E.isMatrix4?(x.boundary=64,x.storage=64):E.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",E),x}function _(E){const x=E.target;x.removeEventListener("dispose",_);const T=o.indexOf(x.__bindingPointIndex);o.splice(T,1),n.deleteBuffer(i[x.id]),delete i[x.id],delete s[x.id]}function g(){for(const E in i)n.deleteBuffer(i[E]);o=[],i={},s={}}return{bind:l,update:c,dispose:g}}class uR{constructor(e={}){const{canvas:t=Qz(),context:r=null,depth:i=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:f=!1}=e;this.isWebGLRenderer=!0;let p;r!==null?p=r.getContextAttributes().alpha:p=o;const m=new Uint32Array(4),y=new Int32Array(4);let A=null,_=null;const g=[],E=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Hr,this._useLegacyLights=!1,this.toneMapping=xa,this.toneMappingExposure=1;const x=this;let T=!1,O=0,I=0,b=null,R=-1,C=null;const M=new In,B=new In;let F=null;const z=new st(0);let j=0,Y=t.width,oe=t.height,le=1,X=null,ee=null;const ie=new In(0,0,Y,oe),fe=new In(0,0,Y,oe);let me=!1;const he=new vy;let Ae=!1,De=!1,Ie=null;const He=new Bt,rt=new Be,vt=new J,Qe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Xe(){return b===null?le:1}let te=r;function Le(U,K){for(let q=0;q<U.length;q++){const re=U[q],Z=t.getContext(re,K);if(Z!==null)return Z}return null}try{const U={alpha:!0,depth:i,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${ep}`),t.addEventListener("webglcontextlost",Ee,!1),t.addEventListener("webglcontextrestored",ae,!1),t.addEventListener("webglcontextcreationerror",tt,!1),te===null){const K=["webgl2","webgl","experimental-webgl"];if(x.isWebGL1Renderer===!0&&K.shift(),te=Le(K,U),te===null)throw Le(K)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&te instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),te.getShaderPrecisionFormat===void 0&&(te.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(U){throw console.error("THREE.WebGLRenderer: "+U.message),U}let be,Ne,Me,ot,Ze,$,V,ce,ke,pe,ye,qe,Ge,Ke,yt,At,Ue,Qt,Ht,wt,it,at,Ct,bt;function Wt(){be=new One(te),Ne=new Mne(te,be,e),be.init(Ne),at=new uH(te,be,Ne),Me=new mie(te,be,Ne),ot=new kne(te),Ze=new rie,$=new gie(te,be,Me,Ze,Ne,at,ot),V=new Ine(x),ce=new Lne(x),ke=new $Z(te,Ne),Ct=new Cne(te,be,ke,Ne),pe=new Bne(te,ke,ot,Ct),ye=new Hne(te,pe,ke,ot),Ht=new zne(te,Ne,$),At=new Rne(Ze),qe=new nie(x,V,ce,be,Ne,Ct,At),Ge=new _ie(x,Ze),Ke=new sie,yt=new hie(be,Ne),Qt=new Tne(x,V,ce,Me,ye,p,l),Ue=new pie(x,ye,Ne),bt=new Eie(te,ot,Ne,Me),wt=new bne(te,be,ot,Ne),it=new Nne(te,be,ot,Ne),ot.programs=qe.programs,x.capabilities=Ne,x.extensions=be,x.properties=Ze,x.renderLists=Ke,x.shadowMap=Ue,x.state=Me,x.info=ot}Wt();const Gt=new vie(x,te);this.xr=Gt,this.getContext=function(){return te},this.getContextAttributes=function(){return te.getContextAttributes()},this.forceContextLoss=function(){const U=be.get("WEBGL_lose_context");U&&U.loseContext()},this.forceContextRestore=function(){const U=be.get("WEBGL_lose_context");U&&U.restoreContext()},this.getPixelRatio=function(){return le},this.setPixelRatio=function(U){U!==void 0&&(le=U,this.setSize(Y,oe,!1))},this.getSize=function(U){return U.set(Y,oe)},this.setSize=function(U,K,q=!0){if(Gt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Y=U,oe=K,t.width=Math.floor(U*le),t.height=Math.floor(K*le),q===!0&&(t.style.width=U+"px",t.style.height=K+"px"),this.setViewport(0,0,U,K)},this.getDrawingBufferSize=function(U){return U.set(Y*le,oe*le).floor()},this.setDrawingBufferSize=function(U,K,q){Y=U,oe=K,le=q,t.width=Math.floor(U*q),t.height=Math.floor(K*q),this.setViewport(0,0,U,K)},this.getCurrentViewport=function(U){return U.copy(M)},this.getViewport=function(U){return U.copy(ie)},this.setViewport=function(U,K,q,re){U.isVector4?ie.set(U.x,U.y,U.z,U.w):ie.set(U,K,q,re),Me.viewport(M.copy(ie).multiplyScalar(le).floor())},this.getScissor=function(U){return U.copy(fe)},this.setScissor=function(U,K,q,re){U.isVector4?fe.set(U.x,U.y,U.z,U.w):fe.set(U,K,q,re),Me.scissor(B.copy(fe).multiplyScalar(le).floor())},this.getScissorTest=function(){return me},this.setScissorTest=function(U){Me.setScissorTest(me=U)},this.setOpaqueSort=function(U){X=U},this.setTransparentSort=function(U){ee=U},this.getClearColor=function(U){return U.copy(Qt.getClearColor())},this.setClearColor=function(){Qt.setClearColor.apply(Qt,arguments)},this.getClearAlpha=function(){return Qt.getClearAlpha()},this.setClearAlpha=function(){Qt.setClearAlpha.apply(Qt,arguments)},this.clear=function(U=!0,K=!0,q=!0){let re=0;if(U){let Z=!1;if(b!==null){const ve=b.texture.format;Z=ve===KM||ve===XM||ve===jM}if(Z){const ve=b.texture.type,we=ve===Aa||ve===al||ve===Nx||ve===bc||ve===GM||ve===WM,Te=Qt.getClearColor(),Se=Qt.getClearAlpha(),ct=Te.r,ze=Te.g,Ve=Te.b;we?(m[0]=ct,m[1]=ze,m[2]=Ve,m[3]=Se,te.clearBufferuiv(te.COLOR,0,m)):(y[0]=ct,y[1]=ze,y[2]=Ve,y[3]=Se,te.clearBufferiv(te.COLOR,0,y))}else re|=te.COLOR_BUFFER_BIT}K&&(re|=te.DEPTH_BUFFER_BIT),q&&(re|=te.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),te.clear(re)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ee,!1),t.removeEventListener("webglcontextrestored",ae,!1),t.removeEventListener("webglcontextcreationerror",tt,!1),Ke.dispose(),yt.dispose(),Ze.dispose(),V.dispose(),ce.dispose(),ye.dispose(),Ct.dispose(),bt.dispose(),qe.dispose(),Gt.dispose(),Gt.removeEventListener("sessionstart",Fn),Gt.removeEventListener("sessionend",An),Ie&&(Ie.dispose(),Ie=null),Ar.stop()};function Ee(U){U.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),T=!0}function ae(){console.log("THREE.WebGLRenderer: Context Restored."),T=!1;const U=ot.autoReset,K=Ue.enabled,q=Ue.autoUpdate,re=Ue.needsUpdate,Z=Ue.type;Wt(),ot.autoReset=U,Ue.enabled=K,Ue.autoUpdate=q,Ue.needsUpdate=re,Ue.type=Z}function tt(U){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",U.statusMessage)}function $e(U){const K=U.target;K.removeEventListener("dispose",$e),Pt(K)}function Pt(U){xt(U),Ze.remove(U)}function xt(U){const K=Ze.get(U).programs;K!==void 0&&(K.forEach(function(q){qe.releaseProgram(q)}),U.isShaderMaterial&&qe.releaseShaderCache(U))}this.renderBufferDirect=function(U,K,q,re,Z,ve){K===null&&(K=Qe);const we=Z.isMesh&&Z.matrixWorld.determinant()<0,Te=H(U,K,q,re,Z);Me.setMaterial(re,we);let Se=q.index,ct=1;if(re.wireframe===!0){if(Se=pe.getWireframeAttribute(q),Se===void 0)return;ct=2}const ze=q.drawRange,Ve=q.attributes.position;let ft=ze.start*ct,St=(ze.start+ze.count)*ct;ve!==null&&(ft=Math.max(ft,ve.start*ct),St=Math.min(St,(ve.start+ve.count)*ct)),Se!==null?(ft=Math.max(ft,0),St=Math.min(St,Se.count)):Ve!=null&&(ft=Math.max(ft,0),St=Math.min(St,Ve.count));const Mt=St-ft;if(Mt<0||Mt===1/0)return;Ct.setup(Z,re,Te,q,Se);let Ft,ut=wt;if(Se!==null&&(Ft=ke.get(Se),ut=it,ut.setIndex(Ft)),Z.isMesh)re.wireframe===!0?(Me.setLineWidth(re.wireframeLinewidth*Xe()),ut.setMode(te.LINES)):ut.setMode(te.TRIANGLES);else if(Z.isLine){let et=re.linewidth;et===void 0&&(et=1),Me.setLineWidth(et*Xe()),Z.isLineSegments?ut.setMode(te.LINES):Z.isLineLoop?ut.setMode(te.LINE_LOOP):ut.setMode(te.LINE_STRIP)}else Z.isPoints?ut.setMode(te.POINTS):Z.isSprite&&ut.setMode(te.TRIANGLES);if(Z.isBatchedMesh)ut.renderMultiDraw(Z._multiDrawStarts,Z._multiDrawCounts,Z._multiDrawCount);else if(Z.isInstancedMesh)ut.renderInstances(ft,Mt,Z.count);else if(q.isInstancedBufferGeometry){const et=q._maxInstanceCount!==void 0?q._maxInstanceCount:1/0,Yt=Math.min(q.instanceCount,et);ut.renderInstances(ft,Mt,Yt)}else ut.render(ft,Mt)};function hn(U,K,q){U.transparent===!0&&U.side===Os&&U.forceSinglePass===!1?(U.side=ns,U.needsUpdate=!0,jt(U,K,q),U.side=Ma,U.needsUpdate=!0,jt(U,K,q),U.side=Os):jt(U,K,q)}this.compile=function(U,K,q=null){q===null&&(q=U),_=yt.get(q),_.init(),E.push(_),q.traverseVisible(function(Z){Z.isLight&&Z.layers.test(K.layers)&&(_.pushLight(Z),Z.castShadow&&_.pushShadow(Z))}),U!==q&&U.traverseVisible(function(Z){Z.isLight&&Z.layers.test(K.layers)&&(_.pushLight(Z),Z.castShadow&&_.pushShadow(Z))}),_.setupLights(x._useLegacyLights);const re=new Set;return U.traverse(function(Z){const ve=Z.material;if(ve)if(Array.isArray(ve))for(let we=0;we<ve.length;we++){const Te=ve[we];hn(Te,q,Z),re.add(Te)}else hn(ve,q,Z),re.add(ve)}),E.pop(),_=null,re},this.compileAsync=function(U,K,q=null){const re=this.compile(U,K,q);return new Promise(Z=>{function ve(){if(re.forEach(function(we){Ze.get(we).currentProgram.isReady()&&re.delete(we)}),re.size===0){Z(U);return}setTimeout(ve,10)}be.get("KHR_parallel_shader_compile")!==null?ve():setTimeout(ve,10)})};let En=null;function Xn(U){En&&En(U)}function Fn(){Ar.stop()}function An(){Ar.start()}const Ar=new iH;Ar.setAnimationLoop(Xn),typeof self<"u"&&Ar.setContext(self),this.setAnimationLoop=function(U){En=U,Gt.setAnimationLoop(U),U===null?Ar.stop():Ar.start()},Gt.addEventListener("sessionstart",Fn),Gt.addEventListener("sessionend",An),this.render=function(U,K){if(K!==void 0&&K.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(T===!0)return;U.matrixWorldAutoUpdate===!0&&U.updateMatrixWorld(),K.parent===null&&K.matrixWorldAutoUpdate===!0&&K.updateMatrixWorld(),Gt.enabled===!0&&Gt.isPresenting===!0&&(Gt.cameraAutoUpdate===!0&&Gt.updateCamera(K),K=Gt.getCamera()),U.isScene===!0&&U.onBeforeRender(x,U,K,b),_=yt.get(U,E.length),_.init(),E.push(_),He.multiplyMatrices(K.projectionMatrix,K.matrixWorldInverse),he.setFromProjectionMatrix(He),De=this.localClippingEnabled,Ae=At.init(this.clippingPlanes,De),A=Ke.get(U,g.length),A.init(),g.push(A),Fr(U,K,0,x.sortObjects),A.finish(),x.sortObjects===!0&&A.sort(X,ee),this.info.render.frame++,Ae===!0&&At.beginShadows();const q=_.state.shadowsArray;if(Ue.render(q,U,K),Ae===!0&&At.endShadows(),this.info.autoReset===!0&&this.info.reset(),Qt.render(A,U),_.setupLights(x._useLegacyLights),K.isArrayCamera){const re=K.cameras;for(let Z=0,ve=re.length;Z<ve;Z++){const we=re[Z];As(A,U,we,we.viewport)}}else As(A,U,K);b!==null&&($.updateMultisampleRenderTarget(b),$.updateRenderTargetMipmap(b)),U.isScene===!0&&U.onAfterRender(x,U,K),Ct.resetDefaultState(),R=-1,C=null,E.pop(),E.length>0?_=E[E.length-1]:_=null,g.pop(),g.length>0?A=g[g.length-1]:A=null};function Fr(U,K,q,re){if(U.visible===!1)return;if(U.layers.test(K.layers)){if(U.isGroup)q=U.renderOrder;else if(U.isLOD)U.autoUpdate===!0&&U.update(K);else if(U.isLight)_.pushLight(U),U.castShadow&&_.pushShadow(U);else if(U.isSprite){if(!U.frustumCulled||he.intersectsSprite(U)){re&&vt.setFromMatrixPosition(U.matrixWorld).applyMatrix4(He);const we=ye.update(U),Te=U.material;Te.visible&&A.push(U,we,Te,q,vt.z,null)}}else if((U.isMesh||U.isLine||U.isPoints)&&(!U.frustumCulled||he.intersectsObject(U))){const we=ye.update(U),Te=U.material;if(re&&(U.boundingSphere!==void 0?(U.boundingSphere===null&&U.computeBoundingSphere(),vt.copy(U.boundingSphere.center)):(we.boundingSphere===null&&we.computeBoundingSphere(),vt.copy(we.boundingSphere.center)),vt.applyMatrix4(U.matrixWorld).applyMatrix4(He)),Array.isArray(Te)){const Se=we.groups;for(let ct=0,ze=Se.length;ct<ze;ct++){const Ve=Se[ct],ft=Te[Ve.materialIndex];ft&&ft.visible&&A.push(U,we,ft,q,vt.z,Ve)}}else Te.visible&&A.push(U,we,Te,q,vt.z,null)}}const ve=U.children;for(let we=0,Te=ve.length;we<Te;we++)Fr(ve[we],K,q,re)}function As(U,K,q,re){const Z=U.opaque,ve=U.transmissive,we=U.transparent;_.setupLightsView(q),Ae===!0&&At.setGlobalState(x.clippingPlanes,q),ve.length>0&&sa(Z,ve,K,q),re&&Me.viewport(M.copy(re)),Z.length>0&&_i(Z,K,q),ve.length>0&&_i(ve,K,q),we.length>0&&_i(we,K,q),Me.buffers.depth.setTest(!0),Me.buffers.depth.setMask(!0),Me.buffers.color.setMask(!0),Me.setPolygonOffset(!1)}function sa(U,K,q,re){if((q.isScene===!0?q.overrideMaterial:null)!==null)return;const ve=Ne.isWebGL2;Ie===null&&(Ie=new Yo(1,1,{generateMipmaps:!0,type:be.has("EXT_color_buffer_half_float")?Qi:Aa,minFilter:Ia,samples:ve?4:0})),x.getDrawingBufferSize(rt),ve?Ie.setSize(rt.x,rt.y):Ie.setSize(BE(rt.x),BE(rt.y));const we=x.getRenderTarget();x.setRenderTarget(Ie),x.getClearColor(z),j=x.getClearAlpha(),j<1&&x.setClearColor(16777215,.5),x.clear();const Te=x.toneMapping;x.toneMapping=xa,_i(U,q,re),$.updateMultisampleRenderTarget(Ie),$.updateRenderTargetMipmap(Ie);let Se=!1;for(let ct=0,ze=K.length;ct<ze;ct++){const Ve=K[ct],ft=Ve.object,St=Ve.geometry,Mt=Ve.material,Ft=Ve.group;if(Mt.side===Os&&ft.layers.test(re.layers)){const ut=Mt.side;Mt.side=ns,Mt.needsUpdate=!0,Ir(ft,q,re,St,Mt,Ft),Mt.side=ut,Mt.needsUpdate=!0,Se=!0}}Se===!0&&($.updateMultisampleRenderTarget(Ie),$.updateRenderTargetMipmap(Ie)),x.setRenderTarget(we),x.setClearColor(z,j),x.toneMapping=Te}function _i(U,K,q){const re=K.isScene===!0?K.overrideMaterial:null;for(let Z=0,ve=U.length;Z<ve;Z++){const we=U[Z],Te=we.object,Se=we.geometry,ct=re===null?we.material:re,ze=we.group;Te.layers.test(q.layers)&&Ir(Te,K,q,Se,ct,ze)}}function Ir(U,K,q,re,Z,ve){U.onBeforeRender(x,K,q,re,Z,ve),U.modelViewMatrix.multiplyMatrices(q.matrixWorldInverse,U.matrixWorld),U.normalMatrix.getNormalMatrix(U.modelViewMatrix),Z.onBeforeRender(x,K,q,re,U,ve),Z.transparent===!0&&Z.side===Os&&Z.forceSinglePass===!1?(Z.side=ns,Z.needsUpdate=!0,x.renderBufferDirect(q,K,re,Z,U,ve),Z.side=Ma,Z.needsUpdate=!0,x.renderBufferDirect(q,K,re,Z,U,ve),Z.side=Os):x.renderBufferDirect(q,K,re,Z,U,ve),U.onAfterRender(x,K,q,re,Z,ve)}function jt(U,K,q){K.isScene!==!0&&(K=Qe);const re=Ze.get(U),Z=_.state.lights,ve=_.state.shadowsArray,we=Z.state.version,Te=qe.getParameters(U,Z.state,ve,K,q),Se=qe.getProgramCacheKey(Te);let ct=re.programs;re.environment=U.isMeshStandardMaterial?K.environment:null,re.fog=K.fog,re.envMap=(U.isMeshStandardMaterial?ce:V).get(U.envMap||re.environment),ct===void 0&&(U.addEventListener("dispose",$e),ct=new Map,re.programs=ct);let ze=ct.get(Se);if(ze!==void 0){if(re.currentProgram===ze&&re.lightsStateVersion===we)return Na(U,Te),ze}else Te.uniforms=qe.getUniforms(U),U.onBuild(q,Te,x),U.onBeforeCompile(Te,x),ze=qe.acquireProgram(Te,Se),ct.set(Se,ze),re.uniforms=Te.uniforms;const Ve=re.uniforms;return(!U.isShaderMaterial&&!U.isRawShaderMaterial||U.clipping===!0)&&(Ve.clippingPlanes=At.uniform),Na(U,Te),re.needsLights=se(U),re.lightsStateVersion=we,re.needsLights&&(Ve.ambientLightColor.value=Z.state.ambient,Ve.lightProbe.value=Z.state.probe,Ve.directionalLights.value=Z.state.directional,Ve.directionalLightShadows.value=Z.state.directionalShadow,Ve.spotLights.value=Z.state.spot,Ve.spotLightShadows.value=Z.state.spotShadow,Ve.rectAreaLights.value=Z.state.rectArea,Ve.ltc_1.value=Z.state.rectAreaLTC1,Ve.ltc_2.value=Z.state.rectAreaLTC2,Ve.pointLights.value=Z.state.point,Ve.pointLightShadows.value=Z.state.pointShadow,Ve.hemisphereLights.value=Z.state.hemi,Ve.directionalShadowMap.value=Z.state.directionalShadowMap,Ve.directionalShadowMatrix.value=Z.state.directionalShadowMatrix,Ve.spotShadowMap.value=Z.state.spotShadowMap,Ve.spotLightMatrix.value=Z.state.spotLightMatrix,Ve.spotLightMap.value=Z.state.spotLightMap,Ve.pointShadowMap.value=Z.state.pointShadowMap,Ve.pointShadowMatrix.value=Z.state.pointShadowMatrix),re.currentProgram=ze,re.uniformsList=null,ze}function Ei(U){if(U.uniformsList===null){const K=U.currentProgram.getUniforms();U.uniformsList=B_.seqWithValue(K.seq,U.uniforms)}return U.uniformsList}function Na(U,K){const q=Ze.get(U);q.outputColorSpace=K.outputColorSpace,q.batching=K.batching,q.instancing=K.instancing,q.instancingColor=K.instancingColor,q.skinning=K.skinning,q.morphTargets=K.morphTargets,q.morphNormals=K.morphNormals,q.morphColors=K.morphColors,q.morphTargetsCount=K.morphTargetsCount,q.numClippingPlanes=K.numClippingPlanes,q.numIntersection=K.numClipIntersection,q.vertexAlphas=K.vertexAlphas,q.vertexTangents=K.vertexTangents,q.toneMapping=K.toneMapping}function H(U,K,q,re,Z){K.isScene!==!0&&(K=Qe),$.resetTextureUnits();const ve=K.fog,we=re.isMeshStandardMaterial?K.environment:null,Te=b===null?x.outputColorSpace:b.isXRRenderTarget===!0?b.texture.colorSpace:Pa,Se=(re.isMeshStandardMaterial?ce:V).get(re.envMap||we),ct=re.vertexColors===!0&&!!q.attributes.color&&q.attributes.color.itemSize===4,ze=!!q.attributes.tangent&&(!!re.normalMap||re.anisotropy>0),Ve=!!q.morphAttributes.position,ft=!!q.morphAttributes.normal,St=!!q.morphAttributes.color;let Mt=xa;re.toneMapped&&(b===null||b.isXRRenderTarget===!0)&&(Mt=x.toneMapping);const Ft=q.morphAttributes.position||q.morphAttributes.normal||q.morphAttributes.color,ut=Ft!==void 0?Ft.length:0,et=Ze.get(re),Yt=_.state.lights;if(Ae===!0&&(De===!0||U!==C)){const Vt=U===C&&re.id===R;At.setState(re,U,Vt)}let Dt=!1;re.version===et.__version?(et.needsLights&&et.lightsStateVersion!==Yt.state.version||et.outputColorSpace!==Te||Z.isBatchedMesh&&et.batching===!1||!Z.isBatchedMesh&&et.batching===!0||Z.isInstancedMesh&&et.instancing===!1||!Z.isInstancedMesh&&et.instancing===!0||Z.isSkinnedMesh&&et.skinning===!1||!Z.isSkinnedMesh&&et.skinning===!0||Z.isInstancedMesh&&et.instancingColor===!0&&Z.instanceColor===null||Z.isInstancedMesh&&et.instancingColor===!1&&Z.instanceColor!==null||et.envMap!==Se||re.fog===!0&&et.fog!==ve||et.numClippingPlanes!==void 0&&(et.numClippingPlanes!==At.numPlanes||et.numIntersection!==At.numIntersection)||et.vertexAlphas!==ct||et.vertexTangents!==ze||et.morphTargets!==Ve||et.morphNormals!==ft||et.morphColors!==St||et.toneMapping!==Mt||Ne.isWebGL2===!0&&et.morphTargetsCount!==ut)&&(Dt=!0):(Dt=!0,et.__version=re.version);let Rt=et.currentProgram;Dt===!0&&(Rt=jt(re,K,Z));let nn=!1,Ln=!1,bn=!1;const un=Rt.getUniforms(),gt=et.uniforms;if(Me.useProgram(Rt.program)&&(nn=!0,Ln=!0,bn=!0),re.id!==R&&(R=re.id,Ln=!0),nn||C!==U){un.setValue(te,"projectionMatrix",U.projectionMatrix),un.setValue(te,"viewMatrix",U.matrixWorldInverse);const Vt=un.map.cameraPosition;Vt!==void 0&&Vt.setValue(te,vt.setFromMatrixPosition(U.matrixWorld)),Ne.logarithmicDepthBuffer&&un.setValue(te,"logDepthBufFC",2/(Math.log(U.far+1)/Math.LN2)),(re.isMeshPhongMaterial||re.isMeshToonMaterial||re.isMeshLambertMaterial||re.isMeshBasicMaterial||re.isMeshStandardMaterial||re.isShaderMaterial)&&un.setValue(te,"isOrthographic",U.isOrthographicCamera===!0),C!==U&&(C=U,Ln=!0,bn=!0)}if(Z.isSkinnedMesh){un.setOptional(te,Z,"bindMatrix"),un.setOptional(te,Z,"bindMatrixInverse");const Vt=Z.skeleton;Vt&&(Ne.floatVertexTextures?(Vt.boneTexture===null&&Vt.computeBoneTexture(),un.setValue(te,"boneTexture",Vt.boneTexture,$)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}Z.isBatchedMesh&&(un.setOptional(te,Z,"batchingTexture"),un.setValue(te,"batchingTexture",Z._matricesTexture,$));const On=q.morphAttributes;if((On.position!==void 0||On.normal!==void 0||On.color!==void 0&&Ne.isWebGL2===!0)&&Ht.update(Z,q,Rt),(Ln||et.receiveShadow!==Z.receiveShadow)&&(et.receiveShadow=Z.receiveShadow,un.setValue(te,"receiveShadow",Z.receiveShadow)),re.isMeshGouraudMaterial&&re.envMap!==null&&(gt.envMap.value=Se,gt.flipEnvMap.value=Se.isCubeTexture&&Se.isRenderTargetTexture===!1?-1:1),Ln&&(un.setValue(te,"toneMappingExposure",x.toneMappingExposure),et.needsLights&&G(gt,bn),ve&&re.fog===!0&&Ge.refreshFogUniforms(gt,ve),Ge.refreshMaterialUniforms(gt,re,le,oe,Ie),B_.upload(te,Ei(et),gt,$)),re.isShaderMaterial&&re.uniformsNeedUpdate===!0&&(B_.upload(te,Ei(et),gt,$),re.uniformsNeedUpdate=!1),re.isSpriteMaterial&&un.setValue(te,"center",Z.center),un.setValue(te,"modelViewMatrix",Z.modelViewMatrix),un.setValue(te,"normalMatrix",Z.normalMatrix),un.setValue(te,"modelMatrix",Z.matrixWorld),re.isShaderMaterial||re.isRawShaderMaterial){const Vt=re.uniformsGroups;for(let qt=0,Bn=Vt.length;qt<Bn;qt++)if(Ne.isWebGL2){const Wi=Vt[qt];bt.update(Wi,Rt),bt.bind(Wi,Rt)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Rt}function G(U,K){U.ambientLightColor.needsUpdate=K,U.lightProbe.needsUpdate=K,U.directionalLights.needsUpdate=K,U.directionalLightShadows.needsUpdate=K,U.pointLights.needsUpdate=K,U.pointLightShadows.needsUpdate=K,U.spotLights.needsUpdate=K,U.spotLightShadows.needsUpdate=K,U.rectAreaLights.needsUpdate=K,U.hemisphereLights.needsUpdate=K}function se(U){return U.isMeshLambertMaterial||U.isMeshToonMaterial||U.isMeshPhongMaterial||U.isMeshStandardMaterial||U.isShadowMaterial||U.isShaderMaterial&&U.lights===!0}this.getActiveCubeFace=function(){return O},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(U,K,q){Ze.get(U.texture).__webglTexture=K,Ze.get(U.depthTexture).__webglTexture=q;const re=Ze.get(U);re.__hasExternalTextures=!0,re.__hasExternalTextures&&(re.__autoAllocateDepthBuffer=q===void 0,re.__autoAllocateDepthBuffer||be.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),re.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(U,K){const q=Ze.get(U);q.__webglFramebuffer=K,q.__useDefaultFramebuffer=K===void 0},this.setRenderTarget=function(U,K=0,q=0){b=U,O=K,I=q;let re=!0,Z=null,ve=!1,we=!1;if(U){const Se=Ze.get(U);Se.__useDefaultFramebuffer!==void 0?(Me.bindFramebuffer(te.FRAMEBUFFER,null),re=!1):Se.__webglFramebuffer===void 0?$.setupRenderTarget(U):Se.__hasExternalTextures&&$.rebindTextures(U,Ze.get(U.texture).__webglTexture,Ze.get(U.depthTexture).__webglTexture);const ct=U.texture;(ct.isData3DTexture||ct.isDataArrayTexture||ct.isCompressedArrayTexture)&&(we=!0);const ze=Ze.get(U).__webglFramebuffer;U.isWebGLCubeRenderTarget?(Array.isArray(ze[K])?Z=ze[K][q]:Z=ze[K],ve=!0):Ne.isWebGL2&&U.samples>0&&$.useMultisampledRTT(U)===!1?Z=Ze.get(U).__webglMultisampledFramebuffer:Array.isArray(ze)?Z=ze[q]:Z=ze,M.copy(U.viewport),B.copy(U.scissor),F=U.scissorTest}else M.copy(ie).multiplyScalar(le).floor(),B.copy(fe).multiplyScalar(le).floor(),F=me;if(Me.bindFramebuffer(te.FRAMEBUFFER,Z)&&Ne.drawBuffers&&re&&Me.drawBuffers(U,Z),Me.viewport(M),Me.scissor(B),Me.setScissorTest(F),ve){const Se=Ze.get(U.texture);te.framebufferTexture2D(te.FRAMEBUFFER,te.COLOR_ATTACHMENT0,te.TEXTURE_CUBE_MAP_POSITIVE_X+K,Se.__webglTexture,q)}else if(we){const Se=Ze.get(U.texture),ct=K||0;te.framebufferTextureLayer(te.FRAMEBUFFER,te.COLOR_ATTACHMENT0,Se.__webglTexture,q||0,ct)}R=-1},this.readRenderTargetPixels=function(U,K,q,re,Z,ve,we){if(!(U&&U.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Te=Ze.get(U).__webglFramebuffer;if(U.isWebGLCubeRenderTarget&&we!==void 0&&(Te=Te[we]),Te){Me.bindFramebuffer(te.FRAMEBUFFER,Te);try{const Se=U.texture,ct=Se.format,ze=Se.type;if(ct!==Ni&&at.convert(ct)!==te.getParameter(te.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Ve=ze===Qi&&(be.has("EXT_color_buffer_half_float")||Ne.isWebGL2&&be.has("EXT_color_buffer_float"));if(ze!==Aa&&at.convert(ze)!==te.getParameter(te.IMPLEMENTATION_COLOR_READ_TYPE)&&!(ze===fi&&(Ne.isWebGL2||be.has("OES_texture_float")||be.has("WEBGL_color_buffer_float")))&&!Ve){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}K>=0&&K<=U.width-re&&q>=0&&q<=U.height-Z&&te.readPixels(K,q,re,Z,at.convert(ct),at.convert(ze),ve)}finally{const Se=b!==null?Ze.get(b).__webglFramebuffer:null;Me.bindFramebuffer(te.FRAMEBUFFER,Se)}}},this.copyFramebufferToTexture=function(U,K,q=0){const re=Math.pow(2,-q),Z=Math.floor(K.image.width*re),ve=Math.floor(K.image.height*re);$.setTexture2D(K,0),te.copyTexSubImage2D(te.TEXTURE_2D,q,0,0,U.x,U.y,Z,ve),Me.unbindTexture()},this.copyTextureToTexture=function(U,K,q,re=0){const Z=K.image.width,ve=K.image.height,we=at.convert(q.format),Te=at.convert(q.type);$.setTexture2D(q,0),te.pixelStorei(te.UNPACK_FLIP_Y_WEBGL,q.flipY),te.pixelStorei(te.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q.premultiplyAlpha),te.pixelStorei(te.UNPACK_ALIGNMENT,q.unpackAlignment),K.isDataTexture?te.texSubImage2D(te.TEXTURE_2D,re,U.x,U.y,Z,ve,we,Te,K.image.data):K.isCompressedTexture?te.compressedTexSubImage2D(te.TEXTURE_2D,re,U.x,U.y,K.mipmaps[0].width,K.mipmaps[0].height,we,K.mipmaps[0].data):te.texSubImage2D(te.TEXTURE_2D,re,U.x,U.y,we,Te,K.image),re===0&&q.generateMipmaps&&te.generateMipmap(te.TEXTURE_2D),Me.unbindTexture()},this.copyTextureToTexture3D=function(U,K,q,re,Z=0){if(x.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const ve=U.max.x-U.min.x+1,we=U.max.y-U.min.y+1,Te=U.max.z-U.min.z+1,Se=at.convert(re.format),ct=at.convert(re.type);let ze;if(re.isData3DTexture)$.setTexture3D(re,0),ze=te.TEXTURE_3D;else if(re.isDataArrayTexture||re.isCompressedArrayTexture)$.setTexture2DArray(re,0),ze=te.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}te.pixelStorei(te.UNPACK_FLIP_Y_WEBGL,re.flipY),te.pixelStorei(te.UNPACK_PREMULTIPLY_ALPHA_WEBGL,re.premultiplyAlpha),te.pixelStorei(te.UNPACK_ALIGNMENT,re.unpackAlignment);const Ve=te.getParameter(te.UNPACK_ROW_LENGTH),ft=te.getParameter(te.UNPACK_IMAGE_HEIGHT),St=te.getParameter(te.UNPACK_SKIP_PIXELS),Mt=te.getParameter(te.UNPACK_SKIP_ROWS),Ft=te.getParameter(te.UNPACK_SKIP_IMAGES),ut=q.isCompressedTexture?q.mipmaps[Z]:q.image;te.pixelStorei(te.UNPACK_ROW_LENGTH,ut.width),te.pixelStorei(te.UNPACK_IMAGE_HEIGHT,ut.height),te.pixelStorei(te.UNPACK_SKIP_PIXELS,U.min.x),te.pixelStorei(te.UNPACK_SKIP_ROWS,U.min.y),te.pixelStorei(te.UNPACK_SKIP_IMAGES,U.min.z),q.isDataTexture||q.isData3DTexture?te.texSubImage3D(ze,Z,K.x,K.y,K.z,ve,we,Te,Se,ct,ut.data):q.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),te.compressedTexSubImage3D(ze,Z,K.x,K.y,K.z,ve,we,Te,Se,ut.data)):te.texSubImage3D(ze,Z,K.x,K.y,K.z,ve,we,Te,Se,ct,ut),te.pixelStorei(te.UNPACK_ROW_LENGTH,Ve),te.pixelStorei(te.UNPACK_IMAGE_HEIGHT,ft),te.pixelStorei(te.UNPACK_SKIP_PIXELS,St),te.pixelStorei(te.UNPACK_SKIP_ROWS,Mt),te.pixelStorei(te.UNPACK_SKIP_IMAGES,Ft),Z===0&&re.generateMipmaps&&te.generateMipmap(ze),Me.unbindTexture()},this.initTexture=function(U){U.isCubeTexture?$.setTextureCube(U,0):U.isData3DTexture?$.setTexture3D(U,0):U.isDataArrayTexture||U.isCompressedArrayTexture?$.setTexture2DArray(U,0):$.setTexture2D(U,0),Me.unbindTexture()},this.resetState=function(){O=0,I=0,b=null,Me.reset(),Ct.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Wo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===Fx?"display-p3":"srgb",t.unpackColorSpace=Pn.workingColorSpace===py?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Hr?Rc:QM}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Rc?Hr:Pa}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class fH extends uR{}fH.prototype.isWebGL1Renderer=!0;class Vx{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new st(e),this.density=t}clone(){return new Vx(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Gx{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new st(e),this.near=t,this.far=r}clone(){return new Gx(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Bg extends dn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class Ey{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Lg,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=zs()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=zs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=zs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Xi=new J;class Uc{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Xi.fromBufferAttribute(this,t),Xi.applyMatrix4(e),this.setXYZ(t,Xi.x,Xi.y,Xi.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Xi.fromBufferAttribute(this,t),Xi.applyNormalMatrix(e),this.setXYZ(t,Xi.x,Xi.y,Xi.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Xi.fromBufferAttribute(this,t),Xi.transformDirection(e),this.setXYZ(t,Xi.x,Xi.y,Xi.z);return this}setX(e,t){return this.normalized&&(t=tn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ms(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ms(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ms(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ms(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=tn(t,this.array),r=tn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=tn(t,this.array),r=tn(r,this.array),i=tn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=tn(t,this.array),r=tn(r,this.array),i=tn(i,this.array),s=tn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new _n(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Uc(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class hR extends kr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new st(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let ff;const tm=new J,df=new J,pf=new J,mf=new Be,nm=new Be,dH=new Bt,v0=new J,rm=new J,_0=new J,rO=new Be,vw=new Be,iO=new Be;class pH extends dn{constructor(e=new hR){if(super(),this.isSprite=!0,this.type="Sprite",ff===void 0){ff=new Jt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new Ey(t,5);ff.setIndex([0,1,2,0,2,3]),ff.setAttribute("position",new Uc(r,3,0,!1)),ff.setAttribute("uv",new Uc(r,2,3,!1))}this.geometry=ff,this.material=e,this.center=new Be(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),df.setFromMatrixScale(this.matrixWorld),dH.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),pf.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&df.multiplyScalar(-pf.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const o=this.center;E0(v0.set(-.5,-.5,0),pf,o,df,i,s),E0(rm.set(.5,-.5,0),pf,o,df,i,s),E0(_0.set(.5,.5,0),pf,o,df,i,s),rO.set(0,0),vw.set(1,0),iO.set(1,1);let a=e.ray.intersectTriangle(v0,rm,_0,!1,tm);if(a===null&&(E0(rm.set(-.5,.5,0),pf,o,df,i,s),vw.set(0,1),a=e.ray.intersectTriangle(v0,_0,rm,!1,tm),a===null))return;const l=e.ray.origin.distanceTo(tm);l<e.near||l>e.far||t.push({distance:l,point:tm.clone(),uv:ps.getInterpolation(tm,v0,rm,_0,rO,vw,iO,new Be),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function E0(n,e,t,r,i,s){mf.subVectors(n,t).addScalar(.5).multiply(r),i!==void 0?(nm.x=s*mf.x-i*mf.y,nm.y=i*mf.x+s*mf.y):nm.copy(mf),n.copy(e),n.x+=nm.x,n.y+=nm.y,n.applyMatrix4(dH)}const x0=new J,sO=new J;class mH extends dn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let r=0,i=t.length;r<i;r++){const s=t[r];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,r=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:r,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,i;for(r=1,i=t.length;r<i;r++){let s=t[r].distance;if(t[r].object.visible&&(s-=s*t[r].hysteresis),e<s)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){x0.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(x0);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){x0.setFromMatrixPosition(e.matrixWorld),sO.setFromMatrixPosition(this.matrixWorld);const r=x0.distanceTo(sO)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s;i++){let o=t[i].distance;if(t[i].object.visible&&(o-=o*t[i].hysteresis),r>=o)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let i=0,s=r.length;i<s;i++){const o=r[i];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const oO=new J,aO=new In,lO=new In,xie=new J,cO=new Bt,A0=new J,_w=new ni,uO=new Bt,Ew=new np;class fR extends Rr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=kT,this.bindMatrix=new Bt,this.bindMatrixInverse=new Bt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new gi),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,A0),this.boundingBox.expandByPoint(A0)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new ni),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,A0),this.boundingSphere.expandByPoint(A0)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.material,i=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_w.copy(this.boundingSphere),_w.applyMatrix4(i),e.ray.intersectsSphere(_w)!==!1&&(uO.copy(i).invert(),Ew.copy(e.ray).applyMatrix4(uO),!(this.boundingBox!==null&&Ew.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,Ew)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new In,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.fromBufferAttribute(t,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===kT?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Rz?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const r=this.skeleton,i=this.geometry;aO.fromBufferAttribute(i.attributes.skinIndex,e),lO.fromBufferAttribute(i.attributes.skinWeight,e),oO.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=lO.getComponent(s);if(o!==0){const a=aO.getComponent(s);cO.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),t.addScaledVector(xie.copy(oO).applyMatrix4(cO),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class Wx extends dn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Qu extends Qn{constructor(e=null,t=1,r=1,i,s,o,a,l,c=vr,u=vr,f,p){super(null,o,a,l,c,u,i,s,f,p),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const hO=new Bt,Aie=new Bt;class xy{constructor(e=[],t=[]){this.uuid=zs(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new Bt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new Bt;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:Aie;hO.multiplyMatrices(a,t[s]),hO.toArray(r,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new xy(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new Qu(t,e,e,Ni,fi);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const s=e.bones[r];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Wx),this.bones.push(o),this.boneInverses.push(new Bt().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const o=t[i];e.bones.push(o.uuid);const a=r[i];e.boneInverses.push(a.toArray())}return e}}class Ld extends _n{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const gf=new Bt,fO=new Bt,w0=[],dO=new gi,wie=new Bt,im=new Rr,sm=new ni;class dR extends Rr{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Ld(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<r;i++)this.setMatrixAt(i,wie)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new gi),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,gf),dO.copy(e.boundingBox).applyMatrix4(gf),this.boundingBox.union(dO)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new ni),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,gf),sm.copy(e.boundingSphere).applyMatrix4(gf),this.boundingSphere.union(sm)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const r=this.matrixWorld,i=this.count;if(im.geometry=this.geometry,im.material=this.material,im.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),sm.copy(this.boundingSphere),sm.applyMatrix4(r),e.ray.intersectsSphere(sm)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,gf),fO.multiplyMatrices(r,gf),im.matrixWorld=fO,im.raycast(e,w0);for(let o=0,a=w0.length;o<a;o++){const l=w0[o];l.instanceId=s,l.object=this,t.push(l)}w0.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Ld(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}function Sie(n,e){return n.z-e.z}function Tie(n,e){return e.z-n.z}class Cie{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){const r=this.pool,i=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1});const s=r[this.index];i.push(s),this.index++,s.start=e.start,s.count=e.count,s.z=t}reset(){this.list.length=0,this.index=0}}const yf="batchId",ql=new Bt,pO=new Bt,bie=new Bt,mO=new Bt,xw=new vy,S0=new gi,vu=new ni,om=new J,Aw=new Cie,Di=new Rr,T0=[];function Mie(n,e,t=0){const r=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const i=n.count;for(let s=0;s<i;s++)for(let o=0;o<r;o++)e.setComponent(s+t,o,n.getComponent(s,o))}else e.array.set(n.array,t*r);e.needsUpdate=!0}class gH extends Rr{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,r=t*2,i){super(new Jt,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),r=new Qu(t,e,e,Ni,fi);this._matricesTexture=r}_initializeGeometry(e){const t=this.geometry,r=this._maxVertexCount,i=this._maxGeometryCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const a in e.attributes){const l=e.getAttribute(a),{array:c,itemSize:u,normalized:f}=l,p=new c.constructor(r*u),m=new l.constructor(p,u,f);m.setUsage(l.usage),t.setAttribute(a,m)}if(e.getIndex()!==null){const a=r>65536?new Uint32Array(s):new Uint16Array(s);t.setIndex(new _n(a,1))}const o=i>65536?new Uint32Array(r):new Uint16Array(r);t.setAttribute(yf,new _n(o,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(yf))throw new Error(`BatchedMesh: Geometry cannot use attribute "${yf}"`);const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const r in t.attributes){if(r===yf)continue;if(!e.hasAttribute(r))throw new Error(`BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const i=e.getAttribute(r),s=t.getAttribute(r);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gi);const e=this._geometryCount,t=this.boundingBox,r=this._active;t.makeEmpty();for(let i=0;i<e;i++)r[i]!==!1&&(this.getMatrixAt(i,ql),this.getBoundingBoxAt(i,S0).applyMatrix4(ql),t.union(S0))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ni);const e=this._geometryCount,t=this.boundingSphere,r=this._active;t.makeEmpty();for(let i=0;i<e;i++)r[i]!==!1&&(this.getMatrixAt(i,ql),this.getBoundingSphereAt(i,vu).applyMatrix4(ql),t.union(vu))}addGeometry(e,t=-1,r=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const i={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,a=this._drawRanges,l=this._bounds;this._geometryCount!==0&&(s=o[o.length-1]),t===-1?i.vertexCount=e.getAttribute("position").count:i.vertexCount=t,s===null?i.vertexStart=0:i.vertexStart=s.vertexStart+s.vertexCount;const c=e.getIndex(),u=c!==null;if(u&&(r===-1?i.indexCount=c.count:i.indexCount=r,s===null?i.indexStart=0:i.indexStart=s.indexStart+s.indexCount),i.indexStart!==-1&&i.indexStart+i.indexCount>this._maxIndexCount||i.vertexStart+i.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const f=this._visibility,p=this._active,m=this._matricesTexture,y=this._matricesTexture.image.data;f.push(!0),p.push(!0);const A=this._geometryCount;this._geometryCount++,bie.toArray(y,A*16),m.needsUpdate=!0,o.push(i),a.push({start:u?i.indexStart:i.vertexStart,count:-1}),l.push({boxInitialized:!1,box:new gi,sphereInitialized:!1,sphere:new ni});const _=this.geometry.getAttribute(yf);for(let g=0;g<i.vertexCount;g++)_.setX(i.vertexStart+g,A);return _.needsUpdate=!0,this.setGeometryAt(A,e),A}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const r=this.geometry,i=r.getIndex()!==null,s=r.getIndex(),o=t.getIndex(),a=this._reservedRanges[e];if(i&&o.count>a.indexCount||t.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const l=a.vertexStart,c=a.vertexCount;for(const m in r.attributes){if(m===yf)continue;const y=t.getAttribute(m),A=r.getAttribute(m);Mie(y,A,l);const _=y.itemSize;for(let g=y.count,E=c;g<E;g++){const x=l+g;for(let T=0;T<_;T++)A.setComponent(x,T,0)}A.needsUpdate=!0}if(i){const m=a.indexStart;for(let y=0;y<o.count;y++)s.setX(m+y,l+o.getX(y));for(let y=o.count,A=a.indexCount;y<A;y++)s.setX(m+y,l);s.needsUpdate=!0}const u=this._bounds[e];t.boundingBox!==null?(u.box.copy(t.boundingBox),u.boxInitialized=!0):u.boxInitialized=!1,t.boundingSphere!==null?(u.sphere.copy(t.boundingSphere),u.sphereInitialized=!0):u.sphereInitialized=!1;const f=this._drawRanges[e],p=t.getAttribute("position");return f.count=i?o.count:p.count,this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._active;return e>=t.length||t[e]===!1?this:(t[e]=!1,this._visibilityChanged=!0,this)}getBoundingBoxAt(e,t){if(this._active[e]===!1)return this;const i=this._bounds[e],s=i.box,o=this.geometry;if(i.boxInitialized===!1){s.makeEmpty();const a=o.index,l=o.attributes.position,c=this._drawRanges[e];for(let u=c.start,f=c.start+c.count;u<f;u++){let p=u;a&&(p=a.getX(p)),s.expandByPoint(om.fromBufferAttribute(l,p))}i.boxInitialized=!0}return t.copy(s),t}getBoundingSphereAt(e,t){if(this._active[e]===!1)return this;const i=this._bounds[e],s=i.sphere,o=this.geometry;if(i.sphereInitialized===!1){s.makeEmpty(),this.getBoundingBoxAt(e,S0),S0.getCenter(s.center);const a=o.index,l=o.attributes.position,c=this._drawRanges[e];let u=0;for(let f=c.start,p=c.start+c.count;f<p;f++){let m=f;a&&(m=a.getX(m)),om.fromBufferAttribute(l,m),u=Math.max(u,s.center.distanceToSquared(om))}s.radius=Math.sqrt(u),i.sphereInitialized=!0}return t.copy(s),t}setMatrixAt(e,t){const r=this._active,i=this._matricesTexture,s=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||r[e]===!1?this:(t.toArray(s,e*16),i.needsUpdate=!0,this)}getMatrixAt(e,t){const r=this._active,i=this._matricesTexture.image.data,s=this._geometryCount;return e>=s||r[e]===!1?null:t.fromArray(i,e*16)}setVisibleAt(e,t){const r=this._visibility,i=this._active,s=this._geometryCount;return e>=s||i[e]===!1||r[e]===t?this:(r[e]=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._visibility,r=this._active,i=this._geometryCount;return e>=i||r[e]===!1?!1:t[e]}raycast(e,t){const r=this._visibility,i=this._active,s=this._drawRanges,o=this._geometryCount,a=this.matrixWorld,l=this.geometry;Di.material=this.material,Di.geometry.index=l.index,Di.geometry.attributes=l.attributes,Di.geometry.boundingBox===null&&(Di.geometry.boundingBox=new gi),Di.geometry.boundingSphere===null&&(Di.geometry.boundingSphere=new ni);for(let c=0;c<o;c++){if(!r[c]||!i[c])continue;const u=s[c];Di.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(c,Di.matrixWorld).premultiply(a),this.getBoundingBoxAt(c,Di.geometry.boundingBox),this.getBoundingSphereAt(c,Di.geometry.boundingSphere),Di.raycast(e,T0);for(let f=0,p=T0.length;f<p;f++){const m=T0[f];m.object=this,m.batchId=c,t.push(m)}T0.length=0}Di.material=null,Di.geometry.index=null,Di.geometry.attributes={},Di.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,r,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=i.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._visibility,c=this._multiDrawStarts,u=this._multiDrawCounts,f=this._drawRanges,p=this.perObjectFrustumCulled;p&&(mO.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),xw.setFromProjectionMatrix(mO,e.isWebGPURenderer?Id:Wo));let m=0;if(this.sortObjects){pO.copy(this.matrixWorld).invert(),om.setFromMatrixPosition(r.matrixWorld).applyMatrix4(pO);for(let _=0,g=l.length;_<g;_++)if(l[_]){this.getMatrixAt(_,ql),this.getBoundingSphereAt(_,vu).applyMatrix4(ql);let E=!1;if(p&&(E=!xw.intersectsSphere(vu)),!E){const x=om.distanceTo(vu.center);Aw.push(f[_],x)}}const y=Aw.list,A=this.customSort;A===null?y.sort(s.transparent?Tie:Sie):A.call(this,y,r);for(let _=0,g=y.length;_<g;_++){const E=y[_];c[m]=E.start*a,u[m]=E.count,m++}Aw.reset()}else for(let y=0,A=l.length;y<A;y++)if(l[y]){let _=!1;if(p&&(this.getMatrixAt(y,ql),this.getBoundingSphereAt(y,vu).applyMatrix4(ql),_=!xw.intersectsSphere(vu)),!_){const g=f[y];c[m]=g.start*a,u[m]=g.count,m++}}this._multiDrawCount=m,this._visibilityChanged=!1}onBeforeShadow(e,t,r,i,s,o){this.onBeforeRender(e,null,i,s,o)}}class Hi extends kr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new st(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const gO=new J,yO=new J,vO=new Bt,ww=new np,C0=new ni;class Tl extends dn{constructor(e=new Jt,t=new Hi){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)gO.fromBufferAttribute(t,i-1),yO.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=gO.distanceTo(yO);e.setAttribute("lineDistance",new Et(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),C0.copy(r.boundingSphere),C0.applyMatrix4(i),C0.radius+=s,e.ray.intersectsSphere(C0)===!1)return;vO.copy(i).invert(),ww.copy(e.ray).applyMatrix4(vO);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new J,u=new J,f=new J,p=new J,m=this.isLineSegments?2:1,y=r.index,_=r.attributes.position;if(y!==null){const g=Math.max(0,o.start),E=Math.min(y.count,o.start+o.count);for(let x=g,T=E-1;x<T;x+=m){const O=y.getX(x),I=y.getX(x+1);if(c.fromBufferAttribute(_,O),u.fromBufferAttribute(_,I),ww.distanceSqToSegment(c,u,p,f)>l)continue;p.applyMatrix4(this.matrixWorld);const R=e.ray.origin.distanceTo(p);R<e.near||R>e.far||t.push({distance:R,point:f.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else{const g=Math.max(0,o.start),E=Math.min(_.count,o.start+o.count);for(let x=g,T=E-1;x<T;x+=m){if(c.fromBufferAttribute(_,x),u.fromBufferAttribute(_,x+1),ww.distanceSqToSegment(c,u,p,f)>l)continue;p.applyMatrix4(this.matrixWorld);const I=e.ray.origin.distanceTo(p);I<e.near||I>e.far||t.push({distance:I,point:f.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const _O=new J,EO=new J;class ta extends Tl{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,s=t.count;i<s;i+=2)_O.fromBufferAttribute(t,i),EO.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+_O.distanceTo(EO);e.setAttribute("lineDistance",new Et(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class pR extends Tl{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class $x extends kr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new st(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const xO=new Bt,pC=new np,b0=new ni,M0=new J;class mR extends dn{constructor(e=new Jt,t=new $x){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),b0.copy(r.boundingSphere),b0.applyMatrix4(i),b0.radius+=s,e.ray.intersectsSphere(b0)===!1)return;xO.copy(i).invert(),pC.copy(e.ray).applyMatrix4(xO);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=r.index,f=r.attributes.position;if(c!==null){const p=Math.max(0,o.start),m=Math.min(c.count,o.start+o.count);for(let y=p,A=m;y<A;y++){const _=c.getX(y);M0.fromBufferAttribute(f,_),AO(M0,_,l,i,e,t,this)}}else{const p=Math.max(0,o.start),m=Math.min(f.count,o.start+o.count);for(let y=p,A=m;y<A;y++)M0.fromBufferAttribute(f,y),AO(M0,y,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function AO(n,e,t,r,i,s,o){const a=pC.distanceSqToPoint(n);if(a<t){const l=new J;pC.closestPointToPoint(n,l),l.applyMatrix4(r);const c=i.ray.origin.distanceTo(l);if(c<i.near||c>i.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class Rie extends Qn{constructor(e,t,r,i,s,o,a,l,c){super(e,t,r,i,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:Hn,this.magFilter=s!==void 0?s:Hn,this.generateMipmaps=!1;const u=this;function f(){u.needsUpdate=!0,e.requestVideoFrameCallback(f)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(f)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Iie extends Qn{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=vr,this.minFilter=vr,this.generateMipmaps=!1,this.needsUpdate=!0}}class jx extends Qn{constructor(e,t,r,i,s,o,a,l,c,u,f,p){super(null,o,a,l,c,u,i,s,f,p),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Pie extends jx{constructor(e,t,r,i,s,o){super(e,t,r,s,o),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=hi}}class Die extends jx{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,Ra),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class Lie extends Qn{constructor(e,t,r,i,s,o,a,l,c){super(e,t,r,i,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class na{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,i=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),s+=r.distanceTo(i),t.push(s),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let i=0;const s=r.length;let o;t?o=t:o=e*r[s-1];let a=0,l=s-1,c;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),c=r[i]-o,c<0)a=i+1;else if(c>0)l=i-1;else{l=i;break}if(i=l,r[i]===o)return i/(s-1);const u=r[i],p=r[i+1]-u,m=(o-u)/p;return(i+m)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const o=this.getPoint(i),a=this.getPoint(s),l=t||(o.isVector2?new Be:new J);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new J,i=[],s=[],o=[],a=new J,l=new Bt;for(let m=0;m<=e;m++){const y=m/e;i[m]=this.getTangentAt(y,new J)}s[0]=new J,o[0]=new J;let c=Number.MAX_VALUE;const u=Math.abs(i[0].x),f=Math.abs(i[0].y),p=Math.abs(i[0].z);u<=c&&(c=u,r.set(1,0,0)),f<=c&&(c=f,r.set(0,1,0)),p<=c&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],a),o[0].crossVectors(i[0],s[0]);for(let m=1;m<=e;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),a.crossVectors(i[m-1],i[m]),a.length()>Number.EPSILON){a.normalize();const y=Math.acos(_r(i[m-1].dot(i[m]),-1,1));s[m].applyMatrix4(l.makeRotationAxis(a,y))}o[m].crossVectors(i[m],s[m])}if(t===!0){let m=Math.acos(_r(s[0].dot(s[e]),-1,1));m/=e,i[0].dot(a.crossVectors(s[0],s[e]))>0&&(m=-m);for(let y=1;y<=e;y++)s[y].applyMatrix4(l.makeRotationAxis(i[y],m*y)),o[y].crossVectors(i[y],s[y])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Xx extends na{constructor(e=0,t=0,r=1,i=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const r=t||new Be,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),f=Math.sin(this.aRotation),p=l-this.aX,m=c-this.aY;l=p*u-m*f+this.aX,c=p*f+m*u+this.aY}return r.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class yH extends Xx{constructor(e,t,r,i,s,o){super(e,t,r,r,i,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function gR(){let n=0,e=0,t=0,r=0;function i(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,r=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){i(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,f){let p=(o-s)/c-(a-s)/(c+u)+(a-o)/u,m=(a-o)/u-(l-o)/(u+f)+(l-a)/f;p*=u,m*=u,i(o,a,p,m)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+r*a}}}const R0=new J,Sw=new gR,Tw=new gR,Cw=new gR;class vH extends na{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new J){const r=t,i=this.points,s=i.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,u;this.closed||a>0?c=i[(a-1)%s]:(R0.subVectors(i[0],i[1]).add(i[0]),c=R0);const f=i[a%s],p=i[(a+1)%s];if(this.closed||a+2<s?u=i[(a+2)%s]:(R0.subVectors(i[s-1],i[s-2]).add(i[s-1]),u=R0),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let y=Math.pow(c.distanceToSquared(f),m),A=Math.pow(f.distanceToSquared(p),m),_=Math.pow(p.distanceToSquared(u),m);A<1e-4&&(A=1),y<1e-4&&(y=A),_<1e-4&&(_=A),Sw.initNonuniformCatmullRom(c.x,f.x,p.x,u.x,y,A,_),Tw.initNonuniformCatmullRom(c.y,f.y,p.y,u.y,y,A,_),Cw.initNonuniformCatmullRom(c.z,f.z,p.z,u.z,y,A,_)}else this.curveType==="catmullrom"&&(Sw.initCatmullRom(c.x,f.x,p.x,u.x,this.tension),Tw.initCatmullRom(c.y,f.y,p.y,u.y,this.tension),Cw.initCatmullRom(c.z,f.z,p.z,u.z,this.tension));return r.set(Sw.calc(l),Tw.calc(l),Cw.calc(l)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new J().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function wO(n,e,t,r,i){const s=(r-e)*.5,o=(i-t)*.5,a=n*n,l=n*a;return(2*t-2*r+s+o)*l+(-3*t+3*r-2*s-o)*a+s*n+t}function Oie(n,e){const t=1-n;return t*t*e}function Bie(n,e){return 2*(1-n)*n*e}function Nie(n,e){return n*n*e}function Jm(n,e,t,r){return Oie(n,e)+Bie(n,t)+Nie(n,r)}function kie(n,e){const t=1-n;return t*t*t*e}function Fie(n,e){const t=1-n;return 3*t*t*n*e}function Uie(n,e){return 3*(1-n)*n*n*e}function zie(n,e){return n*n*n*e}function Ym(n,e,t,r,i){return kie(n,e)+Fie(n,t)+Uie(n,r)+zie(n,i)}class yR extends na{constructor(e=new Be,t=new Be,r=new Be,i=new Be){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Be){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(Ym(e,i.x,s.x,o.x,a.x),Ym(e,i.y,s.y,o.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class _H extends na{constructor(e=new J,t=new J,r=new J,i=new J){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new J){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(Ym(e,i.x,s.x,o.x,a.x),Ym(e,i.y,s.y,o.y,a.y),Ym(e,i.z,s.z,o.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class vR extends na{constructor(e=new Be,t=new Be){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Be){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Be){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class EH extends na{constructor(e=new J,t=new J){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new J){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new J){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class _R extends na{constructor(e=new Be,t=new Be,r=new Be){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Be){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(Jm(e,i.x,s.x,o.x),Jm(e,i.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ER extends na{constructor(e=new J,t=new J,r=new J){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new J){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(Jm(e,i.x,s.x,o.x),Jm(e,i.y,s.y,o.y),Jm(e,i.z,s.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class xR extends na{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Be){const r=t,i=this.points,s=(i.length-1)*e,o=Math.floor(s),a=s-o,l=i[o===0?o:o-1],c=i[o],u=i[o>i.length-2?i.length-1:o+1],f=i[o>i.length-3?i.length-1:o+2];return r.set(wO(a,l.x,c.x,u.x,f.x),wO(a,l.y,c.y,u.y,f.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new Be().fromArray(i))}return this}}var NE=Object.freeze({__proto__:null,ArcCurve:yH,CatmullRomCurve3:vH,CubicBezierCurve:yR,CubicBezierCurve3:_H,EllipseCurve:Xx,LineCurve:vR,LineCurve3:EH,QuadraticBezierCurve:_R,QuadraticBezierCurve3:ER,SplineCurve:xR});class xH extends na{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new NE[r](t,e))}return this}getPoint(e,t){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const o=i[s]-r,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const u=l[c];r&&r.equals(u)||(t.push(u),r=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(new NE[i.type]().fromJSON(i))}return this}}class Ng extends xH{constructor(e){super(),this.type="Path",this.currentPoint=new Be,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new vR(this.currentPoint.clone(),new Be(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){const s=new _R(this.currentPoint.clone(),new Be(e,t),new Be(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,s,o){const a=new yR(this.currentPoint.clone(),new Be(e,t),new Be(r,i),new Be(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new xR(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,r,i,s,o),this}absarc(e,t,r,i,s,o){return this.absellipse(e,t,r,r,i,s,o),this}ellipse(e,t,r,i,s,o,a,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,t+u,r,i,s,o,a,l),this}absellipse(e,t,r,i,s,o,a,l){const c=new Xx(e,t,r,i,s,o,a,l);if(this.curves.length>0){const f=c.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Ay extends Jt{constructor(e=[new Be(0,-.5),new Be(.5,0),new Be(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=_r(i,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],u=1/t,f=new J,p=new Be,m=new J,y=new J,A=new J;let _=0,g=0;for(let E=0;E<=e.length-1;E++)switch(E){case 0:_=e[E+1].x-e[E].x,g=e[E+1].y-e[E].y,m.x=g*1,m.y=-_,m.z=g*0,A.copy(m),m.normalize(),l.push(m.x,m.y,m.z);break;case e.length-1:l.push(A.x,A.y,A.z);break;default:_=e[E+1].x-e[E].x,g=e[E+1].y-e[E].y,m.x=g*1,m.y=-_,m.z=g*0,y.copy(m),m.x+=A.x,m.y+=A.y,m.z+=A.z,m.normalize(),l.push(m.x,m.y,m.z),A.copy(y)}for(let E=0;E<=t;E++){const x=r+E*u*i,T=Math.sin(x),O=Math.cos(x);for(let I=0;I<=e.length-1;I++){f.x=e[I].x*T,f.y=e[I].y,f.z=e[I].x*O,o.push(f.x,f.y,f.z),p.x=E/t,p.y=I/(e.length-1),a.push(p.x,p.y);const b=l[3*I+0]*T,R=l[3*I+1],C=l[3*I+0]*O;c.push(b,R,C)}}for(let E=0;E<t;E++)for(let x=0;x<e.length-1;x++){const T=x+E*e.length,O=T,I=T+e.length,b=T+e.length+1,R=T+1;s.push(O,I,R),s.push(b,R,I)}this.setIndex(s),this.setAttribute("position",new Et(o,3)),this.setAttribute("uv",new Et(a,2)),this.setAttribute("normal",new Et(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ay(e.points,e.segments,e.phiStart,e.phiLength)}}class Kx extends Ay{constructor(e=1,t=1,r=4,i=8){const s=new Ng;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(r),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:r,radialSegments:i}}static fromJSON(e){return new Kx(e.radius,e.length,e.capSegments,e.radialSegments)}}class Jx extends Jt{constructor(e=1,t=32,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);const s=[],o=[],a=[],l=[],c=new J,u=new Be;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let f=0,p=3;f<=t;f++,p+=3){const m=r+f/t*i;c.x=e*Math.cos(m),c.y=e*Math.sin(m),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[p]/e+1)/2,u.y=(o[p+1]/e+1)/2,l.push(u.x,u.y)}for(let f=1;f<=t;f++)s.push(f,f+1,0);this.setIndex(s),this.setAttribute("position",new Et(o,3)),this.setAttribute("normal",new Et(a,3)),this.setAttribute("uv",new Et(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Jx(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class ip extends Jt{constructor(e=1,t=1,r=1,i=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;i=Math.floor(i),s=Math.floor(s);const u=[],f=[],p=[],m=[];let y=0;const A=[],_=r/2;let g=0;E(),o===!1&&(e>0&&x(!0),t>0&&x(!1)),this.setIndex(u),this.setAttribute("position",new Et(f,3)),this.setAttribute("normal",new Et(p,3)),this.setAttribute("uv",new Et(m,2));function E(){const T=new J,O=new J;let I=0;const b=(t-e)/r;for(let R=0;R<=s;R++){const C=[],M=R/s,B=M*(t-e)+e;for(let F=0;F<=i;F++){const z=F/i,j=z*l+a,Y=Math.sin(j),oe=Math.cos(j);O.x=B*Y,O.y=-M*r+_,O.z=B*oe,f.push(O.x,O.y,O.z),T.set(Y,b,oe).normalize(),p.push(T.x,T.y,T.z),m.push(z,1-M),C.push(y++)}A.push(C)}for(let R=0;R<i;R++)for(let C=0;C<s;C++){const M=A[C][R],B=A[C+1][R],F=A[C+1][R+1],z=A[C][R+1];u.push(M,B,z),u.push(B,F,z),I+=6}c.addGroup(g,I,0),g+=I}function x(T){const O=y,I=new Be,b=new J;let R=0;const C=T===!0?e:t,M=T===!0?1:-1;for(let F=1;F<=i;F++)f.push(0,_*M,0),p.push(0,M,0),m.push(.5,.5),y++;const B=y;for(let F=0;F<=i;F++){const j=F/i*l+a,Y=Math.cos(j),oe=Math.sin(j);b.x=C*oe,b.y=_*M,b.z=C*Y,f.push(b.x,b.y,b.z),p.push(0,M,0),I.x=Y*.5+.5,I.y=oe*.5*M+.5,m.push(I.x,I.y),y++}for(let F=0;F<i;F++){const z=O+F,j=B+F;T===!0?u.push(j,j+1,z):u.push(j+1,j,z),R+=3}c.addGroup(g,R,T===!0?1:2),g+=R}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ip(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Yx extends ip{constructor(e=1,t=1,r=32,i=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,r,i,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new Yx(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Qc extends Jt{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const s=[],o=[];a(i),c(r),u(),this.setAttribute("position",new Et(s,3)),this.setAttribute("normal",new Et(s.slice(),3)),this.setAttribute("uv",new Et(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(E){const x=new J,T=new J,O=new J;for(let I=0;I<t.length;I+=3)m(t[I+0],x),m(t[I+1],T),m(t[I+2],O),l(x,T,O,E)}function l(E,x,T,O){const I=O+1,b=[];for(let R=0;R<=I;R++){b[R]=[];const C=E.clone().lerp(T,R/I),M=x.clone().lerp(T,R/I),B=I-R;for(let F=0;F<=B;F++)F===0&&R===I?b[R][F]=C:b[R][F]=C.clone().lerp(M,F/B)}for(let R=0;R<I;R++)for(let C=0;C<2*(I-R)-1;C++){const M=Math.floor(C/2);C%2===0?(p(b[R][M+1]),p(b[R+1][M]),p(b[R][M])):(p(b[R][M+1]),p(b[R+1][M+1]),p(b[R+1][M]))}}function c(E){const x=new J;for(let T=0;T<s.length;T+=3)x.x=s[T+0],x.y=s[T+1],x.z=s[T+2],x.normalize().multiplyScalar(E),s[T+0]=x.x,s[T+1]=x.y,s[T+2]=x.z}function u(){const E=new J;for(let x=0;x<s.length;x+=3){E.x=s[x+0],E.y=s[x+1],E.z=s[x+2];const T=_(E)/2/Math.PI+.5,O=g(E)/Math.PI+.5;o.push(T,1-O)}y(),f()}function f(){for(let E=0;E<o.length;E+=6){const x=o[E+0],T=o[E+2],O=o[E+4],I=Math.max(x,T,O),b=Math.min(x,T,O);I>.9&&b<.1&&(x<.2&&(o[E+0]+=1),T<.2&&(o[E+2]+=1),O<.2&&(o[E+4]+=1))}}function p(E){s.push(E.x,E.y,E.z)}function m(E,x){const T=E*3;x.x=e[T+0],x.y=e[T+1],x.z=e[T+2]}function y(){const E=new J,x=new J,T=new J,O=new J,I=new Be,b=new Be,R=new Be;for(let C=0,M=0;C<s.length;C+=9,M+=6){E.set(s[C+0],s[C+1],s[C+2]),x.set(s[C+3],s[C+4],s[C+5]),T.set(s[C+6],s[C+7],s[C+8]),I.set(o[M+0],o[M+1]),b.set(o[M+2],o[M+3]),R.set(o[M+4],o[M+5]),O.copy(E).add(x).add(T).divideScalar(3);const B=_(O);A(I,M+0,E,B),A(b,M+2,x,B),A(R,M+4,T,B)}}function A(E,x,T,O){O<0&&E.x===1&&(o[x]=E.x-1),T.x===0&&T.z===0&&(o[x]=O/2/Math.PI+.5)}function _(E){return Math.atan2(E.z,-E.x)}function g(E){return Math.atan2(-E.y,Math.sqrt(E.x*E.x+E.z*E.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Qc(e.vertices,e.indices,e.radius,e.details)}}class qx extends Qc{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new qx(e.radius,e.detail)}}const I0=new J,P0=new J,bw=new J,D0=new ps;class AH extends Jt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(Yu*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],f=new Array(3),p={},m=[];for(let y=0;y<l;y+=3){o?(c[0]=o.getX(y),c[1]=o.getX(y+1),c[2]=o.getX(y+2)):(c[0]=y,c[1]=y+1,c[2]=y+2);const{a:A,b:_,c:g}=D0;if(A.fromBufferAttribute(a,c[0]),_.fromBufferAttribute(a,c[1]),g.fromBufferAttribute(a,c[2]),D0.getNormal(bw),f[0]=`${Math.round(A.x*i)},${Math.round(A.y*i)},${Math.round(A.z*i)}`,f[1]=`${Math.round(_.x*i)},${Math.round(_.y*i)},${Math.round(_.z*i)}`,f[2]=`${Math.round(g.x*i)},${Math.round(g.y*i)},${Math.round(g.z*i)}`,!(f[0]===f[1]||f[1]===f[2]||f[2]===f[0]))for(let E=0;E<3;E++){const x=(E+1)%3,T=f[E],O=f[x],I=D0[u[E]],b=D0[u[x]],R=`${T}_${O}`,C=`${O}_${T}`;C in p&&p[C]?(bw.dot(p[C].normal)<=s&&(m.push(I.x,I.y,I.z),m.push(b.x,b.y,b.z)),p[C]=null):R in p||(p[R]={index0:c[E],index1:c[x],normal:bw.clone()})}}for(const y in p)if(p[y]){const{index0:A,index1:_}=p[y];I0.fromBufferAttribute(a,A),P0.fromBufferAttribute(a,_),m.push(I0.x,I0.y,I0.z),m.push(P0.x,P0.y,P0.z)}this.setAttribute("position",new Et(m,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Zu extends Ng{constructor(e){super(e),this.uuid=zs(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(new Ng().fromJSON(i))}return this}}const Hie={triangulate:function(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=wH(n,0,i,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,f,p,m;if(r&&(s=jie(n,e,s,t)),n.length>80*t){a=c=n[0],l=u=n[1];for(let y=t;y<i;y+=t)f=n[y],p=n[y+1],f<a&&(a=f),p<l&&(l=p),f>c&&(c=f),p>u&&(u=p);m=Math.max(c-a,u-l),m=m!==0?32767/m:0}return kg(s,o,t,a,l,m,0),o}};function wH(n,e,t,r,i){let s,o;if(i===rse(n,e,t,r)>0)for(s=e;s<t;s+=r)o=SO(s,n[s],n[s+1],o);else for(s=t-r;s>=e;s-=r)o=SO(s,n[s],n[s+1],o);return o&&Qx(o,o.next)&&(Ug(o),o=o.next),o}function yh(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(Qx(t,t.next)||hr(t.prev,t,t.next)===0)){if(Ug(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function kg(n,e,t,r,i,s,o){if(!n)return;!o&&s&&qie(n,r,i,s);let a=n,l,c;for(;n.prev!==n.next;){if(l=n.prev,c=n.next,s?Gie(n,r,i,s):Vie(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(c.i/t|0),Ug(n),n=c.next,a=c.next;continue}if(n=c,n===a){o?o===1?(n=Wie(yh(n),e,t),kg(n,e,t,r,i,s,2)):o===2&&$ie(n,e,t,r,i,s):kg(yh(n),e,t,r,i,s,1);break}}}function Vie(n){const e=n.prev,t=n,r=n.next;if(hr(e,t,r)>=0)return!1;const i=e.x,s=t.x,o=r.x,a=e.y,l=t.y,c=r.y,u=i<s?i<o?i:o:s<o?s:o,f=a<l?a<c?a:c:l<c?l:c,p=i>s?i>o?i:o:s>o?s:o,m=a>l?a>c?a:c:l>c?l:c;let y=r.next;for(;y!==e;){if(y.x>=u&&y.x<=p&&y.y>=f&&y.y<=m&&Xf(i,a,s,l,o,c,y.x,y.y)&&hr(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function Gie(n,e,t,r){const i=n.prev,s=n,o=n.next;if(hr(i,s,o)>=0)return!1;const a=i.x,l=s.x,c=o.x,u=i.y,f=s.y,p=o.y,m=a<l?a<c?a:c:l<c?l:c,y=u<f?u<p?u:p:f<p?f:p,A=a>l?a>c?a:c:l>c?l:c,_=u>f?u>p?u:p:f>p?f:p,g=mC(m,y,e,t,r),E=mC(A,_,e,t,r);let x=n.prevZ,T=n.nextZ;for(;x&&x.z>=g&&T&&T.z<=E;){if(x.x>=m&&x.x<=A&&x.y>=y&&x.y<=_&&x!==i&&x!==o&&Xf(a,u,l,f,c,p,x.x,x.y)&&hr(x.prev,x,x.next)>=0||(x=x.prevZ,T.x>=m&&T.x<=A&&T.y>=y&&T.y<=_&&T!==i&&T!==o&&Xf(a,u,l,f,c,p,T.x,T.y)&&hr(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;x&&x.z>=g;){if(x.x>=m&&x.x<=A&&x.y>=y&&x.y<=_&&x!==i&&x!==o&&Xf(a,u,l,f,c,p,x.x,x.y)&&hr(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;T&&T.z<=E;){if(T.x>=m&&T.x<=A&&T.y>=y&&T.y<=_&&T!==i&&T!==o&&Xf(a,u,l,f,c,p,T.x,T.y)&&hr(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function Wie(n,e,t){let r=n;do{const i=r.prev,s=r.next.next;!Qx(i,s)&&SH(i,r,r.next,s)&&Fg(i,s)&&Fg(s,i)&&(e.push(i.i/t|0),e.push(r.i/t|0),e.push(s.i/t|0),Ug(r),Ug(r.next),r=n=s),r=r.next}while(r!==n);return yh(r)}function $ie(n,e,t,r,i,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&ese(o,a)){let l=TH(o,a);o=yh(o,o.next),l=yh(l,l.next),kg(o,e,t,r,i,s,0),kg(l,e,t,r,i,s,0);return}a=a.next}o=o.next}while(o!==n)}function jie(n,e,t,r){const i=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:n.length,c=wH(n,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(Zie(c));for(i.sort(Xie),s=0;s<i.length;s++)t=Kie(i[s],t);return t}function Xie(n,e){return n.x-e.x}function Kie(n,e){const t=Jie(n,e);if(!t)return e;const r=TH(t,n);return yh(r,r.next),yh(t,t.next)}function Jie(n,e){let t=e,r=-1/0,i;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const p=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=s&&p>r&&(r=p,i=t.x<t.next.x?t:t.next,p===s))return i}t=t.next}while(t!==e);if(!i)return null;const a=i,l=i.x,c=i.y;let u=1/0,f;t=i;do s>=t.x&&t.x>=l&&s!==t.x&&Xf(o<c?s:r,o,l,c,o<c?r:s,o,t.x,t.y)&&(f=Math.abs(o-t.y)/(s-t.x),Fg(t,n)&&(f<u||f===u&&(t.x>i.x||t.x===i.x&&Yie(i,t)))&&(i=t,u=f)),t=t.next;while(t!==a);return i}function Yie(n,e){return hr(n.prev,n,e.prev)<0&&hr(e.next,n,n.next)<0}function qie(n,e,t,r){let i=n;do i.z===0&&(i.z=mC(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,Qie(i)}function Qie(n){let e,t,r,i,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,r=t,a=0,e=0;e<c&&(a++,r=r.nextZ,!!r);e++);for(l=c;a>0||l>0&&r;)a!==0&&(l===0||!r||t.z<=r.z)?(i=t,t=t.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;t=r}s.nextZ=null,c*=2}while(o>1);return n}function mC(n,e,t,r,i){return n=(n-t)*i|0,e=(e-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function Zie(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Xf(n,e,t,r,i,s,o,a){return(i-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(r-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(i-o)*(r-a)}function ese(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!tse(n,e)&&(Fg(n,e)&&Fg(e,n)&&nse(n,e)&&(hr(n.prev,n,e.prev)||hr(n,e.prev,e))||Qx(n,e)&&hr(n.prev,n,n.next)>0&&hr(e.prev,e,e.next)>0)}function hr(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Qx(n,e){return n.x===e.x&&n.y===e.y}function SH(n,e,t,r){const i=O0(hr(n,e,t)),s=O0(hr(n,e,r)),o=O0(hr(t,r,n)),a=O0(hr(t,r,e));return!!(i!==s&&o!==a||i===0&&L0(n,t,e)||s===0&&L0(n,r,e)||o===0&&L0(t,n,r)||a===0&&L0(t,e,r))}function L0(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function O0(n){return n>0?1:n<0?-1:0}function tse(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&SH(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Fg(n,e){return hr(n.prev,n,n.next)<0?hr(n,e,n.next)>=0&&hr(n,n.prev,e)>=0:hr(n,e,n.prev)<0||hr(n,n.next,e)<0}function nse(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function TH(n,e){const t=new gC(n.i,n.x,n.y),r=new gC(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function SO(n,e,t,r){const i=new gC(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ug(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function gC(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function rse(n,e,t,r){let i=0;for(let s=e,o=t-r;s<t;s+=r)i+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return i}class wa{static area(e){const t=e.length;let r=0;for(let i=t-1,s=0;s<t;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return wa.area(e)<0}static triangulateShape(e,t){const r=[],i=[],s=[];TO(e),CO(r,e);let o=e.length;t.forEach(TO);for(let l=0;l<t.length;l++)i.push(o),o+=t[l].length,CO(r,t[l]);const a=Hie.triangulate(r,i);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function TO(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function CO(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class Zx extends Jt{constructor(e=new Zu([new Be(.5,.5),new Be(-.5,.5),new Be(-.5,-.5),new Be(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let a=0,l=e.length;a<l;a++){const c=e[a];o(c)}this.setAttribute("position",new Et(i,3)),this.setAttribute("uv",new Et(s,2)),this.computeVertexNormals();function o(a){const l=[],c=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,f=t.depth!==void 0?t.depth:1;let p=t.bevelEnabled!==void 0?t.bevelEnabled:!0,m=t.bevelThickness!==void 0?t.bevelThickness:.2,y=t.bevelSize!==void 0?t.bevelSize:m-.1,A=t.bevelOffset!==void 0?t.bevelOffset:0,_=t.bevelSegments!==void 0?t.bevelSegments:3;const g=t.extrudePath,E=t.UVGenerator!==void 0?t.UVGenerator:ise;let x,T=!1,O,I,b,R;g&&(x=g.getSpacedPoints(u),T=!0,p=!1,O=g.computeFrenetFrames(u,!1),I=new J,b=new J,R=new J),p||(_=0,m=0,y=0,A=0);const C=a.extractPoints(c);let M=C.shape;const B=C.holes;if(!wa.isClockWise(M)){M=M.reverse();for(let te=0,Le=B.length;te<Le;te++){const be=B[te];wa.isClockWise(be)&&(B[te]=be.reverse())}}const z=wa.triangulateShape(M,B),j=M;for(let te=0,Le=B.length;te<Le;te++){const be=B[te];M=M.concat(be)}function Y(te,Le,be){return Le||console.error("THREE.ExtrudeGeometry: vec does not exist"),te.clone().addScaledVector(Le,be)}const oe=M.length,le=z.length;function X(te,Le,be){let Ne,Me,ot;const Ze=te.x-Le.x,$=te.y-Le.y,V=be.x-te.x,ce=be.y-te.y,ke=Ze*Ze+$*$,pe=Ze*ce-$*V;if(Math.abs(pe)>Number.EPSILON){const ye=Math.sqrt(ke),qe=Math.sqrt(V*V+ce*ce),Ge=Le.x-$/ye,Ke=Le.y+Ze/ye,yt=be.x-ce/qe,At=be.y+V/qe,Ue=((yt-Ge)*ce-(At-Ke)*V)/(Ze*ce-$*V);Ne=Ge+Ze*Ue-te.x,Me=Ke+$*Ue-te.y;const Qt=Ne*Ne+Me*Me;if(Qt<=2)return new Be(Ne,Me);ot=Math.sqrt(Qt/2)}else{let ye=!1;Ze>Number.EPSILON?V>Number.EPSILON&&(ye=!0):Ze<-Number.EPSILON?V<-Number.EPSILON&&(ye=!0):Math.sign($)===Math.sign(ce)&&(ye=!0),ye?(Ne=-$,Me=Ze,ot=Math.sqrt(ke)):(Ne=Ze,Me=$,ot=Math.sqrt(ke/2))}return new Be(Ne/ot,Me/ot)}const ee=[];for(let te=0,Le=j.length,be=Le-1,Ne=te+1;te<Le;te++,be++,Ne++)be===Le&&(be=0),Ne===Le&&(Ne=0),ee[te]=X(j[te],j[be],j[Ne]);const ie=[];let fe,me=ee.concat();for(let te=0,Le=B.length;te<Le;te++){const be=B[te];fe=[];for(let Ne=0,Me=be.length,ot=Me-1,Ze=Ne+1;Ne<Me;Ne++,ot++,Ze++)ot===Me&&(ot=0),Ze===Me&&(Ze=0),fe[Ne]=X(be[Ne],be[ot],be[Ze]);ie.push(fe),me=me.concat(fe)}for(let te=0;te<_;te++){const Le=te/_,be=m*Math.cos(Le*Math.PI/2),Ne=y*Math.sin(Le*Math.PI/2)+A;for(let Me=0,ot=j.length;Me<ot;Me++){const Ze=Y(j[Me],ee[Me],Ne);He(Ze.x,Ze.y,-be)}for(let Me=0,ot=B.length;Me<ot;Me++){const Ze=B[Me];fe=ie[Me];for(let $=0,V=Ze.length;$<V;$++){const ce=Y(Ze[$],fe[$],Ne);He(ce.x,ce.y,-be)}}}const he=y+A;for(let te=0;te<oe;te++){const Le=p?Y(M[te],me[te],he):M[te];T?(b.copy(O.normals[0]).multiplyScalar(Le.x),I.copy(O.binormals[0]).multiplyScalar(Le.y),R.copy(x[0]).add(b).add(I),He(R.x,R.y,R.z)):He(Le.x,Le.y,0)}for(let te=1;te<=u;te++)for(let Le=0;Le<oe;Le++){const be=p?Y(M[Le],me[Le],he):M[Le];T?(b.copy(O.normals[te]).multiplyScalar(be.x),I.copy(O.binormals[te]).multiplyScalar(be.y),R.copy(x[te]).add(b).add(I),He(R.x,R.y,R.z)):He(be.x,be.y,f/u*te)}for(let te=_-1;te>=0;te--){const Le=te/_,be=m*Math.cos(Le*Math.PI/2),Ne=y*Math.sin(Le*Math.PI/2)+A;for(let Me=0,ot=j.length;Me<ot;Me++){const Ze=Y(j[Me],ee[Me],Ne);He(Ze.x,Ze.y,f+be)}for(let Me=0,ot=B.length;Me<ot;Me++){const Ze=B[Me];fe=ie[Me];for(let $=0,V=Ze.length;$<V;$++){const ce=Y(Ze[$],fe[$],Ne);T?He(ce.x,ce.y+x[u-1].y,x[u-1].x+be):He(ce.x,ce.y,f+be)}}}Ae(),De();function Ae(){const te=i.length/3;if(p){let Le=0,be=oe*Le;for(let Ne=0;Ne<le;Ne++){const Me=z[Ne];rt(Me[2]+be,Me[1]+be,Me[0]+be)}Le=u+_*2,be=oe*Le;for(let Ne=0;Ne<le;Ne++){const Me=z[Ne];rt(Me[0]+be,Me[1]+be,Me[2]+be)}}else{for(let Le=0;Le<le;Le++){const be=z[Le];rt(be[2],be[1],be[0])}for(let Le=0;Le<le;Le++){const be=z[Le];rt(be[0]+oe*u,be[1]+oe*u,be[2]+oe*u)}}r.addGroup(te,i.length/3-te,0)}function De(){const te=i.length/3;let Le=0;Ie(j,Le),Le+=j.length;for(let be=0,Ne=B.length;be<Ne;be++){const Me=B[be];Ie(Me,Le),Le+=Me.length}r.addGroup(te,i.length/3-te,1)}function Ie(te,Le){let be=te.length;for(;--be>=0;){const Ne=be;let Me=be-1;Me<0&&(Me=te.length-1);for(let ot=0,Ze=u+_*2;ot<Ze;ot++){const $=oe*ot,V=oe*(ot+1),ce=Le+Ne+$,ke=Le+Me+$,pe=Le+Me+V,ye=Le+Ne+V;vt(ce,ke,pe,ye)}}}function He(te,Le,be){l.push(te),l.push(Le),l.push(be)}function rt(te,Le,be){Qe(te),Qe(Le),Qe(be);const Ne=i.length/3,Me=E.generateTopUV(r,i,Ne-3,Ne-2,Ne-1);Xe(Me[0]),Xe(Me[1]),Xe(Me[2])}function vt(te,Le,be,Ne){Qe(te),Qe(Le),Qe(Ne),Qe(Le),Qe(be),Qe(Ne);const Me=i.length/3,ot=E.generateSideWallUV(r,i,Me-6,Me-3,Me-2,Me-1);Xe(ot[0]),Xe(ot[1]),Xe(ot[3]),Xe(ot[1]),Xe(ot[2]),Xe(ot[3])}function Qe(te){i.push(l[te*3+0]),i.push(l[te*3+1]),i.push(l[te*3+2])}function Xe(te){s.push(te.x),s.push(te.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return sse(t,r,e)}static fromJSON(e,t){const r=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];r.push(a)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new NE[i.type]().fromJSON(i)),new Zx(r,e.options)}}const ise={generateTopUV:function(n,e,t,r,i){const s=e[t*3],o=e[t*3+1],a=e[r*3],l=e[r*3+1],c=e[i*3],u=e[i*3+1];return[new Be(s,o),new Be(a,l),new Be(c,u)]},generateSideWallUV:function(n,e,t,r,i,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],c=e[r*3],u=e[r*3+1],f=e[r*3+2],p=e[i*3],m=e[i*3+1],y=e[i*3+2],A=e[s*3],_=e[s*3+1],g=e[s*3+2];return Math.abs(a-u)<Math.abs(o-c)?[new Be(o,1-l),new Be(c,1-f),new Be(p,1-y),new Be(A,1-g)]:[new Be(a,1-l),new Be(u,1-f),new Be(m,1-y),new Be(_,1-g)]}};function sse(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,i=n.length;r<i;r++){const s=n[r];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class wy extends Qc{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new wy(e.radius,e.detail)}}class Sy extends Qc{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Sy(e.radius,e.detail)}}class eA extends Jt{constructor(e=.5,t=1,r=32,i=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:s,thetaLength:o},r=Math.max(3,r),i=Math.max(1,i);const a=[],l=[],c=[],u=[];let f=e;const p=(t-e)/i,m=new J,y=new Be;for(let A=0;A<=i;A++){for(let _=0;_<=r;_++){const g=s+_/r*o;m.x=f*Math.cos(g),m.y=f*Math.sin(g),l.push(m.x,m.y,m.z),c.push(0,0,1),y.x=(m.x/t+1)/2,y.y=(m.y/t+1)/2,u.push(y.x,y.y)}f+=p}for(let A=0;A<i;A++){const _=A*(r+1);for(let g=0;g<r;g++){const E=g+_,x=E,T=E+r+1,O=E+r+2,I=E+1;a.push(x,T,I),a.push(T,O,I)}}this.setIndex(a),this.setAttribute("position",new Et(l,3)),this.setAttribute("normal",new Et(c,3)),this.setAttribute("uv",new Et(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new eA(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class tA extends Jt{constructor(e=new Zu([new Be(0,.5),new Be(-.5,-.5),new Be(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],i=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;this.setIndex(r),this.setAttribute("position",new Et(i,3)),this.setAttribute("normal",new Et(s,3)),this.setAttribute("uv",new Et(o,2));function c(u){const f=i.length/3,p=u.extractPoints(t);let m=p.shape;const y=p.holes;wa.isClockWise(m)===!1&&(m=m.reverse());for(let _=0,g=y.length;_<g;_++){const E=y[_];wa.isClockWise(E)===!0&&(y[_]=E.reverse())}const A=wa.triangulateShape(m,y);for(let _=0,g=y.length;_<g;_++){const E=y[_];m=m.concat(E)}for(let _=0,g=m.length;_<g;_++){const E=m[_];i.push(E.x,E.y,0),s.push(0,0,1),o.push(E.x,E.y)}for(let _=0,g=A.length;_<g;_++){const E=A[_],x=E[0]+f,T=E[1]+f,O=E[2]+f;r.push(x,T,O),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return ose(t,e)}static fromJSON(e,t){const r=[];for(let i=0,s=e.shapes.length;i<s;i++){const o=t[e.shapes[i]];r.push(o)}return new tA(r,e.curveSegments)}}function ose(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const i=n[t];e.shapes.push(i.uuid)}else e.shapes.push(n.uuid);return e}class Ty extends Jt{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const l=Math.min(o+a,Math.PI);let c=0;const u=[],f=new J,p=new J,m=[],y=[],A=[],_=[];for(let g=0;g<=r;g++){const E=[],x=g/r;let T=0;g===0&&o===0?T=.5/t:g===r&&l===Math.PI&&(T=-.5/t);for(let O=0;O<=t;O++){const I=O/t;f.x=-e*Math.cos(i+I*s)*Math.sin(o+x*a),f.y=e*Math.cos(o+x*a),f.z=e*Math.sin(i+I*s)*Math.sin(o+x*a),y.push(f.x,f.y,f.z),p.copy(f).normalize(),A.push(p.x,p.y,p.z),_.push(I+T,1-x),E.push(c++)}u.push(E)}for(let g=0;g<r;g++)for(let E=0;E<t;E++){const x=u[g][E+1],T=u[g][E],O=u[g+1][E],I=u[g+1][E+1];(g!==0||o>0)&&m.push(x,T,I),(g!==r-1||l<Math.PI)&&m.push(T,O,I)}this.setIndex(m),this.setAttribute("position",new Et(y,3)),this.setAttribute("normal",new Et(A,3)),this.setAttribute("uv",new Et(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ty(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class nA extends Qc{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new nA(e.radius,e.detail)}}class rA extends Jt{constructor(e=1,t=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const o=[],a=[],l=[],c=[],u=new J,f=new J,p=new J;for(let m=0;m<=r;m++)for(let y=0;y<=i;y++){const A=y/i*s,_=m/r*Math.PI*2;f.x=(e+t*Math.cos(_))*Math.cos(A),f.y=(e+t*Math.cos(_))*Math.sin(A),f.z=t*Math.sin(_),a.push(f.x,f.y,f.z),u.x=e*Math.cos(A),u.y=e*Math.sin(A),p.subVectors(f,u).normalize(),l.push(p.x,p.y,p.z),c.push(y/i),c.push(m/r)}for(let m=1;m<=r;m++)for(let y=1;y<=i;y++){const A=(i+1)*m+y-1,_=(i+1)*(m-1)+y-1,g=(i+1)*(m-1)+y,E=(i+1)*m+y;o.push(A,_,E),o.push(_,g,E)}this.setIndex(o),this.setAttribute("position",new Et(a,3)),this.setAttribute("normal",new Et(l,3)),this.setAttribute("uv",new Et(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rA(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class iA extends Jt{constructor(e=1,t=.4,r=64,i=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:s,q:o},r=Math.floor(r),i=Math.floor(i);const a=[],l=[],c=[],u=[],f=new J,p=new J,m=new J,y=new J,A=new J,_=new J,g=new J;for(let x=0;x<=r;++x){const T=x/r*s*Math.PI*2;E(T,s,o,e,m),E(T+.01,s,o,e,y),_.subVectors(y,m),g.addVectors(y,m),A.crossVectors(_,g),g.crossVectors(A,_),A.normalize(),g.normalize();for(let O=0;O<=i;++O){const I=O/i*Math.PI*2,b=-t*Math.cos(I),R=t*Math.sin(I);f.x=m.x+(b*g.x+R*A.x),f.y=m.y+(b*g.y+R*A.y),f.z=m.z+(b*g.z+R*A.z),l.push(f.x,f.y,f.z),p.subVectors(f,m).normalize(),c.push(p.x,p.y,p.z),u.push(x/r),u.push(O/i)}}for(let x=1;x<=r;x++)for(let T=1;T<=i;T++){const O=(i+1)*(x-1)+(T-1),I=(i+1)*x+(T-1),b=(i+1)*x+T,R=(i+1)*(x-1)+T;a.push(O,I,R),a.push(I,b,R)}this.setIndex(a),this.setAttribute("position",new Et(l,3)),this.setAttribute("normal",new Et(c,3)),this.setAttribute("uv",new Et(u,2));function E(x,T,O,I,b){const R=Math.cos(x),C=Math.sin(x),M=O/T*x,B=Math.cos(M);b.x=I*(2+B)*.5*R,b.y=I*(2+B)*C*.5,b.z=I*Math.sin(M)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iA(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class sA extends Jt{constructor(e=new ER(new J(-1,-1,0),new J(-1,1,0),new J(1,1,0)),t=64,r=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new J,l=new J,c=new Be;let u=new J;const f=[],p=[],m=[],y=[];A(),this.setIndex(y),this.setAttribute("position",new Et(f,3)),this.setAttribute("normal",new Et(p,3)),this.setAttribute("uv",new Et(m,2));function A(){for(let x=0;x<t;x++)_(x);_(s===!1?t:0),E(),g()}function _(x){u=e.getPointAt(x/t,u);const T=o.normals[x],O=o.binormals[x];for(let I=0;I<=i;I++){const b=I/i*Math.PI*2,R=Math.sin(b),C=-Math.cos(b);l.x=C*T.x+R*O.x,l.y=C*T.y+R*O.y,l.z=C*T.z+R*O.z,l.normalize(),p.push(l.x,l.y,l.z),a.x=u.x+r*l.x,a.y=u.y+r*l.y,a.z=u.z+r*l.z,f.push(a.x,a.y,a.z)}}function g(){for(let x=1;x<=t;x++)for(let T=1;T<=i;T++){const O=(i+1)*(x-1)+(T-1),I=(i+1)*x+(T-1),b=(i+1)*x+T,R=(i+1)*(x-1)+T;y.push(O,I,R),y.push(I,b,R)}}function E(){for(let x=0;x<=t;x++)for(let T=0;T<=i;T++)c.x=x/t,c.y=T/i,m.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new sA(new NE[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class CH extends Jt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],r=new Set,i=new J,s=new J;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const f=l[c],p=f.start,m=f.count;for(let y=p,A=p+m;y<A;y+=3)for(let _=0;_<3;_++){const g=a.getX(y+_),E=a.getX(y+(_+1)%3);i.fromBufferAttribute(o,g),s.fromBufferAttribute(o,E),bO(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const u=3*a+c,f=3*a+(c+1)%3;i.fromBufferAttribute(o,u),s.fromBufferAttribute(o,f),bO(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Et(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function bO(n,e,t){const r=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(r)===!0||t.has(i)===!0?!1:(t.add(r),t.add(i),!0)}var MO=Object.freeze({__proto__:null,BoxGeometry:bh,CapsuleGeometry:Kx,CircleGeometry:Jx,ConeGeometry:Yx,CylinderGeometry:ip,DodecahedronGeometry:qx,EdgesGeometry:AH,ExtrudeGeometry:Zx,IcosahedronGeometry:wy,LatheGeometry:Ay,OctahedronGeometry:Sy,PlaneGeometry:_y,PolyhedronGeometry:Qc,RingGeometry:eA,ShapeGeometry:tA,SphereGeometry:Ty,TetrahedronGeometry:nA,TorusGeometry:rA,TorusKnotGeometry:iA,TubeGeometry:sA,WireframeGeometry:CH});class bH extends kr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new st(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class MH extends qo{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Cy extends kr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new st(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yc,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ba extends Cy{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Be(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return _r(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new st(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new st(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new st(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class RH extends kr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new st(16777215),this.specular=new st(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yc,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=dy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class IH extends kr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new st(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yc,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class PH extends kr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yc,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class DH extends kr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new st(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yc,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=dy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class LH extends kr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new st(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yc,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class OH extends Hi{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Vu(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function BH(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function NH(n){function e(i,s){return n[i]-n[s]}const t=n.length,r=new Array(t);for(let i=0;i!==t;++i)r[i]=i;return r.sort(e),r}function yC(n,e,t){const r=n.length,i=new n.constructor(r);for(let s=0,o=0;o!==r;++s){const a=t[s]*e;for(let l=0;l!==e;++l)i[o++]=n[a+l]}return i}function AR(n,e,t,r){let i=1,s=n[0];for(;s!==void 0&&s[r]===void 0;)s=n[i++];if(s===void 0)return;let o=s[r];if(o!==void 0)if(Array.isArray(o))do o=s[r],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[i++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[r],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[i++];while(s!==void 0);else do o=s[r],o!==void 0&&(e.push(s.time),t.push(o)),s=n[i++];while(s!==void 0)}function ase(n,e,t,r,i=30){const s=n.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),f=[],p=[];for(let m=0;m<c.times.length;++m){const y=c.times[m]*i;if(!(y<t||y>=r)){f.push(c.times[m]);for(let A=0;A<u;++A)p.push(c.values[m*u+A])}}f.length!==0&&(c.times=Vu(f,c.times.constructor),c.values=Vu(p,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function lse(n,e=0,t=n,r=30){r<=0&&(r=30);const i=t.tracks.length,s=e/r;for(let o=0;o<i;++o){const a=t.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=n.tracks.find(function(g){return g.name===a.name&&g.ValueTypeName===l});if(c===void 0)continue;let u=0;const f=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=f/3);let p=0;const m=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=m/3);const y=a.times.length-1;let A;if(s<=a.times[0]){const g=u,E=f-u;A=a.values.slice(g,E)}else if(s>=a.times[y]){const g=y*f+u,E=g+f-u;A=a.values.slice(g,E)}else{const g=a.createInterpolant(),E=u,x=f-u;g.evaluate(s),A=g.resultBuffer.slice(E,x)}l==="quaternion"&&new mi().fromArray(A).normalize().conjugate().toArray(A);const _=c.times.length;for(let g=0;g<_;++g){const E=g*m+p;if(l==="quaternion")mi.multiplyQuaternionsFlat(c.values,E,A,0,c.values,E);else{const x=m-p*2;for(let T=0;T<x;++T)c.values[E+T]-=A[T]}}}return n.blendMode=YM,n}const cse={convertArray:Vu,isTypedArray:BH,getKeyframeOrder:NH,sortedArray:yC,flattenJSON:AR,subclip:ase,makeClipAdditive:lse};class sp{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],s=t[r-1];e:{t:{let o;n:{r:if(!(e<i)){for(let a=r+2;;){if(i===void 0){if(e<s)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(s=i,i=t[++r],e<i)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(r=2,s=a);for(let l=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===l)break;if(i=s,s=t[--r-1],e>=s)break t}o=r,r=0;break n}break e}for(;r<o;){const a=r+o>>>1;e<t[a]?o=a:r=a+1}if(i=t[r],s=t[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let o=0;o!==i;++o)t[o]=r[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class kH extends sp{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Fu,endingEnd:Fu}}intervalChanged_(e,t,r){const i=this.parameterPositions;let s=e-2,o=e+1,a=i[s],l=i[o];if(a===void 0)switch(this.getSettings_().endingStart){case Uu:s=e,a=2*t-r;break;case Rg:s=i.length-2,a=t+i[s]-i[s+1];break;default:s=e,a=r}if(l===void 0)switch(this.getSettings_().endingEnd){case Uu:o=e,l=2*r-t;break;case Rg:o=1,l=r+i[1]-i[0];break;default:o=e-1,l=t}const c=(r-t)*.5,u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-r),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,f=this._offsetNext,p=this._weightPrev,m=this._weightNext,y=(r-t)/(i-t),A=y*y,_=A*y,g=-p*_+2*p*A-p*y,E=(1+p)*_+(-1.5-2*p)*A+(-.5+p)*y+1,x=(-1-m)*_+(1.5+m)*A+.5*y,T=m*_-m*A;for(let O=0;O!==a;++O)s[O]=g*o[u+O]+E*o[c+O]+x*o[l+O]+T*o[f+O];return s}}class wR extends sp{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(r-t)/(i-t),f=1-u;for(let p=0;p!==a;++p)s[p]=o[c+p]*f+o[l+p]*u;return s}}class FH extends sp{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class ra{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Vu(t,this.TimeBufferType),this.values=Vu(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Vu(e.times,Array),values:Vu(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new FH(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new wR(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new kH(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Rd:t=this.InterpolantFactoryMethodDiscrete;break;case gh:t=this.InterpolantFactoryMethodLinear;break;case O_:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Rd;case this.InterpolantFactoryMethodLinear:return gh;case this.InterpolantFactoryMethodSmooth:return O_}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let s=0,o=i-1;for(;s!==i&&r[s]<e;)++s;for(;o!==-1&&r[o]>t;)--o;if(++o,s!==0||o!==i){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=r.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=r[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(i!==void 0&&BH(i))for(let a=0,l=i.length;a!==l;++a){const c=i[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),i=this.getInterpolation()===O_,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a],u=e[a+1];if(c!==u&&(a!==1||c!==e[0]))if(i)l=!0;else{const f=a*r,p=f-r,m=f+r;for(let y=0;y!==r;++y){const A=t[f+y];if(A!==t[p+y]||A!==t[m+y]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const f=a*r,p=o*r;for(let m=0;m!==r;++m)t[p+m]=t[f+m]}++o}}if(s>0){e[o]=e[s];for(let a=s*r,l=o*r,c=0;c!==r;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*r)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}ra.prototype.TimeBufferType=Float32Array;ra.prototype.ValueBufferType=Float32Array;ra.prototype.DefaultInterpolation=gh;class Mh extends ra{}Mh.prototype.ValueTypeName="bool";Mh.prototype.ValueBufferType=Array;Mh.prototype.DefaultInterpolation=Rd;Mh.prototype.InterpolantFactoryMethodLinear=void 0;Mh.prototype.InterpolantFactoryMethodSmooth=void 0;class SR extends ra{}SR.prototype.ValueTypeName="color";class Od extends ra{}Od.prototype.ValueTypeName="number";class UH extends sp{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(r-t)/(i-t);let c=e*a;for(let u=c+a;c!==u;c+=4)mi.slerpFlat(s,0,o,c-a,o,c,l);return s}}class zc extends ra{InterpolantFactoryMethodLinear(e){return new UH(this.times,this.values,this.getValueSize(),e)}}zc.prototype.ValueTypeName="quaternion";zc.prototype.DefaultInterpolation=gh;zc.prototype.InterpolantFactoryMethodSmooth=void 0;class Rh extends ra{}Rh.prototype.ValueTypeName="string";Rh.prototype.ValueBufferType=Array;Rh.prototype.DefaultInterpolation=Rd;Rh.prototype.InterpolantFactoryMethodLinear=void 0;Rh.prototype.InterpolantFactoryMethodSmooth=void 0;class Bd extends ra{}Bd.prototype.ValueTypeName="vector";class Nd{constructor(e,t=-1,r,i=kx){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=zs(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let o=0,a=r.length;o!==a;++o)t.push(hse(r[o]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=r.length;s!==o;++s)t.push(ra.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=NH(l);l=yC(l,1,u),c=yC(c,1,u),!i&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new Od(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/r))}return new this(e,-1,o)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const f=u[1];let p=i[f];p||(i[f]=p=[]),p.push(c)}}const o=[];for(const a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],t,r));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(f,p,m,y,A){if(m.length!==0){const _=[],g=[];AR(m,_,g,y),_.length!==0&&A.push(new f(p,_,g))}},i=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let f=0;f<c.length;f++){const p=c[f].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const m={};let y;for(y=0;y<p.length;y++)if(p[y].morphTargets)for(let A=0;A<p[y].morphTargets.length;A++)m[p[y].morphTargets[A]]=-1;for(const A in m){const _=[],g=[];for(let E=0;E!==p[y].morphTargets.length;++E){const x=p[y];_.push(x.time),g.push(x.morphTarget===A?1:0)}i.push(new Od(".morphTargetInfluence["+A+"]",_,g))}l=m.length*o}else{const m=".bones["+t[f].name+"]";r(Bd,m+".position",p,"pos",i),r(zc,m+".quaternion",p,"rot",i),r(Bd,m+".scale",p,"scl",i)}}return i.length===0?null:new this(s,l,i,a)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function use(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Od;case"vector":case"vector2":case"vector3":case"vector4":return Bd;case"color":return SR;case"quaternion":return zc;case"bool":case"boolean":return Mh;case"string":return Rh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function hse(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=use(n.type);if(n.times===void 0){const t=[],r=[];AR(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const cl={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class TR{constructor(e,t,r){const i=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(u){a++,s===!1&&i.onStart!==void 0&&i.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,i.onProgress!==void 0&&i.onProgress(u,o,a),o===a&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(u){i.onError!==void 0&&i.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,f){return c.push(u,f),this},this.removeHandler=function(u){const f=c.indexOf(u);return f!==-1&&c.splice(f,2),this},this.getHandler=function(u){for(let f=0,p=c.length;f<p;f+=2){const m=c[f],y=c[f+1];if(m.global&&(m.lastIndex=0),m.test(u))return y}return null}}}const Kf=new TR;let Vi=class{constructor(e){this.manager=e!==void 0?e:Kf,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,s){r.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};Vi.DEFAULT_MATERIAL_NAME="__DEFAULT";const Ya={};class fse extends Error{constructor(e,t){super(e),this.response=t}}class Gs extends Vi{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=cl.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Ya[e]!==void 0){Ya[e].push({onLoad:t,onProgress:r,onError:i});return}Ya[e]=[],Ya[e].push({onLoad:t,onProgress:r,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=Ya[e],f=c.body.getReader(),p=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),m=p?parseInt(p):0,y=m!==0;let A=0;const _=new ReadableStream({start(g){E();function E(){f.read().then(({done:x,value:T})=>{if(x)g.close();else{A+=T.byteLength;const O=new ProgressEvent("progress",{lengthComputable:y,loaded:A,total:m});for(let I=0,b=u.length;I<b;I++){const R=u[I];R.onProgress&&R.onProgress(O)}g.enqueue(T),E()}})}}});return new Response(_)}else throw new fse(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return c.json();default:if(a===void 0)return c.text();{const f=/charset="?([^;"\s]*)"?/i.exec(a),p=f&&f[1]?f[1].toLowerCase():void 0,m=new TextDecoder(p);return c.arrayBuffer().then(y=>m.decode(y))}}}).then(c=>{cl.add(e,c);const u=Ya[e];delete Ya[e];for(let f=0,p=u.length;f<p;f++){const m=u[f];m.onLoad&&m.onLoad(c)}}).catch(c=>{const u=Ya[e];if(u===void 0)throw this.manager.itemError(e),c;delete Ya[e];for(let f=0,p=u.length;f<p;f++){const m=u[f];m.onError&&m.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class dse extends Vi{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Gs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=[];for(let r=0;r<e.length;r++){const i=Nd.parse(e[r]);t.push(i)}return t}}class pse extends Vi{constructor(e){super(e)}load(e,t,r,i){const s=this,o=[],a=new jx,l=new Gs(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(f){l.load(e[f],function(p){const m=s.parse(p,!0);o[f]={width:m.width,height:m.height,format:m.format,mipmaps:m.mipmaps},c+=1,c===6&&(m.mipmapCount===1&&(a.minFilter=Hn),a.image=o,a.format=m.format,a.needsUpdate=!0,t&&t(a))},r,i)}if(Array.isArray(e))for(let f=0,p=e.length;f<p;++f)u(f);else l.load(e,function(f){const p=s.parse(f,!0);if(p.isCubemap){const m=p.mipmaps.length/p.mipmapCount;for(let y=0;y<m;y++){o[y]={mipmaps:[]};for(let A=0;A<p.mipmapCount;A++)o[y].mipmaps.push(p.mipmaps[y*p.mipmapCount+A]),o[y].format=p.format,o[y].width=p.width,o[y].height=p.height}a.image=o}else a.image.width=p.width,a.image.height=p.height,a.mipmaps=p.mipmaps;p.mipmapCount===1&&(a.minFilter=Hn),a.format=p.format,a.needsUpdate=!0,t&&t(a)},r,i);return a}}class zg extends Vi{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=cl.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Og("img");function l(){u(),cl.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(f){u(),i&&i(f),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class zH extends Vi{constructor(e){super(e)}load(e,t,r,i){const s=new yy;s.colorSpace=Hr;const o=new zg(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let c=0;c<e.length;++c)l(c);return s}}class CR extends Vi{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Qu,a=new Gs(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let c;try{c=s.parse(l)}catch(u){if(i!==void 0)i(u);else{console.error(u);return}}c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:hi,o.wrapT=c.wrapT!==void 0?c.wrapT:hi,o.magFilter=c.magFilter!==void 0?c.magFilter:Hn,o.minFilter=c.minFilter!==void 0?c.minFilter:Hn,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0?o.colorSpace=c.colorSpace:c.encoding!==void 0&&(o.encoding=c.encoding),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=Ia),c.mipmapCount===1&&(o.minFilter=Hn),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c)},r,i),o}}class HH extends Vi{constructor(e){super(e)}load(e,t,r,i){const s=new Qn,o=new zg(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},r,i),s}}class Zc extends dn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new st(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class VH extends Zc{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(dn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new st(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Mw=new Bt,RO=new J,IO=new J;class bR{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Be(512,512),this.map=null,this.mapPass=null,this.matrix=new Bt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new vy,this._frameExtents=new Be(1,1),this._viewportCount=1,this._viewports=[new In(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;RO.setFromMatrixPosition(e.matrixWorld),t.position.copy(RO),IO.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(IO),t.updateMatrixWorld(),Mw.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Mw),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(Mw)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class mse extends bR{constructor(){super(new Mr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=Pd*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(r!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=r,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class MR extends Zc{constructor(e,t,r=0,i=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(dn.DEFAULT_UP),this.updateMatrix(),this.target=new dn,this.distance=r,this.angle=i,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new mse}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const PO=new Bt,am=new J,Rw=new J;class gse extends bR{constructor(){super(new Mr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Be(4,2),this._viewportCount=6,this._viewports=[new In(2,1,1,1),new In(0,1,1,1),new In(3,1,1,1),new In(1,1,1,1),new In(3,0,1,1),new In(1,0,1,1)],this._cubeDirections=[new J(1,0,0),new J(-1,0,0),new J(0,0,1),new J(0,0,-1),new J(0,1,0),new J(0,-1,0)],this._cubeUps=[new J(0,1,0),new J(0,1,0),new J(0,1,0),new J(0,1,0),new J(0,0,1),new J(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,i=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),am.setFromMatrixPosition(e.matrixWorld),r.position.copy(am),Rw.copy(r.position),Rw.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(Rw),r.updateMatrixWorld(),i.makeTranslation(-am.x,-am.y,-am.z),PO.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(PO)}}class RR extends Zc{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new gse}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class yse extends bR{constructor(){super(new qc(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class IR extends Zc{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(dn.DEFAULT_UP),this.updateMatrix(),this.target=new dn,this.shadow=new yse}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class GH extends Zc{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class WH extends Zc{constructor(e,t,r=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class $H{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new J)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*i),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*r),t.addScaledVector(o[4],1.092548*(r*i)),t.addScaledVector(o[5],1.092548*(i*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(r*s)),t.addScaledVector(o[8],.546274*(r*r-i*i)),t}getIrradianceAt(e,t){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*i),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*r),t.addScaledVector(o[4],2*.429043*r*i),t.addScaledVector(o[5],2*.429043*i*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*r*s),t.addScaledVector(o[8],.429043*(r*r-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const r=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*r,t[4]=1.092548*r*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*r*s,t[8]=.546274*(r*r-i*i)}}class jH extends Zc{constructor(e=new $H,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class oA extends Vi{constructor(e){super(e),this.textures={}}load(e,t,r,i){const s=this,o=new Gs(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=this.textures;function r(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const i=oA.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new st().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(i.uniforms[s]={},o.type){case"t":i.uniforms[s].value=r(o.value);break;case"c":i.uniforms[s].value=new st().setHex(o.value);break;case"v2":i.uniforms[s].value=new Be().fromArray(o.value);break;case"v3":i.uniforms[s].value=new J().fromArray(o.value);break;case"v4":i.uniforms[s].value=new In().fromArray(o.value);break;case"m3":i.uniforms[s].value=new on().fromArray(o.value);break;case"m4":i.uniforms[s].value=new Bt().fromArray(o.value);break;default:i.uniforms[s].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=r(e.map)),e.matcap!==void 0&&(i.matcap=r(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new Be().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=r(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new Be().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:bH,SpriteMaterial:hR,RawShaderMaterial:MH,ShaderMaterial:qo,PointsMaterial:$x,MeshPhysicalMaterial:Ba,MeshStandardMaterial:Cy,MeshPhongMaterial:RH,MeshToonMaterial:IH,MeshNormalMaterial:PH,MeshLambertMaterial:DH,MeshDepthMaterial:lR,MeshDistanceMaterial:cR,MeshBasicMaterial:ks,MeshMatcapMaterial:LH,LineDashedMaterial:OH,LineBasicMaterial:Hi,Material:kr};return new t[e]}}class Sa{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class XH extends Jt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class KH extends Vi{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Gs(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t={},r={};function i(m,y){if(t[y]!==void 0)return t[y];const _=m.interleavedBuffers[y],g=s(m,_.buffer),E=Wf(_.type,g),x=new Ey(E,_.stride);return x.uuid=_.uuid,t[y]=x,x}function s(m,y){if(r[y]!==void 0)return r[y];const _=m.arrayBuffers[y],g=new Uint32Array(_).buffer;return r[y]=g,g}const o=e.isInstancedBufferGeometry?new XH:new Jt,a=e.data.index;if(a!==void 0){const m=Wf(a.type,a.array);o.setIndex(new _n(m,1))}const l=e.data.attributes;for(const m in l){const y=l[m];let A;if(y.isInterleavedBufferAttribute){const _=i(e.data,y.data);A=new Uc(_,y.itemSize,y.offset,y.normalized)}else{const _=Wf(y.type,y.array),g=y.isInstancedBufferAttribute?Ld:_n;A=new g(_,y.itemSize,y.normalized)}y.name!==void 0&&(A.name=y.name),y.usage!==void 0&&A.setUsage(y.usage),o.setAttribute(m,A)}const c=e.data.morphAttributes;if(c)for(const m in c){const y=c[m],A=[];for(let _=0,g=y.length;_<g;_++){const E=y[_];let x;if(E.isInterleavedBufferAttribute){const T=i(e.data,E.data);x=new Uc(T,E.itemSize,E.offset,E.normalized)}else{const T=Wf(E.type,E.array);x=new _n(T,E.itemSize,E.normalized)}E.name!==void 0&&(x.name=E.name),A.push(x)}o.morphAttributes[m]=A}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const f=e.data.groups||e.data.drawcalls||e.data.offsets;if(f!==void 0)for(let m=0,y=f.length;m!==y;++m){const A=f[m];o.addGroup(A.start,A.count,A.materialIndex)}const p=e.data.boundingSphere;if(p!==void 0){const m=new J;p.center!==void 0&&m.fromArray(p.center),o.boundingSphere=new ni(m,p.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class vse extends Vi{constructor(e){super(e)}load(e,t,r,i){const s=this,o=this.path===""?Sa.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Gs(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(f){i!==void 0&&i(f),console.error("THREE:ObjectLoader: Can't parse "+e+".",f.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,t)},r,i)}async loadAsync(e,t){const r=this,i=this.path===""?Sa.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new Gs(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(a)}parse(e,t){const r=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,function(){t!==void 0&&t(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,r),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),t!==void 0){let f=!1;for(const p in o)if(o[p].data instanceof HTMLImageElement){f=!0;break}f===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,a,o,t),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),l}parseShapes(e){const t={};if(e!==void 0)for(let r=0,i=e.length;r<i;r++){const s=new Zu().fromJSON(e[r]);t[s.uuid]=s}return t}parseSkeletons(e,t){const r={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new xy().fromJSON(e[s],i);r[a.uuid]=a}return r}parseGeometries(e,t){const r={};if(e!==void 0){const i=new KH;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=i.parse(l);break;default:l.type in MO?a=MO[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),r[l.uuid]=a}}return r}parseMaterials(e,t){const r={},i={};if(e!==void 0){const s=new oA;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];r[l.uuid]===void 0&&(r[l.uuid]=s.parse(l)),i[l.uuid]=r[l.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let r=0;r<e.length;r++){const i=e[r],s=Nd.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const r=this,i={};let s;function o(l){return r.manager.itemStart(l),s.load(l,function(){r.manager.itemEnd(l)},void 0,function(){r.manager.itemError(l),r.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:r.resourcePath+c;return o(u)}else return l.data?{data:Wf(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new TR(t);s=new zg(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const f=e[c],p=f.url;if(Array.isArray(p)){const m=[];for(let y=0,A=p.length;y<A;y++){const _=p[y],g=a(_);g!==null&&(g instanceof HTMLImageElement?m.push(g):m.push(new Qu(g.data,g.width,g.height)))}i[f.uuid]=new zu(m)}else{const m=a(f.url);i[f.uuid]=new zu(m)}}}return i}async parseImagesAsync(e){const t=this,r={};let i;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await i.loadAsync(l)}else return o.data?{data:Wf(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){i=new zg(this.manager),i.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.url;if(Array.isArray(c)){const u=[];for(let f=0,p=c.length;f<p;f++){const m=c[f],y=await s(m);y!==null&&(y instanceof HTMLImageElement?u.push(y):u.push(new Qu(y.data,y.width,y.height)))}r[l.uuid]=new zu(u)}else{const u=await s(l.url);r[l.uuid]=new zu(u)}}}return r}parseTextures(e,t){function r(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const i={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],c=l.data;let u;Array.isArray(c)?(u=new yy,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new Qu:u=new Qn,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=a.uuid,a.name!==void 0&&(u.name=a.name),a.mapping!==void 0&&(u.mapping=r(a.mapping,_se)),a.channel!==void 0&&(u.channel=a.channel),a.offset!==void 0&&u.offset.fromArray(a.offset),a.repeat!==void 0&&u.repeat.fromArray(a.repeat),a.center!==void 0&&u.center.fromArray(a.center),a.rotation!==void 0&&(u.rotation=a.rotation),a.wrap!==void 0&&(u.wrapS=r(a.wrap[0],DO),u.wrapT=r(a.wrap[1],DO)),a.format!==void 0&&(u.format=a.format),a.internalFormat!==void 0&&(u.internalFormat=a.internalFormat),a.type!==void 0&&(u.type=a.type),a.colorSpace!==void 0&&(u.colorSpace=a.colorSpace),a.encoding!==void 0&&(u.encoding=a.encoding),a.minFilter!==void 0&&(u.minFilter=r(a.minFilter,LO)),a.magFilter!==void 0&&(u.magFilter=r(a.magFilter,LO)),a.anisotropy!==void 0&&(u.anisotropy=a.anisotropy),a.flipY!==void 0&&(u.flipY=a.flipY),a.generateMipmaps!==void 0&&(u.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(u.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(u.compareFunction=a.compareFunction),a.userData!==void 0&&(u.userData=a.userData),i[a.uuid]=u}return i}parseObject(e,t,r,i,s){let o;function a(p){return t[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",p),t[p]}function l(p){if(p!==void 0){if(Array.isArray(p)){const m=[];for(let y=0,A=p.length;y<A;y++){const _=p[y];r[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",_),m.push(r[_])}return m}return r[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",p),r[p]}}function c(p){return i[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",p),i[p]}let u,f;switch(e.type){case"Scene":o=new Bg,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new st(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new Gx(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new Vx(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new Mr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new qc(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new GH(e.color,e.intensity);break;case"DirectionalLight":o=new IR(e.color,e.intensity);break;case"PointLight":o=new RR(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new WH(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new MR(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new VH(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new jH().fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),f=l(e.material),o=new fR(u,f),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),f=l(e.material),o=new Rr(u,f);break;case"InstancedMesh":u=a(e.geometry),f=l(e.material);const p=e.count,m=e.instanceMatrix,y=e.instanceColor;o=new dR(u,f,p),o.instanceMatrix=new Ld(new Float32Array(m.array),16),y!==void 0&&(o.instanceColor=new Ld(new Float32Array(y.array),y.itemSize));break;case"BatchedMesh":u=a(e.geometry),f=l(e.material),o=new gH(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,f),o.geometry=u,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(A=>{const _=new gi;_.min.fromArray(A.boxMin),_.max.fromArray(A.boxMax);const g=new ni;return g.radius=A.sphereRadius,g.center.fromArray(A.sphereCenter),{boxInitialized:A.boxInitialized,box:_,sphereInitialized:A.sphereInitialized,sphere:g}}),o._maxGeometryCount=e.maxGeometryCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=c(e.matricesTexture.uuid);break;case"LOD":o=new mH;break;case"Line":o=new Tl(a(e.geometry),l(e.material));break;case"LineLoop":o=new pR(a(e.geometry),l(e.material));break;case"LineSegments":o=new ta(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new mR(a(e.geometry),l(e.material));break;case"Sprite":o=new pH(l(e.material));break;case"Group":o=new ll;break;case"Bone":o=new Wx;break;default:o=new dn}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const p=e.children;for(let m=0;m<p.length;m++)o.add(this.parseObject(p[m],t,r,i,s))}if(e.animations!==void 0){const p=e.animations;for(let m=0;m<p.length;m++){const y=p[m];o.animations.push(s[y])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const p=e.levels;for(let m=0;m<p.length;m++){const y=p[m],A=o.getObjectByProperty("uuid",y.object);A!==void 0&&o.addLevel(A,y.distance,y.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const i=t[r.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(i,r.bindMatrix)}})}}const _se={UVMapping:Ox,CubeReflectionMapping:Ra,CubeRefractionMapping:kc,EquirectangularReflectionMapping:bd,EquirectangularRefractionMapping:bg,CubeUVReflectionMapping:tp},DO={RepeatWrapping:Fc,ClampToEdgeWrapping:hi,MirroredRepeatWrapping:Md},LO={NearestFilter:vr,NearestMipmapNearestFilter:Mg,NearestMipmapLinearFilter:cd,LinearFilter:Hn,LinearMipmapNearestFilter:Bx,LinearMipmapLinearFilter:Ia};class JH extends Vi{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=cl.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(c=>{t&&t(c),s.manager.itemEnd(e)}).catch(c=>{i&&i(c)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const l=fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return cl.add(e,c),t&&t(c),s.manager.itemEnd(e),c}).catch(function(c){i&&i(c),cl.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});cl.add(e,l),s.manager.itemStart(e)}}let B0;class PR{static getContext(){return B0===void 0&&(B0=new(window.AudioContext||window.webkitAudioContext)),B0}static setContext(e){B0=e}}class Ese extends Vi{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Gs(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const c=l.slice(0);PR.getContext().decodeAudioData(c,function(f){t(f)}).catch(a)}catch(c){a(c)}},r,i);function a(l){i?i(l):console.error(l),s.manager.itemError(e)}}}const OO=new Bt,BO=new Bt,_u=new Bt;class xse{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Mr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Mr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,_u.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,o=t.near*Math.tan(Yu*t.fov*.5)/t.zoom;let a,l;BO.elements[12]=-i,OO.elements[12]=i,a=-o*t.aspect+s,l=o*t.aspect+s,_u.elements[0]=2*t.near/(l-a),_u.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(_u),a=-o*t.aspect-s,l=o*t.aspect-s,_u.elements[0]=2*t.near/(l-a),_u.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(_u)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(BO),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(OO)}}class DR{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=NO(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=NO();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function NO(){return(typeof performance>"u"?Date:performance).now()}const Eu=new J,kO=new mi,Ase=new J,xu=new J;class wse extends dn{constructor(){super(),this.type="AudioListener",this.context=PR.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new DR}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Eu,kO,Ase),xu.set(0,0,-1).applyQuaternion(kO),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Eu.x,i),t.positionY.linearRampToValueAtTime(Eu.y,i),t.positionZ.linearRampToValueAtTime(Eu.z,i),t.forwardX.linearRampToValueAtTime(xu.x,i),t.forwardY.linearRampToValueAtTime(xu.y,i),t.forwardZ.linearRampToValueAtTime(xu.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(Eu.x,Eu.y,Eu.z),t.setOrientation(xu.x,xu.y,xu.z,r.x,r.y,r.z)}}let YH=class extends dn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}};const Au=new J,FO=new mi,Sse=new J,wu=new J;class Tse extends YH{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Au,FO,Sse),wu.set(0,0,1).applyQuaternion(FO);const t=this.panner;if(t.positionX){const r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Au.x,r),t.positionY.linearRampToValueAtTime(Au.y,r),t.positionZ.linearRampToValueAtTime(Au.z,r),t.orientationX.linearRampToValueAtTime(wu.x,r),t.orientationY.linearRampToValueAtTime(wu.y,r),t.orientationZ.linearRampToValueAtTime(wu.z,r)}else t.setPosition(Au.x,Au.y,Au.z),t.setOrientation(wu.x,wu.y,wu.z)}}class Cse{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}class qH{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,s,o;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,i=this.valueSize,s=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==i;++a)r[s+a]=r[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(r,s,0,a,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,i=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(r,i,l,1-s,t)}o>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(r[l]!==r[l+t]){a.setValue(r,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let s=r,o=i;s!==o;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,s){if(i>=.5)for(let o=0;o!==s;++o)e[t+o]=e[r+o]}_slerp(e,t,r,i){mi.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,s){const o=this._workIndex*s;mi.multiplyQuaternionsFlat(e,o,e,t,e,r),mi.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,r,i,s){const o=1-i;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[r+a]*i}}_lerpAdditive(e,t,r,i,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[r+o]*i}}}const LR="\\[\\]\\.:\\/",bse=new RegExp("["+LR+"]","g"),OR="[^"+LR+"]",Mse="[^"+LR.replace("\\.","")+"]",Rse=/((?:WC+[\/:])*)/.source.replace("WC",OR),Ise=/(WCOD+)?/.source.replace("WCOD",Mse),Pse=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",OR),Dse=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",OR),Lse=new RegExp("^"+Rse+Ise+Pse+Dse+"$"),Ose=["material","materials","bones","map"];class Bse{constructor(e,t,r){const i=r||vn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class vn{constructor(e,t,r){this.path=t,this.parsedPath=r||vn.parseTrackName(t),this.node=vn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new vn.Composite(e,t,r):new vn(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(bse,"")}static parseTrackName(e){const t=Lse.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);Ose.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=r(a.children);if(l)return l}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=vn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let c=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[i];if(o===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}vn.Composite=Bse;vn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};vn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};vn.prototype.GetterByBindingType=[vn.prototype._getValue_direct,vn.prototype._getValue_array,vn.prototype._getValue_arrayElement,vn.prototype._getValue_toArray];vn.prototype.SetterByBindingTypeAndVersioning=[[vn.prototype._setValue_direct,vn.prototype._setValue_direct_setNeedsUpdate,vn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[vn.prototype._setValue_array,vn.prototype._setValue_array_setNeedsUpdate,vn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[vn.prototype._setValue_arrayElement,vn.prototype._setValue_arrayElement_setNeedsUpdate,vn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[vn.prototype._setValue_fromArray,vn.prototype._setValue_fromArray_setNeedsUpdate,vn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Nse{constructor(){this.isAnimationObjectGroup=!0,this.uuid=zs(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,i=arguments.length;r!==i;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,i=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let u=0,f=arguments.length;u!==f;++u){const p=arguments[u],m=p.uuid;let y=t[m];if(y===void 0){y=l++,t[m]=y,e.push(p);for(let A=0,_=o;A!==_;++A)s[A].push(new vn(p,r[A],i[A]))}else if(y<c){a=e[y];const A=--c,_=e[A];t[_.uuid]=y,e[y]=_,t[m]=A,e[A]=p;for(let g=0,E=o;g!==E;++g){const x=s[g],T=x[A];let O=x[y];x[y]=T,O===void 0&&(O=new vn(p,r[g],i[g])),x[A]=O}}else e[y]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,u=t[c];if(u!==void 0&&u>=s){const f=s++,p=e[f];t[p.uuid]=u,e[u]=p,t[c]=f,e[f]=l;for(let m=0,y=i;m!==y;++m){const A=r[m],_=A[f],g=A[u];A[u]=_,A[f]=g}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],u=c.uuid,f=t[u];if(f!==void 0)if(delete t[u],f<s){const p=--s,m=e[p],y=--o,A=e[y];t[m.uuid]=f,e[f]=m,t[A.uuid]=p,e[p]=A,e.pop();for(let _=0,g=i;_!==g;++_){const E=r[_],x=E[p],T=E[y];E[f]=x,E[p]=T,E.pop()}}else{const p=--o,m=e[p];p>0&&(t[m.uuid]=f),e[f]=m,e.pop();for(let y=0,A=i;y!==A;++y){const _=r[y];_[f]=_[p],_.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const r=this._bindingsIndicesByPath;let i=r[e];const s=this._bindings;if(i!==void 0)return s[i];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,f=new Array(c);i=s.length,r[e]=i,o.push(e),a.push(t),s.push(f);for(let p=u,m=l.length;p!==m;++p){const y=l[p];f[p]=new vn(y,e,t)}return f}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(r!==void 0){const i=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];t[c]=r,o[r]=l,o.pop(),s[r]=s[a],s.pop(),i[r]=i[a],i.pop()}}}class QH{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:Fu,endingEnd:Fu};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Fz,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const i=this._clip.duration,s=e._clip.duration,o=s/i,a=i/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const i=this._mixer,s=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+r,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*r;l<0||r===0?t=0:(this._startTime=null,t=r*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case YM:for(let u=0,f=l.length;u!==f;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);break;case kx:default:for(let u=0,f=l.length;u!==f;++u)l[u].evaluate(o),c[u].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const o=r===Uz;if(e===0)return s===-1?i:o&&(s&1)===1?t-i:i;if(r===kz){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){const a=Math.floor(i/t);i-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(o&&(s&1)===1)return t-i}return i}_setEndings(e,t,r){const i=this._interpolantSettings;r?(i.endingStart=Uu,i.endingEnd=Uu):(e?i.endingStart=this.zeroSlopeAtStart?Uu:Fu:i.endingStart=Rg,t?i.endingEnd=this.zeroSlopeAtEnd?Uu:Fu:i.endingEnd=Rg)}_scheduleFading(e,t,r){const i=this._mixer,s=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=r,this}}const kse=new Float32Array(1);class ZH extends Dl{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,o=e._propertyBindings,a=e._interpolants,l=r.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let f=0;f!==s;++f){const p=i[f],m=p.name;let y=u[m];if(y!==void 0)++y.referenceCount,o[f]=y;else{if(y=o[f],y!==void 0){y._cacheIndex===null&&(++y.referenceCount,this._addInactiveBinding(y,l,m));continue}const A=t&&t._propertyBindings[f].binding.parsedPath;y=new qH(vn.create(r,m,A),p.ValueTypeName,p.getValueSize()),++y.referenceCount,this._addInactiveBinding(y,l,m),o[f]=y}a[f].resultBuffer=y.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const i=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;const f=a.actionByRoot,p=(e._localRoot||this._root).uuid;delete f[p],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_addInactiveBinding(e,t,r){const i=this._bindingsByRootAndName,s=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,o=this._bindingsByRootAndName,a=o[i],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[i]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new wR(new Float32Array(2),new Float32Array(2),1,kse),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=r,t[r]=s}clipAction(e,t,r){const i=t||this._root,s=i.uuid;let o=typeof e=="string"?Nd.findByName(i,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(r===void 0&&(o!==null?r=o.blendMode:r=kx),l!==void 0){const f=l.actionByRoot[s];if(f!==void 0&&f.blendMode===r)return f;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const u=new QH(this,o,t,r);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,t){const r=t||this._root,i=r.uuid,s=typeof e=="string"?Nd.findByName(r,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==r;++c)t[c]._update(i,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,f=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,f._cacheIndex=u,t[u]=f,t.pop(),this._removeInactiveBindingsForAction(c)}delete i[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const o in r){const a=r[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class BR{constructor(e){this.value=e}clone(){return new BR(this.value.clone===void 0?this.value:this.value.clone())}}let Fse=0;class Use extends Dl{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Fse++}),this.name="",this.usage=Lg,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let r=0,i=t.length;r<i;r++){const s=Array.isArray(t[r])?t[r]:[t[r]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class zse extends Ey{constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Hse{constructor(e,t,r,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class aA{constructor(e,t,r=0,i=1/0){this.ray=new np(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new qu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return vC(e,this,r,t),r.sort(UO),r}intersectObjects(e,t=!0,r=[]){for(let i=0,s=e.length;i<s;i++)vC(e[i],this,r,t);return r.sort(UO),r}}function UO(n,e){return n.distance-e.distance}function vC(n,e,t,r){if(n.layers.test(e.layers)&&n.raycast(e,t),r===!0){const i=n.children;for(let s=0,o=i.length;s<o;s++)vC(i[s],e,t,!0)}}class eV{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(_r(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Vse{constructor(e=1,t=0,r=0){return this.radius=e,this.theta=t,this.y=r,this}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}}const zO=new Be;class Gse{constructor(e=new Be(1/0,1/0),t=new Be(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=zO.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,zO).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const HO=new J,N0=new J;class Wse{constructor(e=new J,t=new J){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){HO.subVectors(e,this.start),N0.subVectors(this.end,this.start);const r=N0.dot(N0);let s=N0.dot(HO)/r;return t&&(s=_r(s,0,1)),s}closestPointToPoint(e,t,r){const i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const VO=new J;class $se extends dn{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const r=new Jt,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,u=a/l*Math.PI*2;i.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}r.setAttribute("position",new Et(i,3));const s=new Hi({fog:!1,toneMapped:!1});this.cone=new ta(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),VO.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(VO),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Ql=new J,k0=new Bt,Iw=new Bt;class jse extends ta{constructor(e){const t=tV(e),r=new Jt,i=[],s=[],o=new st(0,0,1),a=new st(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}r.setAttribute("position",new Et(i,3)),r.setAttribute("color",new Et(s,3));const l=new Hi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,i=r.getAttribute("position");Iw.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(k0.multiplyMatrices(Iw,a.matrixWorld),Ql.setFromMatrixPosition(k0),i.setXYZ(o,Ql.x,Ql.y,Ql.z),k0.multiplyMatrices(Iw,a.parent.matrixWorld),Ql.setFromMatrixPosition(k0),i.setXYZ(o+1,Ql.x,Ql.y,Ql.z),o+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function tV(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,tV(n.children[t]));return e}class Xse extends Rr{constructor(e,t,r){const i=new Ty(t,4,2),s=new ks({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Kse=new J,GO=new st,WO=new st;class Jse extends dn{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const i=new Sy(t);i.rotateY(Math.PI*.5),this.material=new ks({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),o=new Float32Array(s.count*3);i.setAttribute("color",new _n(o,3)),this.add(new Rr(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");GO.copy(this.light.color),WO.copy(this.light.groundColor);for(let r=0,i=t.count;r<i;r++){const s=r<i/2?GO:WO;t.setXYZ(r,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Kse.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Yse extends ta{constructor(e=10,t=10,r=4473924,i=8947848){r=new st(r),i=new st(i);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let p=0,m=0,y=-a;p<=t;p++,y+=o){l.push(-a,0,y,a,0,y),l.push(y,0,-a,y,0,a);const A=p===s?r:i;A.toArray(c,m),m+=3,A.toArray(c,m),m+=3,A.toArray(c,m),m+=3,A.toArray(c,m),m+=3}const u=new Jt;u.setAttribute("position",new Et(l,3)),u.setAttribute("color",new Et(c,3));const f=new Hi({vertexColors:!0,toneMapped:!1});super(u,f),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class qse extends ta{constructor(e=10,t=16,r=8,i=64,s=4473924,o=8947848){s=new st(s),o=new st(o);const a=[],l=[];if(t>1)for(let f=0;f<t;f++){const p=f/t*(Math.PI*2),m=Math.sin(p)*e,y=Math.cos(p)*e;a.push(0,0,0),a.push(m,0,y);const A=f&1?s:o;l.push(A.r,A.g,A.b),l.push(A.r,A.g,A.b)}for(let f=0;f<r;f++){const p=f&1?s:o,m=e-e/r*f;for(let y=0;y<i;y++){let A=y/i*(Math.PI*2),_=Math.sin(A)*m,g=Math.cos(A)*m;a.push(_,0,g),l.push(p.r,p.g,p.b),A=(y+1)/i*(Math.PI*2),_=Math.sin(A)*m,g=Math.cos(A)*m,a.push(_,0,g),l.push(p.r,p.g,p.b)}}const c=new Jt;c.setAttribute("position",new Et(a,3)),c.setAttribute("color",new Et(l,3));const u=new Hi({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const $O=new J,F0=new J,jO=new J;class Qse extends dn{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new Jt;i.setAttribute("position",new Et([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Hi({fog:!1,toneMapped:!1});this.lightPlane=new Tl(i,s),this.add(this.lightPlane),i=new Jt,i.setAttribute("position",new Et([0,0,0,0,0,1],3)),this.targetLine=new Tl(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),$O.setFromMatrixPosition(this.light.matrixWorld),F0.setFromMatrixPosition(this.light.target.matrixWorld),jO.subVectors(F0,$O),this.lightPlane.lookAt(F0),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(F0),this.targetLine.scale.z=jO.length()}}const U0=new J,gr=new gy;class Zse extends ta{constructor(e){const t=new Jt,r=new Hi({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(y,A){l(y),l(A)}function l(y){i.push(0,0,0),s.push(0,0,0),o[y]===void 0&&(o[y]=[]),o[y].push(i.length/3-1)}t.setAttribute("position",new Et(i,3)),t.setAttribute("color",new Et(s,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new st(16755200),u=new st(16711680),f=new st(43775),p=new st(16777215),m=new st(3355443);this.setColors(c,u,f,p,m)}setColors(e,t,r,i,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,r.r,r.g,r.b),a.setXYZ(33,r.r,r.g,r.b),a.setXYZ(34,r.r,r.g,r.b),a.setXYZ(35,r.r,r.g,r.b),a.setXYZ(36,r.r,r.g,r.b),a.setXYZ(37,r.r,r.g,r.b),a.setXYZ(38,i.r,i.g,i.b),a.setXYZ(39,i.r,i.g,i.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,r=1,i=1;gr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Tr("c",t,e,gr,0,0,-1),Tr("t",t,e,gr,0,0,1),Tr("n1",t,e,gr,-r,-i,-1),Tr("n2",t,e,gr,r,-i,-1),Tr("n3",t,e,gr,-r,i,-1),Tr("n4",t,e,gr,r,i,-1),Tr("f1",t,e,gr,-r,-i,1),Tr("f2",t,e,gr,r,-i,1),Tr("f3",t,e,gr,-r,i,1),Tr("f4",t,e,gr,r,i,1),Tr("u1",t,e,gr,r*.7,i*1.1,-1),Tr("u2",t,e,gr,-r*.7,i*1.1,-1),Tr("u3",t,e,gr,0,i*2,-1),Tr("cf1",t,e,gr,-r,0,1),Tr("cf2",t,e,gr,r,0,1),Tr("cf3",t,e,gr,0,-i,1),Tr("cf4",t,e,gr,0,i,1),Tr("cn1",t,e,gr,-r,0,-1),Tr("cn2",t,e,gr,r,0,-1),Tr("cn3",t,e,gr,0,-i,-1),Tr("cn4",t,e,gr,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Tr(n,e,t,r,i,s,o){U0.set(i,s,o).unproject(r);const a=e[n];if(a!==void 0){const l=t.getAttribute("position");for(let c=0,u=a.length;c<u;c++)l.setXYZ(a[c],U0.x,U0.y,U0.z)}}const z0=new gi;class eoe extends ta{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new Jt;s.setIndex(new _n(r,1)),s.setAttribute("position",new _n(i,3)),super(s,new Hi({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&z0.setFromObject(this.object),z0.isEmpty())return;const t=z0.min,r=z0.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=t.x,s[4]=r.y,s[5]=r.z,s[6]=t.x,s[7]=t.y,s[8]=r.z,s[9]=r.x,s[10]=t.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=t.z,s[15]=t.x,s[16]=r.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=r.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class toe extends ta{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Jt;s.setIndex(new _n(r,1)),s.setAttribute("position",new Et(i,3)),super(s,new Hi({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class noe extends Tl{constructor(e,t=1,r=16776960){const i=r,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Jt;o.setAttribute("position",new Et(s,3)),o.computeBoundingSphere(),super(o,new Hi({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Jt;l.setAttribute("position",new Et(a,3)),l.computeBoundingSphere(),this.add(new Rr(l,new ks({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const XO=new J;let H0,Pw;class roe extends dn{constructor(e=new J(0,0,1),t=new J(0,0,0),r=1,i=16776960,s=r*.2,o=s*.2){super(),this.type="ArrowHelper",H0===void 0&&(H0=new Jt,H0.setAttribute("position",new Et([0,0,0,0,1,0],3)),Pw=new ip(0,.5,1,5,1),Pw.translate(0,-.5,0)),this.position.copy(t),this.line=new Tl(H0,new Hi({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Rr(Pw,new ks({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{XO.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(XO,t)}}setLength(e,t=e*.2,r=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class ioe extends ta{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Jt;i.setAttribute("position",new Et(t,3)),i.setAttribute("color",new Et(r,3));const s=new Hi({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,t,r){const i=new st,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(r),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class soe{constructor(){this.type="ShapePath",this.color=new st,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Ng,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,s,o){return this.currentPath.bezierCurveTo(e,t,r,i,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(g){const E=[];for(let x=0,T=g.length;x<T;x++){const O=g[x],I=new Zu;I.curves=O.curves,E.push(I)}return E}function r(g,E){const x=E.length;let T=!1;for(let O=x-1,I=0;I<x;O=I++){let b=E[O],R=E[I],C=R.x-b.x,M=R.y-b.y;if(Math.abs(M)>Number.EPSILON){if(M<0&&(b=E[I],C=-C,R=E[O],M=-M),g.y<b.y||g.y>R.y)continue;if(g.y===b.y){if(g.x===b.x)return!0}else{const B=M*(g.x-b.x)-C*(g.y-b.y);if(B===0)return!0;if(B<0)continue;T=!T}}else{if(g.y!==b.y)continue;if(R.x<=g.x&&g.x<=b.x||b.x<=g.x&&g.x<=R.x)return!0}}return T}const i=wa.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new Zu,l.curves=a.curves,c.push(l),c;let u=!i(s[0].getPoints());u=e?!u:u;const f=[],p=[];let m=[],y=0,A;p[y]=void 0,m[y]=[];for(let g=0,E=s.length;g<E;g++)a=s[g],A=a.getPoints(),o=i(A),o=e?!o:o,o?(!u&&p[y]&&y++,p[y]={s:new Zu,p:A},p[y].s.curves=a.curves,u&&y++,m[y]=[]):m[y].push({h:a,p:A[0]});if(!p[0])return t(s);if(p.length>1){let g=!1,E=0;for(let x=0,T=p.length;x<T;x++)f[x]=[];for(let x=0,T=p.length;x<T;x++){const O=m[x];for(let I=0;I<O.length;I++){const b=O[I];let R=!0;for(let C=0;C<p.length;C++)r(b.p,p[C].p)&&(x!==C&&E++,R?(R=!1,f[C].push(b)):g=!0);R&&f[x].push(b)}}E>0&&g===!1&&(m=f)}let _;for(let g=0,E=p.length;g<E;g++){l=p[g].s,c.push(l),_=m[g];for(let x=0,T=_.length;x<T;x++)l.holes.push(_[x].h)}return c}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ep}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ep);const ooe=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:HM,AddEquation:dc,AddOperation:wz,AdditiveAnimationBlendMode:YM,AdditiveBlending:DT,AgXToneMapping:Mz,AlphaFormat:Dz,AlwaysCompare:Yz,AlwaysDepth:gz,AlwaysStencilFunc:cC,AmbientLight:GH,AnimationAction:QH,AnimationClip:Nd,AnimationLoader:dse,AnimationMixer:ZH,AnimationObjectGroup:Nse,AnimationUtils:cse,ArcCurve:yH,ArrayCamera:hH,ArrowHelper:roe,AttachedBindMode:kT,Audio:YH,AudioAnalyser:Cse,AudioContext:PR,AudioListener:wse,AudioLoader:Ese,AxesHelper:ioe,BackSide:ns,BasicDepthPacking:Hz,BasicShadowMap:Q4,BatchedMesh:gH,Bone:Wx,BooleanKeyframeTrack:Mh,Box2:Gse,Box3:gi,Box3Helper:toe,BoxGeometry:bh,BoxHelper:eoe,BufferAttribute:_n,BufferGeometry:Jt,BufferGeometryLoader:KH,ByteType:Iz,Cache:cl,Camera:gy,CameraHelper:Zse,CanvasTexture:Lie,CapsuleGeometry:Kx,CatmullRomCurve3:vH,CineonToneMapping:Cz,CircleGeometry:Jx,ClampToEdgeWrapping:hi,Clock:DR,Color:st,ColorKeyframeTrack:SR,ColorManagement:Pn,CompressedArrayTexture:Pie,CompressedCubeTexture:Die,CompressedTexture:jx,CompressedTextureLoader:pse,ConeGeometry:Yx,ConstantAlphaFactor:dz,ConstantColorFactor:hz,CubeCamera:rH,CubeReflectionMapping:Ra,CubeRefractionMapping:kc,CubeTexture:yy,CubeTextureLoader:zH,CubeUVReflectionMapping:tp,CubicBezierCurve:yR,CubicBezierCurve3:_H,CubicInterpolant:kH,CullFaceBack:PT,CullFaceFront:q4,CullFaceFrontBack:TQ,CullFaceNone:Y4,Curve:na,CurvePath:xH,CustomBlending:Z4,CustomToneMapping:bz,CylinderGeometry:ip,Cylindrical:Vse,Data3DTexture:nR,DataArrayTexture:zx,DataTexture:Qu,DataTextureLoader:CR,DataUtils:Hu,DecrementStencilOp:OQ,DecrementWrapStencilOp:NQ,DefaultLoadingManager:Kf,DepthFormat:Mc,DepthStencilFormat:mh,DepthTexture:aR,DetachedBindMode:Rz,DirectionalLight:IR,DirectionalLightHelper:Qse,DiscreteInterpolant:FH,DisplayP3ColorSpace:Fx,DodecahedronGeometry:qx,DoubleSide:Os,DstAlphaFactor:oz,DstColorFactor:lz,DynamicCopyUsage:qQ,DynamicDrawUsage:$Q,DynamicReadUsage:KQ,EdgesGeometry:AH,EllipseCurve:Xx,EqualCompare:jz,EqualDepth:vz,EqualStencilFunc:zQ,EquirectangularReflectionMapping:bd,EquirectangularRefractionMapping:bg,Euler:my,EventDispatcher:Dl,ExtrudeGeometry:Zx,FileLoader:Gs,Float16BufferAttribute:NZ,Float32BufferAttribute:Et,Float64BufferAttribute:kZ,FloatType:fi,Fog:Gx,FogExp2:Vx,FramebufferTexture:Iie,FrontSide:Ma,Frustum:vy,GLBufferAttribute:Hse,GLSL1:ZQ,GLSL3:uC,GreaterCompare:Xz,GreaterDepth:Ez,GreaterEqualCompare:Jz,GreaterEqualDepth:_z,GreaterEqualStencilFunc:WQ,GreaterStencilFunc:VQ,GridHelper:Yse,Group:ll,HalfFloatType:Qi,HemisphereLight:VH,HemisphereLightHelper:Jse,IcosahedronGeometry:wy,ImageBitmapLoader:JH,ImageLoader:zg,ImageUtils:tR,IncrementStencilOp:LQ,IncrementWrapStencilOp:BQ,InstancedBufferAttribute:Ld,InstancedBufferGeometry:XH,InstancedInterleavedBuffer:zse,InstancedMesh:dR,Int16BufferAttribute:OZ,Int32BufferAttribute:BZ,Int8BufferAttribute:PZ,IntType:VM,InterleavedBuffer:Ey,InterleavedBufferAttribute:Uc,Interpolant:sp,InterpolateDiscrete:Rd,InterpolateLinear:gh,InterpolateSmooth:O_,InvertStencilOp:kQ,KeepStencilOp:Iu,KeyframeTrack:ra,LOD:mH,LatheGeometry:Ay,Layers:qu,LessCompare:$z,LessDepth:yz,LessEqualCompare:ZM,LessEqualDepth:Cg,LessEqualStencilFunc:HQ,LessStencilFunc:UQ,Light:Zc,LightProbe:jH,Line:Tl,Line3:Wse,LineBasicMaterial:Hi,LineCurve:vR,LineCurve3:EH,LineDashedMaterial:OH,LineLoop:pR,LineSegments:ta,LinearDisplayP3ColorSpace:py,LinearEncoding:QM,LinearFilter:Hn,LinearInterpolant:wR,LinearMipMapLinearFilter:IQ,LinearMipMapNearestFilter:RQ,LinearMipmapLinearFilter:Ia,LinearMipmapNearestFilter:Bx,LinearSRGBColorSpace:Pa,LinearToneMapping:Sz,LinearTransfer:Ig,Loader:Vi,LoaderUtils:Sa,LoadingManager:TR,LoopOnce:kz,LoopPingPong:Uz,LoopRepeat:Fz,LuminanceAlphaFormat:Oz,LuminanceFormat:Lz,MOUSE:wQ,Material:kr,MaterialLoader:oA,MathUtils:Ux,Matrix3:on,Matrix4:Bt,MaxEquation:NT,Mesh:Rr,MeshBasicMaterial:ks,MeshDepthMaterial:lR,MeshDistanceMaterial:cR,MeshLambertMaterial:DH,MeshMatcapMaterial:LH,MeshNormalMaterial:PH,MeshPhongMaterial:RH,MeshPhysicalMaterial:Ba,MeshStandardMaterial:Cy,MeshToonMaterial:IH,MinEquation:BT,MirroredRepeatWrapping:Md,MixOperation:Az,MultiplyBlending:OT,MultiplyOperation:dy,NearestFilter:vr,NearestMipMapLinearFilter:MQ,NearestMipMapNearestFilter:bQ,NearestMipmapLinearFilter:cd,NearestMipmapNearestFilter:Mg,NeverCompare:Wz,NeverDepth:mz,NeverStencilFunc:FQ,NoBlending:gl,NoColorSpace:Bs,NoToneMapping:xa,NormalAnimationBlendMode:kx,NormalBlending:Ju,NotEqualCompare:Kz,NotEqualDepth:xz,NotEqualStencilFunc:GQ,NumberKeyframeTrack:Od,Object3D:dn,ObjectLoader:vse,ObjectSpaceNormalMap:Gz,OctahedronGeometry:Sy,OneFactor:rz,OneMinusConstantAlphaFactor:pz,OneMinusConstantColorFactor:fz,OneMinusDstAlphaFactor:az,OneMinusDstColorFactor:cz,OneMinusSrcAlphaFactor:DE,OneMinusSrcColorFactor:sz,OrthographicCamera:qc,P3Primaries:Dg,PCFShadowMap:Lx,PCFSoftShadowMap:jm,PMREMGenerator:fC,Path:Ng,PerspectiveCamera:Mr,Plane:sc,PlaneGeometry:_y,PlaneHelper:noe,PointLight:RR,PointLightHelper:Xse,Points:mR,PointsMaterial:$x,PolarGridHelper:qse,PolyhedronGeometry:Qc,PositionalAudio:Tse,PropertyBinding:vn,PropertyMixer:qH,QuadraticBezierCurve:_R,QuadraticBezierCurve3:ER,Quaternion:mi,QuaternionKeyframeTrack:zc,QuaternionLinearInterpolant:UH,RED_GREEN_RGTC2_Format:aC,RED_RGTC1_Format:Nz,REVISION:ep,RGBADepthPacking:Vz,RGBAFormat:Ni,RGBAIntegerFormat:KM,RGBA_ASTC_10x10_Format:tC,RGBA_ASTC_10x5_Format:QT,RGBA_ASTC_10x6_Format:ZT,RGBA_ASTC_10x8_Format:eC,RGBA_ASTC_12x10_Format:nC,RGBA_ASTC_12x12_Format:rC,RGBA_ASTC_4x4_Format:WT,RGBA_ASTC_5x4_Format:$T,RGBA_ASTC_5x5_Format:jT,RGBA_ASTC_6x5_Format:XT,RGBA_ASTC_6x6_Format:KT,RGBA_ASTC_8x5_Format:JT,RGBA_ASTC_8x6_Format:YT,RGBA_ASTC_8x8_Format:qT,RGBA_BPTC_Format:L_,RGBA_ETC2_EAC_Format:GT,RGBA_PVRTC_2BPPV1_Format:HT,RGBA_PVRTC_4BPPV1_Format:zT,RGBA_S3TC_DXT1_Format:I_,RGBA_S3TC_DXT3_Format:P_,RGBA_S3TC_DXT5_Format:D_,RGB_BPTC_SIGNED_Format:iC,RGB_BPTC_UNSIGNED_Format:sC,RGB_ETC1_Format:JM,RGB_ETC2_Format:VT,RGB_PVRTC_2BPPV1_Format:UT,RGB_PVRTC_4BPPV1_Format:FT,RGB_S3TC_DXT1_Format:R_,RGFormat:Bz,RGIntegerFormat:XM,RawShaderMaterial:MH,Ray:np,Raycaster:aA,Rec709Primaries:Pg,RectAreaLight:WH,RedFormat:$M,RedIntegerFormat:jM,ReinhardToneMapping:Tz,RenderTarget:Zz,RepeatWrapping:Fc,ReplaceStencilOp:DQ,ReverseSubtractEquation:tz,RingGeometry:eA,SIGNED_RED_GREEN_RGTC2_Format:lC,SIGNED_RED_RGTC1_Format:oC,SRGBColorSpace:Hr,SRGBTransfer:Wn,Scene:Bg,ShaderChunk:en,ShaderLib:Uo,ShaderMaterial:qo,ShadowMaterial:bH,Shape:Zu,ShapeGeometry:tA,ShapePath:soe,ShapeUtils:wa,ShortType:Pz,Skeleton:xy,SkeletonHelper:jse,SkinnedMesh:fR,Source:zu,Sphere:ni,SphereGeometry:Ty,Spherical:eV,SphericalHarmonics3:$H,SplineCurve:xR,SpotLight:MR,SpotLightHelper:$se,Sprite:pH,SpriteMaterial:hR,SrcAlphaFactor:PE,SrcAlphaSaturateFactor:uz,SrcColorFactor:iz,StaticCopyUsage:YQ,StaticDrawUsage:Lg,StaticReadUsage:XQ,StereoCamera:xse,StreamCopyUsage:QQ,StreamDrawUsage:jQ,StreamReadUsage:JQ,StringKeyframeTrack:Rh,SubtractEquation:ez,SubtractiveBlending:LT,TOUCH:SQ,TangentSpaceNormalMap:Yc,TetrahedronGeometry:nA,Texture:Qn,TextureLoader:HH,TorusGeometry:rA,TorusKnotGeometry:iA,Triangle:ps,TriangleFanDrawMode:LE,TriangleStripDrawMode:qM,TrianglesDrawMode:zz,TubeGeometry:sA,TwoPassDoubleSide:CQ,UVMapping:Ox,Uint16BufferAttribute:rR,Uint32BufferAttribute:iR,Uint8BufferAttribute:DZ,Uint8ClampedBufferAttribute:LZ,Uniform:BR,UniformsGroup:Use,UniformsLib:nt,UniformsUtils:nH,UnsignedByteType:Aa,UnsignedInt248Type:bc,UnsignedIntType:al,UnsignedShort4444Type:GM,UnsignedShort5551Type:WM,UnsignedShortType:Nx,VSMShadowMap:Bo,Vector2:Be,Vector3:J,Vector4:In,VectorKeyframeTrack:Bd,VideoTexture:Rie,WebGL1Renderer:fH,WebGL3DRenderTarget:_Z,WebGLArrayRenderTarget:vZ,WebGLCoordinateSystem:Wo,WebGLCubeRenderTarget:sR,WebGLMultipleRenderTargets:EZ,WebGLRenderTarget:Yo,WebGLRenderer:uR,WebGLUtils:uH,WebGPUCoordinateSystem:Id,WireframeGeometry:CH,WrapAroundEnding:Rg,ZeroCurvatureEnding:Fu,ZeroFactor:nz,ZeroSlopeEnding:Uu,ZeroStencilOp:PQ,_SRGBAFormat:OE,createCanvasElement:Qz,sRGBEncoding:Rc},Symbol.toStringTag,{value:"Module"}));var nV={exports:{}},Ih={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Ih.ConcurrentRoot=1;Ih.ContinuousEventPriority=4;Ih.DefaultEventPriority=16;Ih.DiscreteEventPriority=1;Ih.IdleEventPriority=536870912;Ih.LegacyRoot=0;nV.exports=Ih;var Jf=nV.exports;function aoe(n){let e;const t=new Set,r=(c,u)=>{const f=typeof c=="function"?c(e):c;if(f!==e){const p=e;e=u?f:Object.assign({},e,f),t.forEach(m=>m(e,p))}},i=()=>e,s=(c,u=i,f=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let p=u(e);function m(){const y=u(e);if(!f(p,y)){const A=p;c(p=y,A)}}return t.add(m),()=>t.delete(m)},l={setState:r,getState:i,subscribe:(c,u,f)=>u||f?s(c,u,f):(t.add(c),()=>t.delete(c)),destroy:()=>t.clear()};return e=n(r,i,l),l}const loe=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),KO=loe?D.useEffect:D.useLayoutEffect;function lA(n){const e=typeof n=="function"?aoe(n):n,t=(r=e.getState,i=Object.is)=>{const[,s]=D.useReducer(_=>_+1,0),o=e.getState(),a=D.useRef(o),l=D.useRef(r),c=D.useRef(i),u=D.useRef(!1),f=D.useRef();f.current===void 0&&(f.current=r(o));let p,m=!1;(a.current!==o||l.current!==r||c.current!==i||u.current)&&(p=r(o),m=!i(f.current,p)),KO(()=>{m&&(f.current=p),a.current=o,l.current=r,c.current=i,u.current=!1});const y=D.useRef(o);KO(()=>{const _=()=>{try{const E=e.getState(),x=l.current(E);c.current(f.current,x)||(a.current=E,f.current=x,s())}catch{u.current=!0,s()}},g=e.subscribe(_);return e.getState()!==y.current&&_(),g},[]);const A=m?p:f.current;return D.useDebugValue(A),A};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[t,e];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},t}var rV={exports:{}},iV={exports:{}},sV={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(X,ee){var ie=X.length;X.push(ee);e:for(;0<ie;){var fe=ie-1>>>1,me=X[fe];if(0<i(me,ee))X[fe]=ee,X[ie]=me,ie=fe;else break e}}function t(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var ee=X[0],ie=X.pop();if(ie!==ee){X[0]=ie;e:for(var fe=0,me=X.length,he=me>>>1;fe<he;){var Ae=2*(fe+1)-1,De=X[Ae],Ie=Ae+1,He=X[Ie];if(0>i(De,ie))Ie<me&&0>i(He,De)?(X[fe]=He,X[Ie]=ie,fe=Ie):(X[fe]=De,X[Ae]=ie,fe=Ae);else if(Ie<me&&0>i(He,ie))X[fe]=He,X[Ie]=ie,fe=Ie;else break e}}return ee}function i(X,ee){var ie=X.sortIndex-ee.sortIndex;return ie!==0?ie:X.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,f=null,p=3,m=!1,y=!1,A=!1,_=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(X){for(var ee=t(c);ee!==null;){if(ee.callback===null)r(c);else if(ee.startTime<=X)r(c),ee.sortIndex=ee.expirationTime,e(l,ee);else break;ee=t(c)}}function T(X){if(A=!1,x(X),!y)if(t(l)!==null)y=!0,oe(O);else{var ee=t(c);ee!==null&&le(T,ee.startTime-X)}}function O(X,ee){y=!1,A&&(A=!1,g(R),R=-1),m=!0;var ie=p;try{for(x(ee),f=t(l);f!==null&&(!(f.expirationTime>ee)||X&&!B());){var fe=f.callback;if(typeof fe=="function"){f.callback=null,p=f.priorityLevel;var me=fe(f.expirationTime<=ee);ee=n.unstable_now(),typeof me=="function"?f.callback=me:f===t(l)&&r(l),x(ee)}else r(l);f=t(l)}if(f!==null)var he=!0;else{var Ae=t(c);Ae!==null&&le(T,Ae.startTime-ee),he=!1}return he}finally{f=null,p=ie,m=!1}}var I=!1,b=null,R=-1,C=5,M=-1;function B(){return!(n.unstable_now()-M<C)}function F(){if(b!==null){var X=n.unstable_now();M=X;var ee=!0;try{ee=b(!0,X)}finally{ee?z():(I=!1,b=null)}}else I=!1}var z;if(typeof E=="function")z=function(){E(F)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,Y=j.port2;j.port1.onmessage=F,z=function(){Y.postMessage(null)}}else z=function(){_(F,0)};function oe(X){b=X,I||(I=!0,z())}function le(X,ee){R=_(function(){X(n.unstable_now())},ee)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_continueExecution=function(){y||m||(y=!0,oe(O))},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(X){switch(p){case 1:case 2:case 3:var ee=3;break;default:ee=p}var ie=p;p=ee;try{return X()}finally{p=ie}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(X,ee){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var ie=p;p=X;try{return ee()}finally{p=ie}},n.unstable_scheduleCallback=function(X,ee,ie){var fe=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?fe+ie:fe):ie=fe,X){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=ie+me,X={id:u++,callback:ee,priorityLevel:X,startTime:ie,expirationTime:me,sortIndex:-1},ie>fe?(X.sortIndex=ie,e(c,X),t(l)===null&&X===t(c)&&(A?(g(R),R=-1):A=!0,le(T,ie-fe))):(X.sortIndex=me,e(l,X),y||m||(y=!0,oe(O))),X},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(X){var ee=p;return function(){var ie=p;p=ee;try{return X.apply(this,arguments)}finally{p=ie}}}})(sV);iV.exports=sV;var _C=iV.exports;/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var coe=function(e){var t={},r=D,i=_C,s=Object.assign;function o(h){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+h,w=1;w<arguments.length;w++)d+="&args[]="+encodeURIComponent(arguments[w]);return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),y=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),g=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),T=Symbol.for("react.offscreen"),O=Symbol.iterator;function I(h){return h===null||typeof h!="object"?null:(h=O&&h[O]||h["@@iterator"],typeof h=="function"?h:null)}function b(h){if(h==null)return null;if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case u:return"Fragment";case c:return"Portal";case p:return"Profiler";case f:return"StrictMode";case _:return"Suspense";case g:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case y:return(h.displayName||"Context")+".Consumer";case m:return(h._context.displayName||"Context")+".Provider";case A:var d=h.render;return h=h.displayName,h||(h=d.displayName||d.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case E:return d=h.displayName||null,d!==null?d:b(h.type)||"Memo";case x:d=h._payload,h=h._init;try{return b(h(d))}catch{}}return null}function R(h){var d=h.type;switch(h.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return h=d.render,h=h.displayName||h.name||"",d.displayName||(h!==""?"ForwardRef("+h+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return b(d);case 8:return d===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function C(h){var d=h,w=h;if(h.alternate)for(;d.return;)d=d.return;else{h=d;do d=h,d.flags&4098&&(w=d.return),h=d.return;while(h)}return d.tag===3?w:null}function M(h){if(C(h)!==h)throw Error(o(188))}function B(h){var d=h.alternate;if(!d){if(d=C(h),d===null)throw Error(o(188));return d!==h?null:h}for(var w=h,S=d;;){var P=w.return;if(P===null)break;var N=P.alternate;if(N===null){if(S=P.return,S!==null){w=S;continue}break}if(P.child===N.child){for(N=P.child;N;){if(N===w)return M(P),h;if(N===S)return M(P),d;N=N.sibling}throw Error(o(188))}if(w.return!==S.return)w=P,S=N;else{for(var Q=!1,ue=P.child;ue;){if(ue===w){Q=!0,w=P,S=N;break}if(ue===S){Q=!0,S=P,w=N;break}ue=ue.sibling}if(!Q){for(ue=N.child;ue;){if(ue===w){Q=!0,w=N,S=P;break}if(ue===S){Q=!0,S=N,w=P;break}ue=ue.sibling}if(!Q)throw Error(o(189))}}if(w.alternate!==S)throw Error(o(190))}if(w.tag!==3)throw Error(o(188));return w.stateNode.current===w?h:d}function F(h){return h=B(h),h!==null?z(h):null}function z(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){var d=z(h);if(d!==null)return d;h=h.sibling}return null}function j(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){if(h.tag!==4){var d=j(h);if(d!==null)return d}h=h.sibling}return null}var Y=Array.isArray,oe=e.getPublicInstance,le=e.getRootHostContext,X=e.getChildHostContext,ee=e.prepareForCommit,ie=e.resetAfterCommit,fe=e.createInstance,me=e.appendInitialChild,he=e.finalizeInitialChildren,Ae=e.prepareUpdate,De=e.shouldSetTextContent,Ie=e.createTextInstance,He=e.scheduleTimeout,rt=e.cancelTimeout,vt=e.noTimeout,Qe=e.isPrimaryRenderer,Xe=e.supportsMutation,te=e.supportsPersistence,Le=e.supportsHydration,be=e.getInstanceFromNode,Ne=e.preparePortalMount,Me=e.getCurrentEventPriority,ot=e.detachDeletedInstance,Ze=e.supportsMicrotasks,$=e.scheduleMicrotask,V=e.supportsTestSelectors,ce=e.findFiberRoot,ke=e.getBoundingRect,pe=e.getTextContent,ye=e.isHiddenSubtree,qe=e.matchAccessibilityRole,Ge=e.setFocusIfFocusable,Ke=e.setupIntersectionObserver,yt=e.appendChild,At=e.appendChildToContainer,Ue=e.commitTextUpdate,Qt=e.commitMount,Ht=e.commitUpdate,wt=e.insertBefore,it=e.insertInContainerBefore,at=e.removeChild,Ct=e.removeChildFromContainer,bt=e.resetTextContent,Wt=e.hideInstance,Gt=e.hideTextInstance,Ee=e.unhideInstance,ae=e.unhideTextInstance,tt=e.clearContainer,$e=e.cloneInstance,Pt=e.createContainerChildSet,xt=e.appendChildToContainerChildSet,hn=e.finalizeContainerChildren,En=e.replaceContainerChildren,Xn=e.cloneHiddenInstance,Fn=e.cloneHiddenTextInstance,An=e.canHydrateInstance,Ar=e.canHydrateTextInstance,Fr=e.canHydrateSuspenseInstance,As=e.isSuspenseInstancePending,sa=e.isSuspenseInstanceFallback,_i=e.registerSuspenseInstanceRetry,Ir=e.getNextHydratableSibling,jt=e.getFirstHydratableChild,Ei=e.getFirstHydratableChildWithinContainer,Na=e.getFirstHydratableChildWithinSuspenseInstance,H=e.hydrateInstance,G=e.hydrateTextInstance,se=e.hydrateSuspenseInstance,U=e.getNextHydratableInstanceAfterSuspenseInstance,K=e.commitHydratedContainer,q=e.commitHydratedSuspenseInstance,re=e.clearSuspenseBoundary,Z=e.clearSuspenseBoundaryFromContainer,ve=e.shouldDeleteUnhydratedTailInstances,we=e.didNotMatchHydratedContainerTextInstance,Te=e.didNotMatchHydratedTextInstance,Se;function ct(h){if(Se===void 0)try{throw Error()}catch(w){var d=w.stack.trim().match(/\n( *(at )?)/);Se=d&&d[1]||""}return`
`+Se+h}var ze=!1;function Ve(h,d){if(!h||ze)return"";ze=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(Ye){var S=Ye}Reflect.construct(h,[],d)}else{try{d.call()}catch(Ye){S=Ye}h.call(d.prototype)}else{try{throw Error()}catch(Ye){S=Ye}h()}}catch(Ye){if(Ye&&S&&typeof Ye.stack=="string"){for(var P=Ye.stack.split(`
`),N=S.stack.split(`
`),Q=P.length-1,ue=N.length-1;1<=Q&&0<=ue&&P[Q]!==N[ue];)ue--;for(;1<=Q&&0<=ue;Q--,ue--)if(P[Q]!==N[ue]){if(Q!==1||ue!==1)do if(Q--,ue--,0>ue||P[Q]!==N[ue]){var Re=`
`+P[Q].replace(" at new "," at ");return h.displayName&&Re.includes("<anonymous>")&&(Re=Re.replace("<anonymous>",h.displayName)),Re}while(1<=Q&&0<=ue);break}}}finally{ze=!1,Error.prepareStackTrace=w}return(h=h?h.displayName||h.name:"")?ct(h):""}var ft=Object.prototype.hasOwnProperty,St=[],Mt=-1;function Ft(h){return{current:h}}function ut(h){0>Mt||(h.current=St[Mt],St[Mt]=null,Mt--)}function et(h,d){Mt++,St[Mt]=h.current,h.current=d}var Yt={},Dt=Ft(Yt),Rt=Ft(!1),nn=Yt;function Ln(h,d){var w=h.type.contextTypes;if(!w)return Yt;var S=h.stateNode;if(S&&S.__reactInternalMemoizedUnmaskedChildContext===d)return S.__reactInternalMemoizedMaskedChildContext;var P={},N;for(N in w)P[N]=d[N];return S&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=d,h.__reactInternalMemoizedMaskedChildContext=P),P}function bn(h){return h=h.childContextTypes,h!=null}function un(){ut(Rt),ut(Dt)}function gt(h,d,w){if(Dt.current!==Yt)throw Error(o(168));et(Dt,d),et(Rt,w)}function On(h,d,w){var S=h.stateNode;if(d=d.childContextTypes,typeof S.getChildContext!="function")return w;S=S.getChildContext();for(var P in S)if(!(P in d))throw Error(o(108,R(h)||"Unknown",P));return s({},w,S)}function Vt(h){return h=(h=h.stateNode)&&h.__reactInternalMemoizedMergedChildContext||Yt,nn=Dt.current,et(Dt,h),et(Rt,Rt.current),!0}function qt(h,d,w){var S=h.stateNode;if(!S)throw Error(o(169));w?(h=On(h,d,nn),S.__reactInternalMemoizedMergedChildContext=h,ut(Rt),ut(Dt),et(Dt,h)):ut(Rt),et(Rt,w)}var Bn=Math.clz32?Math.clz32:js,Wi=Math.log,ri=Math.LN2;function js(h){return h>>>=0,h===0?32:31-(Wi(h)/ri|0)|0}var Dh=64,Lh=4194304;function wo(h){switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return h&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return h}}function Xs(h,d){var w=h.pendingLanes;if(w===0)return 0;var S=0,P=h.suspendedLanes,N=h.pingedLanes,Q=w&268435455;if(Q!==0){var ue=Q&~P;ue!==0?S=wo(ue):(N&=Q,N!==0&&(S=wo(N)))}else Q=w&~P,Q!==0?S=wo(Q):N!==0&&(S=wo(N));if(S===0)return 0;if(d!==0&&d!==S&&!(d&P)&&(P=S&-S,N=d&-d,P>=N||P===16&&(N&4194240)!==0))return d;if(S&4&&(S|=w&16),d=h.entangledLanes,d!==0)for(h=h.entanglements,d&=S;0<d;)w=31-Bn(d),P=1<<w,S|=h[w],d&=~P;return S}function Uy(h,d){switch(h){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zy(h,d){for(var w=h.suspendedLanes,S=h.pingedLanes,P=h.expirationTimes,N=h.pendingLanes;0<N;){var Q=31-Bn(N),ue=1<<Q,Re=P[Q];Re===-1?(!(ue&w)||ue&S)&&(P[Q]=Uy(ue,d)):Re<=d&&(h.expiredLanes|=ue),N&=~ue}}function Oh(h){return h=h.pendingLanes&-1073741825,h!==0?h:h&1073741824?1073741824:0}function Bh(h){for(var d=[],w=0;31>w;w++)d.push(h);return d}function Bl(h,d,w){h.pendingLanes|=d,d!==536870912&&(h.suspendedLanes=0,h.pingedLanes=0),h=h.eventTimes,d=31-Bn(d),h[d]=w}function Nl(h,d){var w=h.pendingLanes&~d;h.pendingLanes=d,h.suspendedLanes=0,h.pingedLanes=0,h.expiredLanes&=d,h.mutableReadLanes&=d,h.entangledLanes&=d,d=h.entanglements;var S=h.eventTimes;for(h=h.expirationTimes;0<w;){var P=31-Bn(w),N=1<<P;d[P]=0,S[P]=-1,h[P]=-1,w&=~N}}function mp(h,d){var w=h.entangledLanes|=d;for(h=h.entanglements;w;){var S=31-Bn(w),P=1<<S;P&d|h[S]&d&&(h[S]|=d),w&=~P}}var gn=0;function Hy(h){return h&=-h,1<h?4<h?h&268435455?16:536870912:4:1}var Ks=i.unstable_scheduleCallback,Vy=i.unstable_cancelCallback,gp=i.unstable_shouldYield,Nh=i.unstable_requestPaint,wr=i.unstable_now,ka=i.unstable_ImmediatePriority,eu=i.unstable_UserBlockingPriority,kh=i.unstable_NormalPriority,yp=i.unstable_IdlePriority,Un=null,Js=null;function gA(h){if(Js&&typeof Js.onCommitFiberRoot=="function")try{Js.onCommitFiberRoot(Un,h,void 0,(h.current.flags&128)===128)}catch{}}function Gy(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var ws=typeof Object.is=="function"?Object.is:Gy,Ys=null,Fa=!1,qs=!1;function vp(h){Ys===null?Ys=[h]:Ys.push(h)}function yA(h){Fa=!0,vp(h)}function xi(){if(!qs&&Ys!==null){qs=!0;var h=0,d=gn;try{var w=Ys;for(gn=1;h<w.length;h++){var S=w[h];do S=S(!0);while(S!==null)}Ys=null,Fa=!1}catch(P){throw Ys!==null&&(Ys=Ys.slice(h+1)),Ks(ka,xi),P}finally{gn=d,qs=!1}}return null}var Wy=a.ReactCurrentBatchConfig;function kl(h,d){if(ws(h,d))return!0;if(typeof h!="object"||h===null||typeof d!="object"||d===null)return!1;var w=Object.keys(h),S=Object.keys(d);if(w.length!==S.length)return!1;for(S=0;S<w.length;S++){var P=w[S];if(!ft.call(d,P)||!ws(h[P],d[P]))return!1}return!0}function Fh(h){switch(h.tag){case 5:return ct(h.type);case 16:return ct("Lazy");case 13:return ct("Suspense");case 19:return ct("SuspenseList");case 0:case 2:case 15:return h=Ve(h.type,!1),h;case 11:return h=Ve(h.type.render,!1),h;case 1:return h=Ve(h.type,!0),h;default:return""}}function ss(h,d){if(h&&h.defaultProps){d=s({},d),h=h.defaultProps;for(var w in h)d[w]===void 0&&(d[w]=h[w]);return d}return d}var Ua=Ft(null),Uh=null,za=null,Ha=null;function zh(){Ha=za=Uh=null}function _p(h,d,w){Qe?(et(Ua,d._currentValue),d._currentValue=w):(et(Ua,d._currentValue2),d._currentValue2=w)}function tu(h){var d=Ua.current;ut(Ua),Qe?h._currentValue=d:h._currentValue2=d}function nu(h,d,w){for(;h!==null;){var S=h.alternate;if((h.childLanes&d)!==d?(h.childLanes|=d,S!==null&&(S.childLanes|=d)):S!==null&&(S.childLanes&d)!==d&&(S.childLanes|=d),h===w)break;h=h.return}}function Va(h,d){Uh=h,Ha=za=null,h=h.dependencies,h!==null&&h.firstContext!==null&&(h.lanes&d&&(bs=!0),h.firstContext=null)}function ii(h){var d=Qe?h._currentValue:h._currentValue2;if(Ha!==h)if(h={context:h,memoizedValue:d,next:null},za===null){if(Uh===null)throw Error(o(308));za=h,Uh.dependencies={lanes:0,firstContext:h}}else za=za.next=h;return d}var Ss=null,So=!1;function To(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ep(h,d){h=h.updateQueue,d.updateQueue===h&&(d.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,effects:h.effects})}function Qs(h,d){return{eventTime:h,lane:d,tag:0,payload:null,callback:null,next:null}}function Co(h,d){var w=h.updateQueue;w!==null&&(w=w.shared,Pr!==null&&h.mode&1&&!(ln&2)?(h=w.interleaved,h===null?(d.next=d,Ss===null?Ss=[w]:Ss.push(w)):(d.next=h.next,h.next=d),w.interleaved=d):(h=w.pending,h===null?d.next=d:(d.next=h.next,h.next=d),w.pending=d))}function ru(h,d,w){if(d=d.updateQueue,d!==null&&(d=d.shared,(w&4194240)!==0)){var S=d.lanes;S&=h.pendingLanes,w|=S,d.lanes=w,mp(h,w)}}function iu(h,d){var w=h.updateQueue,S=h.alternate;if(S!==null&&(S=S.updateQueue,w===S)){var P=null,N=null;if(w=w.firstBaseUpdate,w!==null){do{var Q={eventTime:w.eventTime,lane:w.lane,tag:w.tag,payload:w.payload,callback:w.callback,next:null};N===null?P=N=Q:N=N.next=Q,w=w.next}while(w!==null);N===null?P=N=d:N=N.next=d}else P=N=d;w={baseState:S.baseState,firstBaseUpdate:P,lastBaseUpdate:N,shared:S.shared,effects:S.effects},h.updateQueue=w;return}h=w.lastBaseUpdate,h===null?w.firstBaseUpdate=d:h.next=d,w.lastBaseUpdate=d}function $r(h,d,w,S){var P=h.updateQueue;So=!1;var N=P.firstBaseUpdate,Q=P.lastBaseUpdate,ue=P.shared.pending;if(ue!==null){P.shared.pending=null;var Re=ue,Ye=Re.next;Re.next=null,Q===null?N=Ye:Q.next=Ye,Q=Re;var pt=h.alternate;pt!==null&&(pt=pt.updateQueue,ue=pt.lastBaseUpdate,ue!==Q&&(ue===null?pt.firstBaseUpdate=Ye:ue.next=Ye,pt.lastBaseUpdate=Re))}if(N!==null){var Xt=P.baseState;Q=0,pt=Ye=Re=null,ue=N;do{var Lt=ue.lane,zn=ue.eventTime;if((S&Lt)===Lt){pt!==null&&(pt=pt.next={eventTime:zn,lane:0,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null});e:{var It=h,Ci=ue;switch(Lt=d,zn=w,Ci.tag){case 1:if(It=Ci.payload,typeof It=="function"){Xt=It.call(zn,Xt,Lt);break e}Xt=It;break e;case 3:It.flags=It.flags&-65537|128;case 0:if(It=Ci.payload,Lt=typeof It=="function"?It.call(zn,Xt,Lt):It,Lt==null)break e;Xt=s({},Xt,Lt);break e;case 2:So=!0}}ue.callback!==null&&ue.lane!==0&&(h.flags|=64,Lt=P.effects,Lt===null?P.effects=[ue]:Lt.push(ue))}else zn={eventTime:zn,lane:Lt,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},pt===null?(Ye=pt=zn,Re=Xt):pt=pt.next=zn,Q|=Lt;if(ue=ue.next,ue===null){if(ue=P.shared.pending,ue===null)break;Lt=ue,ue=Lt.next,Lt.next=null,P.lastBaseUpdate=Lt,P.shared.pending=null}}while(!0);if(pt===null&&(Re=Xt),P.baseState=Re,P.firstBaseUpdate=Ye,P.lastBaseUpdate=pt,d=P.shared.interleaved,d!==null){P=d;do Q|=P.lane,P=P.next;while(P!==d)}else N===null&&(P.shared.lanes=0);Xh|=Q,h.lanes=Q,h.memoizedState=Xt}}function xp(h,d,w){if(h=d.effects,d.effects=null,h!==null)for(d=0;d<h.length;d++){var S=h[d],P=S.callback;if(P!==null){if(S.callback=null,S=w,typeof P!="function")throw Error(o(191,P));P.call(S)}}}var Ap=new r.Component().refs;function oa(h,d,w,S){d=h.memoizedState,w=w(S,d),w=w==null?d:s({},d,w),h.memoizedState=w,h.lanes===0&&(h.updateQueue.baseState=w)}var v={isMounted:function(h){return(h=h._reactInternals)?C(h)===h:!1},enqueueSetState:function(h,d,w){h=h._reactInternals;var S=ji(),P=zl(h),N=Qs(S,P);N.payload=d,w!=null&&(N.callback=w),Co(h,N),d=to(h,P,S),d!==null&&ru(d,h,P)},enqueueReplaceState:function(h,d,w){h=h._reactInternals;var S=ji(),P=zl(h),N=Qs(S,P);N.tag=1,N.payload=d,w!=null&&(N.callback=w),Co(h,N),d=to(h,P,S),d!==null&&ru(d,h,P)},enqueueForceUpdate:function(h,d){h=h._reactInternals;var w=ji(),S=zl(h),P=Qs(w,S);P.tag=2,d!=null&&(P.callback=d),Co(h,P),d=to(h,S,w),d!==null&&ru(d,h,S)}};function L(h,d,w,S,P,N,Q){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(S,N,Q):d.prototype&&d.prototype.isPureReactComponent?!kl(w,S)||!kl(P,N):!0}function k(h,d,w){var S=!1,P=Yt,N=d.contextType;return typeof N=="object"&&N!==null?N=ii(N):(P=bn(d)?nn:Dt.current,S=d.contextTypes,N=(S=S!=null)?Ln(h,P):Yt),d=new d(w,N),h.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=v,h.stateNode=d,d._reactInternals=h,S&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=P,h.__reactInternalMemoizedMaskedChildContext=N),d}function W(h,d,w,S){h=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(w,S),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(w,S),d.state!==h&&v.enqueueReplaceState(d,d.state,null)}function ge(h,d,w,S){var P=h.stateNode;P.props=w,P.state=h.memoizedState,P.refs=Ap,To(h);var N=d.contextType;typeof N=="object"&&N!==null?P.context=ii(N):(N=bn(d)?nn:Dt.current,P.context=Ln(h,N)),P.state=h.memoizedState,N=d.getDerivedStateFromProps,typeof N=="function"&&(oa(h,d,N,w),P.state=h.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(d=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),d!==P.state&&v.enqueueReplaceState(P,P.state,null),$r(h,w,P,S),P.state=h.memoizedState),typeof P.componentDidMount=="function"&&(h.flags|=4194308)}var _e=[],Je=0,$t=null,Zn=0,rn=[],Cn=0,jr=null,si=1,Xr="";function Ai(h,d){_e[Je++]=Zn,_e[Je++]=$t,$t=h,Zn=d}function su(h,d,w){rn[Cn++]=si,rn[Cn++]=Xr,rn[Cn++]=jr,jr=h;var S=si;h=Xr;var P=32-Bn(S)-1;S&=~(1<<P),w+=1;var N=32-Bn(d)+P;if(30<N){var Q=P-P%5;N=(S&(1<<Q)-1).toString(32),S>>=Q,P-=Q,si=1<<32-Bn(d)+P|w<<P|S,Xr=N+h}else si=1<<N|w<<P|S,Xr=h}function ou(h){h.return!==null&&(Ai(h,1),su(h,1,0))}function vA(h){for(;h===$t;)$t=_e[--Je],_e[Je]=null,Zn=_e[--Je],_e[Je]=null;for(;h===jr;)jr=rn[--Cn],rn[Cn]=null,Xr=rn[--Cn],rn[Cn]=null,si=rn[--Cn],rn[Cn]=null}var Ts=null,Cs=null,er=!1,wp=!1,bo=null;function dI(h,d){var w=no(5,null,null,0);w.elementType="DELETED",w.stateNode=d,w.return=h,d=h.deletions,d===null?(h.deletions=[w],h.flags|=16):d.push(w)}function pI(h,d){switch(h.tag){case 5:return d=An(d,h.type,h.pendingProps),d!==null?(h.stateNode=d,Ts=h,Cs=jt(d),!0):!1;case 6:return d=Ar(d,h.pendingProps),d!==null?(h.stateNode=d,Ts=h,Cs=null,!0):!1;case 13:if(d=Fr(d),d!==null){var w=jr!==null?{id:si,overflow:Xr}:null;return h.memoizedState={dehydrated:d,treeContext:w,retryLane:1073741824},w=no(18,null,null,0),w.stateNode=d,w.return=h,h.child=w,Ts=h,Cs=null,!0}return!1;default:return!1}}function _A(h){return(h.mode&1)!==0&&(h.flags&128)===0}function EA(h){if(er){var d=Cs;if(d){var w=d;if(!pI(h,d)){if(_A(h))throw Error(o(418));d=Ir(w);var S=Ts;d&&pI(h,d)?dI(S,w):(h.flags=h.flags&-4097|2,er=!1,Ts=h)}}else{if(_A(h))throw Error(o(418));h.flags=h.flags&-4097|2,er=!1,Ts=h}}}function mI(h){for(h=h.return;h!==null&&h.tag!==5&&h.tag!==3&&h.tag!==13;)h=h.return;Ts=h}function Sp(h){if(!Le||h!==Ts)return!1;if(!er)return mI(h),er=!0,!1;if(h.tag!==3&&(h.tag!==5||ve(h.type)&&!De(h.type,h.memoizedProps))){var d=Cs;if(d){if(_A(h)){for(h=Cs;h;)h=Ir(h);throw Error(o(418))}for(;d;)dI(h,d),d=Ir(d)}}if(mI(h),h.tag===13){if(!Le)throw Error(o(316));if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(o(317));Cs=U(h)}else Cs=Ts?Ir(h.stateNode):null;return!0}function Hh(){Le&&(Cs=Ts=null,wp=er=!1)}function xA(h){bo===null?bo=[h]:bo.push(h)}function Tp(h,d,w){if(h=w.ref,h!==null&&typeof h!="function"&&typeof h!="object"){if(w._owner){if(w=w._owner,w){if(w.tag!==1)throw Error(o(309));var S=w.stateNode}if(!S)throw Error(o(147,h));var P=S,N=""+h;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===N?d.ref:(d=function(Q){var ue=P.refs;ue===Ap&&(ue=P.refs={}),Q===null?delete ue[N]:ue[N]=Q},d._stringRef=N,d)}if(typeof h!="string")throw Error(o(284));if(!w._owner)throw Error(o(290,h))}return h}function $y(h,d){throw h=Object.prototype.toString.call(d),Error(o(31,h==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":h))}function gI(h){var d=h._init;return d(h._payload)}function yI(h){function d(xe,de){if(h){var Ce=xe.deletions;Ce===null?(xe.deletions=[de],xe.flags|=16):Ce.push(de)}}function w(xe,de){if(!h)return null;for(;de!==null;)d(xe,de),de=de.sibling;return null}function S(xe,de){for(xe=new Map;de!==null;)de.key!==null?xe.set(de.key,de):xe.set(de.index,de),de=de.sibling;return xe}function P(xe,de){return xe=Vl(xe,de),xe.index=0,xe.sibling=null,xe}function N(xe,de,Ce){return xe.index=Ce,h?(Ce=xe.alternate,Ce!==null?(Ce=Ce.index,Ce<de?(xe.flags|=2,de):Ce):(xe.flags|=2,de)):(xe.flags|=1048576,de)}function Q(xe){return h&&xe.alternate===null&&(xe.flags|=2),xe}function ue(xe,de,Ce,ht){return de===null||de.tag!==6?(de=i1(Ce,xe.mode,ht),de.return=xe,de):(de=P(de,Ce),de.return=xe,de)}function Re(xe,de,Ce,ht){var Tt=Ce.type;return Tt===u?pt(xe,de,Ce.props.children,ht,Ce.key):de!==null&&(de.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===x&&gI(Tt)===de.type)?(ht=P(de,Ce.props),ht.ref=Tp(xe,de,Ce),ht.return=xe,ht):(ht=Av(Ce.type,Ce.key,Ce.props,null,xe.mode,ht),ht.ref=Tp(xe,de,Ce),ht.return=xe,ht)}function Ye(xe,de,Ce,ht){return de===null||de.tag!==4||de.stateNode.containerInfo!==Ce.containerInfo||de.stateNode.implementation!==Ce.implementation?(de=s1(Ce,xe.mode,ht),de.return=xe,de):(de=P(de,Ce.children||[]),de.return=xe,de)}function pt(xe,de,Ce,ht,Tt){return de===null||de.tag!==7?(de=du(Ce,xe.mode,ht,Tt),de.return=xe,de):(de=P(de,Ce),de.return=xe,de)}function Xt(xe,de,Ce){if(typeof de=="string"&&de!==""||typeof de=="number")return de=i1(""+de,xe.mode,Ce),de.return=xe,de;if(typeof de=="object"&&de!==null){switch(de.$$typeof){case l:return Ce=Av(de.type,de.key,de.props,null,xe.mode,Ce),Ce.ref=Tp(xe,null,de),Ce.return=xe,Ce;case c:return de=s1(de,xe.mode,Ce),de.return=xe,de;case x:var ht=de._init;return Xt(xe,ht(de._payload),Ce)}if(Y(de)||I(de))return de=du(de,xe.mode,Ce,null),de.return=xe,de;$y(xe,de)}return null}function Lt(xe,de,Ce,ht){var Tt=de!==null?de.key:null;if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number")return Tt!==null?null:ue(xe,de,""+Ce,ht);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case l:return Ce.key===Tt?Re(xe,de,Ce,ht):null;case c:return Ce.key===Tt?Ye(xe,de,Ce,ht):null;case x:return Tt=Ce._init,Lt(xe,de,Tt(Ce._payload),ht)}if(Y(Ce)||I(Ce))return Tt!==null?null:pt(xe,de,Ce,ht,null);$y(xe,Ce)}return null}function zn(xe,de,Ce,ht,Tt){if(typeof ht=="string"&&ht!==""||typeof ht=="number")return xe=xe.get(Ce)||null,ue(de,xe,""+ht,Tt);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case l:return xe=xe.get(ht.key===null?Ce:ht.key)||null,Re(de,xe,ht,Tt);case c:return xe=xe.get(ht.key===null?Ce:ht.key)||null,Ye(de,xe,ht,Tt);case x:var sn=ht._init;return zn(xe,de,Ce,sn(ht._payload),Tt)}if(Y(ht)||I(ht))return xe=xe.get(Ce)||null,pt(de,xe,ht,Tt,null);$y(de,ht)}return null}function It(xe,de,Ce,ht){for(var Tt=null,sn=null,Kt=de,wn=de=0,Jr=null;Kt!==null&&wn<Ce.length;wn++){Kt.index>wn?(Jr=Kt,Kt=null):Jr=Kt.sibling;var Sn=Lt(xe,Kt,Ce[wn],ht);if(Sn===null){Kt===null&&(Kt=Jr);break}h&&Kt&&Sn.alternate===null&&d(xe,Kt),de=N(Sn,de,wn),sn===null?Tt=Sn:sn.sibling=Sn,sn=Sn,Kt=Jr}if(wn===Ce.length)return w(xe,Kt),er&&Ai(xe,wn),Tt;if(Kt===null){for(;wn<Ce.length;wn++)Kt=Xt(xe,Ce[wn],ht),Kt!==null&&(de=N(Kt,de,wn),sn===null?Tt=Kt:sn.sibling=Kt,sn=Kt);return er&&Ai(xe,wn),Tt}for(Kt=S(xe,Kt);wn<Ce.length;wn++)Jr=zn(Kt,xe,wn,Ce[wn],ht),Jr!==null&&(h&&Jr.alternate!==null&&Kt.delete(Jr.key===null?wn:Jr.key),de=N(Jr,de,wn),sn===null?Tt=Jr:sn.sibling=Jr,sn=Jr);return h&&Kt.forEach(function(Gl){return d(xe,Gl)}),er&&Ai(xe,wn),Tt}function Ci(xe,de,Ce,ht){var Tt=I(Ce);if(typeof Tt!="function")throw Error(o(150));if(Ce=Tt.call(Ce),Ce==null)throw Error(o(151));for(var sn=Tt=null,Kt=de,wn=de=0,Jr=null,Sn=Ce.next();Kt!==null&&!Sn.done;wn++,Sn=Ce.next()){Kt.index>wn?(Jr=Kt,Kt=null):Jr=Kt.sibling;var Gl=Lt(xe,Kt,Sn.value,ht);if(Gl===null){Kt===null&&(Kt=Jr);break}h&&Kt&&Gl.alternate===null&&d(xe,Kt),de=N(Gl,de,wn),sn===null?Tt=Gl:sn.sibling=Gl,sn=Gl,Kt=Jr}if(Sn.done)return w(xe,Kt),er&&Ai(xe,wn),Tt;if(Kt===null){for(;!Sn.done;wn++,Sn=Ce.next())Sn=Xt(xe,Sn.value,ht),Sn!==null&&(de=N(Sn,de,wn),sn===null?Tt=Sn:sn.sibling=Sn,sn=Sn);return er&&Ai(xe,wn),Tt}for(Kt=S(xe,Kt);!Sn.done;wn++,Sn=Ce.next())Sn=zn(Kt,xe,wn,Sn.value,ht),Sn!==null&&(h&&Sn.alternate!==null&&Kt.delete(Sn.key===null?wn:Sn.key),de=N(Sn,de,wn),sn===null?Tt=Sn:sn.sibling=Sn,sn=Sn);return h&&Kt.forEach(function(oG){return d(xe,oG)}),er&&Ai(xe,wn),Tt}function ro(xe,de,Ce,ht){if(typeof Ce=="object"&&Ce!==null&&Ce.type===u&&Ce.key===null&&(Ce=Ce.props.children),typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case l:e:{for(var Tt=Ce.key,sn=de;sn!==null;){if(sn.key===Tt){if(Tt=Ce.type,Tt===u){if(sn.tag===7){w(xe,sn.sibling),de=P(sn,Ce.props.children),de.return=xe,xe=de;break e}}else if(sn.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===x&&gI(Tt)===sn.type){w(xe,sn.sibling),de=P(sn,Ce.props),de.ref=Tp(xe,sn,Ce),de.return=xe,xe=de;break e}w(xe,sn);break}else d(xe,sn);sn=sn.sibling}Ce.type===u?(de=du(Ce.props.children,xe.mode,ht,Ce.key),de.return=xe,xe=de):(ht=Av(Ce.type,Ce.key,Ce.props,null,xe.mode,ht),ht.ref=Tp(xe,de,Ce),ht.return=xe,xe=ht)}return Q(xe);case c:e:{for(sn=Ce.key;de!==null;){if(de.key===sn)if(de.tag===4&&de.stateNode.containerInfo===Ce.containerInfo&&de.stateNode.implementation===Ce.implementation){w(xe,de.sibling),de=P(de,Ce.children||[]),de.return=xe,xe=de;break e}else{w(xe,de);break}else d(xe,de);de=de.sibling}de=s1(Ce,xe.mode,ht),de.return=xe,xe=de}return Q(xe);case x:return sn=Ce._init,ro(xe,de,sn(Ce._payload),ht)}if(Y(Ce))return It(xe,de,Ce,ht);if(I(Ce))return Ci(xe,de,Ce,ht);$y(xe,Ce)}return typeof Ce=="string"&&Ce!==""||typeof Ce=="number"?(Ce=""+Ce,de!==null&&de.tag===6?(w(xe,de.sibling),de=P(de,Ce),de.return=xe,xe=de):(w(xe,de),de=i1(Ce,xe.mode,ht),de.return=xe,xe=de),Q(xe)):w(xe,de)}return ro}var Vh=yI(!0),vI=yI(!1),Cp={},Zs=Ft(Cp),bp=Ft(Cp),Gh=Ft(Cp);function aa(h){if(h===Cp)throw Error(o(174));return h}function AA(h,d){et(Gh,d),et(bp,h),et(Zs,Cp),h=le(d),ut(Zs),et(Zs,h)}function Wh(){ut(Zs),ut(bp),ut(Gh)}function _I(h){var d=aa(Gh.current),w=aa(Zs.current);d=X(w,h.type,d),w!==d&&(et(bp,h),et(Zs,d))}function wA(h){bp.current===h&&(ut(Zs),ut(bp))}var or=Ft(0);function jy(h){for(var d=h;d!==null;){if(d.tag===13){var w=d.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||As(w)||sa(w)))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if(d.flags&128)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===h)break;for(;d.sibling===null;){if(d.return===null||d.return===h)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var SA=[];function TA(){for(var h=0;h<SA.length;h++){var d=SA[h];Qe?d._workInProgressVersionPrimary=null:d._workInProgressVersionSecondary=null}SA.length=0}var Xy=a.ReactCurrentDispatcher,eo=a.ReactCurrentBatchConfig,$h=0,mr=null,wi=null,Kr=null,Ky=!1,Mp=!1,Rp=0,P9=0;function Si(){throw Error(o(321))}function CA(h,d){if(d===null)return!1;for(var w=0;w<d.length&&w<h.length;w++)if(!ws(h[w],d[w]))return!1;return!0}function bA(h,d,w,S,P,N){if($h=N,mr=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,Xy.current=h===null||h.memoizedState===null?B9:N9,h=w(S,P),Mp){N=0;do{if(Mp=!1,Rp=0,25<=N)throw Error(o(301));N+=1,Kr=wi=null,d.updateQueue=null,Xy.current=k9,h=w(S,P)}while(Mp)}if(Xy.current=Zy,d=wi!==null&&wi.next!==null,$h=0,Kr=wi=mr=null,Ky=!1,d)throw Error(o(300));return h}function MA(){var h=Rp!==0;return Rp=0,h}function Ga(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?mr.memoizedState=Kr=h:Kr=Kr.next=h,Kr}function la(){if(wi===null){var h=mr.alternate;h=h!==null?h.memoizedState:null}else h=wi.next;var d=Kr===null?mr.memoizedState:Kr.next;if(d!==null)Kr=d,wi=h;else{if(h===null)throw Error(o(310));wi=h,h={memoizedState:wi.memoizedState,baseState:wi.baseState,baseQueue:wi.baseQueue,queue:wi.queue,next:null},Kr===null?mr.memoizedState=Kr=h:Kr=Kr.next=h}return Kr}function au(h,d){return typeof d=="function"?d(h):d}function Jy(h){var d=la(),w=d.queue;if(w===null)throw Error(o(311));w.lastRenderedReducer=h;var S=wi,P=S.baseQueue,N=w.pending;if(N!==null){if(P!==null){var Q=P.next;P.next=N.next,N.next=Q}S.baseQueue=P=N,w.pending=null}if(P!==null){N=P.next,S=S.baseState;var ue=Q=null,Re=null,Ye=N;do{var pt=Ye.lane;if(($h&pt)===pt)Re!==null&&(Re=Re.next={lane:0,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null}),S=Ye.hasEagerState?Ye.eagerState:h(S,Ye.action);else{var Xt={lane:pt,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null};Re===null?(ue=Re=Xt,Q=S):Re=Re.next=Xt,mr.lanes|=pt,Xh|=pt}Ye=Ye.next}while(Ye!==null&&Ye!==N);Re===null?Q=S:Re.next=ue,ws(S,d.memoizedState)||(bs=!0),d.memoizedState=S,d.baseState=Q,d.baseQueue=Re,w.lastRenderedState=S}if(h=w.interleaved,h!==null){P=h;do N=P.lane,mr.lanes|=N,Xh|=N,P=P.next;while(P!==h)}else P===null&&(w.lanes=0);return[d.memoizedState,w.dispatch]}function Yy(h){var d=la(),w=d.queue;if(w===null)throw Error(o(311));w.lastRenderedReducer=h;var S=w.dispatch,P=w.pending,N=d.memoizedState;if(P!==null){w.pending=null;var Q=P=P.next;do N=h(N,Q.action),Q=Q.next;while(Q!==P);ws(N,d.memoizedState)||(bs=!0),d.memoizedState=N,d.baseQueue===null&&(d.baseState=N),w.lastRenderedState=N}return[N,S]}function EI(){}function xI(h,d){var w=mr,S=la(),P=d(),N=!ws(S.memoizedState,P);if(N&&(S.memoizedState=P,bs=!0),S=S.queue,Pp(SI.bind(null,w,S,h),[h]),S.getSnapshot!==d||N||Kr!==null&&Kr.memoizedState.tag&1){if(w.flags|=2048,Ip(9,wI.bind(null,w,S,P,d),void 0,null),Pr===null)throw Error(o(349));$h&30||AI(w,d,P)}return P}function AI(h,d,w){h.flags|=16384,h={getSnapshot:d,value:w},d=mr.updateQueue,d===null?(d={lastEffect:null,stores:null},mr.updateQueue=d,d.stores=[h]):(w=d.stores,w===null?d.stores=[h]:w.push(h))}function wI(h,d,w,S){d.value=w,d.getSnapshot=S,TI(d)&&to(h,1,-1)}function SI(h,d,w){return w(function(){TI(d)&&to(h,1,-1)})}function TI(h){var d=h.getSnapshot;h=h.value;try{var w=d();return!ws(h,w)}catch{return!0}}function RA(h){var d=Ga();return typeof h=="function"&&(h=h()),d.memoizedState=d.baseState=h,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:au,lastRenderedState:h},d.queue=h,h=h.dispatch=O9.bind(null,mr,h),[d.memoizedState,h]}function Ip(h,d,w,S){return h={tag:h,create:d,destroy:w,deps:S,next:null},d=mr.updateQueue,d===null?(d={lastEffect:null,stores:null},mr.updateQueue=d,d.lastEffect=h.next=h):(w=d.lastEffect,w===null?d.lastEffect=h.next=h:(S=w.next,w.next=h,h.next=S,d.lastEffect=h)),h}function CI(){return la().memoizedState}function qy(h,d,w,S){var P=Ga();mr.flags|=h,P.memoizedState=Ip(1|d,w,void 0,S===void 0?null:S)}function Qy(h,d,w,S){var P=la();S=S===void 0?null:S;var N=void 0;if(wi!==null){var Q=wi.memoizedState;if(N=Q.destroy,S!==null&&CA(S,Q.deps)){P.memoizedState=Ip(d,w,N,S);return}}mr.flags|=h,P.memoizedState=Ip(1|d,w,N,S)}function IA(h,d){return qy(8390656,8,h,d)}function Pp(h,d){return Qy(2048,8,h,d)}function bI(h,d){return Qy(4,2,h,d)}function MI(h,d){return Qy(4,4,h,d)}function RI(h,d){if(typeof d=="function")return h=h(),d(h),function(){d(null)};if(d!=null)return h=h(),d.current=h,function(){d.current=null}}function II(h,d,w){return w=w!=null?w.concat([h]):null,Qy(4,4,RI.bind(null,d,h),w)}function PA(){}function PI(h,d){var w=la();d=d===void 0?null:d;var S=w.memoizedState;return S!==null&&d!==null&&CA(d,S[1])?S[0]:(w.memoizedState=[h,d],h)}function DI(h,d){var w=la();d=d===void 0?null:d;var S=w.memoizedState;return S!==null&&d!==null&&CA(d,S[1])?S[0]:(h=h(),w.memoizedState=[h,d],h)}function D9(h,d){var w=gn;gn=w!==0&&4>w?w:4,h(!0);var S=eo.transition;eo.transition={};try{h(!1),d()}finally{gn=w,eo.transition=S}}function LI(){return la().memoizedState}function L9(h,d,w){var S=zl(h);w={lane:S,action:w,hasEagerState:!1,eagerState:null,next:null},OI(h)?BI(d,w):(NI(h,d,w),w=ji(),h=to(h,S,w),h!==null&&kI(h,d,S))}function O9(h,d,w){var S=zl(h),P={lane:S,action:w,hasEagerState:!1,eagerState:null,next:null};if(OI(h))BI(d,P);else{NI(h,d,P);var N=h.alternate;if(h.lanes===0&&(N===null||N.lanes===0)&&(N=d.lastRenderedReducer,N!==null))try{var Q=d.lastRenderedState,ue=N(Q,w);if(P.hasEagerState=!0,P.eagerState=ue,ws(ue,Q))return}catch{}finally{}w=ji(),h=to(h,S,w),h!==null&&kI(h,d,S)}}function OI(h){var d=h.alternate;return h===mr||d!==null&&d===mr}function BI(h,d){Mp=Ky=!0;var w=h.pending;w===null?d.next=d:(d.next=w.next,w.next=d),h.pending=d}function NI(h,d,w){Pr!==null&&h.mode&1&&!(ln&2)?(h=d.interleaved,h===null?(w.next=w,Ss===null?Ss=[d]:Ss.push(d)):(w.next=h.next,h.next=w),d.interleaved=w):(h=d.pending,h===null?w.next=w:(w.next=h.next,h.next=w),d.pending=w)}function kI(h,d,w){if(w&4194240){var S=d.lanes;S&=h.pendingLanes,w|=S,d.lanes=w,mp(h,w)}}var Zy={readContext:ii,useCallback:Si,useContext:Si,useEffect:Si,useImperativeHandle:Si,useInsertionEffect:Si,useLayoutEffect:Si,useMemo:Si,useReducer:Si,useRef:Si,useState:Si,useDebugValue:Si,useDeferredValue:Si,useTransition:Si,useMutableSource:Si,useSyncExternalStore:Si,useId:Si,unstable_isNewReconciler:!1},B9={readContext:ii,useCallback:function(h,d){return Ga().memoizedState=[h,d===void 0?null:d],h},useContext:ii,useEffect:IA,useImperativeHandle:function(h,d,w){return w=w!=null?w.concat([h]):null,qy(4194308,4,RI.bind(null,d,h),w)},useLayoutEffect:function(h,d){return qy(4194308,4,h,d)},useInsertionEffect:function(h,d){return qy(4,2,h,d)},useMemo:function(h,d){var w=Ga();return d=d===void 0?null:d,h=h(),w.memoizedState=[h,d],h},useReducer:function(h,d,w){var S=Ga();return d=w!==void 0?w(d):d,S.memoizedState=S.baseState=d,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:d},S.queue=h,h=h.dispatch=L9.bind(null,mr,h),[S.memoizedState,h]},useRef:function(h){var d=Ga();return h={current:h},d.memoizedState=h},useState:RA,useDebugValue:PA,useDeferredValue:function(h){var d=RA(h),w=d[0],S=d[1];return IA(function(){var P=eo.transition;eo.transition={};try{S(h)}finally{eo.transition=P}},[h]),w},useTransition:function(){var h=RA(!1),d=h[0];return h=D9.bind(null,h[1]),Ga().memoizedState=h,[d,h]},useMutableSource:function(){},useSyncExternalStore:function(h,d,w){var S=mr,P=Ga();if(er){if(w===void 0)throw Error(o(407));w=w()}else{if(w=d(),Pr===null)throw Error(o(349));$h&30||AI(S,d,w)}P.memoizedState=w;var N={value:w,getSnapshot:d};return P.queue=N,IA(SI.bind(null,S,N,h),[h]),S.flags|=2048,Ip(9,wI.bind(null,S,N,w,d),void 0,null),w},useId:function(){var h=Ga(),d=Pr.identifierPrefix;if(er){var w=Xr,S=si;w=(S&~(1<<32-Bn(S)-1)).toString(32)+w,d=":"+d+"R"+w,w=Rp++,0<w&&(d+="H"+w.toString(32)),d+=":"}else w=P9++,d=":"+d+"r"+w.toString(32)+":";return h.memoizedState=d},unstable_isNewReconciler:!1},N9={readContext:ii,useCallback:PI,useContext:ii,useEffect:Pp,useImperativeHandle:II,useInsertionEffect:bI,useLayoutEffect:MI,useMemo:DI,useReducer:Jy,useRef:CI,useState:function(){return Jy(au)},useDebugValue:PA,useDeferredValue:function(h){var d=Jy(au),w=d[0],S=d[1];return Pp(function(){var P=eo.transition;eo.transition={};try{S(h)}finally{eo.transition=P}},[h]),w},useTransition:function(){var h=Jy(au)[0],d=la().memoizedState;return[h,d]},useMutableSource:EI,useSyncExternalStore:xI,useId:LI,unstable_isNewReconciler:!1},k9={readContext:ii,useCallback:PI,useContext:ii,useEffect:Pp,useImperativeHandle:II,useInsertionEffect:bI,useLayoutEffect:MI,useMemo:DI,useReducer:Yy,useRef:CI,useState:function(){return Yy(au)},useDebugValue:PA,useDeferredValue:function(h){var d=Yy(au),w=d[0],S=d[1];return Pp(function(){var P=eo.transition;eo.transition={};try{S(h)}finally{eo.transition=P}},[h]),w},useTransition:function(){var h=Yy(au)[0],d=la().memoizedState;return[h,d]},useMutableSource:EI,useSyncExternalStore:xI,useId:LI,unstable_isNewReconciler:!1};function DA(h,d){try{var w="",S=d;do w+=Fh(S),S=S.return;while(S);var P=w}catch(N){P=`
Error generating stack: `+N.message+`
`+N.stack}return{value:h,source:d,stack:P}}function LA(h,d){try{console.error(d.value)}catch(w){setTimeout(function(){throw w})}}var F9=typeof WeakMap=="function"?WeakMap:Map;function FI(h,d,w){w=Qs(-1,w),w.tag=3,w.payload={element:null};var S=d.value;return w.callback=function(){mv||(mv=!0,qA=S),LA(h,d)},w}function UI(h,d,w){w=Qs(-1,w),w.tag=3;var S=h.type.getDerivedStateFromError;if(typeof S=="function"){var P=d.value;w.payload=function(){return S(P)},w.callback=function(){LA(h,d)}}var N=h.stateNode;return N!==null&&typeof N.componentDidCatch=="function"&&(w.callback=function(){LA(h,d),typeof S!="function"&&(Fl===null?Fl=new Set([this]):Fl.add(this));var Q=d.stack;this.componentDidCatch(d.value,{componentStack:Q!==null?Q:""})}),w}function zI(h,d,w){var S=h.pingCache;if(S===null){S=h.pingCache=new F9;var P=new Set;S.set(d,P)}else P=S.get(d),P===void 0&&(P=new Set,S.set(d,P));P.has(w)||(P.add(w),h=Q9.bind(null,h,d,w),d.then(h,h))}function HI(h){do{var d;if((d=h.tag===13)&&(d=h.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return h;h=h.return}while(h!==null);return null}function VI(h,d,w,S,P){return h.mode&1?(h.flags|=65536,h.lanes=P,h):(h===d?h.flags|=65536:(h.flags|=128,w.flags|=131072,w.flags&=-52805,w.tag===1&&(w.alternate===null?w.tag=17:(d=Qs(-1,1),d.tag=2,Co(w,d))),w.lanes|=1),h)}function ca(h){h.flags|=4}function GI(h,d){if(h!==null&&h.child===d.child)return!0;if(d.flags&16)return!1;for(h=d.child;h!==null;){if(h.flags&12854||h.subtreeFlags&12854)return!1;h=h.sibling}return!0}var Dp,Lp,ev,tv;if(Xe)Dp=function(h,d){for(var w=d.child;w!==null;){if(w.tag===5||w.tag===6)me(h,w.stateNode);else if(w.tag!==4&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===d)break;for(;w.sibling===null;){if(w.return===null||w.return===d)return;w=w.return}w.sibling.return=w.return,w=w.sibling}},Lp=function(){},ev=function(h,d,w,S,P){if(h=h.memoizedProps,h!==S){var N=d.stateNode,Q=aa(Zs.current);w=Ae(N,w,h,S,P,Q),(d.updateQueue=w)&&ca(d)}},tv=function(h,d,w,S){w!==S&&ca(d)};else if(te){Dp=function(h,d,w,S){for(var P=d.child;P!==null;){if(P.tag===5){var N=P.stateNode;w&&S&&(N=Xn(N,P.type,P.memoizedProps,P)),me(h,N)}else if(P.tag===6)N=P.stateNode,w&&S&&(N=Fn(N,P.memoizedProps,P)),me(h,N);else if(P.tag!==4){if(P.tag===22&&P.memoizedState!==null)N=P.child,N!==null&&(N.return=P),Dp(h,P,!0,!0);else if(P.child!==null){P.child.return=P,P=P.child;continue}}if(P===d)break;for(;P.sibling===null;){if(P.return===null||P.return===d)return;P=P.return}P.sibling.return=P.return,P=P.sibling}};var WI=function(h,d,w,S){for(var P=d.child;P!==null;){if(P.tag===5){var N=P.stateNode;w&&S&&(N=Xn(N,P.type,P.memoizedProps,P)),xt(h,N)}else if(P.tag===6)N=P.stateNode,w&&S&&(N=Fn(N,P.memoizedProps,P)),xt(h,N);else if(P.tag!==4){if(P.tag===22&&P.memoizedState!==null)N=P.child,N!==null&&(N.return=P),WI(h,P,!0,!0);else if(P.child!==null){P.child.return=P,P=P.child;continue}}if(P===d)break;for(;P.sibling===null;){if(P.return===null||P.return===d)return;P=P.return}P.sibling.return=P.return,P=P.sibling}};Lp=function(h,d){var w=d.stateNode;if(!GI(h,d)){h=w.containerInfo;var S=Pt(h);WI(S,d,!1,!1),w.pendingChildren=S,ca(d),hn(h,S)}},ev=function(h,d,w,S,P){var N=h.stateNode,Q=h.memoizedProps;if((h=GI(h,d))&&Q===S)d.stateNode=N;else{var ue=d.stateNode,Re=aa(Zs.current),Ye=null;Q!==S&&(Ye=Ae(ue,w,Q,S,P,Re)),h&&Ye===null?d.stateNode=N:(N=$e(N,Ye,w,Q,S,d,h,ue),he(N,w,S,P,Re)&&ca(d),d.stateNode=N,h?ca(d):Dp(N,d,!1,!1))}},tv=function(h,d,w,S){w!==S?(h=aa(Gh.current),w=aa(Zs.current),d.stateNode=Ie(S,h,w,d),ca(d)):d.stateNode=h.stateNode}}else Lp=function(){},ev=function(){},tv=function(){};function Op(h,d){if(!er)switch(h.tailMode){case"hidden":d=h.tail;for(var w=null;d!==null;)d.alternate!==null&&(w=d),d=d.sibling;w===null?h.tail=null:w.sibling=null;break;case"collapsed":w=h.tail;for(var S=null;w!==null;)w.alternate!==null&&(S=w),w=w.sibling;S===null?d||h.tail===null?h.tail=null:h.tail.sibling=null:S.sibling=null}}function Ti(h){var d=h.alternate!==null&&h.alternate.child===h.child,w=0,S=0;if(d)for(var P=h.child;P!==null;)w|=P.lanes|P.childLanes,S|=P.subtreeFlags&14680064,S|=P.flags&14680064,P.return=h,P=P.sibling;else for(P=h.child;P!==null;)w|=P.lanes|P.childLanes,S|=P.subtreeFlags,S|=P.flags,P.return=h,P=P.sibling;return h.subtreeFlags|=S,h.childLanes=w,d}function U9(h,d,w){var S=d.pendingProps;switch(vA(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ti(d),null;case 1:return bn(d.type)&&un(),Ti(d),null;case 3:return S=d.stateNode,Wh(),ut(Rt),ut(Dt),TA(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(h===null||h.child===null)&&(Sp(d)?ca(d):h===null||h.memoizedState.isDehydrated&&!(d.flags&256)||(d.flags|=1024,bo!==null&&(e1(bo),bo=null))),Lp(h,d),Ti(d),null;case 5:wA(d),w=aa(Gh.current);var P=d.type;if(h!==null&&d.stateNode!=null)ev(h,d,P,S,w),h.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!S){if(d.stateNode===null)throw Error(o(166));return Ti(d),null}if(h=aa(Zs.current),Sp(d)){if(!Le)throw Error(o(175));h=H(d.stateNode,d.type,d.memoizedProps,w,h,d,!wp),d.updateQueue=h,h!==null&&ca(d)}else{var N=fe(P,S,w,h,d);Dp(N,d,!1,!1),d.stateNode=N,he(N,P,S,w,h)&&ca(d)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Ti(d),null;case 6:if(h&&d.stateNode!=null)tv(h,d,h.memoizedProps,S);else{if(typeof S!="string"&&d.stateNode===null)throw Error(o(166));if(h=aa(Gh.current),w=aa(Zs.current),Sp(d)){if(!Le)throw Error(o(176));if(h=d.stateNode,S=d.memoizedProps,(w=G(h,S,d,!wp))&&(P=Ts,P!==null))switch(N=(P.mode&1)!==0,P.tag){case 3:we(P.stateNode.containerInfo,h,S,N);break;case 5:Te(P.type,P.memoizedProps,P.stateNode,h,S,N)}w&&ca(d)}else d.stateNode=Ie(S,h,w,d)}return Ti(d),null;case 13:if(ut(or),S=d.memoizedState,er&&Cs!==null&&d.mode&1&&!(d.flags&128)){for(h=Cs;h;)h=Ir(h);return Hh(),d.flags|=98560,d}if(S!==null&&S.dehydrated!==null){if(S=Sp(d),h===null){if(!S)throw Error(o(318));if(!Le)throw Error(o(344));if(h=d.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(o(317));se(h,d)}else Hh(),!(d.flags&128)&&(d.memoizedState=null),d.flags|=4;return Ti(d),null}return bo!==null&&(e1(bo),bo=null),d.flags&128?(d.lanes=w,d):(S=S!==null,w=!1,h===null?Sp(d):w=h.memoizedState!==null,S&&!w&&(d.child.flags|=8192,d.mode&1&&(h===null||or.current&1?Ur===0&&(Ur=3):n1())),d.updateQueue!==null&&(d.flags|=4),Ti(d),null);case 4:return Wh(),Lp(h,d),h===null&&Ne(d.stateNode.containerInfo),Ti(d),null;case 10:return tu(d.type._context),Ti(d),null;case 17:return bn(d.type)&&un(),Ti(d),null;case 19:if(ut(or),P=d.memoizedState,P===null)return Ti(d),null;if(S=(d.flags&128)!==0,N=P.rendering,N===null)if(S)Op(P,!1);else{if(Ur!==0||h!==null&&h.flags&128)for(h=d.child;h!==null;){if(N=jy(h),N!==null){for(d.flags|=128,Op(P,!1),h=N.updateQueue,h!==null&&(d.updateQueue=h,d.flags|=4),d.subtreeFlags=0,h=w,S=d.child;S!==null;)w=S,P=h,w.flags&=14680066,N=w.alternate,N===null?(w.childLanes=0,w.lanes=P,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=N.childLanes,w.lanes=N.lanes,w.child=N.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=N.memoizedProps,w.memoizedState=N.memoizedState,w.updateQueue=N.updateQueue,w.type=N.type,P=N.dependencies,w.dependencies=P===null?null:{lanes:P.lanes,firstContext:P.firstContext}),S=S.sibling;return et(or,or.current&1|2),d.child}h=h.sibling}P.tail!==null&&wr()>YA&&(d.flags|=128,S=!0,Op(P,!1),d.lanes=4194304)}else{if(!S)if(h=jy(N),h!==null){if(d.flags|=128,S=!0,h=h.updateQueue,h!==null&&(d.updateQueue=h,d.flags|=4),Op(P,!0),P.tail===null&&P.tailMode==="hidden"&&!N.alternate&&!er)return Ti(d),null}else 2*wr()-P.renderingStartTime>YA&&w!==1073741824&&(d.flags|=128,S=!0,Op(P,!1),d.lanes=4194304);P.isBackwards?(N.sibling=d.child,d.child=N):(h=P.last,h!==null?h.sibling=N:d.child=N,P.last=N)}return P.tail!==null?(d=P.tail,P.rendering=d,P.tail=d.sibling,P.renderingStartTime=wr(),d.sibling=null,h=or.current,et(or,S?h&1|2:h&1),d):(Ti(d),null);case 22:case 23:return t1(),S=d.memoizedState!==null,h!==null&&h.memoizedState!==null!==S&&(d.flags|=8192),S&&d.mode&1?Ms&1073741824&&(Ti(d),Xe&&d.subtreeFlags&6&&(d.flags|=8192)):Ti(d),null;case 24:return null;case 25:return null}throw Error(o(156,d.tag))}var z9=a.ReactCurrentOwner,bs=!1;function $i(h,d,w,S){d.child=h===null?vI(d,null,w,S):Vh(d,h.child,w,S)}function $I(h,d,w,S,P){w=w.render;var N=d.ref;return Va(d,P),S=bA(h,d,w,S,N,P),w=MA(),h!==null&&!bs?(d.updateQueue=h.updateQueue,d.flags&=-2053,h.lanes&=~P,Wa(h,d,P)):(er&&w&&ou(d),d.flags|=1,$i(h,d,S,P),d.child)}function jI(h,d,w,S,P){if(h===null){var N=w.type;return typeof N=="function"&&!r1(N)&&N.defaultProps===void 0&&w.compare===null&&w.defaultProps===void 0?(d.tag=15,d.type=N,XI(h,d,N,S,P)):(h=Av(w.type,null,S,d,d.mode,P),h.ref=d.ref,h.return=d,d.child=h)}if(N=h.child,!(h.lanes&P)){var Q=N.memoizedProps;if(w=w.compare,w=w!==null?w:kl,w(Q,S)&&h.ref===d.ref)return Wa(h,d,P)}return d.flags|=1,h=Vl(N,S),h.ref=d.ref,h.return=d,d.child=h}function XI(h,d,w,S,P){if(h!==null&&kl(h.memoizedProps,S)&&h.ref===d.ref)if(bs=!1,(h.lanes&P)!==0)h.flags&131072&&(bs=!0);else return d.lanes=h.lanes,Wa(h,d,P);return OA(h,d,w,S,P)}function KI(h,d,w){var S=d.pendingProps,P=S.children,N=h!==null?h.memoizedState:null;if(S.mode==="hidden")if(!(d.mode&1))d.memoizedState={baseLanes:0,cachePool:null},et(jh,Ms),Ms|=w;else if(w&1073741824)d.memoizedState={baseLanes:0,cachePool:null},S=N!==null?N.baseLanes:w,et(jh,Ms),Ms|=S;else return h=N!==null?N.baseLanes|w:w,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:h,cachePool:null},d.updateQueue=null,et(jh,Ms),Ms|=h,null;else N!==null?(S=N.baseLanes|w,d.memoizedState=null):S=w,et(jh,Ms),Ms|=S;return $i(h,d,P,w),d.child}function JI(h,d){var w=d.ref;(h===null&&w!==null||h!==null&&h.ref!==w)&&(d.flags|=512,d.flags|=2097152)}function OA(h,d,w,S,P){var N=bn(w)?nn:Dt.current;return N=Ln(d,N),Va(d,P),w=bA(h,d,w,S,N,P),S=MA(),h!==null&&!bs?(d.updateQueue=h.updateQueue,d.flags&=-2053,h.lanes&=~P,Wa(h,d,P)):(er&&S&&ou(d),d.flags|=1,$i(h,d,w,P),d.child)}function YI(h,d,w,S,P){if(bn(w)){var N=!0;Vt(d)}else N=!1;if(Va(d,P),d.stateNode===null)h!==null&&(h.alternate=null,d.alternate=null,d.flags|=2),k(d,w,S),ge(d,w,S,P),S=!0;else if(h===null){var Q=d.stateNode,ue=d.memoizedProps;Q.props=ue;var Re=Q.context,Ye=w.contextType;typeof Ye=="object"&&Ye!==null?Ye=ii(Ye):(Ye=bn(w)?nn:Dt.current,Ye=Ln(d,Ye));var pt=w.getDerivedStateFromProps,Xt=typeof pt=="function"||typeof Q.getSnapshotBeforeUpdate=="function";Xt||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(ue!==S||Re!==Ye)&&W(d,Q,S,Ye),So=!1;var Lt=d.memoizedState;Q.state=Lt,$r(d,S,Q,P),Re=d.memoizedState,ue!==S||Lt!==Re||Rt.current||So?(typeof pt=="function"&&(oa(d,w,pt,S),Re=d.memoizedState),(ue=So||L(d,w,ue,S,Lt,Re,Ye))?(Xt||typeof Q.UNSAFE_componentWillMount!="function"&&typeof Q.componentWillMount!="function"||(typeof Q.componentWillMount=="function"&&Q.componentWillMount(),typeof Q.UNSAFE_componentWillMount=="function"&&Q.UNSAFE_componentWillMount()),typeof Q.componentDidMount=="function"&&(d.flags|=4194308)):(typeof Q.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=S,d.memoizedState=Re),Q.props=S,Q.state=Re,Q.context=Ye,S=ue):(typeof Q.componentDidMount=="function"&&(d.flags|=4194308),S=!1)}else{Q=d.stateNode,Ep(h,d),ue=d.memoizedProps,Ye=d.type===d.elementType?ue:ss(d.type,ue),Q.props=Ye,Xt=d.pendingProps,Lt=Q.context,Re=w.contextType,typeof Re=="object"&&Re!==null?Re=ii(Re):(Re=bn(w)?nn:Dt.current,Re=Ln(d,Re));var zn=w.getDerivedStateFromProps;(pt=typeof zn=="function"||typeof Q.getSnapshotBeforeUpdate=="function")||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(ue!==Xt||Lt!==Re)&&W(d,Q,S,Re),So=!1,Lt=d.memoizedState,Q.state=Lt,$r(d,S,Q,P);var It=d.memoizedState;ue!==Xt||Lt!==It||Rt.current||So?(typeof zn=="function"&&(oa(d,w,zn,S),It=d.memoizedState),(Ye=So||L(d,w,Ye,S,Lt,It,Re)||!1)?(pt||typeof Q.UNSAFE_componentWillUpdate!="function"&&typeof Q.componentWillUpdate!="function"||(typeof Q.componentWillUpdate=="function"&&Q.componentWillUpdate(S,It,Re),typeof Q.UNSAFE_componentWillUpdate=="function"&&Q.UNSAFE_componentWillUpdate(S,It,Re)),typeof Q.componentDidUpdate=="function"&&(d.flags|=4),typeof Q.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof Q.componentDidUpdate!="function"||ue===h.memoizedProps&&Lt===h.memoizedState||(d.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||ue===h.memoizedProps&&Lt===h.memoizedState||(d.flags|=1024),d.memoizedProps=S,d.memoizedState=It),Q.props=S,Q.state=It,Q.context=Re,S=Ye):(typeof Q.componentDidUpdate!="function"||ue===h.memoizedProps&&Lt===h.memoizedState||(d.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||ue===h.memoizedProps&&Lt===h.memoizedState||(d.flags|=1024),S=!1)}return BA(h,d,w,S,N,P)}function BA(h,d,w,S,P,N){JI(h,d);var Q=(d.flags&128)!==0;if(!S&&!Q)return P&&qt(d,w,!1),Wa(h,d,N);S=d.stateNode,z9.current=d;var ue=Q&&typeof w.getDerivedStateFromError!="function"?null:S.render();return d.flags|=1,h!==null&&Q?(d.child=Vh(d,h.child,null,N),d.child=Vh(d,null,ue,N)):$i(h,d,ue,N),d.memoizedState=S.state,P&&qt(d,w,!0),d.child}function qI(h){var d=h.stateNode;d.pendingContext?gt(h,d.pendingContext,d.pendingContext!==d.context):d.context&&gt(h,d.context,!1),AA(h,d.containerInfo)}function QI(h,d,w,S,P){return Hh(),xA(P),d.flags|=256,$i(h,d,w,S),d.child}var nv={dehydrated:null,treeContext:null,retryLane:0};function rv(h){return{baseLanes:h,cachePool:null}}function ZI(h,d,w){var S=d.pendingProps,P=or.current,N=!1,Q=(d.flags&128)!==0,ue;if((ue=Q)||(ue=h!==null&&h.memoizedState===null?!1:(P&2)!==0),ue?(N=!0,d.flags&=-129):(h===null||h.memoizedState!==null)&&(P|=1),et(or,P&1),h===null)return EA(d),h=d.memoizedState,h!==null&&(h=h.dehydrated,h!==null)?(d.mode&1?sa(h)?d.lanes=8:d.lanes=1073741824:d.lanes=1,null):(P=S.children,h=S.fallback,N?(S=d.mode,N=d.child,P={mode:"hidden",children:P},!(S&1)&&N!==null?(N.childLanes=0,N.pendingProps=P):N=wv(P,S,0,null),h=du(h,S,w,null),N.return=d,h.return=d,N.sibling=h,d.child=N,d.child.memoizedState=rv(w),d.memoizedState=nv,h):NA(d,P));if(P=h.memoizedState,P!==null){if(ue=P.dehydrated,ue!==null){if(Q)return d.flags&256?(d.flags&=-257,iv(h,d,w,Error(o(422)))):d.memoizedState!==null?(d.child=h.child,d.flags|=128,null):(N=S.fallback,P=d.mode,S=wv({mode:"visible",children:S.children},P,0,null),N=du(N,P,w,null),N.flags|=2,S.return=d,N.return=d,S.sibling=N,d.child=S,d.mode&1&&Vh(d,h.child,null,w),d.child.memoizedState=rv(w),d.memoizedState=nv,N);if(!(d.mode&1))d=iv(h,d,w,null);else if(sa(ue))d=iv(h,d,w,Error(o(419)));else if(S=(w&h.childLanes)!==0,bs||S){if(S=Pr,S!==null){switch(w&-w){case 4:N=2;break;case 16:N=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:N=32;break;case 536870912:N=268435456;break;default:N=0}S=N&(S.suspendedLanes|w)?0:N,S!==0&&S!==P.retryLane&&(P.retryLane=S,to(h,S,-1))}n1(),d=iv(h,d,w,Error(o(421)))}else As(ue)?(d.flags|=128,d.child=h.child,d=Z9.bind(null,h),_i(ue,d),d=null):(w=P.treeContext,Le&&(Cs=Na(ue),Ts=d,er=!0,bo=null,wp=!1,w!==null&&(rn[Cn++]=si,rn[Cn++]=Xr,rn[Cn++]=jr,si=w.id,Xr=w.overflow,jr=d)),d=NA(d,d.pendingProps.children),d.flags|=4096);return d}return N?(S=tP(h,d,S.children,S.fallback,w),N=d.child,P=h.child.memoizedState,N.memoizedState=P===null?rv(w):{baseLanes:P.baseLanes|w,cachePool:null},N.childLanes=h.childLanes&~w,d.memoizedState=nv,S):(w=eP(h,d,S.children,w),d.memoizedState=null,w)}return N?(S=tP(h,d,S.children,S.fallback,w),N=d.child,P=h.child.memoizedState,N.memoizedState=P===null?rv(w):{baseLanes:P.baseLanes|w,cachePool:null},N.childLanes=h.childLanes&~w,d.memoizedState=nv,S):(w=eP(h,d,S.children,w),d.memoizedState=null,w)}function NA(h,d){return d=wv({mode:"visible",children:d},h.mode,0,null),d.return=h,h.child=d}function eP(h,d,w,S){var P=h.child;return h=P.sibling,w=Vl(P,{mode:"visible",children:w}),!(d.mode&1)&&(w.lanes=S),w.return=d,w.sibling=null,h!==null&&(S=d.deletions,S===null?(d.deletions=[h],d.flags|=16):S.push(h)),d.child=w}function tP(h,d,w,S,P){var N=d.mode;h=h.child;var Q=h.sibling,ue={mode:"hidden",children:w};return!(N&1)&&d.child!==h?(w=d.child,w.childLanes=0,w.pendingProps=ue,d.deletions=null):(w=Vl(h,ue),w.subtreeFlags=h.subtreeFlags&14680064),Q!==null?S=Vl(Q,S):(S=du(S,N,P,null),S.flags|=2),S.return=d,w.return=d,w.sibling=S,d.child=w,S}function iv(h,d,w,S){return S!==null&&xA(S),Vh(d,h.child,null,w),h=NA(d,d.pendingProps.children),h.flags|=2,d.memoizedState=null,h}function nP(h,d,w){h.lanes|=d;var S=h.alternate;S!==null&&(S.lanes|=d),nu(h.return,d,w)}function kA(h,d,w,S,P){var N=h.memoizedState;N===null?h.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:S,tail:w,tailMode:P}:(N.isBackwards=d,N.rendering=null,N.renderingStartTime=0,N.last=S,N.tail=w,N.tailMode=P)}function rP(h,d,w){var S=d.pendingProps,P=S.revealOrder,N=S.tail;if($i(h,d,S.children,w),S=or.current,S&2)S=S&1|2,d.flags|=128;else{if(h!==null&&h.flags&128)e:for(h=d.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&nP(h,w,d);else if(h.tag===19)nP(h,w,d);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===d)break e;for(;h.sibling===null;){if(h.return===null||h.return===d)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}S&=1}if(et(or,S),!(d.mode&1))d.memoizedState=null;else switch(P){case"forwards":for(w=d.child,P=null;w!==null;)h=w.alternate,h!==null&&jy(h)===null&&(P=w),w=w.sibling;w=P,w===null?(P=d.child,d.child=null):(P=w.sibling,w.sibling=null),kA(d,!1,P,w,N);break;case"backwards":for(w=null,P=d.child,d.child=null;P!==null;){if(h=P.alternate,h!==null&&jy(h)===null){d.child=P;break}h=P.sibling,P.sibling=w,w=P,P=h}kA(d,!0,w,null,N);break;case"together":kA(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function Wa(h,d,w){if(h!==null&&(d.dependencies=h.dependencies),Xh|=d.lanes,!(w&d.childLanes))return null;if(h!==null&&d.child!==h.child)throw Error(o(153));if(d.child!==null){for(h=d.child,w=Vl(h,h.pendingProps),d.child=w,w.return=d;h.sibling!==null;)h=h.sibling,w=w.sibling=Vl(h,h.pendingProps),w.return=d;w.sibling=null}return d.child}function H9(h,d,w){switch(d.tag){case 3:qI(d),Hh();break;case 5:_I(d);break;case 1:bn(d.type)&&Vt(d);break;case 4:AA(d,d.stateNode.containerInfo);break;case 10:_p(d,d.type._context,d.memoizedProps.value);break;case 13:var S=d.memoizedState;if(S!==null)return S.dehydrated!==null?(et(or,or.current&1),d.flags|=128,null):w&d.child.childLanes?ZI(h,d,w):(et(or,or.current&1),h=Wa(h,d,w),h!==null?h.sibling:null);et(or,or.current&1);break;case 19:if(S=(w&d.childLanes)!==0,h.flags&128){if(S)return rP(h,d,w);d.flags|=128}var P=d.memoizedState;if(P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),et(or,or.current),S)break;return null;case 22:case 23:return d.lanes=0,KI(h,d,w)}return Wa(h,d,w)}function V9(h,d){switch(vA(d),d.tag){case 1:return bn(d.type)&&un(),h=d.flags,h&65536?(d.flags=h&-65537|128,d):null;case 3:return Wh(),ut(Rt),ut(Dt),TA(),h=d.flags,h&65536&&!(h&128)?(d.flags=h&-65537|128,d):null;case 5:return wA(d),null;case 13:if(ut(or),h=d.memoizedState,h!==null&&h.dehydrated!==null){if(d.alternate===null)throw Error(o(340));Hh()}return h=d.flags,h&65536?(d.flags=h&-65537|128,d):null;case 19:return ut(or),null;case 4:return Wh(),null;case 10:return tu(d.type._context),null;case 22:case 23:return t1(),null;case 24:return null;default:return null}}var sv=!1,lu=!1,G9=typeof WeakSet=="function"?WeakSet:Set,lt=null;function ov(h,d){var w=h.ref;if(w!==null)if(typeof w=="function")try{w(null)}catch(S){ls(h,d,S)}else w.current=null}function FA(h,d,w){try{w()}catch(S){ls(h,d,S)}}var iP=!1;function W9(h,d){for(ee(h.containerInfo),lt=d;lt!==null;)if(h=lt,d=h.child,(h.subtreeFlags&1028)!==0&&d!==null)d.return=h,lt=d;else for(;lt!==null;){h=lt;try{var w=h.alternate;if(h.flags&1024)switch(h.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var S=w.memoizedProps,P=w.memoizedState,N=h.stateNode,Q=N.getSnapshotBeforeUpdate(h.elementType===h.type?S:ss(h.type,S),P);N.__reactInternalSnapshotBeforeUpdate=Q}break;case 3:Xe&&tt(h.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(ue){ls(h,h.return,ue)}if(d=h.sibling,d!==null){d.return=h.return,lt=d;break}lt=h.return}return w=iP,iP=!1,w}function cu(h,d,w){var S=d.updateQueue;if(S=S!==null?S.lastEffect:null,S!==null){var P=S=S.next;do{if((P.tag&h)===h){var N=P.destroy;P.destroy=void 0,N!==void 0&&FA(d,w,N)}P=P.next}while(P!==S)}}function Bp(h,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var w=d=d.next;do{if((w.tag&h)===h){var S=w.create;w.destroy=S()}w=w.next}while(w!==d)}}function UA(h){var d=h.ref;if(d!==null){var w=h.stateNode;switch(h.tag){case 5:h=oe(w);break;default:h=w}typeof d=="function"?d(h):d.current=h}}function sP(h,d,w){if(Js&&typeof Js.onCommitFiberUnmount=="function")try{Js.onCommitFiberUnmount(Un,d)}catch{}switch(d.tag){case 0:case 11:case 14:case 15:if(h=d.updateQueue,h!==null&&(h=h.lastEffect,h!==null)){var S=h=h.next;do{var P=S,N=P.destroy;P=P.tag,N!==void 0&&(P&2||P&4)&&FA(d,w,N),S=S.next}while(S!==h)}break;case 1:if(ov(d,w),h=d.stateNode,typeof h.componentWillUnmount=="function")try{h.props=d.memoizedProps,h.state=d.memoizedState,h.componentWillUnmount()}catch(Q){ls(d,w,Q)}break;case 5:ov(d,w);break;case 4:Xe?hP(h,d,w):te&&te&&(d=d.stateNode.containerInfo,w=Pt(d),En(d,w))}}function oP(h,d,w){for(var S=d;;)if(sP(h,S,w),S.child===null||Xe&&S.tag===4){if(S===d)break;for(;S.sibling===null;){if(S.return===null||S.return===d)return;S=S.return}S.sibling.return=S.return,S=S.sibling}else S.child.return=S,S=S.child}function aP(h){var d=h.alternate;d!==null&&(h.alternate=null,aP(d)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(d=h.stateNode,d!==null&&ot(d)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function lP(h){return h.tag===5||h.tag===3||h.tag===4}function cP(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||lP(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function uP(h){if(Xe){e:{for(var d=h.return;d!==null;){if(lP(d))break e;d=d.return}throw Error(o(160))}var w=d;switch(w.tag){case 5:d=w.stateNode,w.flags&32&&(bt(d),w.flags&=-33),w=cP(h),HA(h,w,d);break;case 3:case 4:d=w.stateNode.containerInfo,w=cP(h),zA(h,w,d);break;default:throw Error(o(161))}}}function zA(h,d,w){var S=h.tag;if(S===5||S===6)h=h.stateNode,d?it(w,h,d):At(w,h);else if(S!==4&&(h=h.child,h!==null))for(zA(h,d,w),h=h.sibling;h!==null;)zA(h,d,w),h=h.sibling}function HA(h,d,w){var S=h.tag;if(S===5||S===6)h=h.stateNode,d?wt(w,h,d):yt(w,h);else if(S!==4&&(h=h.child,h!==null))for(HA(h,d,w),h=h.sibling;h!==null;)HA(h,d,w),h=h.sibling}function hP(h,d,w){for(var S=d,P=!1,N,Q;;){if(!P){P=S.return;e:for(;;){if(P===null)throw Error(o(160));switch(N=P.stateNode,P.tag){case 5:Q=!1;break e;case 3:N=N.containerInfo,Q=!0;break e;case 4:N=N.containerInfo,Q=!0;break e}P=P.return}P=!0}if(S.tag===5||S.tag===6)oP(h,S,w),Q?Ct(N,S.stateNode):at(N,S.stateNode);else if(S.tag===18)Q?Z(N,S.stateNode):re(N,S.stateNode);else if(S.tag===4){if(S.child!==null){N=S.stateNode.containerInfo,Q=!0,S.child.return=S,S=S.child;continue}}else if(sP(h,S,w),S.child!==null){S.child.return=S,S=S.child;continue}if(S===d)break;for(;S.sibling===null;){if(S.return===null||S.return===d)return;S=S.return,S.tag===4&&(P=!1)}S.sibling.return=S.return,S=S.sibling}}function VA(h,d){if(Xe){switch(d.tag){case 0:case 11:case 14:case 15:cu(3,d,d.return),Bp(3,d),cu(5,d,d.return);return;case 1:return;case 5:var w=d.stateNode;if(w!=null){var S=d.memoizedProps;h=h!==null?h.memoizedProps:S;var P=d.type,N=d.updateQueue;d.updateQueue=null,N!==null&&Ht(w,N,P,h,S,d)}return;case 6:if(d.stateNode===null)throw Error(o(162));w=d.memoizedProps,Ue(d.stateNode,h!==null?h.memoizedProps:w,w);return;case 3:Le&&h!==null&&h.memoizedState.isDehydrated&&K(d.stateNode.containerInfo);return;case 12:return;case 13:av(d);return;case 19:av(d);return;case 17:return}throw Error(o(163))}switch(d.tag){case 0:case 11:case 14:case 15:cu(3,d,d.return),Bp(3,d),cu(5,d,d.return);return;case 12:return;case 13:av(d);return;case 19:av(d);return;case 3:Le&&h!==null&&h.memoizedState.isDehydrated&&K(d.stateNode.containerInfo);break;case 22:case 23:return}e:if(te){switch(d.tag){case 1:case 5:case 6:break e;case 3:case 4:d=d.stateNode,En(d.containerInfo,d.pendingChildren);break e}throw Error(o(163))}}function av(h){var d=h.updateQueue;if(d!==null){h.updateQueue=null;var w=h.stateNode;w===null&&(w=h.stateNode=new G9),d.forEach(function(S){var P=eG.bind(null,h,S);w.has(S)||(w.add(S),S.then(P,P))})}}function $9(h,d){for(lt=d;lt!==null;){d=lt;var w=d.deletions;if(w!==null)for(var S=0;S<w.length;S++){var P=w[S];try{var N=h;Xe?hP(N,P,d):oP(N,P,d);var Q=P.alternate;Q!==null&&(Q.return=null),P.return=null}catch(Tt){ls(P,d,Tt)}}if(w=d.child,d.subtreeFlags&12854&&w!==null)w.return=d,lt=w;else for(;lt!==null;){d=lt;try{var ue=d.flags;if(ue&32&&Xe&&bt(d.stateNode),ue&512){var Re=d.alternate;if(Re!==null){var Ye=Re.ref;Ye!==null&&(typeof Ye=="function"?Ye(null):Ye.current=null)}}if(ue&8192)switch(d.tag){case 13:if(d.memoizedState!==null){var pt=d.alternate;(pt===null||pt.memoizedState===null)&&(JA=wr())}break;case 22:var Xt=d.memoizedState!==null,Lt=d.alternate,zn=Lt!==null&&Lt.memoizedState!==null;if(w=d,Xe){e:if(S=w,P=Xt,N=null,Xe)for(var It=S;;){if(It.tag===5){if(N===null){N=It;var Ci=It.stateNode;P?Wt(Ci):Ee(It.stateNode,It.memoizedProps)}}else if(It.tag===6){if(N===null){var ro=It.stateNode;P?Gt(ro):ae(ro,It.memoizedProps)}}else if((It.tag!==22&&It.tag!==23||It.memoizedState===null||It===S)&&It.child!==null){It.child.return=It,It=It.child;continue}if(It===S)break;for(;It.sibling===null;){if(It.return===null||It.return===S)break e;N===It&&(N=null),It=It.return}N===It&&(N=null),It.sibling.return=It.return,It=It.sibling}}if(Xt&&!zn&&w.mode&1){lt=w;for(var xe=w.child;xe!==null;){for(w=lt=xe;lt!==null;){S=lt;var de=S.child;switch(S.tag){case 0:case 11:case 14:case 15:cu(4,S,S.return);break;case 1:ov(S,S.return);var Ce=S.stateNode;if(typeof Ce.componentWillUnmount=="function"){var ht=S.return;try{Ce.props=S.memoizedProps,Ce.state=S.memoizedState,Ce.componentWillUnmount()}catch(Tt){ls(S,ht,Tt)}}break;case 5:ov(S,S.return);break;case 22:if(S.memoizedState!==null){pP(w);continue}}de!==null?(de.return=S,lt=de):pP(w)}xe=xe.sibling}}}switch(ue&4102){case 2:uP(d),d.flags&=-3;break;case 6:uP(d),d.flags&=-3,VA(d.alternate,d);break;case 4096:d.flags&=-4097;break;case 4100:d.flags&=-4097,VA(d.alternate,d);break;case 4:VA(d.alternate,d)}}catch(Tt){ls(d,d.return,Tt)}if(w=d.sibling,w!==null){w.return=d.return,lt=w;break}lt=d.return}}}function j9(h,d,w){lt=h,fP(h)}function fP(h,d,w){for(var S=(h.mode&1)!==0;lt!==null;){var P=lt,N=P.child;if(P.tag===22&&S){var Q=P.memoizedState!==null||sv;if(!Q){var ue=P.alternate,Re=ue!==null&&ue.memoizedState!==null||lu;ue=sv;var Ye=lu;if(sv=Q,(lu=Re)&&!Ye)for(lt=P;lt!==null;)Q=lt,Re=Q.child,Q.tag===22&&Q.memoizedState!==null?mP(P):Re!==null?(Re.return=Q,lt=Re):mP(P);for(;N!==null;)lt=N,fP(N),N=N.sibling;lt=P,sv=ue,lu=Ye}dP(h)}else P.subtreeFlags&8772&&N!==null?(N.return=P,lt=N):dP(h)}}function dP(h){for(;lt!==null;){var d=lt;if(d.flags&8772){var w=d.alternate;try{if(d.flags&8772)switch(d.tag){case 0:case 11:case 15:lu||Bp(5,d);break;case 1:var S=d.stateNode;if(d.flags&4&&!lu)if(w===null)S.componentDidMount();else{var P=d.elementType===d.type?w.memoizedProps:ss(d.type,w.memoizedProps);S.componentDidUpdate(P,w.memoizedState,S.__reactInternalSnapshotBeforeUpdate)}var N=d.updateQueue;N!==null&&xp(d,N,S);break;case 3:var Q=d.updateQueue;if(Q!==null){if(w=null,d.child!==null)switch(d.child.tag){case 5:w=oe(d.child.stateNode);break;case 1:w=d.child.stateNode}xp(d,Q,w)}break;case 5:var ue=d.stateNode;w===null&&d.flags&4&&Qt(ue,d.type,d.memoizedProps,d);break;case 6:break;case 4:break;case 12:break;case 13:if(Le&&d.memoizedState===null){var Re=d.alternate;if(Re!==null){var Ye=Re.memoizedState;if(Ye!==null){var pt=Ye.dehydrated;pt!==null&&q(pt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}lu||d.flags&512&&UA(d)}catch(Xt){ls(d,d.return,Xt)}}if(d===h){lt=null;break}if(w=d.sibling,w!==null){w.return=d.return,lt=w;break}lt=d.return}}function pP(h){for(;lt!==null;){var d=lt;if(d===h){lt=null;break}var w=d.sibling;if(w!==null){w.return=d.return,lt=w;break}lt=d.return}}function mP(h){for(;lt!==null;){var d=lt;try{switch(d.tag){case 0:case 11:case 15:var w=d.return;try{Bp(4,d)}catch(Re){ls(d,w,Re)}break;case 1:var S=d.stateNode;if(typeof S.componentDidMount=="function"){var P=d.return;try{S.componentDidMount()}catch(Re){ls(d,P,Re)}}var N=d.return;try{UA(d)}catch(Re){ls(d,N,Re)}break;case 5:var Q=d.return;try{UA(d)}catch(Re){ls(d,Q,Re)}}}catch(Re){ls(d,d.return,Re)}if(d===h){lt=null;break}var ue=d.sibling;if(ue!==null){ue.return=d.return,lt=ue;break}lt=d.return}}var lv=0,cv=1,uv=2,hv=3,fv=4;if(typeof Symbol=="function"&&Symbol.for){var Np=Symbol.for;lv=Np("selector.component"),cv=Np("selector.has_pseudo_class"),uv=Np("selector.role"),hv=Np("selector.test_id"),fv=Np("selector.text")}function GA(h){var d=be(h);if(d!=null){if(typeof d.memoizedProps["data-testname"]!="string")throw Error(o(364));return d}if(h=ce(h),h===null)throw Error(o(362));return h.stateNode.current}function WA(h,d){switch(d.$$typeof){case lv:if(h.type===d.value)return!0;break;case cv:e:{d=d.value,h=[h,0];for(var w=0;w<h.length;){var S=h[w++],P=h[w++],N=d[P];if(S.tag!==5||!ye(S)){for(;N!=null&&WA(S,N);)P++,N=d[P];if(P===d.length){d=!0;break e}else for(S=S.child;S!==null;)h.push(S,P),S=S.sibling}}d=!1}return d;case uv:if(h.tag===5&&qe(h.stateNode,d.value))return!0;break;case fv:if((h.tag===5||h.tag===6)&&(h=pe(h),h!==null&&0<=h.indexOf(d.value)))return!0;break;case hv:if(h.tag===5&&(h=h.memoizedProps["data-testname"],typeof h=="string"&&h.toLowerCase()===d.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function $A(h){switch(h.$$typeof){case lv:return"<"+(b(h.value)||"Unknown")+">";case cv:return":has("+($A(h)||"")+")";case uv:return'[role="'+h.value+'"]';case fv:return'"'+h.value+'"';case hv:return'[data-testname="'+h.value+'"]';default:throw Error(o(365))}}function gP(h,d){var w=[];h=[h,0];for(var S=0;S<h.length;){var P=h[S++],N=h[S++],Q=d[N];if(P.tag!==5||!ye(P)){for(;Q!=null&&WA(P,Q);)N++,Q=d[N];if(N===d.length)w.push(P);else for(P=P.child;P!==null;)h.push(P,N),P=P.sibling}}return w}function jA(h,d){if(!V)throw Error(o(363));h=GA(h),h=gP(h,d),d=[],h=Array.from(h);for(var w=0;w<h.length;){var S=h[w++];if(S.tag===5)ye(S)||d.push(S.stateNode);else for(S=S.child;S!==null;)h.push(S),S=S.sibling}return d}var X9=Math.ceil,dv=a.ReactCurrentDispatcher,XA=a.ReactCurrentOwner,Sr=a.ReactCurrentBatchConfig,ln=0,Pr=null,Dr=null,oi=0,Ms=0,jh=Ft(0),Ur=0,kp=null,Xh=0,pv=0,KA=0,Fp=null,os=null,JA=0,YA=1/0;function Kh(){YA=wr()+500}var mv=!1,qA=null,Fl=null,gv=!1,Ul=null,yv=0,Up=0,QA=null,vv=-1,_v=0;function ji(){return ln&6?wr():vv!==-1?vv:vv=wr()}function zl(h){return h.mode&1?ln&2&&oi!==0?oi&-oi:Wy.transition!==null?(_v===0&&(h=Dh,Dh<<=1,!(Dh&4194240)&&(Dh=64),_v=h),_v):(h=gn,h!==0?h:Me()):1}function to(h,d,w){if(50<Up)throw Up=0,QA=null,Error(o(185));var S=Ev(h,d);return S===null?null:(Bl(S,d,w),(!(ln&2)||S!==Pr)&&(S===Pr&&(!(ln&2)&&(pv|=d),Ur===4&&Hl(S,oi)),as(S,w),d===1&&ln===0&&!(h.mode&1)&&(Kh(),Fa&&xi())),S)}function Ev(h,d){h.lanes|=d;var w=h.alternate;for(w!==null&&(w.lanes|=d),w=h,h=h.return;h!==null;)h.childLanes|=d,w=h.alternate,w!==null&&(w.childLanes|=d),w=h,h=h.return;return w.tag===3?w.stateNode:null}function as(h,d){var w=h.callbackNode;zy(h,d);var S=Xs(h,h===Pr?oi:0);if(S===0)w!==null&&Vy(w),h.callbackNode=null,h.callbackPriority=0;else if(d=S&-S,h.callbackPriority!==d){if(w!=null&&Vy(w),d===1)h.tag===0?yA(vP.bind(null,h)):vp(vP.bind(null,h)),Ze?$(function(){ln===0&&xi()}):Ks(ka,xi),w=null;else{switch(Hy(S)){case 1:w=ka;break;case 4:w=eu;break;case 16:w=kh;break;case 536870912:w=yp;break;default:w=kh}w=bP(w,yP.bind(null,h))}h.callbackPriority=d,h.callbackNode=w}}function yP(h,d){if(vv=-1,_v=0,ln&6)throw Error(o(327));var w=h.callbackNode;if(fu()&&h.callbackNode!==w)return null;var S=Xs(h,h===Pr?oi:0);if(S===0)return null;if(S&30||S&h.expiredLanes||d)d=xv(h,S);else{d=S;var P=ln;ln|=2;var N=xP();(Pr!==h||oi!==d)&&(Kh(),uu(h,d));do try{Y9();break}catch(ue){EP(h,ue)}while(!0);zh(),dv.current=N,ln=P,Dr!==null?d=0:(Pr=null,oi=0,d=Ur)}if(d!==0){if(d===2&&(P=Oh(h),P!==0&&(S=P,d=ZA(h,P))),d===1)throw w=kp,uu(h,0),Hl(h,S),as(h,wr()),w;if(d===6)Hl(h,S);else{if(P=h.current.alternate,!(S&30)&&!K9(P)&&(d=xv(h,S),d===2&&(N=Oh(h),N!==0&&(S=N,d=ZA(h,N))),d===1))throw w=kp,uu(h,0),Hl(h,S),as(h,wr()),w;switch(h.finishedWork=P,h.finishedLanes=S,d){case 0:case 1:throw Error(o(345));case 2:hu(h,os);break;case 3:if(Hl(h,S),(S&130023424)===S&&(d=JA+500-wr(),10<d)){if(Xs(h,0)!==0)break;if(P=h.suspendedLanes,(P&S)!==S){ji(),h.pingedLanes|=h.suspendedLanes&P;break}h.timeoutHandle=He(hu.bind(null,h,os),d);break}hu(h,os);break;case 4:if(Hl(h,S),(S&4194240)===S)break;for(d=h.eventTimes,P=-1;0<S;){var Q=31-Bn(S);N=1<<Q,Q=d[Q],Q>P&&(P=Q),S&=~N}if(S=P,S=wr()-S,S=(120>S?120:480>S?480:1080>S?1080:1920>S?1920:3e3>S?3e3:4320>S?4320:1960*X9(S/1960))-S,10<S){h.timeoutHandle=He(hu.bind(null,h,os),S);break}hu(h,os);break;case 5:hu(h,os);break;default:throw Error(o(329))}}}return as(h,wr()),h.callbackNode===w?yP.bind(null,h):null}function ZA(h,d){var w=Fp;return h.current.memoizedState.isDehydrated&&(uu(h,d).flags|=256),h=xv(h,d),h!==2&&(d=os,os=w,d!==null&&e1(d)),h}function e1(h){os===null?os=h:os.push.apply(os,h)}function K9(h){for(var d=h;;){if(d.flags&16384){var w=d.updateQueue;if(w!==null&&(w=w.stores,w!==null))for(var S=0;S<w.length;S++){var P=w[S],N=P.getSnapshot;P=P.value;try{if(!ws(N(),P))return!1}catch{return!1}}}if(w=d.child,d.subtreeFlags&16384&&w!==null)w.return=d,d=w;else{if(d===h)break;for(;d.sibling===null;){if(d.return===null||d.return===h)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Hl(h,d){for(d&=~KA,d&=~pv,h.suspendedLanes|=d,h.pingedLanes&=~d,h=h.expirationTimes;0<d;){var w=31-Bn(d),S=1<<w;h[w]=-1,d&=~S}}function vP(h){if(ln&6)throw Error(o(327));fu();var d=Xs(h,0);if(!(d&1))return as(h,wr()),null;var w=xv(h,d);if(h.tag!==0&&w===2){var S=Oh(h);S!==0&&(d=S,w=ZA(h,S))}if(w===1)throw w=kp,uu(h,0),Hl(h,d),as(h,wr()),w;if(w===6)throw Error(o(345));return h.finishedWork=h.current.alternate,h.finishedLanes=d,hu(h,os),as(h,wr()),null}function _P(h){Ul!==null&&Ul.tag===0&&!(ln&6)&&fu();var d=ln;ln|=1;var w=Sr.transition,S=gn;try{if(Sr.transition=null,gn=1,h)return h()}finally{gn=S,Sr.transition=w,ln=d,!(ln&6)&&xi()}}function t1(){Ms=jh.current,ut(jh)}function uu(h,d){h.finishedWork=null,h.finishedLanes=0;var w=h.timeoutHandle;if(w!==vt&&(h.timeoutHandle=vt,rt(w)),Dr!==null)for(w=Dr.return;w!==null;){var S=w;switch(vA(S),S.tag){case 1:S=S.type.childContextTypes,S!=null&&un();break;case 3:Wh(),ut(Rt),ut(Dt),TA();break;case 5:wA(S);break;case 4:Wh();break;case 13:ut(or);break;case 19:ut(or);break;case 10:tu(S.type._context);break;case 22:case 23:t1()}w=w.return}if(Pr=h,Dr=h=Vl(h.current,null),oi=Ms=d,Ur=0,kp=null,KA=pv=Xh=0,os=Fp=null,Ss!==null){for(d=0;d<Ss.length;d++)if(w=Ss[d],S=w.interleaved,S!==null){w.interleaved=null;var P=S.next,N=w.pending;if(N!==null){var Q=N.next;N.next=P,S.next=Q}w.pending=S}Ss=null}return h}function EP(h,d){do{var w=Dr;try{if(zh(),Xy.current=Zy,Ky){for(var S=mr.memoizedState;S!==null;){var P=S.queue;P!==null&&(P.pending=null),S=S.next}Ky=!1}if($h=0,Kr=wi=mr=null,Mp=!1,Rp=0,XA.current=null,w===null||w.return===null){Ur=1,kp=d,Dr=null;break}e:{var N=h,Q=w.return,ue=w,Re=d;if(d=oi,ue.flags|=32768,Re!==null&&typeof Re=="object"&&typeof Re.then=="function"){var Ye=Re,pt=ue,Xt=pt.tag;if(!(pt.mode&1)&&(Xt===0||Xt===11||Xt===15)){var Lt=pt.alternate;Lt?(pt.updateQueue=Lt.updateQueue,pt.memoizedState=Lt.memoizedState,pt.lanes=Lt.lanes):(pt.updateQueue=null,pt.memoizedState=null)}var zn=HI(Q);if(zn!==null){zn.flags&=-257,VI(zn,Q,ue,N,d),zn.mode&1&&zI(N,Ye,d),d=zn,Re=Ye;var It=d.updateQueue;if(It===null){var Ci=new Set;Ci.add(Re),d.updateQueue=Ci}else It.add(Re);break e}else{if(!(d&1)){zI(N,Ye,d),n1();break e}Re=Error(o(426))}}else if(er&&ue.mode&1){var ro=HI(Q);if(ro!==null){!(ro.flags&65536)&&(ro.flags|=256),VI(ro,Q,ue,N,d),xA(Re);break e}}N=Re,Ur!==4&&(Ur=2),Fp===null?Fp=[N]:Fp.push(N),Re=DA(Re,ue),ue=Q;do{switch(ue.tag){case 3:ue.flags|=65536,d&=-d,ue.lanes|=d;var xe=FI(ue,Re,d);iu(ue,xe);break e;case 1:N=Re;var de=ue.type,Ce=ue.stateNode;if(!(ue.flags&128)&&(typeof de.getDerivedStateFromError=="function"||Ce!==null&&typeof Ce.componentDidCatch=="function"&&(Fl===null||!Fl.has(Ce)))){ue.flags|=65536,d&=-d,ue.lanes|=d;var ht=UI(ue,N,d);iu(ue,ht);break e}}ue=ue.return}while(ue!==null)}wP(w)}catch(Tt){d=Tt,Dr===w&&w!==null&&(Dr=w=w.return);continue}break}while(!0)}function xP(){var h=dv.current;return dv.current=Zy,h===null?Zy:h}function n1(){(Ur===0||Ur===3||Ur===2)&&(Ur=4),Pr===null||!(Xh&268435455)&&!(pv&268435455)||Hl(Pr,oi)}function xv(h,d){var w=ln;ln|=2;var S=xP();Pr===h&&oi===d||uu(h,d);do try{J9();break}catch(P){EP(h,P)}while(!0);if(zh(),ln=w,dv.current=S,Dr!==null)throw Error(o(261));return Pr=null,oi=0,Ur}function J9(){for(;Dr!==null;)AP(Dr)}function Y9(){for(;Dr!==null&&!gp();)AP(Dr)}function AP(h){var d=CP(h.alternate,h,Ms);h.memoizedProps=h.pendingProps,d===null?wP(h):Dr=d,XA.current=null}function wP(h){var d=h;do{var w=d.alternate;if(h=d.return,d.flags&32768){if(w=V9(w,d),w!==null){w.flags&=32767,Dr=w;return}if(h!==null)h.flags|=32768,h.subtreeFlags=0,h.deletions=null;else{Ur=6,Dr=null;return}}else if(w=U9(w,d,Ms),w!==null){Dr=w;return}if(d=d.sibling,d!==null){Dr=d;return}Dr=d=h}while(d!==null);Ur===0&&(Ur=5)}function hu(h,d){var w=gn,S=Sr.transition;try{Sr.transition=null,gn=1,q9(h,d,w)}finally{Sr.transition=S,gn=w}return null}function q9(h,d,w){do fu();while(Ul!==null);if(ln&6)throw Error(o(327));var S=h.finishedWork,P=h.finishedLanes;if(S===null)return null;if(h.finishedWork=null,h.finishedLanes=0,S===h.current)throw Error(o(177));h.callbackNode=null,h.callbackPriority=0;var N=S.lanes|S.childLanes;if(Nl(h,N),h===Pr&&(Dr=Pr=null,oi=0),!(S.subtreeFlags&2064)&&!(S.flags&2064)||gv||(gv=!0,bP(kh,function(){return fu(),null})),N=(S.flags&15990)!==0,S.subtreeFlags&15990||N){N=Sr.transition,Sr.transition=null;var Q=gn;gn=1;var ue=ln;ln|=4,XA.current=null,W9(h,S),$9(h,S),ie(h.containerInfo),h.current=S,j9(S),Nh(),ln=ue,gn=Q,Sr.transition=N}else h.current=S;if(gv&&(gv=!1,Ul=h,yv=P),N=h.pendingLanes,N===0&&(Fl=null),gA(S.stateNode),as(h,wr()),d!==null)for(w=h.onRecoverableError,S=0;S<d.length;S++)w(d[S]);if(mv)throw mv=!1,h=qA,qA=null,h;return yv&1&&h.tag!==0&&fu(),N=h.pendingLanes,N&1?h===QA?Up++:(Up=0,QA=h):Up=0,xi(),null}function fu(){if(Ul!==null){var h=Hy(yv),d=Sr.transition,w=gn;try{if(Sr.transition=null,gn=16>h?16:h,Ul===null)var S=!1;else{if(h=Ul,Ul=null,yv=0,ln&6)throw Error(o(331));var P=ln;for(ln|=4,lt=h.current;lt!==null;){var N=lt,Q=N.child;if(lt.flags&16){var ue=N.deletions;if(ue!==null){for(var Re=0;Re<ue.length;Re++){var Ye=ue[Re];for(lt=Ye;lt!==null;){var pt=lt;switch(pt.tag){case 0:case 11:case 15:cu(8,pt,N)}var Xt=pt.child;if(Xt!==null)Xt.return=pt,lt=Xt;else for(;lt!==null;){pt=lt;var Lt=pt.sibling,zn=pt.return;if(aP(pt),pt===Ye){lt=null;break}if(Lt!==null){Lt.return=zn,lt=Lt;break}lt=zn}}}var It=N.alternate;if(It!==null){var Ci=It.child;if(Ci!==null){It.child=null;do{var ro=Ci.sibling;Ci.sibling=null,Ci=ro}while(Ci!==null)}}lt=N}}if(N.subtreeFlags&2064&&Q!==null)Q.return=N,lt=Q;else e:for(;lt!==null;){if(N=lt,N.flags&2048)switch(N.tag){case 0:case 11:case 15:cu(9,N,N.return)}var xe=N.sibling;if(xe!==null){xe.return=N.return,lt=xe;break e}lt=N.return}}var de=h.current;for(lt=de;lt!==null;){Q=lt;var Ce=Q.child;if(Q.subtreeFlags&2064&&Ce!==null)Ce.return=Q,lt=Ce;else e:for(Q=de;lt!==null;){if(ue=lt,ue.flags&2048)try{switch(ue.tag){case 0:case 11:case 15:Bp(9,ue)}}catch(Tt){ls(ue,ue.return,Tt)}if(ue===Q){lt=null;break e}var ht=ue.sibling;if(ht!==null){ht.return=ue.return,lt=ht;break e}lt=ue.return}}if(ln=P,xi(),Js&&typeof Js.onPostCommitFiberRoot=="function")try{Js.onPostCommitFiberRoot(Un,h)}catch{}S=!0}return S}finally{gn=w,Sr.transition=d}}return!1}function SP(h,d,w){d=DA(w,d),d=FI(h,d,1),Co(h,d),d=ji(),h=Ev(h,1),h!==null&&(Bl(h,1,d),as(h,d))}function ls(h,d,w){if(h.tag===3)SP(h,h,w);else for(;d!==null;){if(d.tag===3){SP(d,h,w);break}else if(d.tag===1){var S=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(Fl===null||!Fl.has(S))){h=DA(w,h),h=UI(d,h,1),Co(d,h),h=ji(),d=Ev(d,1),d!==null&&(Bl(d,1,h),as(d,h));break}}d=d.return}}function Q9(h,d,w){var S=h.pingCache;S!==null&&S.delete(d),d=ji(),h.pingedLanes|=h.suspendedLanes&w,Pr===h&&(oi&w)===w&&(Ur===4||Ur===3&&(oi&130023424)===oi&&500>wr()-JA?uu(h,0):KA|=w),as(h,d)}function TP(h,d){d===0&&(h.mode&1?(d=Lh,Lh<<=1,!(Lh&130023424)&&(Lh=4194304)):d=1);var w=ji();h=Ev(h,d),h!==null&&(Bl(h,d,w),as(h,w))}function Z9(h){var d=h.memoizedState,w=0;d!==null&&(w=d.retryLane),TP(h,w)}function eG(h,d){var w=0;switch(h.tag){case 13:var S=h.stateNode,P=h.memoizedState;P!==null&&(w=P.retryLane);break;case 19:S=h.stateNode;break;default:throw Error(o(314))}S!==null&&S.delete(d),TP(h,w)}var CP;CP=function(h,d,w){if(h!==null)if(h.memoizedProps!==d.pendingProps||Rt.current)bs=!0;else{if(!(h.lanes&w)&&!(d.flags&128))return bs=!1,H9(h,d,w);bs=!!(h.flags&131072)}else bs=!1,er&&d.flags&1048576&&su(d,Zn,d.index);switch(d.lanes=0,d.tag){case 2:var S=d.type;h!==null&&(h.alternate=null,d.alternate=null,d.flags|=2),h=d.pendingProps;var P=Ln(d,Dt.current);Va(d,w),P=bA(null,d,S,h,P,w);var N=MA();return d.flags|=1,typeof P=="object"&&P!==null&&typeof P.render=="function"&&P.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,bn(S)?(N=!0,Vt(d)):N=!1,d.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,To(d),P.updater=v,d.stateNode=P,P._reactInternals=d,ge(d,S,h,w),d=BA(null,d,S,!0,N,w)):(d.tag=0,er&&N&&ou(d),$i(null,d,P,w),d=d.child),d;case 16:S=d.elementType;e:{switch(h!==null&&(h.alternate=null,d.alternate=null,d.flags|=2),h=d.pendingProps,P=S._init,S=P(S._payload),d.type=S,P=d.tag=nG(S),h=ss(S,h),P){case 0:d=OA(null,d,S,h,w);break e;case 1:d=YI(null,d,S,h,w);break e;case 11:d=$I(null,d,S,h,w);break e;case 14:d=jI(null,d,S,ss(S.type,h),w);break e}throw Error(o(306,S,""))}return d;case 0:return S=d.type,P=d.pendingProps,P=d.elementType===S?P:ss(S,P),OA(h,d,S,P,w);case 1:return S=d.type,P=d.pendingProps,P=d.elementType===S?P:ss(S,P),YI(h,d,S,P,w);case 3:e:{if(qI(d),h===null)throw Error(o(387));S=d.pendingProps,N=d.memoizedState,P=N.element,Ep(h,d),$r(d,S,null,w);var Q=d.memoizedState;if(S=Q.element,Le&&N.isDehydrated)if(N={element:S,isDehydrated:!1,cache:Q.cache,transitions:Q.transitions},d.updateQueue.baseState=N,d.memoizedState=N,d.flags&256){P=Error(o(423)),d=QI(h,d,S,w,P);break e}else if(S!==P){P=Error(o(424)),d=QI(h,d,S,w,P);break e}else for(Le&&(Cs=Ei(d.stateNode.containerInfo),Ts=d,er=!0,bo=null,wp=!1),w=vI(d,null,S,w),d.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling;else{if(Hh(),S===P){d=Wa(h,d,w);break e}$i(h,d,S,w)}d=d.child}return d;case 5:return _I(d),h===null&&EA(d),S=d.type,P=d.pendingProps,N=h!==null?h.memoizedProps:null,Q=P.children,De(S,P)?Q=null:N!==null&&De(S,N)&&(d.flags|=32),JI(h,d),$i(h,d,Q,w),d.child;case 6:return h===null&&EA(d),null;case 13:return ZI(h,d,w);case 4:return AA(d,d.stateNode.containerInfo),S=d.pendingProps,h===null?d.child=Vh(d,null,S,w):$i(h,d,S,w),d.child;case 11:return S=d.type,P=d.pendingProps,P=d.elementType===S?P:ss(S,P),$I(h,d,S,P,w);case 7:return $i(h,d,d.pendingProps,w),d.child;case 8:return $i(h,d,d.pendingProps.children,w),d.child;case 12:return $i(h,d,d.pendingProps.children,w),d.child;case 10:e:{if(S=d.type._context,P=d.pendingProps,N=d.memoizedProps,Q=P.value,_p(d,S,Q),N!==null)if(ws(N.value,Q)){if(N.children===P.children&&!Rt.current){d=Wa(h,d,w);break e}}else for(N=d.child,N!==null&&(N.return=d);N!==null;){var ue=N.dependencies;if(ue!==null){Q=N.child;for(var Re=ue.firstContext;Re!==null;){if(Re.context===S){if(N.tag===1){Re=Qs(-1,w&-w),Re.tag=2;var Ye=N.updateQueue;if(Ye!==null){Ye=Ye.shared;var pt=Ye.pending;pt===null?Re.next=Re:(Re.next=pt.next,pt.next=Re),Ye.pending=Re}}N.lanes|=w,Re=N.alternate,Re!==null&&(Re.lanes|=w),nu(N.return,w,d),ue.lanes|=w;break}Re=Re.next}}else if(N.tag===10)Q=N.type===d.type?null:N.child;else if(N.tag===18){if(Q=N.return,Q===null)throw Error(o(341));Q.lanes|=w,ue=Q.alternate,ue!==null&&(ue.lanes|=w),nu(Q,w,d),Q=N.sibling}else Q=N.child;if(Q!==null)Q.return=N;else for(Q=N;Q!==null;){if(Q===d){Q=null;break}if(N=Q.sibling,N!==null){N.return=Q.return,Q=N;break}Q=Q.return}N=Q}$i(h,d,P.children,w),d=d.child}return d;case 9:return P=d.type,S=d.pendingProps.children,Va(d,w),P=ii(P),S=S(P),d.flags|=1,$i(h,d,S,w),d.child;case 14:return S=d.type,P=ss(S,d.pendingProps),P=ss(S.type,P),jI(h,d,S,P,w);case 15:return XI(h,d,d.type,d.pendingProps,w);case 17:return S=d.type,P=d.pendingProps,P=d.elementType===S?P:ss(S,P),h!==null&&(h.alternate=null,d.alternate=null,d.flags|=2),d.tag=1,bn(S)?(h=!0,Vt(d)):h=!1,Va(d,w),k(d,S,P),ge(d,S,P,w),BA(null,d,S,!0,h,w);case 19:return rP(h,d,w);case 22:return KI(h,d,w)}throw Error(o(156,d.tag))};function bP(h,d){return Ks(h,d)}function tG(h,d,w,S){this.tag=h,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function no(h,d,w,S){return new tG(h,d,w,S)}function r1(h){return h=h.prototype,!(!h||!h.isReactComponent)}function nG(h){if(typeof h=="function")return r1(h)?1:0;if(h!=null){if(h=h.$$typeof,h===A)return 11;if(h===E)return 14}return 2}function Vl(h,d){var w=h.alternate;return w===null?(w=no(h.tag,d,h.key,h.mode),w.elementType=h.elementType,w.type=h.type,w.stateNode=h.stateNode,w.alternate=h,h.alternate=w):(w.pendingProps=d,w.type=h.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=h.flags&14680064,w.childLanes=h.childLanes,w.lanes=h.lanes,w.child=h.child,w.memoizedProps=h.memoizedProps,w.memoizedState=h.memoizedState,w.updateQueue=h.updateQueue,d=h.dependencies,w.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},w.sibling=h.sibling,w.index=h.index,w.ref=h.ref,w}function Av(h,d,w,S,P,N){var Q=2;if(S=h,typeof h=="function")r1(h)&&(Q=1);else if(typeof h=="string")Q=5;else e:switch(h){case u:return du(w.children,P,N,d);case f:Q=8,P|=8;break;case p:return h=no(12,w,d,P|2),h.elementType=p,h.lanes=N,h;case _:return h=no(13,w,d,P),h.elementType=_,h.lanes=N,h;case g:return h=no(19,w,d,P),h.elementType=g,h.lanes=N,h;case T:return wv(w,P,N,d);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case m:Q=10;break e;case y:Q=9;break e;case A:Q=11;break e;case E:Q=14;break e;case x:Q=16,S=null;break e}throw Error(o(130,h==null?h:typeof h,""))}return d=no(Q,w,d,P),d.elementType=h,d.type=S,d.lanes=N,d}function du(h,d,w,S){return h=no(7,h,S,d),h.lanes=w,h}function wv(h,d,w,S){return h=no(22,h,S,d),h.elementType=T,h.lanes=w,h.stateNode={},h}function i1(h,d,w){return h=no(6,h,null,d),h.lanes=w,h}function s1(h,d,w){return d=no(4,h.children!==null?h.children:[],h.key,d),d.lanes=w,d.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},d}function rG(h,d,w,S,P){this.tag=d,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=vt,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bh(0),this.expirationTimes=Bh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bh(0),this.identifierPrefix=S,this.onRecoverableError=P,Le&&(this.mutableSourceEagerHydrationData=null)}function MP(h,d,w,S,P,N,Q,ue,Re){return h=new rG(h,d,w,ue,Re),d===1?(d=1,N===!0&&(d|=8)):d=0,N=no(3,null,null,d),h.current=N,N.stateNode=h,N.memoizedState={element:S,isDehydrated:w,cache:null,transitions:null},To(N),h}function RP(h){if(!h)return Yt;h=h._reactInternals;e:{if(C(h)!==h||h.tag!==1)throw Error(o(170));var d=h;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(bn(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(o(171))}if(h.tag===1){var w=h.type;if(bn(w))return On(h,w,d)}return d}function IP(h){var d=h._reactInternals;if(d===void 0)throw typeof h.render=="function"?Error(o(188)):(h=Object.keys(h).join(","),Error(o(268,h)));return h=F(d),h===null?null:h.stateNode}function PP(h,d){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var w=h.retryLane;h.retryLane=w!==0&&w<d?w:d}}function o1(h,d){PP(h,d),(h=h.alternate)&&PP(h,d)}function iG(h){return h=F(h),h===null?null:h.stateNode}function sG(){return null}return t.attemptContinuousHydration=function(h){if(h.tag===13){var d=ji();to(h,134217728,d),o1(h,134217728)}},t.attemptHydrationAtCurrentPriority=function(h){if(h.tag===13){var d=ji(),w=zl(h);to(h,w,d),o1(h,w)}},t.attemptSynchronousHydration=function(h){switch(h.tag){case 3:var d=h.stateNode;if(d.current.memoizedState.isDehydrated){var w=wo(d.pendingLanes);w!==0&&(mp(d,w|1),as(d,wr()),!(ln&6)&&(Kh(),xi()))}break;case 13:var S=ji();_P(function(){return to(h,1,S)}),o1(h,1)}},t.batchedUpdates=function(h,d){var w=ln;ln|=1;try{return h(d)}finally{ln=w,ln===0&&(Kh(),Fa&&xi())}},t.createComponentSelector=function(h){return{$$typeof:lv,value:h}},t.createContainer=function(h,d,w,S,P,N,Q){return MP(h,d,!1,null,w,S,P,N,Q)},t.createHasPseudoClassSelector=function(h){return{$$typeof:cv,value:h}},t.createHydrationContainer=function(h,d,w,S,P,N,Q,ue,Re){return h=MP(w,S,!0,h,P,N,Q,ue,Re),h.context=RP(null),w=h.current,S=ji(),P=zl(w),N=Qs(S,P),N.callback=d??null,Co(w,N),h.current.lanes=P,Bl(h,P,S),as(h,S),h},t.createPortal=function(h,d,w){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:S==null?null:""+S,children:h,containerInfo:d,implementation:w}},t.createRoleSelector=function(h){return{$$typeof:uv,value:h}},t.createTestNameSelector=function(h){return{$$typeof:hv,value:h}},t.createTextSelector=function(h){return{$$typeof:fv,value:h}},t.deferredUpdates=function(h){var d=gn,w=Sr.transition;try{return Sr.transition=null,gn=16,h()}finally{gn=d,Sr.transition=w}},t.discreteUpdates=function(h,d,w,S,P){var N=gn,Q=Sr.transition;try{return Sr.transition=null,gn=1,h(d,w,S,P)}finally{gn=N,Sr.transition=Q,ln===0&&Kh()}},t.findAllNodes=jA,t.findBoundingRects=function(h,d){if(!V)throw Error(o(363));d=jA(h,d),h=[];for(var w=0;w<d.length;w++)h.push(ke(d[w]));for(d=h.length-1;0<d;d--){w=h[d];for(var S=w.x,P=S+w.width,N=w.y,Q=N+w.height,ue=d-1;0<=ue;ue--)if(d!==ue){var Re=h[ue],Ye=Re.x,pt=Ye+Re.width,Xt=Re.y,Lt=Xt+Re.height;if(S>=Ye&&N>=Xt&&P<=pt&&Q<=Lt){h.splice(d,1);break}else if(S!==Ye||w.width!==Re.width||Lt<N||Xt>Q){if(!(N!==Xt||w.height!==Re.height||pt<S||Ye>P)){Ye>S&&(Re.width+=Ye-S,Re.x=S),pt<P&&(Re.width=P-Ye),h.splice(d,1);break}}else{Xt>N&&(Re.height+=Xt-N,Re.y=N),Lt<Q&&(Re.height=Q-Xt),h.splice(d,1);break}}}return h},t.findHostInstance=IP,t.findHostInstanceWithNoPortals=function(h){return h=B(h),h=h!==null?j(h):null,h===null?null:h.stateNode},t.findHostInstanceWithWarning=function(h){return IP(h)},t.flushControlled=function(h){var d=ln;ln|=1;var w=Sr.transition,S=gn;try{Sr.transition=null,gn=1,h()}finally{gn=S,Sr.transition=w,ln=d,ln===0&&(Kh(),xi())}},t.flushPassiveEffects=fu,t.flushSync=_P,t.focusWithin=function(h,d){if(!V)throw Error(o(363));for(h=GA(h),d=gP(h,d),d=Array.from(d),h=0;h<d.length;){var w=d[h++];if(!ye(w)){if(w.tag===5&&Ge(w.stateNode))return!0;for(w=w.child;w!==null;)d.push(w),w=w.sibling}}return!1},t.getCurrentUpdatePriority=function(){return gn},t.getFindAllNodesFailureDescription=function(h,d){if(!V)throw Error(o(363));var w=0,S=[];h=[GA(h),0];for(var P=0;P<h.length;){var N=h[P++],Q=h[P++],ue=d[Q];if((N.tag!==5||!ye(N))&&(WA(N,ue)&&(S.push($A(ue)),Q++,Q>w&&(w=Q)),Q<d.length))for(N=N.child;N!==null;)h.push(N,Q),N=N.sibling}if(w<d.length){for(h=[];w<d.length;w++)h.push($A(d[w]));return`findAllNodes was able to match part of the selector:
  `+(S.join(" > ")+`

No matching component was found for:
  `)+h.join(" > ")}return null},t.getPublicRootInstance=function(h){if(h=h.current,!h.child)return null;switch(h.child.tag){case 5:return oe(h.child.stateNode);default:return h.child.stateNode}},t.injectIntoDevTools=function(h){if(h={bundleType:h.bundleType,version:h.version,rendererPackageName:h.rendererPackageName,rendererConfig:h.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:iG,findFiberByHostInstance:h.findFiberByHostInstance||sG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")h=!1;else{var d=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(d.isDisabled||!d.supportsFiber)h=!0;else{try{Un=d.inject(h),Js=d}catch{}h=!!d.checkDCE}}return h},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(h,d,w,S){if(!V)throw Error(o(363));h=jA(h,d);var P=Ke(h,w,S).disconnect;return{disconnect:function(){P()}}},t.registerMutableSourceForHydration=function(h,d){var w=d._getVersion;w=w(d._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[d,w]:h.mutableSourceEagerHydrationData.push(d,w)},t.runWithPriority=function(h,d){var w=gn;try{return gn=h,d()}finally{gn=w}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(h,d,w,S){var P=d.current,N=ji(),Q=zl(P);return w=RP(w),d.context===null?d.context=w:d.pendingContext=w,d=Qs(N,Q),d.payload={element:h},S=S===void 0?null:S,S!==null&&(d.callback=S),Co(P,d),h=to(P,Q,N),h!==null&&ru(h,P,Q),Q},t};rV.exports=coe;var uoe=rV.exports;const hoe=Vd(uoe),foe=n=>typeof n=="object"&&typeof n.then=="function",Gu=[];function oV(n,e,t=(r,i)=>r===i){if(n===e)return!0;if(!n||!e)return!1;const r=n.length;if(e.length!==r)return!1;for(let i=0;i<r;i++)if(!t(n[i],e[i]))return!1;return!0}function aV(n,e=null,t=!1,r={}){e===null&&(e=[n]);for(const s of Gu)if(oV(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!t)throw s.promise}const i={keys:e,equal:r.equal,remove:()=>{const s=Gu.indexOf(i);s!==-1&&Gu.splice(s,1)},promise:(foe(n)?n:n(...e)).then(s=>{i.response=s,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(s=>i.error=s)};if(Gu.push(i),!t)throw i.promise}const doe=(n,e,t)=>aV(n,e,!1,t),poe=(n,e,t)=>void aV(n,e,!0,t),moe=n=>{if(n===void 0||n.length===0)Gu.splice(0,Gu.length);else{const e=Gu.find(t=>oV(n,t.keys,t.equal));e&&e.remove()}},NR={},kR=n=>void Object.assign(NR,n);function goe(n,e){function t(u,{args:f=[],attach:p,...m},y){let A=`${u[0].toUpperCase()}${u.slice(1)}`,_;if(u==="primitive"){if(m.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const g=m.object;_=Rf(g,{type:u,root:y,attach:p,primitive:!0})}else{const g=NR[A];if(!g)throw new Error(`R3F: ${A} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(f))throw new Error("R3F: The args prop must be an array!");_=Rf(new g(...f),{type:u,root:y,attach:p,memoizedProps:{args:f}})}return _.__r3f.attach===void 0&&(_ instanceof Jt?_.__r3f.attach="geometry":_ instanceof kr&&(_.__r3f.attach="material")),A!=="inject"&&Ow(_,m),_}function r(u,f){let p=!1;if(f){var m,y;(m=f.__r3f)!=null&&m.attach?Lw(u,f,f.__r3f.attach):f.isObject3D&&u.isObject3D&&(u.add(f),p=!0),p||(y=u.__r3f)==null||y.objects.push(f),f.__r3f||Rf(f,{}),f.__r3f.parent=u,xC(f),If(f)}}function i(u,f,p){let m=!1;if(f){var y,A;if((y=f.__r3f)!=null&&y.attach)Lw(u,f,f.__r3f.attach);else if(f.isObject3D&&u.isObject3D){f.parent=u,f.dispatchEvent({type:"added"});const _=u.children.filter(E=>E!==f),g=_.indexOf(p);u.children=[..._.slice(0,g),f,..._.slice(g)],m=!0}m||(A=u.__r3f)==null||A.objects.push(f),f.__r3f||Rf(f,{}),f.__r3f.parent=u,xC(f),If(f)}}function s(u,f,p=!1){u&&[...u].forEach(m=>o(f,m,p))}function o(u,f,p){if(f){var m,y,A;if(f.__r3f&&(f.__r3f.parent=null),(m=u.__r3f)!=null&&m.objects&&(u.__r3f.objects=u.__r3f.objects.filter(T=>T!==f)),(y=f.__r3f)!=null&&y.attach)ZO(u,f,f.__r3f.attach);else if(f.isObject3D&&u.isObject3D){var _;u.remove(f),(_=f.__r3f)!=null&&_.root&&Soe(f.__r3f.root,f)}const E=(A=f.__r3f)==null?void 0:A.primitive,x=!E&&(p===void 0?f.dispose!==null:p);if(!E){var g;s((g=f.__r3f)==null?void 0:g.objects,f,x),s(f.children,f,x)}if(delete f.__r3f,x&&f.dispose&&f.type!=="Scene"){const T=()=>{try{f.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?_C.unstable_scheduleCallback(_C.unstable_IdlePriority,T):T()}If(u)}}function a(u,f,p,m){var y;const A=(y=u.__r3f)==null?void 0:y.parent;if(!A)return;const _=t(f,p,u.__r3f.root);if(u.children){for(const g of u.children)g.__r3f&&r(_,g);u.children=u.children.filter(g=>!g.__r3f)}u.__r3f.objects.forEach(g=>r(_,g)),u.__r3f.objects=[],u.__r3f.autoRemovedBeforeAppend||o(A,u),_.parent&&(_.__r3f.autoRemovedBeforeAppend=!0),r(A,_),_.raycast&&_.__r3f.eventCount&&_.__r3f.root.getState().internal.interaction.push(_),[m,m.alternate].forEach(g=>{g!==null&&(g.stateNode=_,g.ref&&(typeof g.ref=="function"?g.ref(_):g.ref.current=_))})}const l=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:hoe({createInstance:t,removeChild:o,appendChild:r,appendInitialChild:r,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(u,f)=>{if(!f)return;const p=u.getState().scene;p.__r3f&&(p.__r3f.root=u,r(p,f))},removeChildFromContainer:(u,f)=>{f&&o(u.getState().scene,f)},insertInContainerBefore:(u,f,p)=>{if(!f||!p)return;const m=u.getState().scene;m.__r3f&&i(m,f,p)},getRootHostContext:()=>null,getChildHostContext:u=>u,finalizeInitialChildren(u){var f;return!!((f=u==null?void 0:u.__r3f)!=null?f:{}).handlers},prepareUpdate(u,f,p,m){var y;if(((y=u==null?void 0:u.__r3f)!=null?y:{}).primitive&&m.object&&m.object!==u)return[!0];{const{args:_=[],children:g,...E}=m,{args:x=[],children:T,...O}=p;if(!Array.isArray(_))throw new Error("R3F: the args prop must be an array!");if(_.some((b,R)=>b!==x[R]))return[!0];const I=pV(u,E,O,!0);return I.changes.length?[!1,I]:null}},commitUpdate(u,[f,p],m,y,A,_){f?a(u,m,A,_):Ow(u,p)},commitMount(u,f,p,m){var y;const A=(y=u.__r3f)!=null?y:{};u.raycast&&A.handlers&&A.eventCount&&u.__r3f.root.getState().internal.interaction.push(u)},getPublicInstance:u=>u,prepareForCommit:()=>null,preparePortalMount:u=>Rf(u.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(u){var f;const{attach:p,parent:m}=(f=u.__r3f)!=null?f:{};p&&m&&ZO(m,u,p),u.isObject3D&&(u.visible=!1),If(u)},unhideInstance(u,f){var p;const{attach:m,parent:y}=(p=u.__r3f)!=null?p:{};m&&y&&Lw(y,u,m),(u.isObject3D&&f.visible==null||f.visible)&&(u.visible=!0),If(u)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():Jf.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Jn.fun(performance.now)?performance.now:Jn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Jn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Jn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Ow}}var JO,YO;const Dw=n=>"colorSpace"in n||"outputColorSpace"in n,lV=()=>{var n;return(n=NR.ColorManagement)!=null?n:null},cV=n=>n&&n.isOrthographicCamera,yoe=n=>n&&n.hasOwnProperty("current"),by=typeof window<"u"&&((JO=window.document)!=null&&JO.createElement||((YO=window.navigator)==null?void 0:YO.product)==="ReactNative")?D.useLayoutEffect:D.useEffect;function uV(n){const e=D.useRef(n);return by(()=>void(e.current=n),[n]),e}function voe({set:n}){return by(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}let hV=class extends D.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}};hV.getDerivedStateFromError=()=>({error:!0});const fV="__default",qO=new Map,_oe=n=>n&&!!n.memoized&&!!n.changes;function dV(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const lm=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()},Jn={obj:n=>n===Object(n)&&!Jn.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:r="reference",strict:i=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(Jn.str(n)||Jn.num(n))return n===e;const s=Jn.obj(n);if(s&&r==="reference")return n===e;const o=Jn.arr(n);if(o&&t==="reference")return n===e;if((o||s)&&n===e)return!0;let a;for(a in n)if(!(a in e))return!1;if(s&&t==="shallow"&&r==="shallow"){for(a in i?e:n)if(!Jn.equ(n[a],e[a],{strict:i,objects:"reference"}))return!1}else for(a in i?e:n)if(n[a]!==e[a])return!1;if(Jn.und(a)){if(o&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function Eoe(n){const e={nodes:{},materials:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function xoe(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function Rf(n,e){const t=n;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function EC(n,e){let t=n;if(e.includes("-")){const r=e.split("-"),i=r.pop();return t=r.reduce((s,o)=>s[o],n),{target:t,key:i}}else return{target:t,key:e}}const QO=/-\d+$/;function Lw(n,e,t){if(Jn.str(t)){if(QO.test(t)){const s=t.replace(QO,""),{target:o,key:a}=EC(n,s);Array.isArray(o[a])||(o[a]=[])}const{target:r,key:i}=EC(n,t);e.__r3f.previousAttach=r[i],r[i]=e}else e.__r3f.previousAttach=t(n,e)}function ZO(n,e,t){var r,i;if(Jn.str(t)){const{target:s,key:o}=EC(n,t),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(r=e.__r3f)==null||r.previousAttach==null||r.previousAttach(n,e);(i=e.__r3f)==null||delete i.previousAttach}function pV(n,{children:e,key:t,ref:r,...i},{children:s,key:o,ref:a,...l}={},c=!1){var u;const f=(u=n==null?void 0:n.__r3f)!=null?u:{},p=Object.entries(i),m=[];if(c){const A=Object.keys(l);for(let _=0;_<A.length;_++)i.hasOwnProperty(A[_])||p.unshift([A[_],fV+"remove"])}p.forEach(([A,_])=>{var g;if((g=n.__r3f)!=null&&g.primitive&&A==="object"||Jn.equ(_,l[A]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(A))return m.push([A,_,!0,[]]);let E=[];A.includes("-")&&(E=A.split("-")),m.push([A,_,!1,E]);for(const x in i){const T=i[x];x.startsWith(`${A}-`)&&m.push([x,T,!1,x.split("-")])}});const y={...i};return f.memoizedProps&&f.memoizedProps.args&&(y.args=f.memoizedProps.args),f.memoizedProps&&f.memoizedProps.attach&&(y.attach=f.memoizedProps.attach),{memoized:y,changes:m}}const Aoe=typeof process<"u"&&!1;function Ow(n,e){var t,r,i;const s=(t=n.__r3f)!=null?t:{},o=s.root,a=(r=o==null||o.getState==null?void 0:o.getState())!=null?r:{},{memoized:l,changes:c}=_oe(e)?e:pV(n,e),u=s.eventCount;n.__r3f&&(n.__r3f.memoizedProps=l);for(let p=0;p<c.length;p++){let[m,y,A,_]=c[p];if(Dw(n)){const T="srgb",O="srgb-linear";m==="encoding"?(m="colorSpace",y=y===3001?T:O):m==="outputEncoding"&&(m="outputColorSpace",y=y===3001?T:O)}let g=n,E=g[m];if(_.length&&(E=_.reduce((x,T)=>x[T],n),!(E&&E.set))){const[x,...T]=_.reverse();g=T.reverse().reduce((O,I)=>O[I],n),m=x}if(y===fV+"remove")if(g.constructor){let x=qO.get(g.constructor);x||(x=new g.constructor,qO.set(g.constructor,x)),y=x[m]}else y=0;if(A)y?s.handlers[m]=y:delete s.handlers[m],s.eventCount=Object.keys(s.handlers).length;else if(E&&E.set&&(E.copy||E instanceof qu)){if(Array.isArray(y))E.fromArray?E.fromArray(y):E.set(...y);else if(E.copy&&y&&y.constructor&&(Aoe?E.constructor.name===y.constructor.name:E.constructor===y.constructor))E.copy(y);else if(y!==void 0){const x=E instanceof st;!x&&E.setScalar?E.setScalar(y):E instanceof qu&&y instanceof qu?E.mask=y.mask:E.set(y),!lV()&&!a.linear&&x&&E.convertSRGBToLinear()}}else if(g[m]=y,g[m]instanceof Qn&&g[m].format===Ni&&g[m].type===Aa){const x=g[m];Dw(x)&&Dw(a.gl)?x.colorSpace=a.gl.outputColorSpace:x.encoding=a.gl.outputEncoding}If(n)}if(s.parent&&a.internal&&n.raycast&&u!==s.eventCount){const p=a.internal.interaction.indexOf(n);p>-1&&a.internal.interaction.splice(p,1),s.eventCount&&a.internal.interaction.push(n)}return!(c.length===1&&c[0][0]==="onUpdate")&&c.length&&(i=n.__r3f)!=null&&i.parent&&xC(n),n}function If(n){var e,t;const r=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();r&&r.internal.frames===0&&r.invalidate()}function xC(n){n.onUpdate==null||n.onUpdate(n)}function mV(n,e){n.manual||(cV(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function V0(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function woe(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return Jf.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Jf.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Jf.ContinuousEventPriority;default:return Jf.DefaultEventPriority}}function gV(n,e,t,r){const i=t.get(e);i&&(t.delete(e),t.size===0&&(n.delete(r),i.target.releasePointerCapture(r)))}function Soe(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(r=>r!==e),t.initialHits=t.initialHits.filter(r=>r!==e),t.hovered.forEach((r,i)=>{(r.eventObject===e||r.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((r,i)=>{gV(t.capturedMap,e,r,i)})}function Toe(n){function e(l){const{internal:c}=n.getState(),u=l.offsetX-c.initialClick[0],f=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+f*f))}function t(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(u=>{var f;return(f=c.__r3f)==null?void 0:f.handlers["onPointer"+u]}))}function r(l,c){const u=n.getState(),f=new Set,p=[],m=c?c(u.internal.interaction):u.internal.interaction;for(let g=0;g<m.length;g++){const E=lm(m[g]);E&&(E.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(l,u);function y(g){const E=lm(g);if(!E||!E.events.enabled||E.raycaster.camera===null)return[];if(E.raycaster.camera===void 0){var x;E.events.compute==null||E.events.compute(l,E,(x=E.previousRoot)==null?void 0:x.getState()),E.raycaster.camera===void 0&&(E.raycaster.camera=null)}return E.raycaster.camera?E.raycaster.intersectObject(g,!0):[]}let A=m.flatMap(y).sort((g,E)=>{const x=lm(g.object),T=lm(E.object);return!x||!T?g.distance-E.distance:T.events.priority-x.events.priority||g.distance-E.distance}).filter(g=>{const E=V0(g);return f.has(E)?!1:(f.add(E),!0)});u.events.filter&&(A=u.events.filter(A,u));for(const g of A){let E=g.object;for(;E;){var _;(_=E.__r3f)!=null&&_.eventCount&&p.push({...g,eventObject:E}),E=E.parent}}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(let g of u.internal.capturedMap.get(l.pointerId).values())f.has(V0(g.intersection))||p.push(g.intersection);return p}function i(l,c,u,f){const p=n.getState();if(l.length){const m={stopped:!1};for(const y of l){const A=lm(y.object)||p,{raycaster:_,pointer:g,camera:E,internal:x}=A,T=new J(g.x,g.y,0).unproject(E),O=M=>{var B,F;return(B=(F=x.capturedMap.get(M))==null?void 0:F.has(y.eventObject))!=null?B:!1},I=M=>{const B={intersection:y,target:c.target};x.capturedMap.has(M)?x.capturedMap.get(M).set(y.eventObject,B):x.capturedMap.set(M,new Map([[y.eventObject,B]])),c.target.setPointerCapture(M)},b=M=>{const B=x.capturedMap.get(M);B&&gV(x.capturedMap,y.eventObject,B,M)};let R={};for(let M in c){let B=c[M];typeof B!="function"&&(R[M]=B)}let C={...y,...R,pointer:g,intersections:l,stopped:m.stopped,delta:u,unprojectedPoint:T,ray:_.ray,camera:E,stopPropagation(){const M="pointerId"in c&&x.capturedMap.get(c.pointerId);if((!M||M.has(y.eventObject))&&(C.stopped=m.stopped=!0,x.hovered.size&&Array.from(x.hovered.values()).find(B=>B.eventObject===y.eventObject))){const B=l.slice(0,l.indexOf(y));s([...B,y])}},target:{hasPointerCapture:O,setPointerCapture:I,releasePointerCapture:b},currentTarget:{hasPointerCapture:O,setPointerCapture:I,releasePointerCapture:b},nativeEvent:c};if(f(C),m.stopped===!0)break}}return l}function s(l){const{internal:c}=n.getState();for(const u of c.hovered.values())if(!l.length||!l.find(f=>f.object===u.object&&f.index===u.index&&f.instanceId===u.instanceId)){const p=u.eventObject.__r3f,m=p==null?void 0:p.handlers;if(c.hovered.delete(V0(u)),p!=null&&p.eventCount){const y={...u,intersections:l};m.onPointerOut==null||m.onPointerOut(y),m.onPointerLeave==null||m.onPointerLeave(y)}}}function o(l,c){for(let u=0;u<c.length;u++){const f=c[u].__r3f;f==null||f.handlers.onPointerMissed==null||f.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:u}=n.getState();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),s([]))})}}return function(u){const{onPointerMissed:f,internal:p}=n.getState();p.lastEvent.current=u;const m=l==="onPointerMove",y=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",_=r(u,m?t:void 0),g=y?e(u):0;l==="onPointerDown"&&(p.initialClick=[u.offsetX,u.offsetY],p.initialHits=_.map(x=>x.eventObject)),y&&!_.length&&g<=2&&(o(u,p.interaction),f&&f(u)),m&&s(_);function E(x){const T=x.eventObject,O=T.__r3f,I=O==null?void 0:O.handlers;if(O!=null&&O.eventCount)if(m){if(I.onPointerOver||I.onPointerEnter||I.onPointerOut||I.onPointerLeave){const b=V0(x),R=p.hovered.get(b);R?R.stopped&&x.stopPropagation():(p.hovered.set(b,x),I.onPointerOver==null||I.onPointerOver(x),I.onPointerEnter==null||I.onPointerEnter(x))}I.onPointerMove==null||I.onPointerMove(x)}else{const b=I[l];b?(!y||p.initialHits.includes(T))&&(o(u,p.interaction.filter(R=>!p.initialHits.includes(R))),b(x)):y&&p.initialHits.includes(T)&&o(u,p.interaction.filter(R=>!p.initialHits.includes(R)))}}i(_,u,g,E)}}return{handlePointer:a}}const Coe=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],yV=n=>!!(n!=null&&n.render),FR=D.createContext(null),boe=(n,e)=>{const t=lA((a,l)=>{const c=new J,u=new J,f=new J;function p(g=l().camera,E=u,x=l().size){const{width:T,height:O,top:I,left:b}=x,R=T/O;E instanceof J?f.copy(E):f.set(...E);const C=g.getWorldPosition(c).distanceTo(f);if(cV(g))return{width:T/g.zoom,height:O/g.zoom,top:I,left:b,factor:1,distance:C,aspect:R};{const M=g.fov*Math.PI/180,B=2*Math.tan(M/2)*C,F=B*(T/O);return{width:F,height:B,top:I,left:b,factor:T/F,distance:C,aspect:R}}}let m;const y=g=>a(E=>({performance:{...E.performance,current:g}})),A=new Be;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(g=1)=>n(l(),g),advance:(g,E)=>e(g,E,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new DR,pointer:A,mouse:A,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const g=l();m&&clearTimeout(m),g.performance.current!==g.performance.min&&y(g.performance.min),m=setTimeout(()=>y(l().performance.max),g.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:p},setEvents:g=>a(E=>({...E,events:{...E.events,...g}})),setSize:(g,E,x,T,O)=>{const I=l().camera,b={width:g,height:E,top:T||0,left:O||0,updateStyle:x};a(R=>({size:b,viewport:{...R.viewport,...p(I,u,b)}}))},setDpr:g=>a(E=>{const x=dV(g);return{viewport:{...E.viewport,dpr:x,initialDpr:E.viewport.initialDpr||x}}}),setFrameloop:(g="always")=>{const E=l().clock;E.stop(),E.elapsedTime=0,g!=="never"&&(E.start(),E.elapsedTime=0),a(()=>({frameloop:g}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:D.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(g,E,x)=>{const T=l().internal;return T.priority=T.priority+(E>0?1:0),T.subscribers.push({ref:g,priority:E,store:x}),T.subscribers=T.subscribers.sort((O,I)=>O.priority-I.priority),()=>{const O=l().internal;O!=null&&O.subscribers&&(O.priority=O.priority-(E>0?1:0),O.subscribers=O.subscribers.filter(I=>I.ref!==g))}}}}}),r=t.getState();let i=r.size,s=r.viewport.dpr,o=r.camera;return t.subscribe(()=>{const{camera:a,size:l,viewport:c,gl:u,set:f}=t.getState();if(l.width!==i.width||l.height!==i.height||c.dpr!==s){var p;i=l,s=c.dpr,mV(a,l),u.setPixelRatio(c.dpr);const m=(p=l.updateStyle)!=null?p:typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(l.width,l.height,m)}a!==o&&(o=a,f(m=>({viewport:{...m.viewport,...m.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>n(a)),t};let G0,Moe=new Set,Roe=new Set,Ioe=new Set;function Bw(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function cm(n,e){switch(n){case"before":return Bw(Moe,e);case"after":return Bw(Roe,e);case"tail":return Bw(Ioe,e)}}let Nw,kw;function Fw(n,e,t){let r=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(r=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),Nw=e.internal.subscribers,G0=0;G0<Nw.length;G0++)kw=Nw[G0],kw.ref.current(kw.store.getState(),r,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function Poe(n){let e=!1,t,r,i;function s(l){r=requestAnimationFrame(s),e=!0,t=0,cm("before",l);for(const u of n.values()){var c;i=u.store.getState(),i.internal.active&&(i.frameloop==="always"||i.internal.frames>0)&&!((c=i.gl.xr)!=null&&c.isPresenting)&&(t+=Fw(l,i))}if(cm("after",l),t===0)return cm("tail",l),e=!1,cancelAnimationFrame(r)}function o(l,c=1){var u;if(!l)return n.forEach(f=>o(f.store.getState()),c);(u=l.gl.xr)!=null&&u.isPresenting||!l.internal.active||l.frameloop==="never"||(l.internal.frames=Math.min(60,l.internal.frames+c),e||(e=!0,requestAnimationFrame(s)))}function a(l,c=!0,u,f){if(c&&cm("before",l),u)Fw(l,u,f);else for(const p of n.values())Fw(l,p.store.getState());c&&cm("after",l)}return{loop:s,invalidate:o,advance:a}}function UR(){const n=D.useContext(FR);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function Ds(n=t=>t,e){return UR()(n,e)}function My(n,e=0){const t=UR(),r=t.getState().internal.subscribe,i=uV(n);return by(()=>r(i,e,t),[e,r,t]),null}const eB=new WeakMap;function vV(n,e){return function(t,...r){let i=eB.get(t);return i||(i=new t,eB.set(t,i)),n&&n(i),Promise.all(r.map(s=>new Promise((o,a)=>i.load(s,l=>{l.scene&&Object.assign(l,Eoe(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l==null?void 0:l.message}`)))))).finally(()=>i.dispose==null?void 0:i.dispose())}}function op(n,e,t,r){const i=Array.isArray(e)?e:[e],s=doe(vV(t,r),[n,...i],{equal:Jn.equ});return Array.isArray(e)?s:s[0]}op.preload=function(n,e,t){const r=Array.isArray(e)?e:[e];return poe(vV(t),[n,...r])};op.clear=function(n,e){const t=Array.isArray(e)?e:[e];return moe([n,...t])};const kd=new Map,{invalidate:tB,advance:nB}=Poe(kd),{reconciler:Hg,applyProps:vf}=goe(kd,woe),_f={objects:"shallow",strict:!1},Doe=(n,e)=>{const t=typeof n=="function"?n(e):n;return yV(t)?t:new uR({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function Loe(n,e){const t=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:r,height:i,top:s,left:o,updateStyle:a=t}=e;return{width:r,height:i,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:r,height:i,top:s,left:o}=n.parentElement.getBoundingClientRect();return{width:r,height:i,top:s,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function Ooe(n){const e=kd.get(n),t=e==null?void 0:e.fiber,r=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=r||boe(tB,nB),o=t||Hg.createContainer(s,Jf.ConcurrentRoot,null,!1,null,"",i,null);e||kd.set(n,{fiber:o,store:s});let a,l=!1,c;return{configure(u={}){let{gl:f,size:p,scene:m,events:y,onCreated:A,shadows:_=!1,linear:g=!1,flat:E=!1,legacy:x=!1,orthographic:T=!1,frameloop:O="always",dpr:I=[1,2],performance:b,raycaster:R,camera:C,onPointerMissed:M}=u,B=s.getState(),F=B.gl;B.gl||B.set({gl:F=Doe(f,n)});let z=B.raycaster;z||B.set({raycaster:z=new aA});const{params:j,...Y}=R||{};if(Jn.equ(Y,z,_f)||vf(z,{...Y}),Jn.equ(j,z.params,_f)||vf(z,{params:{...z.params,...j}}),!B.camera||B.camera===c&&!Jn.equ(c,C,_f)){c=C;const me=C instanceof gy,he=me?C:T?new qc(0,0,0,0,.1,1e3):new Mr(75,0,.1,1e3);me||(he.position.z=5,C&&vf(he,C),!B.camera&&!(C!=null&&C.rotation)&&he.lookAt(0,0,0)),B.set({camera:he}),z.camera=he}if(!B.scene){let me;m instanceof Bg?me=m:(me=new Bg,m&&vf(me,m)),B.set({scene:Rf(me)})}if(!B.xr){var oe;const me=(De,Ie)=>{const He=s.getState();He.frameloop!=="never"&&nB(De,!0,He,Ie)},he=()=>{const De=s.getState();De.gl.xr.enabled=De.gl.xr.isPresenting,De.gl.xr.setAnimationLoop(De.gl.xr.isPresenting?me:null),De.gl.xr.isPresenting||tB(De)},Ae={connect(){const De=s.getState().gl;De.xr.addEventListener("sessionstart",he),De.xr.addEventListener("sessionend",he)},disconnect(){const De=s.getState().gl;De.xr.removeEventListener("sessionstart",he),De.xr.removeEventListener("sessionend",he)}};typeof((oe=F.xr)==null?void 0:oe.addEventListener)=="function"&&Ae.connect(),B.set({xr:Ae})}if(F.shadowMap){const me=F.shadowMap.enabled,he=F.shadowMap.type;if(F.shadowMap.enabled=!!_,Jn.boo(_))F.shadowMap.type=jm;else if(Jn.str(_)){var le;const Ae={basic:Q4,percentage:Lx,soft:jm,variance:Bo};F.shadowMap.type=(le=Ae[_])!=null?le:jm}else Jn.obj(_)&&Object.assign(F.shadowMap,_);(me!==F.shadowMap.enabled||he!==F.shadowMap.type)&&(F.shadowMap.needsUpdate=!0)}const X=lV();X&&("enabled"in X?X.enabled=!x:"legacyMode"in X&&(X.legacyMode=x)),vf(F,{outputEncoding:g?3e3:3001,toneMapping:E?xa:HM}),B.legacy!==x&&B.set(()=>({legacy:x})),B.linear!==g&&B.set(()=>({linear:g})),B.flat!==E&&B.set(()=>({flat:E})),f&&!Jn.fun(f)&&!yV(f)&&!Jn.equ(f,F,_f)&&vf(F,f),y&&!B.events.handlers&&B.set({events:y(s)});const fe=Loe(n,p);return Jn.equ(fe,B.size,_f)||B.setSize(fe.width,fe.height,fe.updateStyle,fe.top,fe.left),I&&B.viewport.dpr!==dV(I)&&B.setDpr(I),B.frameloop!==O&&B.setFrameloop(O),B.onPointerMissed||B.set({onPointerMissed:M}),b&&!Jn.equ(b,B.performance,_f)&&B.set(me=>({performance:{...me.performance,...b}})),a=A,l=!0,this},render(u){return l||this.configure(),Hg.updateContainer(D.createElement(Boe,{store:s,children:u,onCreated:a,rootElement:n}),o,null,()=>{}),s},unmount(){_V(n)}}}function Boe({store:n,children:e,onCreated:t,rootElement:r}){return by(()=>{const i=n.getState();i.set(s=>({internal:{...s.internal,active:!0}})),t&&t(i),n.getState().events.connected||i.events.connect==null||i.events.connect(r)},[]),D.createElement(FR.Provider,{value:n},e)}function _V(n,e){const t=kd.get(n),r=t==null?void 0:t.fiber;if(r){const i=t==null?void 0:t.store.getState();i&&(i.internal.active=!1),Hg.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var s,o,a,l;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=i.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=i.gl)!=null&&l.xr&&i.xr.disconnect(),xoe(i),kd.delete(n),e&&e(n)}catch{}},500)})}}function Noe(n,e,t){return D.createElement(koe,{key:e.uuid,children:n,container:e,state:t})}function koe({state:n={},children:e,container:t}){const{events:r,size:i,...s}=n,o=UR(),[a]=D.useState(()=>new aA),[l]=D.useState(()=>new Be),c=D.useCallback((f,p)=>{const m={...f};Object.keys(f).forEach(A=>{(Coe.includes(A)||f[A]!==p[A]&&p[A])&&delete m[A]});let y;if(p&&i){const A=p.camera;y=f.viewport.getCurrentViewport(A,new J,i),A!==f.camera&&mV(A,i)}return{...m,scene:t,raycaster:a,pointer:l,mouse:l,previousRoot:o,events:{...f.events,...p==null?void 0:p.events,...r},size:{...f.size,...i},viewport:{...f.viewport,...y},...s}},[n]),[u]=D.useState(()=>{const f=o.getState();return lA((m,y)=>({...f,scene:t,raycaster:a,pointer:l,mouse:l,previousRoot:o,events:{...f.events,...r},size:{...f.size,...i},...s,set:m,get:y,setEvents:A=>m(_=>({..._,events:{..._.events,...A}}))}))});return D.useEffect(()=>{const f=o.subscribe(p=>u.setState(m=>c(p,m)));return()=>{f(),u.destroy()}},[]),D.useEffect(()=>{u.setState(f=>c(o.getState(),f))},[c]),D.createElement(D.Fragment,null,Hg.createPortal(D.createElement(FR.Provider,{value:u},e),u,null))}Hg.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:D.version});function AC(n,e,t){var r,i,s,o,a;e==null&&(e=100);function l(){var u=Date.now()-o;u<e&&u>=0?r=setTimeout(l,e-u):(r=null,t||(a=n.apply(s,i),s=i=null))}var c=function(){s=this,i=arguments,o=Date.now();var u=t&&!r;return r||(r=setTimeout(l,e)),u&&(a=n.apply(s,i),s=i=null),a};return c.clear=function(){r&&(clearTimeout(r),r=null)},c.flush=function(){r&&(a=n.apply(s,i),s=i=null,clearTimeout(r),r=null)},c}AC.debounce=AC;var Foe=AC;const rB=Vd(Foe);function Uoe(n){let{debounce:e,scroll:t,polyfill:r,offsetSize:i}=n===void 0?{debounce:0,scroll:!1,offsetSize:!1}:n;const s=r||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,a]=D.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=D.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),c=e?typeof e=="number"?e:e.scroll:null,u=e?typeof e=="number"?e:e.resize:null,f=D.useRef(!1);D.useEffect(()=>(f.current=!0,()=>void(f.current=!1)));const[p,m,y]=D.useMemo(()=>{const E=()=>{if(!l.current.element)return;const{left:x,top:T,width:O,height:I,bottom:b,right:R,x:C,y:M}=l.current.element.getBoundingClientRect(),B={left:x,top:T,width:O,height:I,bottom:b,right:R,x:C,y:M};l.current.element instanceof HTMLElement&&i&&(B.height=l.current.element.offsetHeight,B.width=l.current.element.offsetWidth),Object.freeze(B),f.current&&!Goe(l.current.lastBounds,B)&&a(l.current.lastBounds=B)};return[E,u?rB(E,u):E,c?rB(E,c):E]},[a,i,c,u]);function A(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(E=>E.removeEventListener("scroll",y,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function _(){l.current.element&&(l.current.resizeObserver=new s(y),l.current.resizeObserver.observe(l.current.element),t&&l.current.scrollContainers&&l.current.scrollContainers.forEach(E=>E.addEventListener("scroll",y,{capture:!0,passive:!0})))}const g=E=>{!E||E===l.current.element||(A(),l.current.element=E,l.current.scrollContainers=EV(E),_())};return Hoe(y,!!t),zoe(m),D.useEffect(()=>{A(),_()},[t,y,m]),D.useEffect(()=>A,[]),[g,o,p]}function zoe(n){D.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function Hoe(n,e){D.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function EV(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:r,overflowY:i}=window.getComputedStyle(n);return[t,r,i].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...EV(n.parentElement)]}const Voe=["x","y","top","bottom","left","right","width","height"],Goe=(n,e)=>Voe.every(t=>n[t]===e[t]);var Woe=Object.defineProperty,$oe=Object.defineProperties,joe=Object.getOwnPropertyDescriptors,iB=Object.getOwnPropertySymbols,Xoe=Object.prototype.hasOwnProperty,Koe=Object.prototype.propertyIsEnumerable,sB=(n,e,t)=>e in n?Woe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,oB=(n,e)=>{for(var t in e||(e={}))Xoe.call(e,t)&&sB(n,t,e[t]);if(iB)for(var t of iB(e))Koe.call(e,t)&&sB(n,t,e[t]);return n},Joe=(n,e)=>$oe(n,joe(e));function xV(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=e?n.return:n.child;for(;r;){const i=xV(r,e,t);if(i)return i;r=e?null:r.sibling}}function AV(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const zR=AV(D.createContext(null));class wV extends D.Component{render(){return D.createElement(zR.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:aB,ReactCurrentDispatcher:lB}=D.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Yoe(){const n=D.useContext(zR);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=D.useId();return D.useMemo(()=>{for(const r of[aB==null?void 0:aB.current,n,n==null?void 0:n.alternate]){if(!r)continue;const i=xV(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[n,e])}function qoe(){var n,e;const t=Yoe(),[r]=D.useState(()=>new Map);r.clear();let i=t;for(;i;){const s=(n=i.type)==null?void 0:n._context;s&&s!==zR&&!r.has(s)&&r.set(s,(e=lB==null?void 0:lB.current)==null?void 0:e.readContext(AV(s))),i=i.return}return r}function Qoe(){const n=qoe();return D.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>D.createElement(e,null,D.createElement(t.Provider,Joe(oB({},r),{value:n.get(t)}))),e=>D.createElement(wV,oB({},e))),[n])}const Uw={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Zoe(n){const{handlePointer:e}=Toe(n);return{priority:1,enabled:!0,compute(t,r,i){r.pointer.set(t.offsetX/r.size.width*2-1,-(t.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(Uw).reduce((t,r)=>({...t,[r]:e(r)}),{}),update:()=>{var t;const{events:r,internal:i}=n.getState();(t=i.lastEvent)!=null&&t.current&&r.handlers&&r.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var r;const{set:i,events:s}=n.getState();s.disconnect==null||s.disconnect(),i(o=>({events:{...o.events,connected:t}})),Object.entries((r=s.handlers)!=null?r:[]).forEach(([o,a])=>{const[l,c]=Uw[o];t.addEventListener(l,a,{passive:c})})},disconnect:()=>{const{set:t,events:r}=n.getState();if(r.connected){var i;Object.entries((i=r.handlers)!=null?i:[]).forEach(([s,o])=>{if(r&&r.connected instanceof HTMLElement){const[a]=Uw[s];r.connected.removeEventListener(a,o)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}const eae=D.forwardRef(function({children:e,fallback:t,resize:r,style:i,gl:s,events:o=Zoe,eventSource:a,eventPrefix:l,shadows:c,linear:u,flat:f,legacy:p,orthographic:m,frameloop:y,dpr:A,performance:_,raycaster:g,camera:E,scene:x,onPointerMissed:T,onCreated:O,...I},b){D.useMemo(()=>kR(ooe),[]);const R=Qoe(),[C,M]=Uoe({scroll:!0,debounce:{scroll:50,resize:0},...r}),B=D.useRef(null),F=D.useRef(null);D.useImperativeHandle(b,()=>B.current);const z=uV(T),[j,Y]=D.useState(!1),[oe,le]=D.useState(!1);if(j)throw j;if(oe)throw oe;const X=D.useRef(null);by(()=>{const ie=B.current;M.width>0&&M.height>0&&ie&&(X.current||(X.current=Ooe(ie)),X.current.configure({gl:s,events:o,shadows:c,linear:u,flat:f,legacy:p,orthographic:m,frameloop:y,dpr:A,performance:_,raycaster:g,camera:E,scene:x,size:M,onPointerMissed:(...fe)=>z.current==null?void 0:z.current(...fe),onCreated:fe=>{fe.events.connect==null||fe.events.connect(a?yoe(a)?a.current:a:F.current),l&&fe.setEvents({compute:(me,he)=>{const Ae=me[l+"X"],De=me[l+"Y"];he.pointer.set(Ae/he.size.width*2-1,-(De/he.size.height)*2+1),he.raycaster.setFromCamera(he.pointer,he.camera)}}),O==null||O(fe)}}),X.current.render(D.createElement(R,null,D.createElement(hV,{set:le},D.createElement(D.Suspense,{fallback:D.createElement(voe,{set:Y})},e)))))}),D.useEffect(()=>{const ie=B.current;if(ie)return()=>_V(ie)},[]);const ee=a?"none":"auto";return D.createElement("div",sr({ref:F,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ee,...i}},I),D.createElement("div",{ref:C,style:{width:"100%",height:"100%"}},D.createElement("canvas",{ref:B,style:{display:"block"}},t)))}),tae=D.forwardRef(function(e,t){return D.createElement(wV,null,D.createElement(eae,sr({},e,{ref:t})))}),Ry=new J,HR=new J,nae=new J;function rae(n,e,t){const r=Ry.setFromMatrixPosition(n.matrixWorld);r.project(e);const i=t.width/2,s=t.height/2;return[r.x*i+i,-(r.y*s)+s]}function iae(n,e){const t=Ry.setFromMatrixPosition(n.matrixWorld),r=HR.setFromMatrixPosition(e.matrixWorld),i=t.sub(r),s=e.getWorldDirection(nae);return i.angleTo(s)>Math.PI/2}function sae(n,e,t,r){const i=Ry.setFromMatrixPosition(n.matrixWorld),s=i.clone();s.project(e),t.setFromCamera(s,e);const o=t.intersectObjects(r,!0);if(o.length){const a=o[0].distance;return i.distanceTo(t.ray.origin)<a}return!0}function oae(n,e){if(e instanceof qc)return e.zoom;if(e instanceof Mr){const t=Ry.setFromMatrixPosition(n.matrixWorld),r=HR.setFromMatrixPosition(e.matrixWorld),i=e.fov*Math.PI/180,s=t.distanceTo(r);return 1/(2*Math.tan(i/2)*s)}else return 1}function aae(n,e,t){if(e instanceof Mr||e instanceof qc){const r=Ry.setFromMatrixPosition(n.matrixWorld),i=HR.setFromMatrixPosition(e.matrixWorld),s=r.distanceTo(i),o=(t[1]-t[0])/(e.far-e.near),a=t[1]-o*e.far;return Math.round(o*s+a)}}const wC=n=>Math.abs(n)<1e-10?0:n;function SV(n,e,t=""){let r="matrix3d(";for(let i=0;i!==16;i++)r+=wC(e[i]*n.elements[i])+(i!==15?",":")");return t+r}const lae=(n=>e=>SV(e,n))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),cae=(n=>(e,t)=>SV(e,n(t),"translate(-50%,-50%)"))(n=>[1/n,1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1]);function uae(n){return n&&typeof n=="object"&&"current"in n}const hae=D.forwardRef(({children:n,eps:e=.001,style:t,className:r,prepend:i,center:s,fullscreen:o,portal:a,distanceFactor:l,sprite:c=!1,transform:u=!1,occlude:f,onOcclude:p,castShadow:m,receiveShadow:y,material:A,geometry:_,zIndexRange:g=[16777271,0],calculatePosition:E=rae,as:x="div",wrapperClass:T,pointerEvents:O="auto",...I},b)=>{const{gl:R,camera:C,scene:M,size:B,raycaster:F,events:z,viewport:j}=Ds(),[Y]=D.useState(()=>document.createElement(x)),oe=D.useRef(),le=D.useRef(null),X=D.useRef(0),ee=D.useRef([0,0]),ie=D.useRef(null),fe=D.useRef(null),me=(a==null?void 0:a.current)||z.connected||R.domElement.parentNode,he=D.useRef(null),Ae=D.useRef(!1),De=D.useMemo(()=>f&&f!=="blending"||Array.isArray(f)&&f.length&&uae(f[0]),[f]);D.useLayoutEffect(()=>{const Qe=R.domElement;f&&f==="blending"?(Qe.style.zIndex=`${Math.floor(g[0]/2)}`,Qe.style.position="absolute",Qe.style.pointerEvents="none"):(Qe.style.zIndex=null,Qe.style.position=null,Qe.style.pointerEvents=null)},[f]),D.useLayoutEffect(()=>{if(le.current){const Qe=oe.current=lF(Y);if(M.updateMatrixWorld(),u)Y.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Xe=E(le.current,C,B);Y.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Xe[0]}px,${Xe[1]}px,0);transform-origin:0 0;`}return me&&(i?me.prepend(Y):me.appendChild(Y)),()=>{me&&me.removeChild(Y),Qe.unmount()}}},[me,u]),D.useLayoutEffect(()=>{T&&(Y.className=T)},[T]);const Ie=D.useMemo(()=>u?{position:"absolute",top:0,left:0,width:B.width,height:B.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-B.height/2,left:-B.width/2,width:B.width,height:B.height},...t},[t,s,o,B,u]),He=D.useMemo(()=>({position:"absolute",pointerEvents:O}),[O]);D.useLayoutEffect(()=>{if(Ae.current=!1,u){var Qe;(Qe=oe.current)==null||Qe.render(D.createElement("div",{ref:ie,style:Ie},D.createElement("div",{ref:fe,style:He},D.createElement("div",{ref:b,className:r,style:t,children:n}))))}else{var Xe;(Xe=oe.current)==null||Xe.render(D.createElement("div",{ref:b,style:Ie,className:r,children:n}))}});const rt=D.useRef(!0);My(Qe=>{if(le.current){C.updateMatrixWorld(),le.current.updateWorldMatrix(!0,!1);const Xe=u?ee.current:E(le.current,C,B);if(u||Math.abs(X.current-C.zoom)>e||Math.abs(ee.current[0]-Xe[0])>e||Math.abs(ee.current[1]-Xe[1])>e){const te=iae(le.current,C);let Le=!1;De&&(Array.isArray(f)?Le=f.map(ot=>ot.current):f!=="blending"&&(Le=[M]));const be=rt.current;if(Le){const ot=sae(le.current,C,F,Le);rt.current=ot&&!te}else rt.current=!te;be!==rt.current&&(p?p(!rt.current):Y.style.display=rt.current?"block":"none");const Ne=Math.floor(g[0]/2),Me=f?De?[g[0],Ne]:[Ne-1,0]:g;if(Y.style.zIndex=`${aae(le.current,C,Me)}`,u){const[ot,Ze]=[B.width/2,B.height/2],$=C.projectionMatrix.elements[5]*Ze,{isOrthographicCamera:V,top:ce,left:ke,bottom:pe,right:ye}=C,qe=lae(C.matrixWorldInverse),Ge=V?`scale(${$})translate(${wC(-(ye+ke)/2)}px,${wC((ce+pe)/2)}px)`:`translateZ(${$}px)`;let Ke=le.current.matrixWorld;c&&(Ke=C.matrixWorldInverse.clone().transpose().copyPosition(Ke).scale(le.current.scale),Ke.elements[3]=Ke.elements[7]=Ke.elements[11]=0,Ke.elements[15]=1),Y.style.width=B.width+"px",Y.style.height=B.height+"px",Y.style.perspective=V?"":`${$}px`,ie.current&&fe.current&&(ie.current.style.transform=`${Ge}${qe}translate(${ot}px,${Ze}px)`,fe.current.style.transform=cae(Ke,1/((l||10)/400)))}else{const ot=l===void 0?1:oae(le.current,C)*l;Y.style.transform=`translate3d(${Xe[0]}px,${Xe[1]}px,0) scale(${ot})`}ee.current=Xe,X.current=C.zoom}}if(!De&&he.current&&!Ae.current)if(u){if(ie.current){const Xe=ie.current.children[0];if(Xe!=null&&Xe.clientWidth&&Xe!=null&&Xe.clientHeight){const{isOrthographicCamera:te}=C;if(te||_)I.scale&&(Array.isArray(I.scale)?I.scale instanceof J?he.current.scale.copy(I.scale.clone().divideScalar(1)):he.current.scale.set(1/I.scale[0],1/I.scale[1],1/I.scale[2]):he.current.scale.setScalar(1/I.scale));else{const Le=(l||10)/400,be=Xe.clientWidth*Le,Ne=Xe.clientHeight*Le;he.current.scale.set(be,Ne,1)}Ae.current=!0}}}else{const Xe=Y.children[0];if(Xe!=null&&Xe.clientWidth&&Xe!=null&&Xe.clientHeight){const te=1/j.factor,Le=Xe.clientWidth*te,be=Xe.clientHeight*te;he.current.scale.set(Le,be,1),Ae.current=!0}he.current.lookAt(Qe.camera.position)}});const vt=D.useMemo(()=>({vertexShader:u?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom" 
            is false. 
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;
            
            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[u]);return D.createElement("group",sr({},I,{ref:le}),f&&!De&&D.createElement("mesh",{castShadow:m,receiveShadow:y,ref:he},_||D.createElement("planeGeometry",null),A||D.createElement("shaderMaterial",{side:Os,vertexShader:vt.vertexShader,fragmentShader:vt.fragmentShader})))});let um=0;const fae=lA(n=>(Kf.onStart=(e,t,r)=>{n({active:!0,item:e,loaded:t,total:r,progress:(t-um)/(r-um)*100})},Kf.onLoad=()=>{n({active:!1})},Kf.onError=e=>n(t=>({errors:[...t.errors,e]})),Kf.onProgress=(e,t,r)=>{t===r&&(um=r),n({active:!0,item:e,loaded:t,total:r,progress:(t-um)/(r-um)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),dae=n=>`Loading ${n.toFixed(2)}%`;function pae({containerStyles:n,innerStyles:e,barStyles:t,dataStyles:r,dataInterpolation:i=dae,initialState:s=o=>o}){const{active:o,progress:a}=fae(),l=D.useRef(0),c=D.useRef(0),u=D.useRef(null),[f,p]=D.useState(s(o));D.useEffect(()=>{let y;return o!==f&&(y=setTimeout(()=>p(o),300)),()=>clearTimeout(y)},[f,o]);const m=D.useCallback(()=>{u.current&&(l.current+=(a-l.current)/2,(l.current>.95*a||a===100)&&(l.current=a),u.current.innerText=i(l.current),l.current<a&&(c.current=requestAnimationFrame(m)))},[i,a]);return D.useEffect(()=>(m(),()=>cancelAnimationFrame(c.current)),[m]),f?D.createElement("div",{style:{...W0.container,opacity:o?1:0,...n}},D.createElement("div",null,D.createElement("div",{style:{...W0.inner,...e}},D.createElement("div",{style:{...W0.bar,transform:`scaleX(${a/100})`,...t}}),D.createElement("span",{ref:u,style:{...W0.data,...r}})))):null}const W0={container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#171717",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 300ms ease",zIndex:1e3},inner:{width:100,height:3,background:"#272727",textAlign:"center"},bar:{height:3,width:"100%",background:"white",transition:"transform 200ms",transformOrigin:"left center"},data:{display:"inline-block",position:"relative",fontVariantNumeric:"tabular-nums",marginTop:"0.8em",color:"#f0f0f0",fontSize:"0.6em",fontFamily:'-apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", "Helvetica Neue", Helvetica, Arial, Roboto, Ubuntu, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',whiteSpace:"nowrap"}};function mae(n,e,t){return Math.max(e,Math.min(n,t))}const Fi={toVector(n,e){return n===void 0&&(n=e),Array.isArray(n)?n:[n,n]},add(n,e){return[n[0]+e[0],n[1]+e[1]]},sub(n,e){return[n[0]-e[0],n[1]-e[1]]},addTo(n,e){n[0]+=e[0],n[1]+=e[1]},subTo(n,e){n[0]-=e[0],n[1]-=e[1]}};function cB(n,e,t){return e===0||Math.abs(e)===1/0?Math.pow(n,t*5):n*e*t/(e+t*n)}function uB(n,e,t,r=.15){return r===0?mae(n,e,t):n<e?-cB(e-n,t-e,r)+e:n>t?+cB(n-t,t-e,r)+t:n}function gae(n,[e,t],[r,i]){const[[s,o],[a,l]]=n;return[uB(e,s,o,r),uB(t,a,l,i)]}function yae(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vae(n){var e=yae(n,"string");return typeof e=="symbol"?e:String(e)}function hs(n,e,t){return e=vae(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hB(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function fr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?hB(Object(t),!0).forEach(function(r){hs(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):hB(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}const TV={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function fB(n){return n?n[0].toUpperCase()+n.slice(1):""}const _ae=["enter","leave"];function Eae(n=!1,e){return n&&!_ae.includes(e)}function xae(n,e="",t=!1){const r=TV[n],i=r&&r[e]||e;return"on"+fB(n)+fB(i)+(Eae(t,i)?"Capture":"")}const Aae=["gotpointercapture","lostpointercapture"];function wae(n){let e=n.substring(2).toLowerCase();const t=!!~e.indexOf("passive");t&&(e=e.replace("passive",""));const r=Aae.includes(e)?"capturecapture":"capture",i=!!~e.indexOf(r);return i&&(e=e.replace("capture","")),{device:e,capture:i,passive:t}}function Sae(n,e=""){const t=TV[n],r=t&&t[e]||e;return n+r}function cA(n){return"touches"in n}function CV(n){return cA(n)?"touch":"pointerType"in n?n.pointerType:"mouse"}function Tae(n){return Array.from(n.touches).filter(e=>{var t,r;return e.target===n.currentTarget||((t=n.currentTarget)===null||t===void 0||(r=t.contains)===null||r===void 0?void 0:r.call(t,e.target))})}function Cae(n){return n.type==="touchend"||n.type==="touchcancel"?n.changedTouches:n.targetTouches}function bV(n){return cA(n)?Cae(n)[0]:n}function bae(n){return Tae(n).map(e=>e.identifier)}function zw(n){const e=bV(n);return cA(n)?e.identifier:e.pointerId}function dB(n){const e=bV(n);return[e.clientX,e.clientY]}function Mae(n){const e={};if("buttons"in n&&(e.buttons=n.buttons),"shiftKey"in n){const{shiftKey:t,altKey:r,metaKey:i,ctrlKey:s}=n;Object.assign(e,{shiftKey:t,altKey:r,metaKey:i,ctrlKey:s})}return e}function kE(n,...e){return typeof n=="function"?n(...e):n}function Rae(){}function Iae(...n){return n.length===0?Rae:n.length===1?n[0]:function(){let e;for(const t of n)e=t.apply(this,arguments)||e;return e}}function pB(n,e){return Object.assign({},e,n||{})}const Pae=32;class Dae{constructor(e,t,r){this.ctrl=e,this.args=t,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:t,ingKey:r,args:i}=this;t[r]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=i,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const t=this.state,r=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=r.from?kE(r.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=e.timeStamp)}computeValues(e){const t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:t,config:r,shared:i}=this;t.args=this.args;let s=0;if(e&&(t.event=e,r.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,i.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,i.locked=!!document.pointerLockElement,Object.assign(i,Mae(e)),i.down=i.pressed=i.buttons%2===1||i.touches>0,s=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){const I=t._delta.map(Math.abs);Fi.addTo(t._distance,I)}this.axisIntent&&this.axisIntent(e);const[o,a]=t._movement,[l,c]=r.threshold,{_step:u,values:f}=t;if(r.hasCustomTransform?(u[0]===!1&&(u[0]=Math.abs(o)>=l&&f[0]),u[1]===!1&&(u[1]=Math.abs(a)>=c&&f[1])):(u[0]===!1&&(u[0]=Math.abs(o)>=l&&Math.sign(o)*l),u[1]===!1&&(u[1]=Math.abs(a)>=c&&Math.sign(a)*c)),t.intentional=u[0]!==!1||u[1]!==!1,!t.intentional)return;const p=[0,0];if(r.hasCustomTransform){const[I,b]=f;p[0]=u[0]!==!1?I-u[0]:0,p[1]=u[1]!==!1?b-u[1]:0}else p[0]=u[0]!==!1?o-u[0]:0,p[1]=u[1]!==!1?a-u[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(p);const m=t.offset,y=t._active&&!t._blocked||t.active;y&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=i[this.ingKey]=t._active,e&&(t.first&&("bounds"in r&&(t._bounds=kE(r.bounds,t)),this.setup&&this.setup()),t.movement=p,this.computeOffset()));const[A,_]=t.offset,[[g,E],[x,T]]=t._bounds;t.overflow=[A<g?-1:A>E?1:0,_<x?-1:_>T?1:0],t._movementBound[0]=t.overflow[0]?t._movementBound[0]===!1?t._movement[0]:t._movementBound[0]:!1,t._movementBound[1]=t.overflow[1]?t._movementBound[1]===!1?t._movement[1]:t._movementBound[1]:!1;const O=t._active?r.rubberband||[0,0]:[0,0];if(t.offset=gae(t._bounds,t.offset,O),t.delta=Fi.sub(t.offset,m),this.computeMovement(),y&&(!t.last||s>Pae)){t.delta=Fi.sub(t.offset,m);const I=t.delta.map(Math.abs);Fi.addTo(t.distance,I),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&s>0&&(t.velocity=[I[0]/s,I[1]/s],t.timeDelta=s)}}emit(){const e=this.state,t=this.shared,r=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!r.triggerAllEvents)return;const i=this.handler(fr(fr(fr({},t),e),{},{[this.aliasKey]:e.values}));i!==void 0&&(e.memo=i)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function Lae([n,e],t){const r=Math.abs(n),i=Math.abs(e);if(r>i&&r>t)return"x";if(i>r&&i>t)return"y"}class Oae extends Dae{constructor(...e){super(...e),hs(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=Fi.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=Fi.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const t=this.state,r=this.config;if(!t.axis&&e){const i=typeof r.axisThreshold=="object"?r.axisThreshold[CV(e)]:r.axisThreshold;t.axis=Lae(t._movement,i)}t._blocked=(r.lockDirection||!!r.axis)&&!t.axis||!!r.axis&&r.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const Bae=n=>n,mB=.15,MV={enabled(n=!0){return n},eventOptions(n,e,t){return fr(fr({},t.shared.eventOptions),n)},preventDefault(n=!1){return n},triggerAllEvents(n=!1){return n},rubberband(n=0){switch(n){case!0:return[mB,mB];case!1:return[0,0];default:return Fi.toVector(n)}},from(n){if(typeof n=="function")return n;if(n!=null)return Fi.toVector(n)},transform(n,e,t){const r=n||t.shared.transform;return this.hasCustomTransform=!!r,r||Bae},threshold(n){return Fi.toVector(n,0)}},Nae=0,Iy=fr(fr({},MV),{},{axis(n,e,{axis:t}){if(this.lockDirection=t==="lock",!this.lockDirection)return t},axisThreshold(n=Nae){return n},bounds(n={}){if(typeof n=="function")return s=>Iy.bounds(n(s));if("current"in n)return()=>n.current;if(typeof HTMLElement=="function"&&n instanceof HTMLElement)return n;const{left:e=-1/0,right:t=1/0,top:r=-1/0,bottom:i=1/0}=n;return[[e,t],[r,i]]}}),gB={ArrowRight:(n,e=1)=>[n*e,0],ArrowLeft:(n,e=1)=>[-1*n*e,0],ArrowUp:(n,e=1)=>[0,-1*n*e],ArrowDown:(n,e=1)=>[0,n*e]};class kae extends Oae{constructor(...e){super(...e),hs(this,"ingKey","dragging")}reset(){super.reset();const e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){const e=this.state;if(e._bounds instanceof HTMLElement){const t=e._bounds.getBoundingClientRect(),r=e.currentTarget.getBoundingClientRect(),i={left:t.left-r.left+e.offset[0],right:t.right-r.right+e.offset[0],top:t.top-r.top+e.offset[1],bottom:t.bottom-r.bottom+e.offset[1]};e._bounds=Iy.bounds(i)}}cancel(){const e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){const t=this.config,r=this.state;if(e.buttons!=null&&(Array.isArray(t.pointerButtons)?!t.pointerButtons.includes(e.buttons):t.pointerButtons!==-1&&t.pointerButtons!==e.buttons))return;const i=this.ctrl.setEventIds(e);t.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(i&&i.size>1&&r._pointerActive)&&(this.start(e),this.setupPointer(e),r._pointerId=zw(e),r._pointerActive=!0,this.computeValues(dB(e)),this.computeInitial(),t.preventScrollAxis&&CV(e)!=="mouse"?(r._active=!1,this.setupScrollPrevention(e)):t.delay>0?(this.setupDelayTrigger(e),t.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){const t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}pointerMove(e){const t=this.state,r=this.config;if(!t._pointerActive)return;const i=zw(e);if(t._pointerId!==void 0&&i!==t._pointerId)return;const s=dB(e);if(document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=Fi.sub(s,t._values),this.computeValues(s)),Fi.addTo(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional){this.timeoutStore.remove("dragDelay"),t.active=!1,this.startPointerDrag(e);return}if(r.preventScrollAxis&&!t._preventScroll)if(t.axis)if(t.axis===r.preventScrollAxis||r.preventScrollAxis==="xy"){t._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}const t=this.state,r=this.config;if(!t._active||!t._pointerActive)return;const i=zw(e);if(t._pointerId!==void 0&&i!==t._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);const[s,o]=t._distance;if(t.tap=s<=r.tapsThreshold&&o<=r.tapsThreshold,t.tap&&r.filterTaps)t._force=!0;else{const[a,l]=t._delta,[c,u]=t._movement,[f,p]=r.swipe.velocity,[m,y]=r.swipe.distance,A=r.swipe.duration;if(t.elapsedTime<A){const _=Math.abs(a/t.timeDelta),g=Math.abs(l/t.timeDelta);_>f&&Math.abs(c)>m&&(t.swipe[0]=Math.sign(a)),g>p&&Math.abs(u)>y&&(t.swipe[1]=Math.sign(l))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){const t=this.config,r=t.device;t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,r,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,Fae(e);const t=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",t),this.eventStore.add(this.sharedConfig.window,"touch","cancel",t),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){const t=gB[e.key];if(t){const r=this.state,i=e.shiftKey?10:e.altKey?.1:1;this.start(e),r._delta=t(this.config.keyboardDisplacement,i),r._keyboardActive=!0,Fi.addTo(r._movement,r._delta),this.compute(e),this.emit()}}keyUp(e){e.key in gB&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){const t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function Fae(n){"persist"in n&&typeof n.persist=="function"&&n.persist()}const Py=typeof window<"u"&&window.document&&window.document.createElement;function RV(){return Py&&"ontouchstart"in window}function Uae(){return RV()||Py&&window.navigator.maxTouchPoints>1}function zae(){return Py&&"onpointerdown"in window}function Hae(){return Py&&"exitPointerLock"in window.document}function Vae(){try{return"constructor"in GestureEvent}catch{return!1}}const co={isBrowser:Py,gesture:Vae(),touch:RV(),touchscreen:Uae(),pointer:zae(),pointerLock:Hae()},Gae=250,Wae=180,$ae=.5,jae=50,Xae=250,Kae=10,yB={mouse:0,touch:0,pen:8},Jae=fr(fr({},Iy),{},{device(n,e,{pointer:{touch:t=!1,lock:r=!1,mouse:i=!1}={}}){return this.pointerLock=r&&co.pointerLock,co.touch&&t?"touch":this.pointerLock?"mouse":co.pointer&&!i?"pointer":co.touch?"touch":"mouse"},preventScrollAxis(n,e,{preventScroll:t}){if(this.preventScrollDelay=typeof t=="number"?t:t||t===void 0&&n?Gae:void 0,!(!co.touchscreen||t===!1))return n||(t!==void 0?"y":void 0)},pointerCapture(n,e,{pointer:{capture:t=!0,buttons:r=1,keys:i=!0}={}}){return this.pointerButtons=r,this.keys=i,!this.pointerLock&&this.device==="pointer"&&t},threshold(n,e,{filterTaps:t=!1,tapsThreshold:r=3,axis:i=void 0}){const s=Fi.toVector(n,t?r:i?1:0);return this.filterTaps=t,this.tapsThreshold=r,s},swipe({velocity:n=$ae,distance:e=jae,duration:t=Xae}={}){return{velocity:this.transform(Fi.toVector(n)),distance:this.transform(Fi.toVector(e)),duration:t}},delay(n=0){switch(n){case!0:return Wae;case!1:return 0;default:return n}},axisThreshold(n){return n?fr(fr({},yB),n):yB},keyboardDisplacement(n=Kae){return n}});fr(fr({},MV),{},{device(n,e,{shared:t,pointer:{touch:r=!1}={}}){if(t.target&&!co.touch&&co.gesture)return"gesture";if(co.touch&&r)return"touch";if(co.touchscreen){if(co.pointer)return"pointer";if(co.touch)return"touch"}},bounds(n,e,{scaleBounds:t={},angleBounds:r={}}){const i=o=>{const a=pB(kE(t,o),{min:-1/0,max:1/0});return[a.min,a.max]},s=o=>{const a=pB(kE(r,o),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof t!="function"&&typeof r!="function"?[i(),s()]:o=>[i(o),s(o)]},threshold(n,e,t){return this.lockDirection=t.axis==="lock",Fi.toVector(n,this.lockDirection?[.1,3]:0)},modifierKey(n){return n===void 0?"ctrlKey":n},pinchOnWheel(n=!0){return n}});fr(fr({},Iy),{},{mouseOnly:(n=!0)=>n});fr(fr({},Iy),{},{mouseOnly:(n=!0)=>n});const IV=new Map,SC=new Map;function Yae(n){IV.set(n.key,n.engine),SC.set(n.key,n.resolver)}const qae={key:"drag",engine:kae,resolver:Jae};function Qae(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function Zae(n,e){if(n==null)return{};var t=Qae(n,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}const ele={target(n){if(n)return()=>"current"in n?n.current:n},enabled(n=!0){return n},window(n=co.isBrowser?window:void 0){return n},eventOptions({passive:n=!0,capture:e=!1}={}){return{passive:n,capture:e}},transform(n){return n}},tle=["target","eventOptions","window","enabled","transform"];function N_(n={},e){const t={};for(const[r,i]of Object.entries(e))switch(typeof i){case"function":t[r]=i.call(t,n[r],r,n);break;case"object":t[r]=N_(n[r],i);break;case"boolean":i&&(t[r]=n[r]);break}return t}function nle(n,e,t={}){const r=n,{target:i,eventOptions:s,window:o,enabled:a,transform:l}=r,c=Zae(r,tle);if(t.shared=N_({target:i,eventOptions:s,window:o,enabled:a,transform:l},ele),e){const u=SC.get(e);t[e]=N_(fr({shared:t.shared},c),u)}else for(const u in c){const f=SC.get(u);f&&(t[u]=N_(fr({shared:t.shared},c[u]),f))}return t}class PV{constructor(e,t){hs(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,r,i,s){const o=this._listeners,a=Sae(t,r),l=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=fr(fr({},l),s);e.addEventListener(a,i,c);const u=()=>{e.removeEventListener(a,i,c),o.delete(u)};return o.add(u),u}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class rle{constructor(){hs(this,"_timeouts",new Map)}add(e,t,r=140,...i){this.remove(e),this._timeouts.set(e,window.setTimeout(t,r,...i))}remove(e){const t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class ile{constructor(e){hs(this,"gestures",new Set),hs(this,"_targetEventStore",new PV(this)),hs(this,"gestureEventStores",{}),hs(this,"gestureTimeoutStores",{}),hs(this,"handlers",{}),hs(this,"config",{}),hs(this,"pointerIds",new Set),hs(this,"touchIds",new Set),hs(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),sle(this,e)}setEventIds(e){if(cA(e))return this.touchIds=new Set(bae(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=nle(e,t,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const t=this.config.shared,r={};let i;if(!(t.target&&(i=t.target(),!i))){if(t.enabled){for(const o of this.gestures){const a=this.config[o],l=vB(r,a.eventOptions,!!i);if(a.enabled){const c=IV.get(o);new c(this,e,o).bind(l)}}const s=vB(r,t.eventOptions,!!i);for(const o in this.nativeHandlers)s(o,"",a=>this.nativeHandlers[o](fr(fr({},this.state.shared),{},{event:a,args:e})),void 0,!0)}for(const s in r)r[s]=Iae(...r[s]);if(!i)return r;for(const s in r){const{device:o,capture:a,passive:l}=wae(s);this._targetEventStore.add(i,o,"",r[s],{capture:a,passive:l})}}}}function Ef(n,e){n.gestures.add(e),n.gestureEventStores[e]=new PV(n,e),n.gestureTimeoutStores[e]=new rle}function sle(n,e){e.drag&&Ef(n,"drag"),e.wheel&&Ef(n,"wheel"),e.scroll&&Ef(n,"scroll"),e.move&&Ef(n,"move"),e.pinch&&Ef(n,"pinch"),e.hover&&Ef(n,"hover")}const vB=(n,e,t)=>(r,i,s,o={},a=!1)=>{var l,c;const u=(l=o.capture)!==null&&l!==void 0?l:e.capture,f=(c=o.passive)!==null&&c!==void 0?c:e.passive;let p=a?r:xae(r,i,u);t&&f&&(p+="Passive"),n[p]=n[p]||[],n[p].push(s)};function ole(n,e={},t,r){const i=ne.useMemo(()=>new ile(n),[]);if(i.applyHandlers(n,r),i.applyConfig(e,t),ne.useEffect(i.effect.bind(i)),ne.useEffect(()=>i.clean.bind(i),[]),e.target===void 0)return i.bind.bind(i)}function ale(n,e){return Yae(qae),ole({drag:n},e||{},"drag")}const lle=n=>(e,t,r)=>{const i=r.subscribe;return r.subscribe=(o,a,l)=>{let c=o;if(a){const u=(l==null?void 0:l.equalityFn)||Object.is;let f=o(r.getState());c=p=>{const m=o(p);if(!u(f,m)){const y=f;a(f=m,y)}},l!=null&&l.fireImmediately&&a(f,f)}return i(c)},n(e,t,r)};function _B(n,e){if(e===zz)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===LE||e===qM){let t=n.getIndex();if(t===null){const o=[],a=n.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const r=t.count-2,i=[];if(t)if(e===LE)for(let o=1;o<=r;o++)i.push(t.getX(0)),i.push(t.getX(o)),i.push(t.getX(o+1));else for(let o=0;o<r;o++)o%2===0?(i.push(t.getX(o)),i.push(t.getX(o+1)),i.push(t.getX(o+2))):(i.push(t.getX(o+2)),i.push(t.getX(o+1)),i.push(t.getX(o)));i.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(i),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}const cle=parseInt(ep.replace(/\D+/g,""));var ho=Uint8Array,gc=Uint16Array,TC=Uint32Array,DV=new ho([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),LV=new ho([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ule=new ho([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),OV=function(n,e){for(var t=new gc(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var i=new TC(t[30]),r=1;r<30;++r)for(var s=t[r];s<t[r+1];++s)i[s]=s-t[r]<<5|r;return[t,i]},BV=OV(DV,2),NV=BV[0],hle=BV[1];NV[28]=258,hle[258]=28;var fle=OV(LV,0),dle=fle[0],CC=new gc(32768);for(var Yn=0;Yn<32768;++Yn){var Zl=(Yn&43690)>>>1|(Yn&21845)<<1;Zl=(Zl&52428)>>>2|(Zl&13107)<<2,Zl=(Zl&61680)>>>4|(Zl&3855)<<4,CC[Yn]=((Zl&65280)>>>8|(Zl&255)<<8)>>>1}var qm=function(n,e,t){for(var r=n.length,i=0,s=new gc(e);i<r;++i)++s[n[i]-1];var o=new gc(e);for(i=0;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;var a;if(t){a=new gc(1<<e);var l=15-e;for(i=0;i<r;++i)if(n[i])for(var c=i<<4|n[i],u=e-n[i],f=o[n[i]-1]++<<u,p=f|(1<<u)-1;f<=p;++f)a[CC[f]>>>l]=c}else for(a=new gc(r),i=0;i<r;++i)n[i]&&(a[i]=CC[o[n[i]-1]++]>>>15-n[i]);return a},Dy=new ho(288);for(var Yn=0;Yn<144;++Yn)Dy[Yn]=8;for(var Yn=144;Yn<256;++Yn)Dy[Yn]=9;for(var Yn=256;Yn<280;++Yn)Dy[Yn]=7;for(var Yn=280;Yn<288;++Yn)Dy[Yn]=8;var kV=new ho(32);for(var Yn=0;Yn<32;++Yn)kV[Yn]=5;var ple=qm(Dy,9,1),mle=qm(kV,5,1),Hw=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},Do=function(n,e,t){var r=e/8|0;return(n[r]|n[r+1]<<8)>>(e&7)&t},Vw=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},gle=function(n){return(n/8|0)+(n&7&&1)},yle=function(n,e,t){(e==null||e<0)&&(e=0),(t==null||t>n.length)&&(t=n.length);var r=new(n instanceof gc?gc:n instanceof TC?TC:ho)(t-e);return r.set(n.subarray(e,t)),r},vle=function(n,e,t){var r=n.length;if(!r||t&&!t.l&&r<5)return e||new ho(0);var i=!e||t,s=!t||t.i;t||(t={}),e||(e=new ho(r*3));var o=function(Ie){var He=e.length;if(Ie>He){var rt=new ho(Math.max(He*2,Ie));rt.set(e),e=rt}},a=t.f||0,l=t.p||0,c=t.b||0,u=t.l,f=t.d,p=t.m,m=t.n,y=r*8;do{if(!u){t.f=a=Do(n,l,1);var A=Do(n,l+1,3);if(l+=3,A)if(A==1)u=ple,f=mle,p=9,m=5;else if(A==2){var x=Do(n,l,31)+257,T=Do(n,l+10,15)+4,O=x+Do(n,l+5,31)+1;l+=14;for(var I=new ho(O),b=new ho(19),R=0;R<T;++R)b[ule[R]]=Do(n,l+R*3,7);l+=T*3;for(var C=Hw(b),M=(1<<C)-1,B=qm(b,C,1),R=0;R<O;){var F=B[Do(n,l,M)];l+=F&15;var _=F>>>4;if(_<16)I[R++]=_;else{var z=0,j=0;for(_==16?(j=3+Do(n,l,3),l+=2,z=I[R-1]):_==17?(j=3+Do(n,l,7),l+=3):_==18&&(j=11+Do(n,l,127),l+=7);j--;)I[R++]=z}}var Y=I.subarray(0,x),oe=I.subarray(x);p=Hw(Y),m=Hw(oe),u=qm(Y,p,1),f=qm(oe,m,1)}else throw"invalid block type";else{var _=gle(l)+4,g=n[_-4]|n[_-3]<<8,E=_+g;if(E>r){if(s)throw"unexpected EOF";break}i&&o(c+g),e.set(n.subarray(_,E),c),t.b=c+=g,t.p=l=E*8;continue}if(l>y){if(s)throw"unexpected EOF";break}}i&&o(c+131072);for(var le=(1<<p)-1,X=(1<<m)-1,ee=l;;ee=l){var z=u[Vw(n,l)&le],ie=z>>>4;if(l+=z&15,l>y){if(s)throw"unexpected EOF";break}if(!z)throw"invalid length/literal";if(ie<256)e[c++]=ie;else if(ie==256){ee=l,u=null;break}else{var fe=ie-254;if(ie>264){var R=ie-257,me=DV[R];fe=Do(n,l,(1<<me)-1)+NV[R],l+=me}var he=f[Vw(n,l)&X],Ae=he>>>4;if(!he)throw"invalid distance";l+=he&15;var oe=dle[Ae];if(Ae>3){var me=LV[Ae];oe+=Vw(n,l)&(1<<me)-1,l+=me}if(l>y){if(s)throw"unexpected EOF";break}i&&o(c+131072);for(var De=c+fe;c<De;c+=4)e[c]=e[c-oe],e[c+1]=e[c+1-oe],e[c+2]=e[c+2-oe],e[c+3]=e[c+3-oe];c=De}}t.l=u,t.p=ee,t.b=c,u&&(a=1,t.m=p,t.d=f,t.n=m)}while(!a);return c==e.length?e:yle(e,0,c)},_le=new ho(0),Ele=function(n){if((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(n[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function $0(n,e){return vle((Ele(n),n.subarray(2,-4)),e)}var xle=typeof TextDecoder<"u"&&new TextDecoder,Ale=0;try{xle.decode(_le,{stream:!0}),Ale=1}catch{}const wle=n=>n&&n.isCubeTexture;class Sle extends Rr{constructor(e,t){var r,i;const s=wle(e),a=((i=s?(r=e.image[0])==null?void 0:r.width:e.image.width)!=null?i:1024)/4,l=Math.floor(Math.log2(a)),c=Math.pow(2,l),u=3*Math.max(c,16*7),f=4*c,p=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/u}`,`#define CUBEUV_TEXEL_HEIGHT ${1/f}`,`#define CUBEUV_MAX_MIP ${l}.0`],m=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,y=p.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${parseInt(ep.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,A={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},_=new wy(1,16),g=new qo({uniforms:A,fragmentShader:y,vertexShader:m,side:Os});super(_,g)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}class VR extends Vi{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Rle(t)}),this.register(function(t){return new kle(t)}),this.register(function(t){return new Fle(t)}),this.register(function(t){return new Ule(t)}),this.register(function(t){return new Ple(t)}),this.register(function(t){return new Dle(t)}),this.register(function(t){return new Lle(t)}),this.register(function(t){return new Ole(t)}),this.register(function(t){return new Mle(t)}),this.register(function(t){return new Ble(t)}),this.register(function(t){return new Ile(t)}),this.register(function(t){return new Nle(t)}),this.register(function(t){return new Cle(t)}),this.register(function(t){return new zle(t)}),this.register(function(t){return new Hle(t)})}load(e,t,r,i){const s=this;let o;this.resourcePath!==""?o=this.resourcePath:this.path!==""?o=this.path:o=Sa.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){i?i(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Gs(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},r,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,i){let s;const o={},a={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(Sa.decodeText(new Uint8Array(e.slice(0,4)))===FV){try{o[mn.KHR_BINARY_GLTF]=new Vle(e)}catch(u){i&&i(u);return}s=JSON.parse(o[mn.KHR_BINARY_GLTF].content)}else s=JSON.parse(Sa.decodeText(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new tce(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const u=this.pluginCallbacks[c](l);a[u.name]=u,o[u.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const u=s.extensionsUsed[c],f=s.extensionsRequired||[];switch(u){case mn.KHR_MATERIALS_UNLIT:o[u]=new ble;break;case mn.KHR_DRACO_MESH_COMPRESSION:o[u]=new Gle(s,this.dracoLoader);break;case mn.KHR_TEXTURE_TRANSFORM:o[u]=new Wle;break;case mn.KHR_MESH_QUANTIZATION:o[u]=new $le;break;default:f.indexOf(u)>=0&&a[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(r,i)}parseAsync(e,t){const r=this;return new Promise(function(i,s){r.parse(e,t,i,s)})}}function Tle(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const mn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Cle{constructor(e){this.parser=e,this.name=mn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,i=t.length;r<i;r++){const s=t[r];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let i=t.cache.get(r);if(i)return i;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const u=new st(16777215);l.color!==void 0&&u.fromArray(l.color);const f=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new IR(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new RR(u),c.distance=f;break;case"spot":c=new MR(u),c.distance=f,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,oc(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),i=Promise.resolve(c),t.cache.add(r,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,s=r.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return r._getNodeRef(t.cache,a,l)})}}class ble{constructor(){this.name=mn.KHR_MATERIALS_UNLIT}getMaterialType(){return ks}extendParams(e,t,r){const i=[];e.color=new st(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}s.baseColorTexture!==void 0&&i.push(r.assignTexture(e,"map",s.baseColorTexture,3001))}return Promise.all(i)}}class Mle{constructor(e){this.parser=e,this.name=mn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class Rle{constructor(e){this.parser=e,this.name=mn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ba}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(r.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Be(a,a)}return Promise.all(s)}}class Ile{constructor(e){this.parser=e,this.name=mn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ba}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class Ple{constructor(e){this.parser=e,this.name=mn.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ba}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new st(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=i.extensions[this.name];return o.sheenColorFactor!==void 0&&t.sheenColor.fromArray(o.sheenColorFactor),o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(r.assignTexture(t,"sheenColorMap",o.sheenColorTexture,3001)),o.sheenRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class Dle{constructor(e){this.parser=e,this.name=mn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ba}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(r.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class Lle{constructor(e){this.parser=e,this.name=mn.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ba}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(r.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new st(a[0],a[1],a[2]),Promise.all(s)}}class Ole{constructor(e){this.parser=e,this.name=mn.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ba}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class Ble{constructor(e){this.parser=e,this.name=mn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ba}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(r.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new st(a[0],a[1],a[2]),o.specularColorTexture!==void 0&&s.push(r.assignTexture(t,"specularColorMap",o.specularColorTexture,3001)),Promise.all(s)}}class Nle{constructor(e){this.parser=e,this.name=mn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ba}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(r.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class kle{constructor(e){this.parser=e,this.name=mn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,i=r.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const s=i.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class Fle{constructor(e){this.parser=e,this.name=mn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=i.images[o.source];let l=r.textureLoader;if(a.uri){const c=r.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return r.loadTextureImage(e,o.source,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Ule{constructor(e){this.parser=e,this.name=mn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=i.images[o.source];let l=r.textureLoader;if(a.uri){const c=r.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return r.loadTextureImage(e,o.source,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class zle{constructor(e){this.name=mn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const i=r.extensions[this.name],s=this.parser.getDependency("buffer",i.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=i.byteOffset||0,c=i.byteLength||0,u=i.count,f=i.byteStride,p=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,f,p,i.mode,i.filter).then(function(m){return m.buffer}):o.ready.then(function(){const m=new ArrayBuffer(u*f);return o.decodeGltfBuffer(new Uint8Array(m),u,f,p,i.mode,i.filter),m})})}else return null}}class Hle{constructor(e){this.name=mn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const i=t.meshes[r.mesh];for(const c of i.primitives)if(c.mode!==oo.TRIANGLES&&c.mode!==oo.TRIANGLE_STRIP&&c.mode!==oo.TRIANGLE_FAN&&c.mode!==void 0)return null;const o=r.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(u=>(l[c]=u,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const u=c.pop(),f=u.isGroup?u.children:[u],p=c[0].count,m=[];for(const y of f){const A=new Bt,_=new J,g=new mi,E=new J(1,1,1),x=new dR(y.geometry,y.material,p);for(let T=0;T<p;T++)l.TRANSLATION&&_.fromBufferAttribute(l.TRANSLATION,T),l.ROTATION&&g.fromBufferAttribute(l.ROTATION,T),l.SCALE&&E.fromBufferAttribute(l.SCALE,T),x.setMatrixAt(T,A.compose(_,g,E));for(const T in l)T!=="TRANSLATION"&&T!=="ROTATION"&&T!=="SCALE"&&y.geometry.setAttribute(T,l[T]);dn.prototype.copy.call(x,y),this.parser.assignFinalMaterial(x),m.push(x)}return u.isGroup?(u.clear(),u.add(...m),u):m[0]}))}}const FV="glTF",hm=12,EB={JSON:1313821514,BIN:5130562};class Vle{constructor(e){this.name=mn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,hm);if(this.header={magic:Sa.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==FV)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-hm,i=new DataView(e,hm);let s=0;for(;s<r;){const o=i.getUint32(s,!0);s+=4;const a=i.getUint32(s,!0);if(s+=4,a===EB.JSON){const l=new Uint8Array(e,hm+s,o);this.content=Sa.decodeText(l)}else if(a===EB.BIN){const l=hm+s;this.body=e.slice(l,l+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Gle{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=mn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,i=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const f=bC[u]||u.toLowerCase();a[f]=o[u]}for(const u in e.attributes){const f=bC[u]||u.toLowerCase();if(o[u]!==void 0){const p=r.accessors[e.attributes[u]],m=hd[p.componentType];c[f]=m.name,l[f]=p.normalized===!0}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(f){i.decodeDracoFile(u,function(p){for(const m in p.attributes){const y=p.attributes[m],A=l[m];A!==void 0&&(y.normalized=A)}f(p)},a,c)})})}}class Wle{constructor(){this.name=mn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class $le{constructor(){this.name=mn.KHR_MESH_QUANTIZATION}}class UV extends sp{constructor(e,t,r,i){super(e,t,r,i)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let o=0;o!==i;o++)t[o]=r[s+o];return t}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,u=i-t,f=(r-t)/u,p=f*f,m=p*f,y=e*c,A=y-c,_=-2*m+3*p,g=m-p,E=1-_,x=g-p+f;for(let T=0;T!==a;T++){const O=o[A+T+a],I=o[A+T+l]*u,b=o[y+T+a],R=o[y+T]*u;s[T]=E*O+x*I+_*b+g*R}return s}}const jle=new mi;class Xle extends UV{interpolate_(e,t,r,i){const s=super.interpolate_(e,t,r,i);return jle.fromArray(s).normalize().toArray(s),s}}const oo={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},hd={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},xB={9728:vr,9729:Hn,9984:Mg,9985:Bx,9986:cd,9987:Ia},AB={33071:hi,33648:Md,10497:Fc},Gw={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},bC={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...cle>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ec={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Kle={CUBICSPLINE:void 0,LINEAR:gh,STEP:Rd},Ww={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Jle(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new Cy({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ma})),n.DefaultMaterial}function Su(n,e,t){for(const r in t.extensions)n[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function oc(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Yle(n,e,t){let r=!1,i=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const f=e[c];if(f.POSITION!==void 0&&(r=!0),f.NORMAL!==void 0&&(i=!0),f.COLOR_0!==void 0&&(s=!0),r&&i&&s)break}if(!r&&!i&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const f=e[c];if(r){const p=f.POSITION!==void 0?t.getDependency("accessor",f.POSITION):n.attributes.position;o.push(p)}if(i){const p=f.NORMAL!==void 0?t.getDependency("accessor",f.NORMAL):n.attributes.normal;a.push(p)}if(s){const p=f.COLOR_0!==void 0?t.getDependency("accessor",f.COLOR_0):n.attributes.color;l.push(p)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],f=c[1],p=c[2];return r&&(n.morphAttributes.position=u),i&&(n.morphAttributes.normal=f),s&&(n.morphAttributes.color=p),n.morphTargetsRelative=!0,n})}function qle(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let r=0,i=t.length;r<i;r++)n.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Qle(n){let e;const t=n.extensions&&n.extensions[mn.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+$w(t.attributes):e=n.indices+":"+$w(n.attributes)+":"+n.mode,n.targets!==void 0)for(let r=0,i=n.targets.length;r<i;r++)e+=":"+$w(n.targets[r]);return e}function $w(n){let e="";const t=Object.keys(n).sort();for(let r=0,i=t.length;r<i;r++)e+=t[r]+":"+n[t[r]]+";";return e}function MC(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Zle(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const ece=new Bt;class tce{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Tle,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,i=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,i=navigator.userAgent.indexOf("Firefox")>-1,s=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||r||i&&s<98?this.textureLoader=new HH(this.options.manager):this.textureLoader=new JH(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Gs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(o){const a={scene:o[0][i.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:i.asset,parser:r,userData:{}};Su(s,a,i),oc(a,i),Promise.all(r._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let i=0,s=t.length;i<s;i++){const o=t[i].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let i=0,s=e.length;i<s;i++){const o=e[i];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(r[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const i=r.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(r,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const i=e(t[r]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let i=0;i<t.length;i++){const s=e(t[i]);s&&r.push(s)}return r}getDependency(e,t){const r=e+":"+t;let i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":i=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(r,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(s,o){return r.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[mn.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(s,o){r.load(Sa.resolveURL(t.uri,i.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){const i=t.byteLength||0,s=t.byteOffset||0;return r.slice(s,s+i)})}loadAccessor(e){const t=this,r=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const o=Gw[i.type],a=hd[i.componentType],l=i.normalized===!0,c=new a(i.count*o);return Promise.resolve(new _n(c,o,l))}const s=[];return i.bufferView!==void 0?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),i.sparse!==void 0&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=Gw[i.type],c=hd[i.componentType],u=c.BYTES_PER_ELEMENT,f=u*l,p=i.byteOffset||0,m=i.bufferView!==void 0?r.bufferViews[i.bufferView].byteStride:void 0,y=i.normalized===!0;let A,_;if(m&&m!==f){const g=Math.floor(p/m),E="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+g+":"+i.count;let x=t.cache.get(E);x||(A=new c(a,g*m,i.count*m/u),x=new Ey(A,m/u),t.cache.add(E,x)),_=new Uc(x,l,p%m/u,y)}else a===null?A=new c(i.count*l):A=new c(a,p,i.count*l),_=new _n(A,l,y);if(i.sparse!==void 0){const g=Gw.SCALAR,E=hd[i.sparse.indices.componentType],x=i.sparse.indices.byteOffset||0,T=i.sparse.values.byteOffset||0,O=new E(o[1],x,i.sparse.count*g),I=new c(o[2],T,i.sparse.count*l);a!==null&&(_=new _n(_.array.slice(),_.itemSize,_.normalized));for(let b=0,R=O.length;b<R;b++){const C=O[b];if(_.setX(C,I[b*l]),l>=2&&_.setY(C,I[b*l+1]),l>=3&&_.setZ(C,I[b*l+2]),l>=4&&_.setW(C,I[b*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return _})}loadTexture(e){const t=this.json,r=this.options,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=r.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,r){const i=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,r).then(function(u){u.flipY=!1,u.name=o.name||a.name||"",u.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(u.name=a.uri);const p=(s.samplers||{})[o.sampler]||{};return u.magFilter=xB[p.magFilter]||Hn,u.minFilter=xB[p.minFilter]||Ia,u.wrapS=AB[p.wrapS]||Fc,u.wrapT=AB[p.wrapT]||Fc,i.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this,i=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(f=>f.clone());const o=i.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=r.getDependency("bufferView",o.bufferView).then(function(f){c=!0;const p=new Blob([f],{type:o.mimeType});return l=a.createObjectURL(p),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(f){return new Promise(function(p,m){let y=p;t.isImageBitmapLoader===!0&&(y=function(A){const _=new Qn(A);_.needsUpdate=!0,p(_)}),t.load(Sa.resolveURL(f,s.path),y,void 0,m)})}).then(function(f){return c===!0&&a.revokeObjectURL(l),f.userData.mimeType=o.mimeType||Zle(o.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),f});return this.sourceCache[e]=u,u}assignTexture(e,t,r,i){const s=this;return this.getDependency("texture",r.index).then(function(o){if(!o)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(o=o.clone(),o.channel=r.texCoord),s.extensions[mn.KHR_TEXTURE_TRANSFORM]){const a=r.extensions!==void 0?r.extensions[mn.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[mn.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return i!==void 0&&("colorSpace"in o?o.colorSpace=i===3001?"srgb":"srgb-linear":o.encoding=i),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const i=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+r.uuid;let l=this.cache.get(a);l||(l=new $x,kr.prototype.copy.call(l,r),l.color.copy(r.color),l.map=r.map,l.sizeAttenuation=!1,this.cache.add(a,l)),r=l}else if(e.isLine){const a="LineBasicMaterial:"+r.uuid;let l=this.cache.get(a);l||(l=new Hi,kr.prototype.copy.call(l,r),l.color.copy(r.color),l.map=r.map,this.cache.add(a,l)),r=l}if(i||s||o){let a="ClonedMaterial:"+r.uuid+":";i&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=r.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),i&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(r))),r=l}e.material=r}getMaterialType(){return Cy}loadMaterial(e){const t=this,r=this.json,i=this.extensions,s=r.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[mn.KHR_MATERIALS_UNLIT]){const f=i[mn.KHR_MATERIALS_UNLIT];o=f.getMaterialType(),c.push(f.extendParams(a,s,t))}else{const f=s.pbrMetallicRoughness||{};if(a.color=new st(1,1,1),a.opacity=1,Array.isArray(f.baseColorFactor)){const p=f.baseColorFactor;a.color.fromArray(p),a.opacity=p[3]}f.baseColorTexture!==void 0&&c.push(t.assignTexture(a,"map",f.baseColorTexture,3001)),a.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,a.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(a,"metalnessMap",f.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",f.metallicRoughnessTexture))),o=this._invokeOne(function(p){return p.getMaterialType&&p.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(p){return p.extendMaterialParams&&p.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=Os);const u=s.alphaMode||Ww.OPAQUE;if(u===Ww.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===Ww.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==ks&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Be(1,1),s.normalTexture.scale!==void 0)){const f=s.normalTexture.scale;a.normalScale.set(f,f)}return s.occlusionTexture!==void 0&&o!==ks&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==ks&&(a.emissive=new st().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&o!==ks&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,3001)),Promise.all(c).then(function(){const f=new o(a);return s.name&&(f.name=s.name),oc(f,s),t.associations.set(f,{materials:e}),s.extensions&&Su(i,f,s),f})}createUniqueName(e){const t=vn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,r=this.extensions,i=this.primitiveCache;function s(a){return r[mn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return wB(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=Qle(c),f=i[u];if(f)o.push(f.promise);else{let p;c.extensions&&c.extensions[mn.KHR_DRACO_MESH_COMPRESSION]?p=s(c):p=wB(new Jt,c,t),i[u]={primitive:c,promise:p},o.push(p)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.json,i=this.extensions,s=r.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=o[l].material===void 0?Jle(this.cache):this.getDependency("material",o[l].material);a.push(u)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],f=[];for(let m=0,y=u.length;m<y;m++){const A=u[m],_=o[m];let g;const E=c[m];if(_.mode===oo.TRIANGLES||_.mode===oo.TRIANGLE_STRIP||_.mode===oo.TRIANGLE_FAN||_.mode===void 0)g=s.isSkinnedMesh===!0?new fR(A,E):new Rr(A,E),g.isSkinnedMesh===!0&&g.normalizeSkinWeights(),_.mode===oo.TRIANGLE_STRIP?g.geometry=_B(g.geometry,qM):_.mode===oo.TRIANGLE_FAN&&(g.geometry=_B(g.geometry,LE));else if(_.mode===oo.LINES)g=new ta(A,E);else if(_.mode===oo.LINE_STRIP)g=new Tl(A,E);else if(_.mode===oo.LINE_LOOP)g=new pR(A,E);else if(_.mode===oo.POINTS)g=new mR(A,E);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+_.mode);Object.keys(g.geometry.morphAttributes).length>0&&qle(g,s),g.name=t.createUniqueName(s.name||"mesh_"+e),oc(g,s),_.extensions&&Su(i,g,_),t.assignFinalMaterial(g),f.push(g)}for(let m=0,y=f.length;m<y;m++)t.associations.set(f[m],{meshes:e,primitives:m});if(f.length===1)return s.extensions&&Su(i,f[0],s),f[0];const p=new ll;s.extensions&&Su(i,p,s),t.associations.set(p,{meshes:e});for(let m=0,y=f.length;m<y;m++)p.add(f[m]);return p})}loadCamera(e){let t;const r=this.json.cameras[e],i=r[r.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?t=new Mr(Ux.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):r.type==="orthographic"&&(t=new qc(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),oc(t,r),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],r=[];for(let i=0,s=t.joints.length;i<s;i++)r.push(this._loadNodeShallow(t.joints[i]));return t.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(i){const s=i.pop(),o=i,a=[],l=[];for(let c=0,u=o.length;c<u;c++){const f=o[c];if(f){a.push(f);const p=new Bt;s!==null&&p.fromArray(s.array,c*16),l.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new xy(a,l)})}loadAnimation(e){const r=this.json.animations[e],i=r.name?r.name:"animation_"+e,s=[],o=[],a=[],l=[],c=[];for(let u=0,f=r.channels.length;u<f;u++){const p=r.channels[u],m=r.samplers[p.sampler],y=p.target,A=y.node,_=r.parameters!==void 0?r.parameters[m.input]:m.input,g=r.parameters!==void 0?r.parameters[m.output]:m.output;y.node!==void 0&&(s.push(this.getDependency("node",A)),o.push(this.getDependency("accessor",_)),a.push(this.getDependency("accessor",g)),l.push(m),c.push(y))}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c)]).then(function(u){const f=u[0],p=u[1],m=u[2],y=u[3],A=u[4],_=[];for(let g=0,E=f.length;g<E;g++){const x=f[g],T=p[g],O=m[g],I=y[g],b=A[g];if(x===void 0)continue;x.updateMatrix();let R;switch(ec[b.path]){case ec.weights:R=Od;break;case ec.rotation:R=zc;break;case ec.position:case ec.scale:default:R=Bd;break}const C=x.name?x.name:x.uuid,M=I.interpolation!==void 0?Kle[I.interpolation]:gh,B=[];ec[b.path]===ec.weights?x.traverse(function(z){z.morphTargetInfluences&&B.push(z.name?z.name:z.uuid)}):B.push(C);let F=O.array;if(O.normalized){const z=MC(F.constructor),j=new Float32Array(F.length);for(let Y=0,oe=F.length;Y<oe;Y++)j[Y]=F[Y]*z;F=j}for(let z=0,j=B.length;z<j;z++){const Y=new R(B[z]+"."+ec[b.path],T.array,F,M);I.interpolation==="CUBICSPLINE"&&(Y.createInterpolant=function(le){const X=this instanceof zc?Xle:UV;return new X(this.times,this.values,this.getValueSize()/3,le)},Y.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),_.push(Y)}}return new Nd(i,void 0,_)})}createNodeMesh(e){const t=this.json,r=this,i=t.nodes[e];return i.mesh===void 0?null:r.getDependency("mesh",i.mesh).then(function(s){const o=r._getNodeRef(r.meshCache,i.mesh,s);return i.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=i.weights.length;l<c;l++)a.morphTargetInfluences[l]=i.weights[l]}),o})}loadNode(e){const t=this.json,r=this,i=t.nodes[e],s=r._loadNodeShallow(e),o=[],a=i.children||[];for(let c=0,u=a.length;c<u;c++)o.push(r.getDependency("node",a[c]));const l=i.skin===void 0?Promise.resolve(null):r.getDependency("skin",i.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const u=c[0],f=c[1],p=c[2];p!==null&&u.traverse(function(m){m.isSkinnedMesh&&m.bind(p,ece)});for(let m=0,y=f.length;m<y;m++)u.add(f[m]);return u})}_loadNodeShallow(e){const t=this.json,r=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],o=s.name?i.createUniqueName(s.name):"",a=[],l=i._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(i.getDependency("camera",s.camera).then(function(c){return i._getNodeRef(i.cameraCache,s.camera,c)})),i._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let u;if(s.isBone===!0?u=new Wx:c.length>1?u=new ll:c.length===1?u=c[0]:u=new dn,u!==c[0])for(let f=0,p=c.length;f<p;f++)u.add(c[f]);if(s.name&&(u.userData.name=s.name,u.name=o),oc(u,s),s.extensions&&Su(r,u,s),s.matrix!==void 0){const f=new Bt;f.fromArray(s.matrix),u.applyMatrix4(f)}else s.translation!==void 0&&u.position.fromArray(s.translation),s.rotation!==void 0&&u.quaternion.fromArray(s.rotation),s.scale!==void 0&&u.scale.fromArray(s.scale);return i.associations.has(u)||i.associations.set(u,{}),i.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const t=this.extensions,r=this.json.scenes[e],i=this,s=new ll;r.name&&(s.name=i.createUniqueName(r.name)),oc(s,r),r.extensions&&Su(t,s,r);const o=r.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(i.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let u=0,f=l.length;u<f;u++)s.add(l[u]);const c=u=>{const f=new Map;for(const[p,m]of i.associations)(p instanceof kr||p instanceof Qn)&&f.set(p,m);return u.traverse(p=>{const m=i.associations.get(p);m!=null&&f.set(p,m)}),f};return i.associations=c(s),s})}}function nce(n,e,t){const r=e.attributes,i=new gi;if(r.POSITION!==void 0){const a=t.json.accessors[r.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(i.set(new J(l[0],l[1],l[2]),new J(c[0],c[1],c[2])),a.normalized){const u=MC(hd[a.componentType]);i.min.multiplyScalar(u),i.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new J,l=new J;for(let c=0,u=s.length;c<u;c++){const f=s[c];if(f.POSITION!==void 0){const p=t.json.accessors[f.POSITION],m=p.min,y=p.max;if(m!==void 0&&y!==void 0){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(y[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(y[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(y[2]))),p.normalized){const A=MC(hd[p.componentType]);l.multiplyScalar(A)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(a)}n.boundingBox=i;const o=new ni;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,n.boundingSphere=o}function wB(n,e,t){const r=e.attributes,i=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in r){const a=bC[o]||o.toLowerCase();a in n.attributes||i.push(s(r[o],a))}if(e.indices!==void 0&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});i.push(o)}return oc(n,e),nce(n,e,t),Promise.all(i).then(function(){return e.targets!==void 0?Yle(n,e.targets,t):n})}class rce extends CR{constructor(e){super(e),this.type=Qi}parse(e){const a=function(x,T){switch(x){case 1:console.error("THREE.RGBELoader Read Error: "+(T||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(T||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(T||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(T||""))}return-1},f=`
`,p=function(x,T,O){T=T||1024;let b=x.pos,R=-1,C=0,M="",B=String.fromCharCode.apply(null,new Uint16Array(x.subarray(b,b+128)));for(;0>(R=B.indexOf(f))&&C<T&&b<x.byteLength;)M+=B,C+=B.length,b+=128,B+=String.fromCharCode.apply(null,new Uint16Array(x.subarray(b,b+128)));return-1<R?(O!==!1&&(x.pos+=C+R+1),M+B.slice(0,R)):!1},m=function(x){const T=/^#\?(\S+)/,O=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,I=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,b=/^\s*FORMAT=(\S+)\s*$/,R=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,C={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let M,B;if(x.pos>=x.byteLength||!(M=p(x)))return a(1,"no header found");if(!(B=M.match(T)))return a(3,"bad initial token");for(C.valid|=1,C.programtype=B[1],C.string+=M+`
`;M=p(x),M!==!1;){if(C.string+=M+`
`,M.charAt(0)==="#"){C.comments+=M+`
`;continue}if((B=M.match(O))&&(C.gamma=parseFloat(B[1])),(B=M.match(I))&&(C.exposure=parseFloat(B[1])),(B=M.match(b))&&(C.valid|=2,C.format=B[1]),(B=M.match(R))&&(C.valid|=4,C.height=parseInt(B[1],10),C.width=parseInt(B[2],10)),C.valid&2&&C.valid&4)break}return C.valid&2?C.valid&4?C:a(3,"missing image size specifier"):a(3,"missing format specifier")},y=function(x,T,O){const I=T;if(I<8||I>32767||x[0]!==2||x[1]!==2||x[2]&128)return new Uint8Array(x);if(I!==(x[2]<<8|x[3]))return a(3,"wrong scanline width");const b=new Uint8Array(4*T*O);if(!b.length)return a(4,"unable to allocate buffer space");let R=0,C=0;const M=4*I,B=new Uint8Array(4),F=new Uint8Array(M);let z=O;for(;z>0&&C<x.byteLength;){if(C+4>x.byteLength)return a(1);if(B[0]=x[C++],B[1]=x[C++],B[2]=x[C++],B[3]=x[C++],B[0]!=2||B[1]!=2||(B[2]<<8|B[3])!=I)return a(3,"bad rgbe scanline format");let j=0,Y;for(;j<M&&C<x.byteLength;){Y=x[C++];const le=Y>128;if(le&&(Y-=128),Y===0||j+Y>M)return a(3,"bad scanline data");if(le){const X=x[C++];for(let ee=0;ee<Y;ee++)F[j++]=X}else F.set(x.subarray(C,C+Y),j),j+=Y,C+=Y}const oe=I;for(let le=0;le<oe;le++){let X=0;b[R]=F[le+X],X+=I,b[R+1]=F[le+X],X+=I,b[R+2]=F[le+X],X+=I,b[R+3]=F[le+X],R+=4}z--}return b},A=function(x,T,O,I){const b=x[T+3],R=Math.pow(2,b-128)/255;O[I+0]=x[T+0]*R,O[I+1]=x[T+1]*R,O[I+2]=x[T+2]*R,O[I+3]=1},_=function(x,T,O,I){const b=x[T+3],R=Math.pow(2,b-128)/255;O[I+0]=Hu.toHalfFloat(Math.min(x[T+0]*R,65504)),O[I+1]=Hu.toHalfFloat(Math.min(x[T+1]*R,65504)),O[I+2]=Hu.toHalfFloat(Math.min(x[T+2]*R,65504)),O[I+3]=Hu.toHalfFloat(1)},g=new Uint8Array(e);g.pos=0;const E=m(g);if(E!==-1){const x=E.width,T=E.height,O=y(g.subarray(g.pos),x,T);if(O!==-1){let I,b,R;switch(this.type){case fi:R=O.length/4;const C=new Float32Array(R*4);for(let B=0;B<R;B++)A(O,B*4,C,B*4);I=C,b=fi;break;case Qi:R=O.length/4;const M=new Uint16Array(R*4);for(let B=0;B<R;B++)_(O,B*4,M,B*4);I=M,b=Qi;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:x,height:T,data:I,header:E.string,gamma:E.gamma,exposure:E.exposure,type:b}}}return null}setDataType(e){return this.type=e,this}load(e,t,r,i){function s(o,a){switch(o.type){case fi:case Qi:"colorSpace"in o?o.colorSpace="srgb-linear":o.encoding=3e3,o.minFilter=Hn,o.magFilter=Hn,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,a)}return super.load(e,s,r,i)}}const fm="colorSpace"in new Qn;class ice extends CR{constructor(e){super(e),this.type=Qi}parse(e){const C=Math.pow(2.7182818,2.2);function M(H,G){for(var se=0,U=0;U<65536;++U)(U==0||H[U>>3]&1<<(U&7))&&(G[se++]=U);for(var K=se-1;se<65536;)G[se++]=0;return K}function B(H){for(var G=0;G<16384;G++)H[G]={},H[G].len=0,H[G].lit=0,H[G].p=null}const F={l:0,c:0,lc:0};function z(H,G,se,U,K){for(;se<H;)G=G<<8|at(U,K),se+=8;se-=H,F.l=G>>se&(1<<H)-1,F.c=G,F.lc=se}const j=new Array(59);function Y(H){for(var G=0;G<=58;++G)j[G]=0;for(var G=0;G<65537;++G)j[H[G]]+=1;for(var se=0,G=58;G>0;--G){var U=se+j[G]>>1;j[G]=se,se=U}for(var G=0;G<65537;++G){var K=H[G];K>0&&(H[G]=K|j[K]++<<6)}}function oe(H,G,se,U,K,q,re){for(var Z=se,ve=0,we=0;K<=q;K++){if(Z.value-se.value>U)return!1;z(6,ve,we,H,Z);var Te=F.l;if(ve=F.c,we=F.lc,re[K]=Te,Te==63){if(Z.value-se.value>U)throw"Something wrong with hufUnpackEncTable";z(8,ve,we,H,Z);var Se=F.l+6;if(ve=F.c,we=F.lc,K+Se>q+1)throw"Something wrong with hufUnpackEncTable";for(;Se--;)re[K++]=0;K--}else if(Te>=59){var Se=Te-59+2;if(K+Se>q+1)throw"Something wrong with hufUnpackEncTable";for(;Se--;)re[K++]=0;K--}}Y(re)}function le(H){return H&63}function X(H){return H>>6}function ee(H,G,se,U){for(;G<=se;G++){var K=X(H[G]),q=le(H[G]);if(K>>q)throw"Invalid table entry";if(q>14){var re=U[K>>q-14];if(re.len)throw"Invalid table entry";if(re.lit++,re.p){var Z=re.p;re.p=new Array(re.lit);for(var ve=0;ve<re.lit-1;++ve)re.p[ve]=Z[ve]}else re.p=new Array(1);re.p[re.lit-1]=G}else if(q)for(var we=0,ve=1<<14-q;ve>0;ve--){var re=U[(K<<14-q)+we];if(re.len||re.p)throw"Invalid table entry";re.len=q,re.lit=G,we++}}return!0}const ie={c:0,lc:0};function fe(H,G,se,U){H=H<<8|at(se,U),G+=8,ie.c=H,ie.lc=G}const me={c:0,lc:0};function he(H,G,se,U,K,q,re,Z,ve,we){if(H==G){U<8&&(fe(se,U,K,re),se=ie.c,U=ie.lc),U-=8;var Te=se>>U,Te=new Uint8Array([Te])[0];if(ve.value+Te>we)return!1;for(var Se=Z[ve.value-1];Te-- >0;)Z[ve.value++]=Se}else if(ve.value<we)Z[ve.value++]=H;else return!1;me.c=se,me.lc=U}function Ae(H){return H&65535}function De(H){var G=Ae(H);return G>32767?G-65536:G}const Ie={a:0,b:0};function He(H,G){var se=De(H),U=De(G),K=U,q=se+(K&1)+(K>>1),re=q,Z=q-K;Ie.a=re,Ie.b=Z}function rt(H,G){var se=Ae(H),U=Ae(G),K=se-(U>>1)&65535,q=U+K-32768&65535;Ie.a=q,Ie.b=K}function vt(H,G,se,U,K,q,re){for(var Z=re<16384,ve=se>K?K:se,we=1,Te;we<=ve;)we<<=1;for(we>>=1,Te=we,we>>=1;we>=1;){for(var Se=0,ct=Se+q*(K-Te),ze=q*we,Ve=q*Te,ft=U*we,St=U*Te,Mt,Ft,ut,et;Se<=ct;Se+=Ve){for(var Yt=Se,Dt=Se+U*(se-Te);Yt<=Dt;Yt+=St){var Rt=Yt+ft,nn=Yt+ze,Ln=nn+ft;Z?(He(H[Yt+G],H[nn+G]),Mt=Ie.a,ut=Ie.b,He(H[Rt+G],H[Ln+G]),Ft=Ie.a,et=Ie.b,He(Mt,Ft),H[Yt+G]=Ie.a,H[Rt+G]=Ie.b,He(ut,et),H[nn+G]=Ie.a,H[Ln+G]=Ie.b):(rt(H[Yt+G],H[nn+G]),Mt=Ie.a,ut=Ie.b,rt(H[Rt+G],H[Ln+G]),Ft=Ie.a,et=Ie.b,rt(Mt,Ft),H[Yt+G]=Ie.a,H[Rt+G]=Ie.b,rt(ut,et),H[nn+G]=Ie.a,H[Ln+G]=Ie.b)}if(se&we){var nn=Yt+ze;Z?He(H[Yt+G],H[nn+G]):rt(H[Yt+G],H[nn+G]),Mt=Ie.a,H[nn+G]=Ie.b,H[Yt+G]=Mt}}if(K&we)for(var Yt=Se,Dt=Se+U*(se-Te);Yt<=Dt;Yt+=St){var Rt=Yt+ft;Z?He(H[Yt+G],H[Rt+G]):rt(H[Yt+G],H[Rt+G]),Mt=Ie.a,H[Rt+G]=Ie.b,H[Yt+G]=Mt}Te=we,we>>=1}return Se}function Qe(H,G,se,U,K,q,re,Z,ve,we){for(var Te=0,Se=0,ct=Z,ze=Math.trunc(K.value+(q+7)/8);K.value<ze;)for(fe(Te,Se,se,K),Te=ie.c,Se=ie.lc;Se>=14;){var Ve=Te>>Se-14&16383,ft=G[Ve];if(ft.len)Se-=ft.len,he(ft.lit,re,Te,Se,se,U,K,ve,we,ct),Te=me.c,Se=me.lc;else{if(!ft.p)throw"hufDecode issues";var St;for(St=0;St<ft.lit;St++){for(var Mt=le(H[ft.p[St]]);Se<Mt&&K.value<ze;)fe(Te,Se,se,K),Te=ie.c,Se=ie.lc;if(Se>=Mt&&X(H[ft.p[St]])==(Te>>Se-Mt&(1<<Mt)-1)){Se-=Mt,he(ft.p[St],re,Te,Se,se,U,K,ve,we,ct),Te=me.c,Se=me.lc;break}}if(St==ft.lit)throw"hufDecode issues"}}var Ft=8-q&7;for(Te>>=Ft,Se-=Ft;Se>0;){var ft=G[Te<<14-Se&16383];if(ft.len)Se-=ft.len,he(ft.lit,re,Te,Se,se,U,K,ve,we,ct),Te=me.c,Se=me.lc;else throw"hufDecode issues"}return!0}function Xe(H,G,se,U,K,q){var re={value:0},Z=se.value,ve=it(G,se),we=it(G,se);se.value+=4;var Te=it(G,se);if(se.value+=4,ve<0||ve>=65537||we<0||we>=65537)throw"Something wrong with HUF_ENCSIZE";var Se=new Array(65537),ct=new Array(16384);B(ct);var ze=U-(se.value-Z);if(oe(H,G,se,ze,ve,we,Se),Te>8*(U-(se.value-Z)))throw"Something wrong with hufUncompress";ee(Se,ve,we,ct),Qe(Se,ct,H,G,se,Te,we,q,K,re)}function te(H,G,se){for(var U=0;U<se;++U)G[U]=H[G[U]]}function Le(H){for(var G=1;G<H.length;G++){var se=H[G-1]+H[G]-128;H[G]=se}}function be(H,G){for(var se=0,U=Math.floor((H.length+1)/2),K=0,q=H.length-1;!(K>q||(G[K++]=H[se++],K>q));)G[K++]=H[U++]}function Ne(H){for(var G=H.byteLength,se=new Array,U=0,K=new DataView(H);G>0;){var q=K.getInt8(U++);if(q<0){var re=-q;G-=re+1;for(var Z=0;Z<re;Z++)se.push(K.getUint8(U++))}else{var re=q;G-=2;for(var ve=K.getUint8(U++),Z=0;Z<re+1;Z++)se.push(ve)}}return se}function Me(H,G,se,U,K,q){var Rt=new DataView(q.buffer),re=se[H.idx[0]].width,Z=se[H.idx[0]].height,ve=3,we=Math.floor(re/8),Te=Math.ceil(re/8),Se=Math.ceil(Z/8),ct=re-(Te-1)*8,ze=Z-(Se-1)*8,Ve={value:0},ft=new Array(ve),St=new Array(ve),Mt=new Array(ve),Ft=new Array(ve),ut=new Array(ve);for(let gt=0;gt<ve;++gt)ut[gt]=G[H.idx[gt]],ft[gt]=gt<1?0:ft[gt-1]+Te*Se,St[gt]=new Float32Array(64),Mt[gt]=new Uint16Array(64),Ft[gt]=new Uint16Array(Te*64);for(let gt=0;gt<Se;++gt){var et=8;gt==Se-1&&(et=ze);var Yt=8;for(let Vt=0;Vt<Te;++Vt){Vt==Te-1&&(Yt=ct);for(let qt=0;qt<ve;++qt)Mt[qt].fill(0),Mt[qt][0]=K[ft[qt]++],ot(Ve,U,Mt[qt]),Ze(Mt[qt],St[qt]),$(St[qt]);V(St);for(let qt=0;qt<ve;++qt)ce(St[qt],Ft[qt],Vt*64)}let On=0;for(let Vt=0;Vt<ve;++Vt){const qt=se[H.idx[Vt]].type;for(let Bn=8*gt;Bn<8*gt+et;++Bn){On=ut[Vt][Bn];for(let Wi=0;Wi<we;++Wi){const ri=Wi*64+(Bn&7)*8;Rt.setUint16(On+0*2*qt,Ft[Vt][ri+0],!0),Rt.setUint16(On+1*2*qt,Ft[Vt][ri+1],!0),Rt.setUint16(On+2*2*qt,Ft[Vt][ri+2],!0),Rt.setUint16(On+3*2*qt,Ft[Vt][ri+3],!0),Rt.setUint16(On+4*2*qt,Ft[Vt][ri+4],!0),Rt.setUint16(On+5*2*qt,Ft[Vt][ri+5],!0),Rt.setUint16(On+6*2*qt,Ft[Vt][ri+6],!0),Rt.setUint16(On+7*2*qt,Ft[Vt][ri+7],!0),On+=8*2*qt}}if(we!=Te)for(let Bn=8*gt;Bn<8*gt+et;++Bn){const Wi=ut[Vt][Bn]+8*we*2*qt,ri=we*64+(Bn&7)*8;for(let js=0;js<Yt;++js)Rt.setUint16(Wi+js*2*qt,Ft[Vt][ri+js],!0)}}}for(var Dt=new Uint16Array(re),Rt=new DataView(q.buffer),nn=0;nn<ve;++nn){se[H.idx[nn]].decoded=!0;var Ln=se[H.idx[nn]].type;if(se[nn].type==2)for(var bn=0;bn<Z;++bn){const gt=ut[nn][bn];for(var un=0;un<re;++un)Dt[un]=Rt.getUint16(gt+un*2*Ln,!0);for(var un=0;un<re;++un)Rt.setFloat32(gt+un*2*Ln,Ee(Dt[un]),!0)}}}function ot(H,G,se){for(var U,K=1;K<64;)U=G[H.value],U==65280?K=64:U>>8==255?K+=U&255:(se[K]=U,K++),H.value++}function Ze(H,G){G[0]=Ee(H[0]),G[1]=Ee(H[1]),G[2]=Ee(H[5]),G[3]=Ee(H[6]),G[4]=Ee(H[14]),G[5]=Ee(H[15]),G[6]=Ee(H[27]),G[7]=Ee(H[28]),G[8]=Ee(H[2]),G[9]=Ee(H[4]),G[10]=Ee(H[7]),G[11]=Ee(H[13]),G[12]=Ee(H[16]),G[13]=Ee(H[26]),G[14]=Ee(H[29]),G[15]=Ee(H[42]),G[16]=Ee(H[3]),G[17]=Ee(H[8]),G[18]=Ee(H[12]),G[19]=Ee(H[17]),G[20]=Ee(H[25]),G[21]=Ee(H[30]),G[22]=Ee(H[41]),G[23]=Ee(H[43]),G[24]=Ee(H[9]),G[25]=Ee(H[11]),G[26]=Ee(H[18]),G[27]=Ee(H[24]),G[28]=Ee(H[31]),G[29]=Ee(H[40]),G[30]=Ee(H[44]),G[31]=Ee(H[53]),G[32]=Ee(H[10]),G[33]=Ee(H[19]),G[34]=Ee(H[23]),G[35]=Ee(H[32]),G[36]=Ee(H[39]),G[37]=Ee(H[45]),G[38]=Ee(H[52]),G[39]=Ee(H[54]),G[40]=Ee(H[20]),G[41]=Ee(H[22]),G[42]=Ee(H[33]),G[43]=Ee(H[38]),G[44]=Ee(H[46]),G[45]=Ee(H[51]),G[46]=Ee(H[55]),G[47]=Ee(H[60]),G[48]=Ee(H[21]),G[49]=Ee(H[34]),G[50]=Ee(H[37]),G[51]=Ee(H[47]),G[52]=Ee(H[50]),G[53]=Ee(H[56]),G[54]=Ee(H[59]),G[55]=Ee(H[61]),G[56]=Ee(H[35]),G[57]=Ee(H[36]),G[58]=Ee(H[48]),G[59]=Ee(H[49]),G[60]=Ee(H[57]),G[61]=Ee(H[58]),G[62]=Ee(H[62]),G[63]=Ee(H[63])}function $(H){const G=.5*Math.cos(.7853975),se=.5*Math.cos(3.14159/16),U=.5*Math.cos(3.14159/8),K=.5*Math.cos(3*3.14159/16),q=.5*Math.cos(5*3.14159/16),re=.5*Math.cos(3*3.14159/8),Z=.5*Math.cos(7*3.14159/16);for(var ve=new Array(4),we=new Array(4),Te=new Array(4),Se=new Array(4),ct=0;ct<8;++ct){var ze=ct*8;ve[0]=U*H[ze+2],ve[1]=re*H[ze+2],ve[2]=U*H[ze+6],ve[3]=re*H[ze+6],we[0]=se*H[ze+1]+K*H[ze+3]+q*H[ze+5]+Z*H[ze+7],we[1]=K*H[ze+1]-Z*H[ze+3]-se*H[ze+5]-q*H[ze+7],we[2]=q*H[ze+1]-se*H[ze+3]+Z*H[ze+5]+K*H[ze+7],we[3]=Z*H[ze+1]-q*H[ze+3]+K*H[ze+5]-se*H[ze+7],Te[0]=G*(H[ze+0]+H[ze+4]),Te[3]=G*(H[ze+0]-H[ze+4]),Te[1]=ve[0]+ve[3],Te[2]=ve[1]-ve[2],Se[0]=Te[0]+Te[1],Se[1]=Te[3]+Te[2],Se[2]=Te[3]-Te[2],Se[3]=Te[0]-Te[1],H[ze+0]=Se[0]+we[0],H[ze+1]=Se[1]+we[1],H[ze+2]=Se[2]+we[2],H[ze+3]=Se[3]+we[3],H[ze+4]=Se[3]-we[3],H[ze+5]=Se[2]-we[2],H[ze+6]=Se[1]-we[1],H[ze+7]=Se[0]-we[0]}for(var Ve=0;Ve<8;++Ve)ve[0]=U*H[16+Ve],ve[1]=re*H[16+Ve],ve[2]=U*H[48+Ve],ve[3]=re*H[48+Ve],we[0]=se*H[8+Ve]+K*H[24+Ve]+q*H[40+Ve]+Z*H[56+Ve],we[1]=K*H[8+Ve]-Z*H[24+Ve]-se*H[40+Ve]-q*H[56+Ve],we[2]=q*H[8+Ve]-se*H[24+Ve]+Z*H[40+Ve]+K*H[56+Ve],we[3]=Z*H[8+Ve]-q*H[24+Ve]+K*H[40+Ve]-se*H[56+Ve],Te[0]=G*(H[Ve]+H[32+Ve]),Te[3]=G*(H[Ve]-H[32+Ve]),Te[1]=ve[0]+ve[3],Te[2]=ve[1]-ve[2],Se[0]=Te[0]+Te[1],Se[1]=Te[3]+Te[2],Se[2]=Te[3]-Te[2],Se[3]=Te[0]-Te[1],H[0+Ve]=Se[0]+we[0],H[8+Ve]=Se[1]+we[1],H[16+Ve]=Se[2]+we[2],H[24+Ve]=Se[3]+we[3],H[32+Ve]=Se[3]-we[3],H[40+Ve]=Se[2]-we[2],H[48+Ve]=Se[1]-we[1],H[56+Ve]=Se[0]-we[0]}function V(H){for(var G=0;G<64;++G){var se=H[0][G],U=H[1][G],K=H[2][G];H[0][G]=se+1.5747*K,H[1][G]=se-.1873*U-.4682*K,H[2][G]=se+1.8556*U}}function ce(H,G,se){for(var U=0;U<64;++U)G[se+U]=Hu.toHalfFloat(ke(H[U]))}function ke(H){return H<=1?Math.sign(H)*Math.pow(Math.abs(H),2.2):Math.sign(H)*Math.pow(C,Math.abs(H)-1)}function pe(H){return new DataView(H.array.buffer,H.offset.value,H.size)}function ye(H){var G=H.viewer.buffer.slice(H.offset.value,H.offset.value+H.size),se=new Uint8Array(Ne(G)),U=new Uint8Array(se.length);return Le(se),be(se,U),new DataView(U.buffer)}function qe(H){var G=H.array.slice(H.offset.value,H.offset.value+H.size),se=$0(G),U=new Uint8Array(se.length);return Le(se),be(se,U),new DataView(U.buffer)}function Ge(H){for(var G=H.viewer,se={value:H.offset.value},U=new Uint16Array(H.width*H.scanlineBlockSize*(H.channels*H.type)),K=new Uint8Array(8192),q=0,re=new Array(H.channels),Z=0;Z<H.channels;Z++)re[Z]={},re[Z].start=q,re[Z].end=re[Z].start,re[Z].nx=H.width,re[Z].ny=H.lines,re[Z].size=H.type,q+=re[Z].nx*re[Z].ny*re[Z].size;var ve=ae(G,se),we=ae(G,se);if(we>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(ve<=we)for(var Z=0;Z<we-ve+1;Z++)K[Z+ve]=Ct(G,se);var Te=new Uint16Array(65536),Se=M(K,Te),ct=it(G,se);Xe(H.array,G,se,ct,U,q);for(var Z=0;Z<H.channels;++Z)for(var ze=re[Z],Ve=0;Ve<re[Z].size;++Ve)vt(U,ze.start+Ve,ze.nx,ze.size,ze.ny,ze.nx*ze.size,Se);te(Te,U,q);for(var ft=0,St=new Uint8Array(U.buffer.byteLength),Mt=0;Mt<H.lines;Mt++)for(var Ft=0;Ft<H.channels;Ft++){var ze=re[Ft],ut=ze.nx*ze.size,et=new Uint8Array(U.buffer,ze.end*2,ut*2);St.set(et,ft),ft+=ut*2,ze.end+=ut}return new DataView(St.buffer)}function Ke(H){var G=H.array.slice(H.offset.value,H.offset.value+H.size),se=$0(G);const U=H.lines*H.channels*H.width,K=H.type==1?new Uint16Array(U):new Uint32Array(U);let q=0,re=0;const Z=new Array(4);for(let ve=0;ve<H.lines;ve++)for(let we=0;we<H.channels;we++){let Te=0;switch(H.type){case 1:Z[0]=q,Z[1]=Z[0]+H.width,q=Z[1]+H.width;for(let Se=0;Se<H.width;++Se){const ct=se[Z[0]++]<<8|se[Z[1]++];Te+=ct,K[re]=Te,re++}break;case 2:Z[0]=q,Z[1]=Z[0]+H.width,Z[2]=Z[1]+H.width,q=Z[2]+H.width;for(let Se=0;Se<H.width;++Se){const ct=se[Z[0]++]<<24|se[Z[1]++]<<16|se[Z[2]++]<<8;Te+=ct,K[re]=Te,re++}break}}return new DataView(K.buffer)}function yt(H){var G=H.viewer,se={value:H.offset.value},U=new Uint8Array(H.width*H.lines*(H.channels*H.type*2)),K={version:bt(G,se),unknownUncompressedSize:bt(G,se),unknownCompressedSize:bt(G,se),acCompressedSize:bt(G,se),dcCompressedSize:bt(G,se),rleCompressedSize:bt(G,se),rleUncompressedSize:bt(G,se),rleRawSize:bt(G,se),totalAcUncompressedCount:bt(G,se),totalDcUncompressedCount:bt(G,se),acCompression:bt(G,se)};if(K.version<2)throw"EXRLoader.parse: "+Ir.compression+" version "+K.version+" is unsupported";for(var q=new Array,re=ae(G,se)-2;re>0;){var Z=At(G.buffer,se),ve=Ct(G,se),we=ve>>2&3,Te=(ve>>4)-1,Se=new Int8Array([Te])[0],ct=Ct(G,se);q.push({name:Z,index:Se,type:ct,compression:we}),re-=Z.length+3}for(var ze=Ir.channels,Ve=new Array(H.channels),ft=0;ft<H.channels;++ft){var St=Ve[ft]={},Mt=ze[ft];St.name=Mt.name,St.compression=0,St.decoded=!1,St.type=Mt.pixelType,St.pLinear=Mt.pLinear,St.width=H.width,St.height=H.lines}for(var Ft={idx:new Array(3)},ut=0;ut<H.channels;++ut)for(var St=Ve[ut],ft=0;ft<q.length;++ft){var et=q[ft];St.name==et.name&&(St.compression=et.compression,et.index>=0&&(Ft.idx[et.index]=ut),St.offset=ut)}if(K.acCompressedSize>0)switch(K.acCompression){case 0:var Rt=new Uint16Array(K.totalAcUncompressedCount);Xe(H.array,G,se,K.acCompressedSize,Rt,K.totalAcUncompressedCount);break;case 1:var Yt=H.array.slice(se.value,se.value+K.totalAcUncompressedCount),Dt=$0(Yt),Rt=new Uint16Array(Dt.buffer);se.value+=K.totalAcUncompressedCount;break}if(K.dcCompressedSize>0){var nn={array:H.array,offset:se,size:K.dcCompressedSize},Ln=new Uint16Array(qe(nn).buffer);se.value+=K.dcCompressedSize}if(K.rleRawSize>0){var Yt=H.array.slice(se.value,se.value+K.rleCompressedSize),Dt=$0(Yt),bn=Ne(Dt.buffer);se.value+=K.rleCompressedSize}for(var un=0,gt=new Array(Ve.length),ft=0;ft<gt.length;++ft)gt[ft]=new Array;for(var On=0;On<H.lines;++On)for(var Vt=0;Vt<Ve.length;++Vt)gt[Vt].push(un),un+=Ve[Vt].width*H.type*2;Me(Ft,gt,Ve,Rt,Ln,U);for(var ft=0;ft<Ve.length;++ft){var St=Ve[ft];if(!St.decoded)switch(St.compression){case 2:for(var qt=0,Bn=0,On=0;On<H.lines;++On){for(var Wi=gt[ft][qt],ri=0;ri<St.width;++ri){for(var js=0;js<2*St.type;++js)U[Wi++]=bn[Bn+js*St.width*St.height];Bn++}qt++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(U.buffer)}function At(H,G){for(var se=new Uint8Array(H),U=0;se[G.value+U]!=0;)U+=1;var K=new TextDecoder().decode(se.slice(G.value,G.value+U));return G.value=G.value+U+1,K}function Ue(H,G,se){var U=new TextDecoder().decode(new Uint8Array(H).slice(G.value,G.value+se));return G.value=G.value+se,U}function Qt(H,G){var se=wt(H,G),U=it(H,G);return[se,U]}function Ht(H,G){var se=it(H,G),U=it(H,G);return[se,U]}function wt(H,G){var se=H.getInt32(G.value,!0);return G.value=G.value+4,se}function it(H,G){var se=H.getUint32(G.value,!0);return G.value=G.value+4,se}function at(H,G){var se=H[G.value];return G.value=G.value+1,se}function Ct(H,G){var se=H.getUint8(G.value);return G.value=G.value+1,se}const bt=function(H,G){let se;return"getBigInt64"in DataView.prototype?se=Number(H.getBigInt64(G.value,!0)):se=H.getUint32(G.value+4,!0)+Number(H.getUint32(G.value,!0)<<32),G.value+=8,se};function Wt(H,G){var se=H.getFloat32(G.value,!0);return G.value+=4,se}function Gt(H,G){return Hu.toHalfFloat(Wt(H,G))}function Ee(H){var G=(H&31744)>>10,se=H&1023;return(H>>15?-1:1)*(G?G===31?se?NaN:1/0:Math.pow(2,G-15)*(1+se/1024):6103515625e-14*(se/1024))}function ae(H,G){var se=H.getUint16(G.value,!0);return G.value+=2,se}function tt(H,G){return Ee(ae(H,G))}function $e(H,G,se,U){for(var K=se.value,q=[];se.value<K+U-1;){var re=At(G,se),Z=wt(H,se),ve=Ct(H,se);se.value+=3;var we=wt(H,se),Te=wt(H,se);q.push({name:re,pixelType:Z,pLinear:ve,xSampling:we,ySampling:Te})}return se.value+=1,q}function Pt(H,G){var se=Wt(H,G),U=Wt(H,G),K=Wt(H,G),q=Wt(H,G),re=Wt(H,G),Z=Wt(H,G),ve=Wt(H,G),we=Wt(H,G);return{redX:se,redY:U,greenX:K,greenY:q,blueX:re,blueY:Z,whiteX:ve,whiteY:we}}function xt(H,G){var se=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],U=Ct(H,G);return se[U]}function hn(H,G){var se=it(H,G),U=it(H,G),K=it(H,G),q=it(H,G);return{xMin:se,yMin:U,xMax:K,yMax:q}}function En(H,G){var se=["INCREASING_Y"],U=Ct(H,G);return se[U]}function Xn(H,G){var se=Wt(H,G),U=Wt(H,G);return[se,U]}function Fn(H,G){var se=Wt(H,G),U=Wt(H,G),K=Wt(H,G);return[se,U,K]}function An(H,G,se,U,K){if(U==="string"||U==="stringvector"||U==="iccProfile")return Ue(G,se,K);if(U==="chlist")return $e(H,G,se,K);if(U==="chromaticities")return Pt(H,se);if(U==="compression")return xt(H,se);if(U==="box2i")return hn(H,se);if(U==="lineOrder")return En(H,se);if(U==="float")return Wt(H,se);if(U==="v2f")return Xn(H,se);if(U==="v3f")return Fn(H,se);if(U==="int")return wt(H,se);if(U==="rational")return Qt(H,se);if(U==="timecode")return Ht(H,se);if(U==="preview")return se.value+=K,"skipped";se.value+=K}function Ar(H,G,se){const U={};if(H.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";U.version=H.getUint8(4);const K=H.getUint8(5);U.spec={singleTile:!!(K&2),longName:!!(K&4),deepFormat:!!(K&8),multiPart:!!(K&16)},se.value=8;for(var q=!0;q;){var re=At(G,se);if(re==0)q=!1;else{var Z=At(G,se),ve=it(H,se),we=An(H,G,se,Z,ve);we===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${Z}'.`):U[re]=we}}if(K&-5)throw console.error("EXRHeader:",U),"THREE.EXRLoader: provided file is currently unsupported.";return U}function Fr(H,G,se,U,K){const q={size:0,viewer:G,array:se,offset:U,width:H.dataWindow.xMax-H.dataWindow.xMin+1,height:H.dataWindow.yMax-H.dataWindow.yMin+1,channels:H.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:H.channels[0].pixelType,uncompress:null,getter:null,format:null,[fm?"colorSpace":"encoding"]:null};switch(H.compression){case"NO_COMPRESSION":q.lines=1,q.uncompress=pe;break;case"RLE_COMPRESSION":q.lines=1,q.uncompress=ye;break;case"ZIPS_COMPRESSION":q.lines=1,q.uncompress=qe;break;case"ZIP_COMPRESSION":q.lines=16,q.uncompress=qe;break;case"PIZ_COMPRESSION":q.lines=32,q.uncompress=Ge;break;case"PXR24_COMPRESSION":q.lines=16,q.uncompress=Ke;break;case"DWAA_COMPRESSION":q.lines=32,q.uncompress=yt;break;case"DWAB_COMPRESSION":q.lines=256,q.uncompress=yt;break;default:throw"EXRLoader.parse: "+H.compression+" is unsupported"}if(q.scanlineBlockSize=q.lines,q.type==1)switch(K){case fi:q.getter=tt,q.inputSize=2;break;case Qi:q.getter=ae,q.inputSize=2;break}else if(q.type==2)switch(K){case fi:q.getter=Wt,q.inputSize=4;break;case Qi:q.getter=Gt,q.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+q.type+" for "+H.compression+".";q.blockCount=(H.dataWindow.yMax+1)/q.scanlineBlockSize;for(var re=0;re<q.blockCount;re++)bt(G,U);q.outputChannels=q.channels==3?4:q.channels;const Z=q.width*q.height*q.outputChannels;switch(K){case fi:q.byteArray=new Float32Array(Z),q.channels<q.outputChannels&&q.byteArray.fill(1,0,Z);break;case Qi:q.byteArray=new Uint16Array(Z),q.channels<q.outputChannels&&q.byteArray.fill(15360,0,Z);break;default:console.error("THREE.EXRLoader: unsupported type: ",K);break}return q.bytesPerLine=q.width*q.inputSize*q.channels,q.outputChannels==4?q.format=Ni:q.format=$M,fm?q.colorSpace="srgb-linear":q.encoding=3e3,q}const As=new DataView(e),sa=new Uint8Array(e),_i={value:0},Ir=Ar(As,e,_i),jt=Fr(Ir,As,sa,_i,this.type),Ei={value:0},Na={R:0,G:1,B:2,A:3,Y:0};for(let H=0;H<jt.height/jt.scanlineBlockSize;H++){const G=it(As,_i);jt.size=it(As,_i),jt.lines=G+jt.scanlineBlockSize>jt.height?jt.height-G:jt.scanlineBlockSize;const U=jt.size<jt.lines*jt.bytesPerLine?jt.uncompress(jt):pe(jt);_i.value+=jt.size;for(let K=0;K<jt.scanlineBlockSize;K++){const q=K+H*jt.scanlineBlockSize;if(q>=jt.height)break;for(let re=0;re<jt.channels;re++){const Z=Na[Ir.channels[re].name];for(let ve=0;ve<jt.width;ve++){Ei.value=(K*(jt.channels*jt.width)+re*jt.width+ve)*jt.inputSize;const we=(jt.height-1-q)*(jt.width*jt.outputChannels)+ve*jt.outputChannels+Z;jt.byteArray[we]=jt.getter(U,Ei)}}}}return{header:Ir,width:jt.width,height:jt.height,data:jt.byteArray,format:jt.format,[fm?"colorSpace":"encoding"]:jt[fm?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,r,i){function s(o,a){fm?o.colorSpace=a.colorSpace:o.encoding=a.encoding,o.minFilter=Hn,o.magFilter=Hn,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,a)}return super.load(e,s,r,i)}}const jw=new WeakMap;class sce extends Vi{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){const s=new Gs(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){const s={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const l in t.attributeTypes){const c=t.attributeTypes[l];c.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[l]=c.name)}const r=JSON.stringify(t);if(jw.has(e)){const l=jw.get(e);if(l.key===r)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(i=l,new Promise((c,u)=>{i._callbacks[s]={resolve:c,reject:u},i.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{i&&s&&this._releaseTask(i,s)}),jw.set(e,{key:r,promise:a}),a}_createGeometry(e){const t=new Jt;e.index&&t.setIndex(new _n(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const i=e.attributes[r],s=i.name,o=i.array,a=i.itemSize;t.setAttribute(s,new _n(o,a))}return t}_loadLibrary(e,t){const r=new Gs(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,s)=>{r.load(e,i,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{const i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);const s=oce.toString(),o=["/* draco decoder */",i,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(s){const o=s.data;switch(o.type){case"decode":i._callbacks[o.id].resolve(o);break;case"error":i._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,s){return i._taskLoad>s._taskLoad?-1:1});const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function oce(){let n,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":n=a.decoderConfig,e=new Promise(function(u){n.onModuleLoaded=function(f){u({draco:f})},DracoDecoderModule(n)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(u=>{const f=u.draco,p=new f.Decoder,m=new f.DecoderBuffer;m.Init(new Int8Array(l),l.byteLength);try{const y=t(f,p,m,c),A=y.attributes.map(_=>_.array.buffer);y.index&&A.push(y.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:y},A)}catch(y){console.error(y),self.postMessage({type:"error",id:a.id,error:y.message})}finally{f.destroy(m),f.destroy(p)}});break}};function t(o,a,l,c){const u=c.attributeIDs,f=c.attributeTypes;let p,m;const y=a.GetEncodedGeometryType(l);if(y===o.TRIANGULAR_MESH)p=new o.Mesh,m=a.DecodeBufferToMesh(l,p);else if(y===o.POINT_CLOUD)p=new o.PointCloud,m=a.DecodeBufferToPointCloud(l,p);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!m.ok()||p.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+m.error_msg());const A={index:null,attributes:[]};for(const _ in u){const g=self[f[_]];let E,x;if(c.useUniqueIDs)x=u[_],E=a.GetAttributeByUniqueId(p,x);else{if(x=a.GetAttributeId(p,o[u[_]]),x===-1)continue;E=a.GetAttribute(p,x)}A.attributes.push(i(o,a,p,_,g,E))}return y===o.TRIANGULAR_MESH&&(A.index=r(o,a,p)),o.destroy(p),A}function r(o,a,l){const u=l.num_faces()*3,f=u*4,p=o._malloc(f);a.GetTrianglesUInt32Array(l,f,p);const m=new Uint32Array(o.HEAPF32.buffer,p,u).slice();return o._free(p),{array:m,itemSize:1}}function i(o,a,l,c,u,f){const p=f.num_components(),y=l.num_points()*p,A=y*u.BYTES_PER_ELEMENT,_=s(o,u),g=o._malloc(A);a.GetAttributeDataArrayForAllPoints(l,f,_,A,g);const E=new u(o.HEAPF32.buffer,g,y).slice();return o._free(g),{name:c,array:E,itemSize:p}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let j0;const Xw=()=>{if(j0)return j0;const n="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),r=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let i=n;WebAssembly.validate(t)&&(i=e);let s;const o=WebAssembly.instantiate(a(i),{}).then(f=>{s=f.instance,s.exports.__wasm_call_ctors()});function a(f){const p=new Uint8Array(f.length);for(let y=0;y<f.length;++y){const A=f.charCodeAt(y);p[y]=A>96?A-71:A>64?A-65:A>47?A+4:A>46?63:62}let m=0;for(let y=0;y<f.length;++y)p[m++]=p[y]<60?r[p[y]]:(p[y]-60)*64+p[++y];return p.buffer.slice(0,m)}function l(f,p,m,y,A,_){const g=s.exports.sbrk,E=m+3&-4,x=g(E*y),T=g(A.length),O=new Uint8Array(s.exports.memory.buffer);O.set(A,T);const I=f(x,m,y,T,A.length);if(I===0&&_&&_(x,E,y),p.set(O.subarray(x,x+m*y)),g(x-g(0)),I!==0)throw new Error(`Malformed buffer data: ${I}`)}const c={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},u={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return j0={ready:o,supported:!0,decodeVertexBuffer(f,p,m,y,A){l(s.exports.meshopt_decodeVertexBuffer,f,p,m,y,s.exports[c[A]])},decodeIndexBuffer(f,p,m,y){l(s.exports.meshopt_decodeIndexBuffer,f,p,m,y)},decodeIndexSequence(f,p,m,y){l(s.exports.meshopt_decodeIndexSequence,f,p,m,y)},decodeGltfBuffer(f,p,m,y,A,_){l(s.exports[u[A]],f,p,m,y,s.exports[c[_]])}},j0};function Ly(n,e){if(Object.is(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;const t=Object.keys(n);if(t.length!==Object.keys(e).length)return!1;for(let r=0;r<t.length;r++)if(!Object.prototype.hasOwnProperty.call(e,t[r])||!Object.is(n[t[r]],e[t[r]]))return!1;return!0}let X0=null,zV="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function HV(n,e,t){return r=>{t&&t(r),n&&(X0||(X0=new sce),X0.setDecoderPath(typeof n=="string"?n:zV),r.setDRACOLoader(X0)),e&&r.setMeshoptDecoder(typeof Xw=="function"?Xw():Xw)}}function Fd(n,e=!0,t=!0,r){return op(VR,n,HV(e,t,r))}Fd.preload=(n,e=!0,t=!0,r)=>op.preload(VR,n,HV(e,t,r));Fd.clear=n=>op.clear(VR,n);Fd.setDecoderPath=n=>{zV=n};/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const ar={LEFT:1,RIGHT:2,MIDDLE:4},Pe=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),xf={NONE:0,IN:1,OUT:-1};function Tu(n){return n.isPerspectiveCamera}function tc(n){return n.isOrthographicCamera}const Af=Math.PI*2,SB=Math.PI/2,VV=1e-5,dm=Math.PI/180;function Lo(n,e,t){return Math.max(e,Math.min(t,n))}function Gn(n,e=VV){return Math.abs(n)<e}function Mn(n,e,t=VV){return Gn(n-e,t)}function TB(n,e){return Math.round(n/e)*e}function pm(n){return isFinite(n)?n:n<0?-Number.MAX_VALUE:Number.MAX_VALUE}function mm(n){return Math.abs(n)<Number.MAX_VALUE?n:n*(1/0)}function K0(n,e,t,r,i=1/0,s){r=Math.max(1e-4,r);const o=2/r,a=o*s,l=1/(1+a+.48*a*a+.235*a*a*a);let c=n-e;const u=e,f=i*r;c=Lo(c,-f,f),e=n-c;const p=(t.value+o*c)*s;t.value=(t.value-o*p)*l;let m=e+(c+p)*l;return u-n>0==m>u&&(m=u,t.value=(m-u)/s),m}function CB(n,e,t,r,i=1/0,s,o){r=Math.max(1e-4,r);const a=2/r,l=a*s,c=1/(1+l+.48*l*l+.235*l*l*l);let u=e.x,f=e.y,p=e.z,m=n.x-u,y=n.y-f,A=n.z-p;const _=u,g=f,E=p,x=i*r,T=x*x,O=m*m+y*y+A*A;if(O>T){const Y=Math.sqrt(O);m=m/Y*x,y=y/Y*x,A=A/Y*x}u=n.x-m,f=n.y-y,p=n.z-A;const I=(t.x+a*m)*s,b=(t.y+a*y)*s,R=(t.z+a*A)*s;t.x=(t.x-a*I)*c,t.y=(t.y-a*b)*c,t.z=(t.z-a*R)*c,o.x=u+(m+I)*c,o.y=f+(y+b)*c,o.z=p+(A+R)*c;const C=_-n.x,M=g-n.y,B=E-n.z,F=o.x-_,z=o.y-g,j=o.z-E;return C*F+M*z+B*j>0&&(o.x=_,o.y=g,o.z=E,t.x=(o.x-_)/s,t.y=(o.y-g)/s,t.z=(o.z-E)/s),o}function Kw(n,e){e.set(0,0),n.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=n.length,e.y/=n.length}function Jw(n,e){return tc(n)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}class ace{constructor(){this._listeners={}}addEventListener(e,t){const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e)}}}var Yw;const lce="2.8.1",J0=1/8,cce=/Mac/.test((Yw=globalThis==null?void 0:globalThis.navigator)===null||Yw===void 0?void 0:Yw.platform);let Ut,bB,Y0,qw,cs,Zt,Tn,wf,gm,ha,fa,Cu,MB,RB,so,ym,Sf,IB,Qw,PB,Zw,eS,q0,tS=class RC extends ace{static install(e){Ut=e.THREE,bB=Object.freeze(new Ut.Vector3(0,0,0)),Y0=Object.freeze(new Ut.Vector3(0,1,0)),qw=Object.freeze(new Ut.Vector3(0,0,1)),cs=new Ut.Vector2,Zt=new Ut.Vector3,Tn=new Ut.Vector3,wf=new Ut.Vector3,gm=new Ut.Vector3,ha=new Ut.Vector3,fa=new Ut.Vector3,Cu=new Ut.Vector3,MB=new Ut.Vector3,RB=new Ut.Vector3,so=new Ut.Spherical,ym=new Ut.Spherical,Sf=new Ut.Box3,IB=new Ut.Box3,Qw=new Ut.Sphere,PB=new Ut.Quaternion,Zw=new Ut.Quaternion,eS=new Ut.Matrix4,q0=new Ut.Raycaster}static get ACTION(){return Pe}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=Pe.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=xf.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new Ut.Vector3,this._focalOffsetVelocity=new Ut.Vector3,this._zoomVelocity={value:0},this._truckInternal=(g,E,x)=>{let T,O;if(Tu(this._camera)){const I=Zt.copy(this._camera.position).sub(this._target),b=this._camera.getEffectiveFOV()*dm,R=I.length()*Math.tan(b*.5);T=this.truckSpeed*g*R/this._elementRect.height,O=this.truckSpeed*E*R/this._elementRect.height}else if(tc(this._camera)){const I=this._camera;T=g*(I.right-I.left)/I.zoom/this._elementRect.width,O=E*(I.top-I.bottom)/I.zoom/this._elementRect.height}else return;this.verticalDragToForward?(x?this.setFocalOffset(this._focalOffsetEnd.x+T,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(T,0,!0),this.forward(-O,!0)):x?this.setFocalOffset(this._focalOffsetEnd.x+T,this._focalOffsetEnd.y+O,this._focalOffsetEnd.z,!0):this.truck(T,O,!0)},this._rotateInternal=(g,E)=>{const x=Af*this.azimuthRotateSpeed*g/this._elementRect.height,T=Af*this.polarRotateSpeed*E/this._elementRect.height;this.rotate(x,T,!0)},this._dollyInternal=(g,E,x)=>{const T=Math.pow(.95,-g*this.dollySpeed),O=this._sphericalEnd.radius,I=this._sphericalEnd.radius*T,b=Lo(I,this.minDistance,this.maxDistance),R=b-I;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(I,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(R,!0),this._dollyToNoClamp(b,!0)):this._dollyToNoClamp(b,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?I:b)-O,this._dollyControlCoord.set(E,x)),this._lastDollyDirection=Math.sign(-g)},this._zoomInternal=(g,E,x)=>{const T=Math.pow(.95,g*this.dollySpeed),O=this._zoom,I=this._zoom*T;this.zoomTo(I,!0),this.dollyToCursor&&(this._changedZoom+=I-O,this._dollyControlCoord.set(E,x))},typeof Ut>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new Ut.Quaternion().setFromUnitVectors(this._camera.up,Y0),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=Pe.NONE,this._target=new Ut.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new Ut.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new Ut.Spherical().setFromVector3(Zt.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new Ut.Vector3,new Ut.Vector3,new Ut.Vector3,new Ut.Vector3],this._updateNearPlaneCorners(),this._boundary=new Ut.Box3(new Ut.Vector3(-1/0,-1/0,-1/0),new Ut.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new Ut.Vector2,this.mouseButtons={left:Pe.ROTATE,middle:Pe.DOLLY,right:Pe.TRUCK,wheel:Tu(this._camera)?Pe.DOLLY:tc(this._camera)?Pe.ZOOM:Pe.NONE},this.touches={one:Pe.TOUCH_ROTATE,two:Tu(this._camera)?Pe.TOUCH_DOLLY_TRUCK:tc(this._camera)?Pe.TOUCH_ZOOM_TRUCK:Pe.NONE,three:Pe.TOUCH_TRUCK};const r=new Ut.Vector2,i=new Ut.Vector2,s=new Ut.Vector2,o=g=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const T=this._domElement.getBoundingClientRect(),O=g.clientX/T.width,I=g.clientY/T.height;if(O<this._interactiveArea.left||O>this._interactiveArea.right||I<this._interactiveArea.top||I>this._interactiveArea.bottom)return}const E=g.pointerType!=="mouse"?null:(g.buttons&ar.LEFT)===ar.LEFT?ar.LEFT:(g.buttons&ar.MIDDLE)===ar.MIDDLE?ar.MIDDLE:(g.buttons&ar.RIGHT)===ar.RIGHT?ar.RIGHT:null;if(E!==null){const T=this._findPointerByMouseButton(E);T&&this._disposePointer(T)}if((g.buttons&ar.LEFT)===ar.LEFT&&this._lockedPointer)return;const x={pointerId:g.pointerId,clientX:g.clientX,clientY:g.clientY,deltaX:0,deltaY:0,mouseButton:E};this._activePointers.push(x),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",l),this._isDragging=!0,p(g)},a=g=>{g.cancelable&&g.preventDefault();const E=g.pointerId,x=this._lockedPointer||this._findPointerById(E);if(x){if(x.clientX=g.clientX,x.clientY=g.clientY,x.deltaX=g.movementX,x.deltaY=g.movementY,this._state=0,g.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(g.buttons&ar.LEFT)===ar.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(g.buttons&ar.MIDDLE)===ar.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(g.buttons&ar.RIGHT)===ar.RIGHT&&(this._state=this._state|this.mouseButtons.right);m()}},l=g=>{const E=this._findPointerById(g.pointerId);if(!(E&&E===this._lockedPointer)){if(E&&this._disposePointer(E),g.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=Pe.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=Pe.NONE;y()}};let c=-1;const u=g=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===Pe.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const I=this._domElement.getBoundingClientRect(),b=g.clientX/I.width,R=g.clientY/I.height;if(b<this._interactiveArea.left||b>this._interactiveArea.right||R<this._interactiveArea.top||R>this._interactiveArea.bottom)return}if(g.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===Pe.ROTATE||this.mouseButtons.wheel===Pe.TRUCK){const I=performance.now();c-I<1e3&&this._getClientRect(this._elementRect),c=I}const E=cce?-1:-3,x=g.deltaMode===1?g.deltaY/E:g.deltaY/(E*10),T=this.dollyToCursor?(g.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,O=this.dollyToCursor?(g.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case Pe.ROTATE:{this._rotateInternal(g.deltaX,g.deltaY),this._isUserControllingRotate=!0;break}case Pe.TRUCK:{this._truckInternal(g.deltaX,g.deltaY,!1),this._isUserControllingTruck=!0;break}case Pe.OFFSET:{this._truckInternal(g.deltaX,g.deltaY,!0),this._isUserControllingOffset=!0;break}case Pe.DOLLY:{this._dollyInternal(-x,T,O),this._isUserControllingDolly=!0;break}case Pe.ZOOM:{this._zoomInternal(-x,T,O),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},f=g=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===RC.ACTION.NONE){const E=g instanceof PointerEvent?g.pointerId:0,x=this._findPointerById(E);x&&this._disposePointer(x),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l);return}g.preventDefault()}},p=g=>{if(!this._enabled)return;if(Kw(this._activePointers,cs),this._getClientRect(this._elementRect),r.copy(cs),i.copy(cs),this._activePointers.length>=2){const x=cs.x-this._activePointers[1].clientX,T=cs.y-this._activePointers[1].clientY,O=Math.sqrt(x*x+T*T);s.set(0,O);const I=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,b=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;i.set(I,b)}if(this._state=0,!g)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in g&&g.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(g.buttons&ar.LEFT)===ar.LEFT&&(this._state=this._state|this.mouseButtons.left),(g.buttons&ar.MIDDLE)===ar.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(g.buttons&ar.RIGHT)===ar.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&Pe.ROTATE)===Pe.ROTATE||(this._state&Pe.TOUCH_ROTATE)===Pe.TOUCH_ROTATE||(this._state&Pe.TOUCH_DOLLY_ROTATE)===Pe.TOUCH_DOLLY_ROTATE||(this._state&Pe.TOUCH_ZOOM_ROTATE)===Pe.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&Pe.TRUCK)===Pe.TRUCK||(this._state&Pe.TOUCH_TRUCK)===Pe.TOUCH_TRUCK||(this._state&Pe.TOUCH_DOLLY_TRUCK)===Pe.TOUCH_DOLLY_TRUCK||(this._state&Pe.TOUCH_ZOOM_TRUCK)===Pe.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&Pe.DOLLY)===Pe.DOLLY||(this._state&Pe.TOUCH_DOLLY)===Pe.TOUCH_DOLLY||(this._state&Pe.TOUCH_DOLLY_TRUCK)===Pe.TOUCH_DOLLY_TRUCK||(this._state&Pe.TOUCH_DOLLY_OFFSET)===Pe.TOUCH_DOLLY_OFFSET||(this._state&Pe.TOUCH_DOLLY_ROTATE)===Pe.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&Pe.ZOOM)===Pe.ZOOM||(this._state&Pe.TOUCH_ZOOM)===Pe.TOUCH_ZOOM||(this._state&Pe.TOUCH_ZOOM_TRUCK)===Pe.TOUCH_ZOOM_TRUCK||(this._state&Pe.TOUCH_ZOOM_OFFSET)===Pe.TOUCH_ZOOM_OFFSET||(this._state&Pe.TOUCH_ZOOM_ROTATE)===Pe.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&Pe.OFFSET)===Pe.OFFSET||(this._state&Pe.TOUCH_OFFSET)===Pe.TOUCH_OFFSET||(this._state&Pe.TOUCH_DOLLY_OFFSET)===Pe.TOUCH_DOLLY_OFFSET||(this._state&Pe.TOUCH_ZOOM_OFFSET)===Pe.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},m=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,Kw(this._activePointers,cs);const E=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,x=E?-E.deltaX:i.x-cs.x,T=E?-E.deltaY:i.y-cs.y;if(i.copy(cs),((this._state&Pe.ROTATE)===Pe.ROTATE||(this._state&Pe.TOUCH_ROTATE)===Pe.TOUCH_ROTATE||(this._state&Pe.TOUCH_DOLLY_ROTATE)===Pe.TOUCH_DOLLY_ROTATE||(this._state&Pe.TOUCH_ZOOM_ROTATE)===Pe.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(x,T),this._isUserControllingRotate=!0),(this._state&Pe.DOLLY)===Pe.DOLLY||(this._state&Pe.ZOOM)===Pe.ZOOM){const O=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,I=this.dollyToCursor?(r.y-this._elementRect.y)/this._elementRect.height*-2+1:0,b=this.dollyDragInverted?-1:1;(this._state&Pe.DOLLY)===Pe.DOLLY?(this._dollyInternal(b*T*J0,O,I),this._isUserControllingDolly=!0):(this._zoomInternal(b*T*J0,O,I),this._isUserControllingZoom=!0)}if((this._state&Pe.TOUCH_DOLLY)===Pe.TOUCH_DOLLY||(this._state&Pe.TOUCH_ZOOM)===Pe.TOUCH_ZOOM||(this._state&Pe.TOUCH_DOLLY_TRUCK)===Pe.TOUCH_DOLLY_TRUCK||(this._state&Pe.TOUCH_ZOOM_TRUCK)===Pe.TOUCH_ZOOM_TRUCK||(this._state&Pe.TOUCH_DOLLY_OFFSET)===Pe.TOUCH_DOLLY_OFFSET||(this._state&Pe.TOUCH_ZOOM_OFFSET)===Pe.TOUCH_ZOOM_OFFSET||(this._state&Pe.TOUCH_DOLLY_ROTATE)===Pe.TOUCH_DOLLY_ROTATE||(this._state&Pe.TOUCH_ZOOM_ROTATE)===Pe.TOUCH_ZOOM_ROTATE){const O=cs.x-this._activePointers[1].clientX,I=cs.y-this._activePointers[1].clientY,b=Math.sqrt(O*O+I*I),R=s.y-b;s.set(0,b);const C=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,M=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&Pe.TOUCH_DOLLY)===Pe.TOUCH_DOLLY||(this._state&Pe.TOUCH_DOLLY_ROTATE)===Pe.TOUCH_DOLLY_ROTATE||(this._state&Pe.TOUCH_DOLLY_TRUCK)===Pe.TOUCH_DOLLY_TRUCK||(this._state&Pe.TOUCH_DOLLY_OFFSET)===Pe.TOUCH_DOLLY_OFFSET?(this._dollyInternal(R*J0,C,M),this._isUserControllingDolly=!0):(this._zoomInternal(R*J0,C,M),this._isUserControllingZoom=!0)}((this._state&Pe.TRUCK)===Pe.TRUCK||(this._state&Pe.TOUCH_TRUCK)===Pe.TOUCH_TRUCK||(this._state&Pe.TOUCH_DOLLY_TRUCK)===Pe.TOUCH_DOLLY_TRUCK||(this._state&Pe.TOUCH_ZOOM_TRUCK)===Pe.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(x,T,!1),this._isUserControllingTruck=!0),((this._state&Pe.OFFSET)===Pe.OFFSET||(this._state&Pe.TOUCH_OFFSET)===Pe.TOUCH_OFFSET||(this._state&Pe.TOUCH_DOLLY_OFFSET)===Pe.TOUCH_DOLLY_OFFSET||(this._state&Pe.TOUCH_ZOOM_OFFSET)===Pe.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(x,T,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},y=()=>{Kw(this._activePointers,cs),i.copy(cs),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",A),this._domElement.ownerDocument.addEventListener("pointerlockerror",_),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",l),p())},this.unlockPointer=()=>{var g,E,x;this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),(g=this._domElement)===null||g===void 0||g.ownerDocument.exitPointerLock(),(E=this._domElement)===null||E===void 0||E.ownerDocument.removeEventListener("pointerlockchange",A),(x=this._domElement)===null||x===void 0||x.ownerDocument.removeEventListener("pointerlockerror",_),this.cancel()};const A=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},_=()=>{this.unlockPointer()};this._addAllEventListeners=g=>{this._domElement=g,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",o),this._domElement.addEventListener("pointercancel",l),this._domElement.addEventListener("wheel",u,{passive:!1}),this._domElement.addEventListener("contextmenu",f)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",o),this._domElement.removeEventListener("pointercancel",l),this._domElement.removeEventListener("wheel",u,{passive:!1}),this._domElement.removeEventListener("contextmenu",f),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.removeEventListener("pointerlockchange",A),this._domElement.ownerDocument.removeEventListener("pointerlockerror",_))},this.cancel=()=>{this._state!==Pe.NONE&&(this._state=Pe.NONE,this._activePointers.length=0,y())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=Lo(e.width,0,1),this._interactiveArea.height=Lo(e.height,0,1),this._interactiveArea.x=Lo(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=Lo(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,r=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,r)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,r=!1){this._isUserControllingRotate=!1;const i=Lo(e,this.minAzimuthAngle,this.maxAzimuthAngle),s=Lo(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=i,this._sphericalEnd.phi=s,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,r||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const o=!r||Mn(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Mn(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=xf.NONE,this._changedDolly=0,this._dollyToNoClamp(Lo(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const r=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const o=this._collisionTest(),a=Mn(o,this._spherical.radius);if(!(r>e)&&a)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,o)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const s=!t||Mn(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(s)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(gm).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const r=!t||Mn(this._target.x,this._targetEnd.x,this.restThreshold)&&Mn(this._target.y,this._targetEnd.y,this.restThreshold)&&Mn(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=Lo(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const r=!t||Mn(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(r)}pan(e,t,r=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,r)}truck(e,t,r=!1){this._camera.updateMatrix(),ha.setFromMatrixColumn(this._camera.matrix,0),fa.setFromMatrixColumn(this._camera.matrix,1),ha.multiplyScalar(e),fa.multiplyScalar(-t);const i=Zt.copy(ha).add(fa),s=Tn.copy(this._targetEnd).add(i);return this.moveTo(s.x,s.y,s.z,r)}forward(e,t=!1){Zt.setFromMatrixColumn(this._camera.matrix,0),Zt.crossVectors(this._camera.up,Zt),Zt.multiplyScalar(e);const r=Tn.copy(this._targetEnd).add(Zt);return this.moveTo(r.x,r.y,r.z,t)}elevate(e,t=!1){return Zt.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+Zt.x,this._targetEnd.y+Zt.y,this._targetEnd.z+Zt.z,t)}moveTo(e,t,r,i=!1){this._isUserControllingTruck=!1;const s=Zt.set(e,t,r).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,s,this.boundaryFriction),this._needsUpdate=!0,i||this._target.copy(this._targetEnd);const o=!i||Mn(this._target.x,this._targetEnd.x,this.restThreshold)&&Mn(this._target.y,this._targetEnd.y,this.restThreshold)&&Mn(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}lookInDirectionOf(e,t,r,i=!1){const a=Zt.set(e,t,r).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(a.x,a.y,a.z,i)}fitToBox(e,t,{cover:r=!1,paddingLeft:i=0,paddingRight:s=0,paddingBottom:o=0,paddingTop:a=0}={}){const l=[],c=e.isBox3?Sf.copy(e):Sf.setFromObject(e);c.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const u=TB(this._sphericalEnd.theta,SB),f=TB(this._sphericalEnd.phi,SB);l.push(this.rotateTo(u,f,t));const p=Zt.setFromSpherical(this._sphericalEnd).normalize(),m=PB.setFromUnitVectors(p,qw),y=Mn(Math.abs(p.y),1);y&&m.multiply(Zw.setFromAxisAngle(Y0,u)),m.multiply(this._yAxisUpSpaceInverse);const A=IB.makeEmpty();Tn.copy(c.min).applyQuaternion(m),A.expandByPoint(Tn),Tn.copy(c.min).setX(c.max.x).applyQuaternion(m),A.expandByPoint(Tn),Tn.copy(c.min).setY(c.max.y).applyQuaternion(m),A.expandByPoint(Tn),Tn.copy(c.max).setZ(c.min.z).applyQuaternion(m),A.expandByPoint(Tn),Tn.copy(c.min).setZ(c.max.z).applyQuaternion(m),A.expandByPoint(Tn),Tn.copy(c.max).setY(c.min.y).applyQuaternion(m),A.expandByPoint(Tn),Tn.copy(c.max).setX(c.min.x).applyQuaternion(m),A.expandByPoint(Tn),Tn.copy(c.max).applyQuaternion(m),A.expandByPoint(Tn),A.min.x-=i,A.min.y-=o,A.max.x+=s,A.max.y+=a,m.setFromUnitVectors(qw,p),y&&m.premultiply(Zw.invert()),m.premultiply(this._yAxisUpSpace);const _=A.getSize(Zt),g=A.getCenter(Tn).applyQuaternion(m);if(Tu(this._camera)){const E=this.getDistanceToFitBox(_.x,_.y,_.z,r);l.push(this.moveTo(g.x,g.y,g.z,t)),l.push(this.dollyTo(E,t)),l.push(this.setFocalOffset(0,0,0,t))}else if(tc(this._camera)){const E=this._camera,x=E.right-E.left,T=E.top-E.bottom,O=r?Math.max(x/_.x,T/_.y):Math.min(x/_.x,T/_.y);l.push(this.moveTo(g.x,g.y,g.z,t)),l.push(this.zoomTo(O,t)),l.push(this.setFocalOffset(0,0,0,t))}return Promise.all(l)}fitToSphere(e,t){const r=[],s=e instanceof Ut.Sphere?Qw.copy(e):RC.createBoundingSphere(e,Qw);if(r.push(this.moveTo(s.center.x,s.center.y,s.center.z,t)),Tu(this._camera)){const o=this.getDistanceToFitSphere(s.radius);r.push(this.dollyTo(o,t))}else if(tc(this._camera)){const o=this._camera.right-this._camera.left,a=this._camera.top-this._camera.bottom,l=2*s.radius,c=Math.min(o/l,a/l);r.push(this.zoomTo(c,t))}return r.push(this.setFocalOffset(0,0,0,t)),Promise.all(r)}setLookAt(e,t,r,i,s,o,a=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=xf.NONE,this._changedDolly=0;const l=Tn.set(i,s,o),c=Zt.set(e,t,r);this._targetEnd.copy(l),this._sphericalEnd.setFromVector3(c.sub(l).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,a||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const u=!a||Mn(this._target.x,this._targetEnd.x,this.restThreshold)&&Mn(this._target.y,this._targetEnd.y,this.restThreshold)&&Mn(this._target.z,this._targetEnd.z,this.restThreshold)&&Mn(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Mn(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Mn(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(u)}lerpLookAt(e,t,r,i,s,o,a,l,c,u,f,p,m,y=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=xf.NONE,this._changedDolly=0;const A=Zt.set(i,s,o),_=Tn.set(e,t,r);so.setFromVector3(_.sub(A).applyQuaternion(this._yAxisUpSpace));const g=wf.set(u,f,p),E=Tn.set(a,l,c);ym.setFromVector3(E.sub(g).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(A.lerp(g,m));const x=ym.theta-so.theta,T=ym.phi-so.phi,O=ym.radius-so.radius;this._sphericalEnd.set(so.radius+O*m,so.phi+T*m,so.theta+x*m),this.normalizeRotations(),this._needsUpdate=!0,y||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const I=!y||Mn(this._target.x,this._targetEnd.x,this.restThreshold)&&Mn(this._target.y,this._targetEnd.y,this.restThreshold)&&Mn(this._target.z,this._targetEnd.z,this.restThreshold)&&Mn(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Mn(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Mn(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(I)}setPosition(e,t,r,i=!1){return this.setLookAt(e,t,r,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,i)}setTarget(e,t,r,i=!1){const s=this.getPosition(Zt),o=this.setLookAt(s.x,s.y,s.z,e,t,r,i);return this._sphericalEnd.phi=Lo(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(e,t,r,i=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,r),this._needsUpdate=!0,i||this._focalOffset.copy(this._focalOffsetEnd);const s=!i||Mn(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&Mn(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&Mn(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}setOrbitPoint(e,t,r){this._camera.updateMatrixWorld(),ha.setFromMatrixColumn(this._camera.matrixWorldInverse,0),fa.setFromMatrixColumn(this._camera.matrixWorldInverse,1),Cu.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const i=Zt.set(e,t,r),s=i.distanceTo(this._camera.position),o=i.sub(this._camera.position);ha.multiplyScalar(o.x),fa.multiplyScalar(o.y),Cu.multiplyScalar(o.z),Zt.copy(ha).add(fa).add(Cu),Zt.z=Zt.z+s,this.dollyTo(s,!1),this.setFocalOffset(-Zt.x,Zt.y,-Zt.z,!1),this.moveTo(e,t,r,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,r,i){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new Ut.Vector4,typeof e=="number"?this._viewport.set(e,t,r,i):this._viewport.copy(e)}getDistanceToFitBox(e,t,r,i=!1){if(Jw(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const s=e/t,o=this._camera.getEffectiveFOV()*dm,a=this._camera.aspect;return((i?s>a:s<a)?t:e/a)*.5/Math.tan(o*.5)+r*.5}getDistanceToFitSphere(e){if(Jw(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*dm,r=Math.atan(Math.tan(t*.5)*this._camera.aspect)*2,i=1<this._camera.aspect?t:r;return e/Math.sin(i*.5)}getTarget(e,t=!0){return(e&&e.isVector3?e:new Ut.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new Ut.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e&&e instanceof Ut.Spherical?e:new Ut.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new Ut.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%Af,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=Af),this._spherical.theta+=Af*Math.round((this._sphericalEnd.theta-this._spherical.theta)/Af)}reset(e=!1){if(!Mn(this._camera.up.x,this._cameraUp0.x)||!Mn(this._camera.up.y,this._cameraUp0.y)||!Mn(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const r=this.getPosition(Zt);this.updateCameraUp(),this.setPosition(r.x,r.y,r.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,Y0),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=Zt.subVectors(this._target,this._camera.position).normalize(),t=Tn.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const r=this.getPosition(Zt);this.updateCameraUp(),this.setPosition(r.x,r.y,r.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,r=this._sphericalEnd.phi-this._spherical.phi,i=this._sphericalEnd.radius-this._spherical.radius,s=MB.subVectors(this._targetEnd,this._target),o=RB.subVectors(this._focalOffsetEnd,this._focalOffset),a=this._zoomEnd-this._zoom;if(Gn(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const f=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=K0(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,f,1/0,e),this._needsUpdate=!0}if(Gn(r))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const f=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=K0(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,f,1/0,e),this._needsUpdate=!0}if(Gn(i))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const f=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=K0(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,f,this.maxSpeed,e),this._needsUpdate=!0}if(Gn(s.x)&&Gn(s.y)&&Gn(s.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const f=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;CB(this._target,this._targetEnd,this._targetVelocity,f,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(Gn(o.x)&&Gn(o.y)&&Gn(o.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const f=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;CB(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,f,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(Gn(a))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const f=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=K0(this._zoom,this._zoomEnd,this._zoomVelocity,f,1/0,e)}if(this.dollyToCursor){if(Tu(this._camera)&&this._changedDolly!==0){const f=this._spherical.radius-this._lastDistance,p=this._camera,m=this._getCameraDirection(gm),y=Zt.copy(m).cross(p.up).normalize();y.lengthSq()===0&&(y.x=1);const A=Tn.crossVectors(y,m),_=this._sphericalEnd.radius*Math.tan(p.getEffectiveFOV()*dm*.5),E=(this._sphericalEnd.radius-f-this._sphericalEnd.radius)/this._sphericalEnd.radius,x=wf.copy(this._targetEnd).add(y.multiplyScalar(this._dollyControlCoord.x*_*p.aspect)).add(A.multiplyScalar(this._dollyControlCoord.y*_)),T=Zt.copy(this._targetEnd).lerp(x,E),O=this._lastDollyDirection===xf.IN&&this._spherical.radius<=this.minDistance,I=this._lastDollyDirection===xf.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(O||I)){this._sphericalEnd.radius-=f,this._spherical.radius-=f;const R=Tn.copy(m).multiplyScalar(-f);T.add(R)}this._boundary.clampPoint(T,T);const b=Tn.subVectors(T,this._targetEnd);this._targetEnd.copy(T),this._target.add(b),this._changedDolly-=f,Gn(this._changedDolly)&&(this._changedDolly=0)}else if(tc(this._camera)&&this._changedZoom!==0){const f=this._zoom-this._lastZoom,p=this._camera,m=Zt.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(p.near+p.far)/(p.near-p.far)).unproject(p),y=Tn.set(0,0,-1).applyQuaternion(p.quaternion),A=wf.copy(m).add(y.multiplyScalar(-m.dot(p.up))),g=-(this._zoom-f-this._zoom)/this._zoom,E=this._getCameraDirection(gm),x=this._targetEnd.dot(E),T=Zt.copy(this._targetEnd).lerp(A,g),O=T.dot(E),I=E.multiplyScalar(O-x);T.sub(I),this._boundary.clampPoint(T,T);const b=Tn.subVectors(T,this._targetEnd);this._targetEnd.copy(T),this._target.add(b),this._changedZoom-=f,Gn(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const l=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,l),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!Gn(this._focalOffset.x)||!Gn(this._focalOffset.y)||!Gn(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),ha.setFromMatrixColumn(this._camera.matrix,0),fa.setFromMatrixColumn(this._camera.matrix,1),Cu.setFromMatrixColumn(this._camera.matrix,2),ha.multiplyScalar(this._focalOffset.x),fa.multiplyScalar(-this._focalOffset.y),Cu.multiplyScalar(this._focalOffset.z),Zt.copy(ha).add(fa).add(Cu),this._camera.position.add(Zt)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),Zt.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const u=this._needsUpdate;return u&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):u?(this.dispatchEvent({type:"update"}),Gn(t,this.restThreshold)&&Gn(r,this.restThreshold)&&Gn(i,this.restThreshold)&&Gn(s.x,this.restThreshold)&&Gn(s.y,this.restThreshold)&&Gn(s.z,this.restThreshold)&&Gn(o.x,this.restThreshold)&&Gn(o.y,this.restThreshold)&&Gn(o.z,this.restThreshold)&&Gn(a,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!u&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=u,this._needsUpdate=!1,u}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:pm(this.maxDistance),minZoom:this.minZoom,maxZoom:pm(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:pm(this.maxPolarAngle),minAzimuthAngle:pm(this.minAzimuthAngle),maxAzimuthAngle:pm(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:Zt.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const r=JSON.parse(e);this.enabled=r.enabled,this.minDistance=r.minDistance,this.maxDistance=mm(r.maxDistance),this.minZoom=r.minZoom,this.maxZoom=mm(r.maxZoom),this.minPolarAngle=r.minPolarAngle,this.maxPolarAngle=mm(r.maxPolarAngle),this.minAzimuthAngle=mm(r.minAzimuthAngle),this.maxAzimuthAngle=mm(r.maxAzimuthAngle),this.smoothTime=r.smoothTime,this.draggingSmoothTime=r.draggingSmoothTime,this.dollySpeed=r.dollySpeed,this.truckSpeed=r.truckSpeed,this.dollyToCursor=r.dollyToCursor,this.verticalDragToForward=r.verticalDragToForward,this._target0.fromArray(r.target0),this._position0.fromArray(r.position0),this._zoom0=r.zoom0,this._focalOffset0.fromArray(r.focalOffset0),this.moveTo(r.target[0],r.target[1],r.target[2],t),so.setFromVector3(Zt.fromArray(r.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(so.theta,so.phi,t),this.dollyTo(so.radius,t),this.zoomTo(r.zoom,t),this.setFocalOffset(r.focalOffset[0],r.focalOffset[1],r.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",lce),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,r){const i=t.lengthSq();if(i===0)return e;const s=Tn.copy(t).add(e),a=this._boundary.clampPoint(s,wf).sub(s),l=a.lengthSq();if(l===0)return e.add(t);if(l===i)return e;if(r===0)return e.add(t).add(a);{const c=1+r*l/t.dot(a);return e.add(Tn.copy(t).multiplyScalar(c)).add(a.multiplyScalar(1-r))}}_updateNearPlaneCorners(){if(Tu(this._camera)){const e=this._camera,t=e.near,r=e.getEffectiveFOV()*dm,i=Math.tan(r*.5)*t,s=i*e.aspect;this._nearPlaneCorners[0].set(-s,-i,0),this._nearPlaneCorners[1].set(s,-i,0),this._nearPlaneCorners[2].set(s,i,0),this._nearPlaneCorners[3].set(-s,i,0)}else if(tc(this._camera)){const e=this._camera,t=1/e.zoom,r=e.left*t,i=e.right*t,s=e.top*t,o=e.bottom*t;this._nearPlaneCorners[0].set(r,s,0),this._nearPlaneCorners[1].set(i,s,0),this._nearPlaneCorners[2].set(i,o,0),this._nearPlaneCorners[3].set(r,o,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||Jw(this._camera,"_collisionTest"))return e;const r=this._getTargetDirection(gm);eS.lookAt(bB,r,this._camera.up);for(let i=0;i<4;i++){const s=Tn.copy(this._nearPlaneCorners[i]);s.applyMatrix4(eS);const o=wf.addVectors(this._target,s);q0.set(o,r),q0.far=this._spherical.radius+1;const a=q0.intersectObjects(this.colliderMeshes);a.length!==0&&a[0].distance<e&&(e=a[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{const r=()=>{this.removeEventListener("rest",r),t()};this.addEventListener("rest",r)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new Ut.Sphere){const r=t,i=r.center;Sf.makeEmpty(),e.traverseVisible(o=>{o.isMesh&&Sf.expandByObject(o)}),Sf.getCenter(i);let s=0;return e.traverseVisible(o=>{if(!o.isMesh)return;const a=o,l=a.geometry.clone();l.applyMatrix4(a.matrixWorld);const u=l.attributes.position;for(let f=0,p=u.count;f<p;f++)Zt.fromBufferAttribute(u,f),s=Math.max(s,i.distanceToSquared(Zt))}),r.radius=Math.sqrt(s),r}};const uce=D.forwardRef((n,e)=>{D.useMemo(()=>{const O={Box3:gi,MathUtils:{clamp:Ux.clamp},Matrix4:Bt,Quaternion:mi,Raycaster:aA,Sphere:ni,Spherical:eV,Vector2:Be,Vector3:J,Vector4:In};tS.install({THREE:O}),kR({CameraControlsImpl:tS})},[]);const{camera:t,domElement:r,makeDefault:i,onStart:s,onEnd:o,onChange:a,regress:l,...c}=n,u=Ds(O=>O.camera),f=Ds(O=>O.gl),p=Ds(O=>O.invalidate),m=Ds(O=>O.events),y=Ds(O=>O.setEvents),A=Ds(O=>O.set),_=Ds(O=>O.get),g=Ds(O=>O.performance),E=t||u,x=r||m.connected||f.domElement,T=D.useMemo(()=>new tS(E),[E]);return My((O,I)=>{T.enabled&&T.update(I)},-1),D.useEffect(()=>(T.connect(x),()=>void T.disconnect()),[x,T]),D.useEffect(()=>{const O=R=>{p(),l&&g.regress(),a&&a(R)},I=R=>{s&&s(R)},b=R=>{o&&o(R)};return T.addEventListener("update",O),T.addEventListener("controlstart",I),T.addEventListener("controlend",b),T.addEventListener("control",O),T.addEventListener("transitionstart",O),T.addEventListener("wake",O),()=>{T.removeEventListener("update",O),T.removeEventListener("controlstart",I),T.removeEventListener("controlend",b),T.removeEventListener("control",O),T.removeEventListener("transitionstart",O),T.removeEventListener("wake",O)}},[T,s,o,p,y,l,a]),D.useEffect(()=>{if(i){const O=_().controls;return A({controls:T}),()=>A({controls:O})}},[i,T]),D.createElement("primitive",sr({ref:e,object:T},c))});function hce(n,e){const t=D.useRef(),[r]=D.useState(()=>e?e instanceof dn?{current:e}:e:t),[i]=D.useState(()=>new ZH(void 0));D.useLayoutEffect(()=>{e&&(r.current=e instanceof dn?e:e.current),i._root=r.current});const s=D.useRef({}),o=D.useMemo(()=>{const a={};return n.forEach(l=>Object.defineProperty(a,l.name,{enumerable:!0,get(){if(r.current)return s.current[l.name]||(s.current[l.name]=i.clipAction(l,r.current))},configurable:!0})),{ref:r,clips:n,actions:a,names:n.map(l=>l.name),mixer:i}},[n]);return My((a,l)=>i.update(l)),D.useEffect(()=>{const a=r.current;return()=>{s.current={},i.stopAllAction(),Object.values(o.actions).forEach(l=>{a&&i.uncacheAction(l,a)})}},[n]),o}var GV={exports:{}},fce="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",dce=fce,pce=dce;function WV(){}function $V(){}$V.resetWarningCache=WV;var mce=function(){function n(r,i,s,o,a,l){if(l!==pce){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:$V,resetWarningCache:WV};return t.PropTypes=t,t};GV.exports=mce();var gce=GV.exports;const Vn=Vd(gce),nS={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},yce="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",DB=n=>Array.isArray(n);function jV({files:n=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:e="",preset:t=void 0,encoding:r=void 0,extensions:i}={}){var s;let o=null,a=!1,l;if(t){if(!(t in nS))throw new Error("Preset must be one of: "+Object.keys(nS).join(", "));n=nS[t],e=yce}if(a=DB(n),l=DB(n)?"cube":n.startsWith("data:application/exr")?"exr":n.startsWith("data:application/hdr")?"hdr":(s=n.split(".").pop())==null||(s=s.split("?"))==null||(s=s.shift())==null?void 0:s.toLowerCase(),o=a?zH:l==="hdr"?rce:l==="exr"?ice:null,!o)throw new Error("useEnvironment: Unrecognized file extension: "+n);const c=op(o,a?[n]:n,m=>{m.setPath==null||m.setPath(e),i&&i(m)}),u=a?c[0]:c;u.mapping=a?Ra:bd;const f=3001,p=3e3;return"colorSpace"in u?u.colorSpace=r??a?"srgb":"srgb-linear":u.encoding=r??a?f:p,u}const vce=n=>n.current&&n.current.isScene,_ce=n=>vce(n)?n.current:n;function GR(n,e,t,r,i=0){const s=_ce(e||t),o=s.background,a=s.environment,l=s.backgroundBlurriness||0;return n!=="only"&&(s.environment=r),n&&(s.background=r),n&&s.backgroundBlurriness!==void 0&&(s.backgroundBlurriness=i),()=>{n!=="only"&&(s.environment=a),n&&(s.background=o),n&&s.backgroundBlurriness!==void 0&&(s.backgroundBlurriness=l)}}function WR({scene:n,background:e=!1,blur:t,map:r}){const i=Ds(s=>s.scene);return D.useLayoutEffect(()=>{if(r)return GR(e,n,i,r,t)},[i,n,r,e,t]),null}function XV({background:n=!1,scene:e,blur:t,...r}){const i=jV(r),s=Ds(o=>o.scene);return D.useLayoutEffect(()=>GR(n,e,s,i,t),[i,n,e,s,t]),null}function Ece({children:n,near:e=1,far:t=1e3,resolution:r=256,frames:i=1,map:s,background:o=!1,blur:a,scene:l,files:c,path:u,preset:f=void 0,extensions:p}){const m=Ds(x=>x.gl),y=Ds(x=>x.scene),A=D.useRef(null),[_]=D.useState(()=>new Bg),g=D.useMemo(()=>{const x=new sR(r);return x.texture.type=Qi,x},[r]);D.useLayoutEffect(()=>(i===1&&A.current.update(m,_),GR(o,l,y,g.texture,a)),[n,_,g.texture,l,y,o,i,m]);let E=1;return My(()=>{(i===1/0||E<i)&&(A.current.update(m,_),E++)}),D.createElement(D.Fragment,null,Noe(D.createElement(D.Fragment,null,n,D.createElement("cubeCamera",{ref:A,args:[e,t,g]}),c||f?D.createElement(XV,{background:!0,files:c,preset:f,path:u,extensions:p}):s?D.createElement(WR,{background:!0,map:s,extensions:p}):null),_))}function xce(n){var e,t,r,i;const s=jV(n),o=n.map||s;D.useMemo(()=>kR({GroundProjectedEnvImpl:Sle}),[]);const a=D.useMemo(()=>[o],[o]),l=(e=n.ground)==null?void 0:e.height,c=(t=n.ground)==null?void 0:t.radius,u=(r=(i=n.ground)==null?void 0:i.scale)!==null&&r!==void 0?r:1e3;return D.createElement(D.Fragment,null,D.createElement(WR,sr({},n,{map:o})),D.createElement("groundProjectedEnvImpl",{args:a,scale:u,height:l,radius:c}))}function Ace(n){return n.ground?D.createElement(xce,n):n.map?D.createElement(WR,n):n.children?D.createElement(Ece,n):D.createElement(XV,n)}function wce(n,e){typeof n=="function"?n(e):n!=null&&(n.current=e)}function KV(...n){return e=>n.forEach(t=>wce(t,e))}function ap(...n){return D.useCallback(KV(...n),n)}const JV=D.forwardRef((n,e)=>{const{children:t,...r}=n,i=D.Children.toArray(t),s=i.find(Sce);if(s){const o=s.props.children,a=i.map(l=>l===s?D.Children.count(o)>1?D.Children.only(null):D.isValidElement(o)?o.props.children:null:l);return D.createElement(IC,sr({},r,{ref:e}),D.isValidElement(o)?D.cloneElement(o,void 0,a):null)}return D.createElement(IC,sr({},r,{ref:e}),t)});JV.displayName="Slot";const IC=D.forwardRef((n,e)=>{const{children:t,...r}=n;return D.isValidElement(t)?D.cloneElement(t,{...Tce(r,t.props),ref:e?KV(e,t.ref):t.ref}):D.Children.count(t)>1?D.Children.only(null):null});IC.displayName="SlotClone";const YV=({children:n})=>D.createElement(D.Fragment,null,n);function Sce(n){return D.isValidElement(n)&&n.type===YV}function Tce(n,e){const t={...e};for(const r in e){const i=n[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?t[r]=(...a)=>{s(...a),i(...a)}:i&&(t[r]=i):r==="style"?t[r]={...i,...s}:r==="className"&&(t[r]=[i,s].filter(Boolean).join(" "))}return{...n,...t}}const Cce=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ph=Cce.reduce((n,e)=>{const t=D.forwardRef((r,i)=>{const{asChild:s,...o}=r,a=s?JV:e;return D.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),D.createElement(a,sr({},o,{ref:i}))});return t.displayName=`Primitive.${e}`,{...n,[e]:t}},{});function bce(n,e){n&&Qg.flushSync(()=>n.dispatchEvent(e))}const Mce=D.forwardRef((n,e)=>{var t;const{container:r=globalThis==null||(t=globalThis.document)===null||t===void 0?void 0:t.body,...i}=n;return r?aF.createPortal(D.createElement(Ph.div,sr({},i,{ref:e})),r):null}),Rce=Mce;var LB=Object.prototype.hasOwnProperty;function Vg(n,e){var t,r;if(n===e)return!0;if(n&&e&&(t=n.constructor)===e.constructor){if(t===Date)return n.getTime()===e.getTime();if(t===RegExp)return n.toString()===e.toString();if(t===Array){if((r=n.length)===e.length)for(;r--&&Vg(n[r],e[r]););return r===-1}if(!t||typeof n=="object"){r=0;for(t in n)if(LB.call(n,t)&&++r&&!LB.call(e,t)||!(t in e)||!Vg(n[t],e[t]))return!1;return Object.keys(e).length===r}}return n!==n&&e!==e}var uA=function(e,t,r,i){this.name=e,this.fn=t,this.args=r,this.modifiers=i};uA.prototype._test=function(e){var t=this.fn;try{fd(this.modifiers.slice(),t,this)(e)}catch{t=function(){return!1}}try{return fd(this.modifiers.slice(),t,this)(e)}catch{return!1}};uA.prototype._check=function(e){try{fd(this.modifiers.slice(),this.fn,this)(e)}catch{if(fd(this.modifiers.slice(),function(r){return r},this)(!1))return}if(!fd(this.modifiers.slice(),this.fn,this)(e))throw null};uA.prototype._testAsync=function(e){var t=this;return new Promise(function(r,i){QV(t.modifiers.slice(),t.fn,t)(e).then(function(s){s?r(e):i(null)}).catch(function(s){return i(s)})})};function qV(n,e){return e===void 0&&(e="simple"),typeof n=="object"?n[e]:n}function fd(n,e,t){if(n.length){var r=n.shift(),i=fd(n,e,t);return r.perform(i,t)}else return qV(e)}function QV(n,e,t){if(n.length){var r=n.shift(),i=QV(n,e,t);return r.performAsync(i,t)}else return function(s){return Promise.resolve(qV(e,"async")(s))}}var Ice=function(e,t,r){this.name=e,this.perform=t,this.performAsync=r},$R=function(n){function e(t,r,i,s){for(var o=[],a=arguments.length-4;a-- >0;)o[a]=arguments[a+4];n.call(this,o),n.captureStackTrace&&n.captureStackTrace(this,e),this.rule=t,this.value=r,this.cause=i,this.target=s}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e}(Error),Da=function(e,t){e===void 0&&(e=[]),t===void 0&&(t=[]),this.chain=e,this.nextRuleModifiers=t};Da.prototype._applyRule=function(e,t){var r=this;return function(){for(var i=[],s=arguments.length;s--;)i[s]=arguments[s];return r.chain.push(new uA(t,e.apply(r,i),i,r.nextRuleModifiers)),r.nextRuleModifiers=[],r}};Da.prototype._applyModifier=function(e,t){return this.nextRuleModifiers.push(new Ice(t,e.simple,e.async)),this};Da.prototype._clone=function(){return new Da(this.chain.slice(),this.nextRuleModifiers.slice())};Da.prototype.test=function(e){return this.chain.every(function(t){return t._test(e)})};Da.prototype.testAll=function(e){var t=[];return this.chain.forEach(function(r){try{r._check(e)}catch(i){t.push(new $R(r,e,i))}}),t};Da.prototype.check=function(e){this.chain.forEach(function(t){try{t._check(e)}catch(r){throw new $R(t,e,r)}})};Da.prototype.testAsync=function(e){var t=this;return new Promise(function(r,i){ZV(e,t.chain.slice(),r,i)})};function ZV(n,e,t,r){if(e.length){var i=e.shift();i._testAsync(n).then(function(){ZV(n,e,t,r)},function(s){r(new $R(i,n,s))})}else t(n)}var OB=function(n,e){return e&&typeof n=="string"&&n.trim().length===0?!0:n==null};function Pce(n,e){return e===void 0&&(e=!1),{simple:function(t){return OB(t,e)||n.check(t)===void 0},async:function(t){return OB(t,e)||n.testAsync(t)}}}function ys(){return typeof Proxy<"u"?e5(new Da):PC(new Da)}var Gg={};ys.extend=function(n){Object.assign(Gg,n)};ys.clearCustomRules=function(){Gg={}};function e5(n){return new Proxy(n,{get:function(t,r){if(r in t)return t[r];var i=e5(n._clone());if(r in FE)return i._applyModifier(FE[r],r);if(r in Gg)return i._applyRule(Gg[r],r);if(r in DC)return i._applyRule(DC[r],r)}})}function PC(n){var e=function(i,s){return Object.keys(i).forEach(function(o){s[o]=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var c=PC(s._clone()),u=c._applyRule(i[o],o).apply(void 0,a);return u}}),s},t=e(DC,n),r=e(Gg,t);return Object.keys(FE).forEach(function(i){Object.defineProperty(r,i,{get:function(){var s=PC(r._clone());return s._applyModifier(FE[i],i)}})}),r}var FE={not:{simple:function(n){return function(e){return!n(e)}},async:function(n){return function(e){return Promise.resolve(n(e)).then(function(t){return!t}).catch(function(){return!0})}}},some:{simple:function(n){return function(e){return Q0(e).some(function(t){try{return n(t)}catch{return!1}})}},async:function(n){return function(e){return Promise.all(Q0(e).map(function(t){try{return n(t).catch(function(){return!1})}catch{return!1}})).then(function(t){return t.some(Boolean)})}}},every:{simple:function(n){return function(e){return e!==!1&&Q0(e).every(n)}},async:function(n){return function(e){return Promise.all(Q0(e).map(n)).then(function(t){return t.every(Boolean)})}}},strict:{simple:function(n,e){return function(t){return BB(e)&&t&&typeof t=="object"?Object.keys(e.args[0]).length===Object.keys(t).length&&n(t):n(t)}},async:function(n,e){return function(t){return Promise.resolve(n(t)).then(function(r){return BB(e)&&t&&typeof t=="object"?Object.keys(e.args[0]).length===Object.keys(t).length&&r:r}).catch(function(){return!1})}}}};function BB(n){return n&&n.name==="schema"&&n.args.length>0&&typeof n.args[0]=="object"}function Q0(n){return typeof n=="string"?n.split(""):n}var DC={equal:function(n){return function(e){return e==n}},exact:function(n){return function(e){return e===n}},number:function(n){return n===void 0&&(n=!0),function(e){return typeof e=="number"&&(n||isFinite(e))}},integer:function(){return function(n){var e=Number.isInteger||Dce;return e(n)}},numeric:function(){return function(n){return!isNaN(parseFloat(n))&&isFinite(n)}},string:function(){return Tf("string")},boolean:function(){return Tf("boolean")},undefined:function(){return Tf("undefined")},null:function(){return Tf("null")},array:function(){return Tf("array")},object:function(){return Tf("object")},instanceOf:function(n){return function(e){return e instanceof n}},pattern:function(n){return function(e){return n.test(e)}},lowercase:function(){return function(n){return typeof n=="boolean"||n===n.toLowerCase()&&n.trim()!==""}},uppercase:function(){return function(n){return n===n.toUpperCase()&&n.trim()!==""}},vowel:function(){return function(n){return/^[aeiou]+$/i.test(n)}},consonant:function(){return function(n){return/^(?=[^aeiou])([a-z]+)$/i.test(n)}},first:function(n){return function(e){return e[0]==n}},last:function(n){return function(e){return e[e.length-1]==n}},empty:function(){return function(n){return n.length===0}},length:function(n,e){return function(t){return t.length>=n&&t.length<=(e||n)}},minLength:function(n){return function(e){return e.length>=n}},maxLength:function(n){return function(e){return e.length<=n}},negative:function(){return function(n){return n<0}},positive:function(){return function(n){return n>=0}},between:function(n,e){return function(t){return t>=n&&t<=e}},range:function(n,e){return function(t){return t>=n&&t<=e}},lessThan:function(n){return function(e){return e<n}},lessThanOrEqual:function(n){return function(e){return e<=n}},greaterThan:function(n){return function(e){return e>n}},greaterThanOrEqual:function(n){return function(e){return e>=n}},even:function(){return function(n){return n%2===0}},odd:function(){return function(n){return n%2!==0}},includes:function(n){return function(e){return~e.indexOf(n)}},schema:function(n){return Lce(n)},passesAnyOf:function(){for(var n=[],e=arguments.length;e--;)n[e]=arguments[e];return function(t){return n.some(function(r){return r.test(t)})}},optional:Pce};function Tf(n){return function(e){return Array.isArray(e)&&n==="array"||e===null&&n==="null"||typeof e===n}}function Dce(n){return typeof n=="number"&&isFinite(n)&&Math.floor(n)===n}function Lce(n){return{simple:function(e){var t=[];if(Object.keys(n).forEach(function(r){var i=n[r];try{i.check((e||{})[r])}catch(s){s.target=r,t.push(s)}}),t.length>0)throw t;return!0},async:function(e){var t=[],r=Object.keys(n).map(function(i){var s=n[i];return s.testAsync((e||{})[i]).catch(function(o){o.target=i,t.push(o)})});return Promise.all(r).then(function(){if(t.length>0)throw t;return!0})}}}var Nn="colors",Ki="sizes",mt="space",Oce={gap:mt,gridGap:mt,columnGap:mt,gridColumnGap:mt,rowGap:mt,gridRowGap:mt,inset:mt,insetBlock:mt,insetBlockEnd:mt,insetBlockStart:mt,insetInline:mt,insetInlineEnd:mt,insetInlineStart:mt,margin:mt,marginTop:mt,marginRight:mt,marginBottom:mt,marginLeft:mt,marginBlock:mt,marginBlockEnd:mt,marginBlockStart:mt,marginInline:mt,marginInlineEnd:mt,marginInlineStart:mt,padding:mt,paddingTop:mt,paddingRight:mt,paddingBottom:mt,paddingLeft:mt,paddingBlock:mt,paddingBlockEnd:mt,paddingBlockStart:mt,paddingInline:mt,paddingInlineEnd:mt,paddingInlineStart:mt,top:mt,right:mt,bottom:mt,left:mt,scrollMargin:mt,scrollMarginTop:mt,scrollMarginRight:mt,scrollMarginBottom:mt,scrollMarginLeft:mt,scrollMarginX:mt,scrollMarginY:mt,scrollMarginBlock:mt,scrollMarginBlockEnd:mt,scrollMarginBlockStart:mt,scrollMarginInline:mt,scrollMarginInlineEnd:mt,scrollMarginInlineStart:mt,scrollPadding:mt,scrollPaddingTop:mt,scrollPaddingRight:mt,scrollPaddingBottom:mt,scrollPaddingLeft:mt,scrollPaddingX:mt,scrollPaddingY:mt,scrollPaddingBlock:mt,scrollPaddingBlockEnd:mt,scrollPaddingBlockStart:mt,scrollPaddingInline:mt,scrollPaddingInlineEnd:mt,scrollPaddingInlineStart:mt,fontSize:"fontSizes",background:Nn,backgroundColor:Nn,backgroundImage:Nn,borderImage:Nn,border:Nn,borderBlock:Nn,borderBlockEnd:Nn,borderBlockStart:Nn,borderBottom:Nn,borderBottomColor:Nn,borderColor:Nn,borderInline:Nn,borderInlineEnd:Nn,borderInlineStart:Nn,borderLeft:Nn,borderLeftColor:Nn,borderRight:Nn,borderRightColor:Nn,borderTop:Nn,borderTopColor:Nn,caretColor:Nn,color:Nn,columnRuleColor:Nn,fill:Nn,outline:Nn,outlineColor:Nn,stroke:Nn,textDecorationColor:Nn,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:Ki,minBlockSize:Ki,maxBlockSize:Ki,inlineSize:Ki,minInlineSize:Ki,maxInlineSize:Ki,width:Ki,minWidth:Ki,maxWidth:Ki,height:Ki,minHeight:Ki,maxHeight:Ki,flexBasis:Ki,gridTemplateColumns:Ki,gridTemplateRows:Ki,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},Bce=(n,e)=>typeof e=="function"?{"()":Function.prototype.toString.call(e)}:e,lp=()=>{const n=Object.create(null);return(e,t,...r)=>{const i=(s=>JSON.stringify(s,Bce))(e);return i in n?n[i]:n[i]=t(e,...r)}},eh=Symbol.for("sxs.internal"),jR=(n,e)=>Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)),NB=n=>{for(const e in n)return!0;return!1},{hasOwnProperty:Nce}=Object.prototype,LC=n=>n.includes("-")?n:n.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),kce=/\s+(?![^()]*\))/,Cf=n=>e=>n(...typeof e=="string"?String(e).split(kce):[e]),kB={appearance:n=>({WebkitAppearance:n,appearance:n}),backfaceVisibility:n=>({WebkitBackfaceVisibility:n,backfaceVisibility:n}),backdropFilter:n=>({WebkitBackdropFilter:n,backdropFilter:n}),backgroundClip:n=>({WebkitBackgroundClip:n,backgroundClip:n}),boxDecorationBreak:n=>({WebkitBoxDecorationBreak:n,boxDecorationBreak:n}),clipPath:n=>({WebkitClipPath:n,clipPath:n}),content:n=>({content:n.includes('"')||n.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(n)?n:`"${n}"`}),hyphens:n=>({WebkitHyphens:n,hyphens:n}),maskImage:n=>({WebkitMaskImage:n,maskImage:n}),maskSize:n=>({WebkitMaskSize:n,maskSize:n}),tabSize:n=>({MozTabSize:n,tabSize:n}),textSizeAdjust:n=>({WebkitTextSizeAdjust:n,textSizeAdjust:n}),userSelect:n=>({WebkitUserSelect:n,userSelect:n}),marginBlock:Cf((n,e)=>({marginBlockStart:n,marginBlockEnd:e||n})),marginInline:Cf((n,e)=>({marginInlineStart:n,marginInlineEnd:e||n})),maxSize:Cf((n,e)=>({maxBlockSize:n,maxInlineSize:e||n})),minSize:Cf((n,e)=>({minBlockSize:n,minInlineSize:e||n})),paddingBlock:Cf((n,e)=>({paddingBlockStart:n,paddingBlockEnd:e||n})),paddingInline:Cf((n,e)=>({paddingInlineStart:n,paddingInlineEnd:e||n}))},rS=/([\d.]+)([^]*)/,Fce=(n,e)=>n.length?n.reduce((t,r)=>(t.push(...e.map(i=>i.includes("&")?i.replace(/&/g,/[ +>|~]/.test(r)&&/&.*&/.test(i)?`:is(${r})`:r):r+" "+i)),t),[]):e,Uce=(n,e)=>n in zce&&typeof e=="string"?e.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(t,r,i,s)=>r+(i==="stretch"?`-moz-available${s};${LC(n)}:${r}-webkit-fill-available`:`-moz-fit-content${s};${LC(n)}:${r}fit-content`)+s):String(e),zce={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},Cl=n=>n?n+"-":"",t5=(n,e,t)=>n.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(r,i,s,o,a)=>o=="$"==!!s?r:(i||o=="--"?"calc(":"")+"var(--"+(o==="$"?Cl(e)+(a.includes("$")?"":Cl(t))+a.replace(/\$/g,"-"):a)+")"+(i||o=="--"?"*"+(i||"")+(s||"1")+")":"")),Hce=/\s*,\s*(?![^()]*\))/,Vce=Object.prototype.toString,Yf=(n,e,t,r,i)=>{let s,o,a;const l=(c,u,f)=>{let p,m;const y=A=>{for(p in A){const E=p.charCodeAt(0)===64,x=E&&Array.isArray(A[p])?A[p]:[A[p]];for(m of x){const T=/[A-Z]/.test(g=p)?g:g.replace(/-[^]/g,I=>I[1].toUpperCase()),O=typeof m=="object"&&m&&m.toString===Vce&&(!r.utils[T]||!u.length);if(T in r.utils&&!O){const I=r.utils[T];if(I!==o){o=I,y(I(m)),o=null;continue}}else if(T in kB){const I=kB[T];if(I!==a){a=I,y(I(m)),a=null;continue}}if(E&&(_=p.slice(1)in r.media?"@media "+r.media[p.slice(1)]:p,p=_.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(I,b,R,C,M,B)=>{const F=rS.test(b),z=.0625*(F?-1:1),[j,Y]=F?[C,b]:[b,C];return"("+(R[0]==="="?"":R[0]===">"===F?"max-":"min-")+j+":"+(R[0]!=="="&&R.length===1?Y.replace(rS,(oe,le,X)=>Number(le)+z*(R===">"?1:-1)+X):Y)+(M?") and ("+(M[0]===">"?"min-":"max-")+j+":"+(M.length===1?B.replace(rS,(oe,le,X)=>Number(le)+z*(M===">"?-1:1)+X):B):"")+")"})),O){const I=E?f.concat(p):[...f],b=E?[...u]:Fce(u,p.split(Hce));s!==void 0&&i(FB(...s)),s=void 0,l(m,b,I)}else s===void 0&&(s=[[],u,f]),p=E||p.charCodeAt(0)!==36?p:`--${Cl(r.prefix)}${p.slice(1).replace(/\$/g,"-")}`,m=O?m:typeof m=="number"?m&&T in Gce?String(m)+"px":String(m):t5(Uce(T,m??""),r.prefix,r.themeMap[T]),s[0].push(`${E?`${p} `:`${LC(p)}:`}${m}`)}}var _,g};y(c),s!==void 0&&i(FB(...s)),s=void 0};l(n,e,t)},FB=(n,e,t)=>`${t.map(r=>`${r}{`).join("")}${e.length?`${e.join(",")}{`:""}${n.join(";")}${e.length?"}":""}${Array(t.length?t.length+1:0).join("}")}`,Gce={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},UB=n=>String.fromCharCode(n+(n>25?39:97)),th=n=>(e=>{let t,r="";for(t=Math.abs(e);t>52;t=t/52|0)r=UB(t%52)+r;return UB(t%52)+r})(((e,t)=>{let r=t.length;for(;r;)e=33*e^t.charCodeAt(--r);return e})(5381,JSON.stringify(n))>>>0),Rm=["themed","global","styled","onevar","resonevar","allvar","inline"],Wce=n=>{if(n.href&&!n.href.startsWith(location.origin))return!1;try{return!!n.cssRules}catch{return!1}},$ce=n=>{let e;const t=()=>{const{cssRules:i}=e.sheet;return[].map.call(i,(s,o)=>{const{cssText:a}=s;let l="";if(a.startsWith("--sxs"))return"";if(i[o-1]&&(l=i[o-1].cssText).startsWith("--sxs")){if(!s.cssRules.length)return"";for(const c in e.rules)if(e.rules[c].group===s)return`--sxs{--sxs:${[...e.rules[c].cache].join(" ")}}${a}`;return s.cssRules.length?`${l}${a}`:""}return a}).join("")},r=()=>{if(e){const{rules:a,sheet:l}=e;if(!l.deleteRule){for(;Object(Object(l.cssRules)[0]).type===3;)l.cssRules.splice(0,1);l.cssRules=[]}for(const c in a)delete a[c]}const i=Object(n).styleSheets||[];for(const a of i)if(Wce(a)){for(let l=0,c=a.cssRules;c[l];++l){const u=Object(c[l]);if(u.type!==1)continue;const f=Object(c[l+1]);if(f.type!==4)continue;++l;const{cssText:p}=u;if(!p.startsWith("--sxs"))continue;const m=p.slice(14,-3).trim().split(/\s+/),y=Rm[m[0]];y&&(e||(e={sheet:a,reset:r,rules:{},toString:t}),e.rules[y]={group:f,index:l,cache:new Set(m)})}if(e)break}if(!e){const a=(l,c)=>({type:c,cssRules:[],insertRule(u,f){this.cssRules.splice(f,0,a(u,{import:3,undefined:1}[(u.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return l==="@media{}"?`@media{${[].map.call(this.cssRules,u=>u.cssText).join("")}}`:l}});e={sheet:n?(n.head||n).appendChild(document.createElement("style")).sheet:a("","text/css"),rules:{},reset:r,toString:t}}const{sheet:s,rules:o}=e;for(let a=Rm.length-1;a>=0;--a){const l=Rm[a];if(!o[l]){const c=Rm[a+1],u=o[c]?o[c].index:s.cssRules.length;s.insertRule("@media{}",u),s.insertRule(`--sxs{--sxs:${a}}`,u),o[l]={group:s.cssRules[u+1],index:u,cache:new Set([a])}}jce(o[l])}};return r(),e},jce=n=>{const e=n.group;let t=e.cssRules.length;n.apply=r=>{try{e.insertRule(r,t),++t}catch{}}},vm=Symbol(),Xce=lp(),zB=(n,e)=>Xce(n,()=>(...t)=>{let r={type:null,composers:new Set};for(const i of t)if(i!=null)if(i[eh]){r.type==null&&(r.type=i[eh].type);for(const s of i[eh].composers)r.composers.add(s)}else i.constructor!==Object||i.$$typeof?r.type==null&&(r.type=i):r.composers.add(Kce(i,n));return r.type==null&&(r.type="span"),r.composers.size||r.composers.add(["PJLV",{},[],[],{},[]]),Jce(n,r,e)}),Kce=({variants:n,compoundVariants:e,defaultVariants:t,...r},i)=>{const s=`${Cl(i.prefix)}c-${th(r)}`,o=[],a=[],l=Object.create(null),c=[];for(const p in t)l[p]=String(t[p]);if(typeof n=="object"&&n)for(const p in n){u=l,f=p,Nce.call(u,f)||(l[p]="undefined");const m=n[p];for(const y in m){const A={[p]:String(y)};String(y)==="undefined"&&c.push(p);const _=m[y],g=[A,_,!NB(_)];o.push(g)}}var u,f;if(typeof e=="object"&&e)for(const p of e){let{css:m,...y}=p;m=typeof m=="object"&&m||{};for(const _ in y)y[_]=String(y[_]);const A=[y,m,!NB(m)];a.push(A)}return[s,r,o,a,l,c]},Jce=(n,e,t)=>{const[r,i,s,o]=Yce(e.composers),a=typeof e.type=="function"||e.type.$$typeof?(f=>{function p(){for(let m=0;m<p[vm].length;m++){const[y,A]=p[vm][m];f.rules[y].apply(A)}return p[vm]=[],null}return p[vm]=[],p.rules={},Rm.forEach(m=>p.rules[m]={apply:y=>p[vm].push([m,y])}),p})(t):null,l=(a||t).rules,c=`.${r}${i.length>1?`:where(.${i.slice(1).join(".")})`:""}`,u=f=>{f=typeof f=="object"&&f||qce;const{css:p,...m}=f,y={};for(const g in s)if(delete m[g],g in f){let E=f[g];typeof E=="object"&&E?y[g]={"@initial":s[g],...E}:(E=String(E),y[g]=E!=="undefined"||o.has(g)?E:s[g])}else y[g]=s[g];const A=new Set([...i]);for(const[g,E,x,T]of e.composers){t.rules.styled.cache.has(g)||(t.rules.styled.cache.add(g),Yf(E,[`.${g}`],[],n,b=>{l.styled.apply(b)}));const O=HB(x,y,n.media),I=HB(T,y,n.media,!0);for(const b of O)if(b!==void 0)for(const[R,C,M]of b){const B=`${g}-${th(C)}-${R}`;A.add(B);const F=(M?t.rules.resonevar:t.rules.onevar).cache,z=M?l.resonevar:l.onevar;F.has(B)||(F.add(B),Yf(C,[`.${B}`],[],n,j=>{z.apply(j)}))}for(const b of I)if(b!==void 0)for(const[R,C]of b){const M=`${g}-${th(C)}-${R}`;A.add(M),t.rules.allvar.cache.has(M)||(t.rules.allvar.cache.add(M),Yf(C,[`.${M}`],[],n,B=>{l.allvar.apply(B)}))}}if(typeof p=="object"&&p){const g=`${r}-i${th(p)}-css`;A.add(g),t.rules.inline.cache.has(g)||(t.rules.inline.cache.add(g),Yf(p,[`.${g}`],[],n,E=>{l.inline.apply(E)}))}for(const g of String(f.className||"").trim().split(/\s+/))g&&A.add(g);const _=m.className=[...A].join(" ");return{type:e.type,className:_,selector:c,props:m,toString:()=>_,deferredInjector:a}};return jR(u,{className:r,selector:c,[eh]:e,toString:()=>(t.rules.styled.cache.has(r)||u(),r)})},Yce=n=>{let e="";const t=[],r={},i=[];for(const[s,,,,o,a]of n){e===""&&(e=s),t.push(s),i.push(...a);for(const l in o){const c=o[l];(r[l]===void 0||c!=="undefined"||a.includes(c))&&(r[l]=c)}}return[e,t,r,new Set(i)]},HB=(n,e,t,r)=>{const i=[];e:for(let[s,o,a]of n){if(a)continue;let l,c=0,u=!1;for(l in s){const f=s[l];let p=e[l];if(p!==f){if(typeof p!="object"||!p)continue e;{let m,y,A=0;for(const _ in p){if(f===String(p[_])){if(_!=="@initial"){const g=_.slice(1);(y=y||[]).push(g in t?t[g]:_.replace(/^@media ?/,"")),u=!0}c+=A,m=!0}++A}if(y&&y.length&&(o={["@media "+y.join(", ")]:o}),!m)continue e}}}(i[c]=i[c]||[]).push([r?"cv":`${l}-${s[l]}`,o,u])}return i},qce={},Qce=lp(),Zce=(n,e)=>Qce(n,()=>(...t)=>{const r=()=>{for(let i of t){i=typeof i=="object"&&i||{};let s=th(i);if(!e.rules.global.cache.has(s)){if(e.rules.global.cache.add(s),"@import"in i){let o=[].indexOf.call(e.sheet.cssRules,e.rules.themed.group)-1;for(let a of[].concat(i["@import"]))a=a.includes('"')||a.includes("'")?a:`"${a}"`,e.sheet.insertRule(`@import ${a};`,o++);delete i["@import"]}Yf(i,[],[],n,o=>{e.rules.global.apply(o)})}}return""};return jR(r,{toString:r})}),eue=lp(),tue=(n,e)=>eue(n,()=>t=>{const r=`${Cl(n.prefix)}k-${th(t)}`,i=()=>{if(!e.rules.global.cache.has(r)){e.rules.global.cache.add(r);const s=[];Yf(t,[],[],n,a=>s.push(a));const o=`@keyframes ${r}{${s.join("")}}`;e.rules.global.apply(o)}return r};return jR(i,{get name(){return i()},toString:i})}),nue=class{constructor(n,e,t,r){this.token=n==null?"":String(n),this.value=e==null?"":String(e),this.scale=t==null?"":String(t),this.prefix=r==null?"":String(r)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+Cl(this.prefix)+Cl(this.scale)+this.token}toString(){return this.computedValue}},rue=lp(),iue=(n,e)=>rue(n,()=>(t,r)=>{r=typeof t=="object"&&t||Object(r);const i=`.${t=(t=typeof t=="string"?t:"")||`${Cl(n.prefix)}t-${th(r)}`}`,s={},o=[];for(const l in r){s[l]={};for(const c in r[l]){const u=`--${Cl(n.prefix)}${l}-${c}`,f=t5(String(r[l][c]),n.prefix,l);s[l][c]=new nue(c,f,l,n.prefix),o.push(`${u}:${f}`)}}const a=()=>{if(o.length&&!e.rules.themed.cache.has(t)){e.rules.themed.cache.add(t);const l=`${r===n.theme?":root,":""}.${t}{${o.join(";")}}`;e.rules.themed.apply(l)}return t};return{...s,get className(){return a()},selector:i,toString:a}}),sue=lp(),oue=lp(),aue=n=>{const e=(t=>{let r=!1;const i=sue(t,s=>{r=!0;const o="prefix"in(s=typeof s=="object"&&s||{})?String(s.prefix):"",a=typeof s.media=="object"&&s.media||{},l=typeof s.root=="object"?s.root||null:globalThis.document||null,c=typeof s.theme=="object"&&s.theme||{},u={prefix:o,media:a,theme:c,themeMap:typeof s.themeMap=="object"&&s.themeMap||{...Oce},utils:typeof s.utils=="object"&&s.utils||{}},f=$ce(l),p={css:zB(u,f),globalCss:Zce(u,f),keyframes:tue(u,f),createTheme:iue(u,f),reset(){f.reset(),p.theme.toString()},theme:{},sheet:f,config:u,prefix:o,getCssText:f.toString,toString:f.toString};return String(p.theme=p.createTheme(c)),p});return r||i.reset(),i})(n);return e.styled=(({config:t,sheet:r})=>oue(t,()=>{const i=zB(t,r);return(...s)=>{const o=i(...s),a=o[eh].type,l=ne.forwardRef((c,u)=>{const f=c&&c.as||a,{props:p,deferredInjector:m}=o(c);return delete p.as,p.ref=u,m?ne.createElement(ne.Fragment,null,ne.createElement(f,p),ne.createElement(m,null)):ne.createElement(f,p)});return l.className=o.className,l.displayName=`Styled.${a.displayName||a.name||a}`,l.selector=o.selector,l.toString=()=>o.selector,l[eh]=o[eh],l}}))(e),e};function el(n,e,{checkForDefaultPrevented:t=!0}={}){return function(i){if(n==null||n(i),t===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function n5(n,e=[]){let t=[];function r(s,o){const a=D.createContext(o),l=t.length;t=[...t,o];function c(f){const{scope:p,children:m,...y}=f,A=(p==null?void 0:p[n][l])||a,_=D.useMemo(()=>y,Object.values(y));return D.createElement(A.Provider,{value:_},m)}function u(f,p){const m=(p==null?void 0:p[n][l])||a,y=D.useContext(m);if(y)return y;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${s}\``)}return c.displayName=s+"Provider",[c,u]}const i=()=>{const s=t.map(o=>D.createContext(o));return function(a){const l=(a==null?void 0:a[n])||s;return D.useMemo(()=>({[`__scope${n}`]:{...a,[n]:l}}),[a,l])}};return i.scopeName=n,[r,lue(i,...e)]}function lue(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const f=l(s)[`__scope${c}`];return{...a,...f}},{});return D.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}function cp(n){const e=D.useRef(n);return D.useEffect(()=>{e.current=n}),D.useMemo(()=>(...t)=>{var r;return(r=e.current)===null||r===void 0?void 0:r.call(e,...t)},[])}function cue(n,e=globalThis==null?void 0:globalThis.document){const t=cp(n);D.useEffect(()=>{const r=i=>{i.key==="Escape"&&t(i)};return e.addEventListener("keydown",r),()=>e.removeEventListener("keydown",r)},[t,e])}const OC="dismissableLayer.update",uue="dismissableLayer.pointerDownOutside",hue="dismissableLayer.focusOutside";let VB;const fue=D.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),due=D.forwardRef((n,e)=>{var t;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:o,onInteractOutside:a,onDismiss:l,...c}=n,u=D.useContext(fue),[f,p]=D.useState(null),m=(t=f==null?void 0:f.ownerDocument)!==null&&t!==void 0?t:globalThis==null?void 0:globalThis.document,[,y]=D.useState({}),A=ap(e,R=>p(R)),_=Array.from(u.layers),[g]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),E=_.indexOf(g),x=f?_.indexOf(f):-1,T=u.layersWithOutsidePointerEventsDisabled.size>0,O=x>=E,I=pue(R=>{const C=R.target,M=[...u.branches].some(B=>B.contains(C));!O||M||(s==null||s(R),a==null||a(R),R.defaultPrevented||l==null||l())},m),b=mue(R=>{const C=R.target;[...u.branches].some(B=>B.contains(C))||(o==null||o(R),a==null||a(R),R.defaultPrevented||l==null||l())},m);return cue(R=>{x===u.layers.size-1&&(i==null||i(R),!R.defaultPrevented&&l&&(R.preventDefault(),l()))},m),D.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(VB=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),GB(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=VB)}},[f,m,r,u]),D.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),GB())},[f,u]),D.useEffect(()=>{const R=()=>y({});return document.addEventListener(OC,R),()=>document.removeEventListener(OC,R)},[]),D.createElement(Ph.div,sr({},c,{ref:A,style:{pointerEvents:T?O?"auto":"none":void 0,...n.style},onFocusCapture:el(n.onFocusCapture,b.onFocusCapture),onBlurCapture:el(n.onBlurCapture,b.onBlurCapture),onPointerDownCapture:el(n.onPointerDownCapture,I.onPointerDownCapture)}))});function pue(n,e=globalThis==null?void 0:globalThis.document){const t=cp(n),r=D.useRef(!1),i=D.useRef(()=>{});return D.useEffect(()=>{const s=a=>{if(a.target&&!r.current){let u=function(){r5(uue,t,c,{discrete:!0})};var l=u;const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=u,e.addEventListener("click",i.current,{once:!0})):u()}else e.removeEventListener("click",i.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",i.current)}},[e,t]),{onPointerDownCapture:()=>r.current=!0}}function mue(n,e=globalThis==null?void 0:globalThis.document){const t=cp(n),r=D.useRef(!1);return D.useEffect(()=>{const i=s=>{s.target&&!r.current&&r5(hue,t,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function GB(){const n=new CustomEvent(OC);document.dispatchEvent(n)}function r5(n,e,t,{discrete:r}){const i=t.originalEvent.target,s=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&i.addEventListener(n,e,{once:!0}),r?bce(i,s):i.dispatchEvent(s)}const Ud=globalThis!=null&&globalThis.document?D.useLayoutEffect:()=>{},gue=wG.useId||(()=>{});let yue=0;function vue(n){const[e,t]=D.useState(gue());return Ud(()=>{n||t(r=>r??String(yue++))},[n]),n||(e?`radix-${e}`:"")}const _ue=["top","right","bottom","left"],Hc=Math.min,Ls=Math.max,UE=Math.round,Z0=Math.floor,Vc=n=>({x:n,y:n}),Eue={left:"right",right:"left",bottom:"top",top:"bottom"},xue={start:"end",end:"start"};function BC(n,e,t){return Ls(n,Hc(e,t))}function bl(n,e){return typeof n=="function"?n(e):n}function Ml(n){return n.split("-")[0]}function up(n){return n.split("-")[1]}function XR(n){return n==="x"?"y":"x"}function KR(n){return n==="y"?"height":"width"}function hp(n){return["top","bottom"].includes(Ml(n))?"y":"x"}function JR(n){return XR(hp(n))}function Aue(n,e,t){t===void 0&&(t=!1);const r=up(n),i=JR(n),s=KR(i);let o=i==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=zE(o)),[o,zE(o)]}function wue(n){const e=zE(n);return[NC(n),e,NC(e)]}function NC(n){return n.replace(/start|end/g,e=>xue[e])}function Sue(n,e,t){const r=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(n){case"top":case"bottom":return t?e?i:r:e?r:i;case"left":case"right":return e?s:o;default:return[]}}function Tue(n,e,t,r){const i=up(n);let s=Sue(Ml(n),t==="start",r);return i&&(s=s.map(o=>o+"-"+i),e&&(s=s.concat(s.map(NC)))),s}function zE(n){return n.replace(/left|right|bottom|top/g,e=>Eue[e])}function Cue(n){return{top:0,right:0,bottom:0,left:0,...n}}function i5(n){return typeof n!="number"?Cue(n):{top:n,right:n,bottom:n,left:n}}function HE(n){return{...n,top:n.y,left:n.x,right:n.x+n.width,bottom:n.y+n.height}}function WB(n,e,t){let{reference:r,floating:i}=n;const s=hp(e),o=JR(e),a=KR(o),l=Ml(e),c=s==="y",u=r.x+r.width/2-i.width/2,f=r.y+r.height/2-i.height/2,p=r[a]/2-i[a]/2;let m;switch(l){case"top":m={x:u,y:r.y-i.height};break;case"bottom":m={x:u,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:f};break;case"left":m={x:r.x-i.width,y:f};break;default:m={x:r.x,y:r.y}}switch(up(e)){case"start":m[o]-=p*(t&&c?-1:1);break;case"end":m[o]+=p*(t&&c?-1:1);break}return m}const bue=async(n,e,t)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=t,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:n,floating:e,strategy:i}),{x:u,y:f}=WB(c,r,l),p=r,m={},y=0;for(let A=0;A<a.length;A++){const{name:_,fn:g}=a[A],{x:E,y:x,data:T,reset:O}=await g({x:u,y:f,initialPlacement:r,placement:p,strategy:i,middlewareData:m,rects:c,platform:o,elements:{reference:n,floating:e}});u=E??u,f=x??f,m={...m,[_]:{...m[_],...T}},O&&y<=50&&(y++,typeof O=="object"&&(O.placement&&(p=O.placement),O.rects&&(c=O.rects===!0?await o.getElementRects({reference:n,floating:e,strategy:i}):O.rects),{x:u,y:f}=WB(c,p,l)),A=-1)}return{x:u,y:f,placement:p,strategy:i,middlewareData:m}};async function Wg(n,e){var t;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:o,elements:a,strategy:l}=n,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:p=!1,padding:m=0}=bl(e,n),y=i5(m),_=a[p?f==="floating"?"reference":"floating":f],g=HE(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(_)))==null||t?_:_.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),E=f==="floating"?{...o.floating,x:r,y:i}:o.reference,x=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),T=await(s.isElement==null?void 0:s.isElement(x))?await(s.getScale==null?void 0:s.getScale(x))||{x:1,y:1}:{x:1,y:1},O=HE(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:E,offsetParent:x,strategy:l}):E);return{top:(g.top-O.top+y.top)/T.y,bottom:(O.bottom-g.bottom+y.bottom)/T.y,left:(g.left-O.left+y.left)/T.x,right:(O.right-g.right+y.right)/T.x}}const Mue=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:i,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=bl(n,e)||{};if(c==null)return{};const f=i5(u),p={x:t,y:r},m=JR(i),y=KR(m),A=await o.getDimensions(c),_=m==="y",g=_?"top":"left",E=_?"bottom":"right",x=_?"clientHeight":"clientWidth",T=s.reference[y]+s.reference[m]-p[m]-s.floating[y],O=p[m]-s.reference[m],I=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let b=I?I[x]:0;(!b||!await(o.isElement==null?void 0:o.isElement(I)))&&(b=a.floating[x]||s.floating[y]);const R=T/2-O/2,C=b/2-A[y]/2-1,M=Hc(f[g],C),B=Hc(f[E],C),F=M,z=b-A[y]-B,j=b/2-A[y]/2+R,Y=BC(F,j,z),oe=!l.arrow&&up(i)!=null&&j!==Y&&s.reference[y]/2-(j<F?M:B)-A[y]/2<0,le=oe?j<F?j-F:j-z:0;return{[m]:p[m]+le,data:{[m]:Y,centerOffset:j-Y-le,...oe&&{alignmentOffset:le}},reset:oe}}}),Rue=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:i,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:A=!0,..._}=bl(n,e);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const g=Ml(i),E=Ml(a)===a,x=await(l.isRTL==null?void 0:l.isRTL(c.floating)),T=p||(E||!A?[zE(a)]:wue(a));!p&&y!=="none"&&T.push(...Tue(a,A,y,x));const O=[a,...T],I=await Wg(e,_),b=[];let R=((r=s.flip)==null?void 0:r.overflows)||[];if(u&&b.push(I[g]),f){const F=Aue(i,o,x);b.push(I[F[0]],I[F[1]])}if(R=[...R,{placement:i,overflows:b}],!b.every(F=>F<=0)){var C,M;const F=(((C=s.flip)==null?void 0:C.index)||0)+1,z=O[F];if(z)return{data:{index:F,overflows:R},reset:{placement:z}};let j=(M=R.filter(Y=>Y.overflows[0]<=0).sort((Y,oe)=>Y.overflows[1]-oe.overflows[1])[0])==null?void 0:M.placement;if(!j)switch(m){case"bestFit":{var B;const Y=(B=R.map(oe=>[oe.placement,oe.overflows.filter(le=>le>0).reduce((le,X)=>le+X,0)]).sort((oe,le)=>oe[1]-le[1])[0])==null?void 0:B[0];Y&&(j=Y);break}case"initialPlacement":j=a;break}if(i!==j)return{reset:{placement:j}}}return{}}}};function $B(n,e){return{top:n.top-e.height,right:n.right-e.width,bottom:n.bottom-e.height,left:n.left-e.width}}function jB(n){return _ue.some(e=>n[e]>=0)}const Iue=function(n){return n===void 0&&(n={}),{name:"hide",options:n,async fn(e){const{rects:t}=e,{strategy:r="referenceHidden",...i}=bl(n,e);switch(r){case"referenceHidden":{const s=await Wg(e,{...i,elementContext:"reference"}),o=$B(s,t.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:jB(o)}}}case"escaped":{const s=await Wg(e,{...i,altBoundary:!0}),o=$B(s,t.floating);return{data:{escapedOffsets:o,escaped:jB(o)}}}default:return{}}}}};async function Pue(n,e){const{placement:t,platform:r,elements:i}=n,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=Ml(t),a=up(t),l=hp(t)==="y",c=["left","top"].includes(o)?-1:1,u=s&&l?-1:1,f=bl(e,n);let{mainAxis:p,crossAxis:m,alignmentAxis:y}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...f};return a&&typeof y=="number"&&(m=a==="end"?y*-1:y),l?{x:m*u,y:p*c}:{x:p*c,y:m*u}}const Due=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:i,y:s,placement:o,middlewareData:a}=e,l=await Pue(e,n);return o===((t=a.offset)==null?void 0:t.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:o}}}}},Lue=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:_=>{let{x:g,y:E}=_;return{x:g,y:E}}},...l}=bl(n,e),c={x:t,y:r},u=await Wg(e,l),f=hp(Ml(i)),p=XR(f);let m=c[p],y=c[f];if(s){const _=p==="y"?"top":"left",g=p==="y"?"bottom":"right",E=m+u[_],x=m-u[g];m=BC(E,m,x)}if(o){const _=f==="y"?"top":"left",g=f==="y"?"bottom":"right",E=y+u[_],x=y-u[g];y=BC(E,y,x)}const A=a.fn({...e,[p]:m,[f]:y});return{...A,data:{x:A.x-t,y:A.y-r}}}}},Oue=function(n){return n===void 0&&(n={}),{options:n,fn(e){const{x:t,y:r,placement:i,rects:s,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=bl(n,e),u={x:t,y:r},f=hp(i),p=XR(f);let m=u[p],y=u[f];const A=bl(a,e),_=typeof A=="number"?{mainAxis:A,crossAxis:0}:{mainAxis:0,crossAxis:0,...A};if(l){const x=p==="y"?"height":"width",T=s.reference[p]-s.floating[x]+_.mainAxis,O=s.reference[p]+s.reference[x]-_.mainAxis;m<T?m=T:m>O&&(m=O)}if(c){var g,E;const x=p==="y"?"width":"height",T=["top","left"].includes(Ml(i)),O=s.reference[f]-s.floating[x]+(T&&((g=o.offset)==null?void 0:g[f])||0)+(T?0:_.crossAxis),I=s.reference[f]+s.reference[x]+(T?0:((E=o.offset)==null?void 0:E[f])||0)-(T?_.crossAxis:0);y<O?y=O:y>I&&(y=I)}return{[p]:m,[f]:y}}}},Bue=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){const{placement:t,rects:r,platform:i,elements:s}=e,{apply:o=()=>{},...a}=bl(n,e),l=await Wg(e,a),c=Ml(t),u=up(t),f=hp(t)==="y",{width:p,height:m}=r.floating;let y,A;c==="top"||c==="bottom"?(y=c,A=u===(await(i.isRTL==null?void 0:i.isRTL(s.floating))?"start":"end")?"left":"right"):(A=c,y=u==="end"?"top":"bottom");const _=m-l[y],g=p-l[A],E=!e.middlewareData.shift;let x=_,T=g;if(f){const I=p-l.left-l.right;T=u||E?Hc(g,I):I}else{const I=m-l.top-l.bottom;x=u||E?Hc(_,I):I}if(E&&!u){const I=Ls(l.left,0),b=Ls(l.right,0),R=Ls(l.top,0),C=Ls(l.bottom,0);f?T=p-2*(I!==0||b!==0?I+b:Ls(l.left,l.right)):x=m-2*(R!==0||C!==0?R+C:Ls(l.top,l.bottom))}await o({...e,availableWidth:T,availableHeight:x});const O=await i.getDimensions(s.floating);return p!==O.width||m!==O.height?{reset:{rects:!0}}:{}}}};function Gc(n){return s5(n)?(n.nodeName||"").toLowerCase():"#document"}function Hs(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Ll(n){var e;return(e=(s5(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function s5(n){return n instanceof Node||n instanceof Hs(n).Node}function Rl(n){return n instanceof Element||n instanceof Hs(n).Element}function La(n){return n instanceof HTMLElement||n instanceof Hs(n).HTMLElement}function XB(n){return typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Hs(n).ShadowRoot}function Oy(n){const{overflow:e,overflowX:t,overflowY:r,display:i}=xo(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(i)}function Nue(n){return["table","td","th"].includes(Gc(n))}function YR(n){const e=qR(),t=xo(n);return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function kue(n){let e=zd(n);for(;La(e)&&!hA(e);){if(YR(e))return e;e=zd(e)}return null}function qR(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function hA(n){return["html","body","#document"].includes(Gc(n))}function xo(n){return Hs(n).getComputedStyle(n)}function fA(n){return Rl(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.pageXOffset,scrollTop:n.pageYOffset}}function zd(n){if(Gc(n)==="html")return n;const e=n.assignedSlot||n.parentNode||XB(n)&&n.host||Ll(n);return XB(e)?e.host:e}function o5(n){const e=zd(n);return hA(e)?n.ownerDocument?n.ownerDocument.body:n.body:La(e)&&Oy(e)?e:o5(e)}function $g(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=o5(n),s=i===((r=n.ownerDocument)==null?void 0:r.body),o=Hs(i);return s?e.concat(o,o.visualViewport||[],Oy(i)?i:[],o.frameElement&&t?$g(o.frameElement):[]):e.concat(i,$g(i,[],t))}function a5(n){const e=xo(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=La(n),s=i?n.offsetWidth:t,o=i?n.offsetHeight:r,a=UE(t)!==s||UE(r)!==o;return a&&(t=s,r=o),{width:t,height:r,$:a}}function QR(n){return Rl(n)?n:n.contextElement}function dd(n){const e=QR(n);if(!La(e))return Vc(1);const t=e.getBoundingClientRect(),{width:r,height:i,$:s}=a5(e);let o=(s?UE(t.width):t.width)/r,a=(s?UE(t.height):t.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Fue=Vc(0);function l5(n){const e=Hs(n);return!qR()||!e.visualViewport?Fue:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Uue(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==Hs(n)?!1:e}function vh(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=n.getBoundingClientRect(),s=QR(n);let o=Vc(1);e&&(r?Rl(r)&&(o=dd(r)):o=dd(n));const a=Uue(s,t,r)?l5(s):Vc(0);let l=(i.left+a.x)/o.x,c=(i.top+a.y)/o.y,u=i.width/o.x,f=i.height/o.y;if(s){const p=Hs(s),m=r&&Rl(r)?Hs(r):r;let y=p,A=y.frameElement;for(;A&&r&&m!==y;){const _=dd(A),g=A.getBoundingClientRect(),E=xo(A),x=g.left+(A.clientLeft+parseFloat(E.paddingLeft))*_.x,T=g.top+(A.clientTop+parseFloat(E.paddingTop))*_.y;l*=_.x,c*=_.y,u*=_.x,f*=_.y,l+=x,c+=T,y=Hs(A),A=y.frameElement}}return HE({width:u,height:f,x:l,y:c})}const zue=[":popover-open",":modal"];function c5(n){return zue.some(e=>{try{return n.matches(e)}catch{return!1}})}function Hue(n){let{elements:e,rect:t,offsetParent:r,strategy:i}=n;const s=i==="fixed",o=Ll(r),a=e?c5(e.floating):!1;if(r===o||a&&s)return t;let l={scrollLeft:0,scrollTop:0},c=Vc(1);const u=Vc(0),f=La(r);if((f||!f&&!s)&&((Gc(r)!=="body"||Oy(o))&&(l=fA(r)),La(r))){const p=vh(r);c=dd(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+u.x,y:t.y*c.y-l.scrollTop*c.y+u.y}}function Vue(n){return Array.from(n.getClientRects())}function u5(n){return vh(Ll(n)).left+fA(n).scrollLeft}function Gue(n){const e=Ll(n),t=fA(n),r=n.ownerDocument.body,i=Ls(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=Ls(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-t.scrollLeft+u5(n);const a=-t.scrollTop;return xo(r).direction==="rtl"&&(o+=Ls(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:a}}function Wue(n,e){const t=Hs(n),r=Ll(n),i=t.visualViewport;let s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;const c=qR();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a,y:l}}function $ue(n,e){const t=vh(n,!0,e==="fixed"),r=t.top+n.clientTop,i=t.left+n.clientLeft,s=La(n)?dd(n):Vc(1),o=n.clientWidth*s.x,a=n.clientHeight*s.y,l=i*s.x,c=r*s.y;return{width:o,height:a,x:l,y:c}}function KB(n,e,t){let r;if(e==="viewport")r=Wue(n,t);else if(e==="document")r=Gue(Ll(n));else if(Rl(e))r=$ue(e,t);else{const i=l5(n);r={...e,x:e.x-i.x,y:e.y-i.y}}return HE(r)}function h5(n,e){const t=zd(n);return t===e||!Rl(t)||hA(t)?!1:xo(t).position==="fixed"||h5(t,e)}function jue(n,e){const t=e.get(n);if(t)return t;let r=$g(n,[],!1).filter(a=>Rl(a)&&Gc(a)!=="body"),i=null;const s=xo(n).position==="fixed";let o=s?zd(n):n;for(;Rl(o)&&!hA(o);){const a=xo(o),l=YR(o);!l&&a.position==="fixed"&&(i=null),(s?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Oy(o)&&!l&&h5(n,o))?r=r.filter(u=>u!==o):i=a,o=zd(o)}return e.set(n,r),r}function Xue(n){let{element:e,boundary:t,rootBoundary:r,strategy:i}=n;const o=[...t==="clippingAncestors"?jue(e,this._c):[].concat(t),r],a=o[0],l=o.reduce((c,u)=>{const f=KB(e,u,i);return c.top=Ls(f.top,c.top),c.right=Hc(f.right,c.right),c.bottom=Hc(f.bottom,c.bottom),c.left=Ls(f.left,c.left),c},KB(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Kue(n){const{width:e,height:t}=a5(n);return{width:e,height:t}}function Jue(n,e,t){const r=La(e),i=Ll(e),s=t==="fixed",o=vh(n,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=Vc(0);if(r||!r&&!s)if((Gc(e)!=="body"||Oy(i))&&(a=fA(e)),r){const f=vh(e,!0,s,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else i&&(l.x=u5(i));const c=o.left+a.scrollLeft-l.x,u=o.top+a.scrollTop-l.y;return{x:c,y:u,width:o.width,height:o.height}}function JB(n,e){return!La(n)||xo(n).position==="fixed"?null:e?e(n):n.offsetParent}function f5(n,e){const t=Hs(n);if(!La(n)||c5(n))return t;let r=JB(n,e);for(;r&&Nue(r)&&xo(r).position==="static";)r=JB(r,e);return r&&(Gc(r)==="html"||Gc(r)==="body"&&xo(r).position==="static"&&!YR(r))?t:r||kue(n)||t}const Yue=async function(n){const e=this.getOffsetParent||f5,t=this.getDimensions;return{reference:Jue(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,...await t(n.floating)}}};function que(n){return xo(n).direction==="rtl"}const Que={convertOffsetParentRelativeRectToViewportRelativeRect:Hue,getDocumentElement:Ll,getClippingRect:Xue,getOffsetParent:f5,getElementRects:Yue,getClientRects:Vue,getDimensions:Kue,getScale:dd,isElement:Rl,isRTL:que};function Zue(n,e){let t=null,r;const i=Ll(n);function s(){var a;clearTimeout(r),(a=t)==null||a.disconnect(),t=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const{left:c,top:u,width:f,height:p}=n.getBoundingClientRect();if(a||e(),!f||!p)return;const m=Z0(u),y=Z0(i.clientWidth-(c+f)),A=Z0(i.clientHeight-(u+p)),_=Z0(c),E={rootMargin:-m+"px "+-y+"px "+-A+"px "+-_+"px",threshold:Ls(0,Hc(1,l))||1};let x=!0;function T(O){const I=O[0].intersectionRatio;if(I!==l){if(!x)return o();I?o(!1,I):r=setTimeout(()=>{o(!1,1e-7)},100)}x=!1}try{t=new IntersectionObserver(T,{...E,root:i.ownerDocument})}catch{t=new IntersectionObserver(T,E)}t.observe(n)}return o(!0),s}function ehe(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=QR(n),u=i||s?[...c?$g(c):[],...$g(e)]:[];u.forEach(g=>{i&&g.addEventListener("scroll",t,{passive:!0}),s&&g.addEventListener("resize",t)});const f=c&&a?Zue(c,t):null;let p=-1,m=null;o&&(m=new ResizeObserver(g=>{let[E]=g;E&&E.target===c&&m&&(m.unobserve(e),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var x;(x=m)==null||x.observe(e)})),t()}),c&&!l&&m.observe(c),m.observe(e));let y,A=l?vh(n):null;l&&_();function _(){const g=vh(n);A&&(g.x!==A.x||g.y!==A.y||g.width!==A.width||g.height!==A.height)&&t(),A=g,y=requestAnimationFrame(_)}return t(),()=>{var g;u.forEach(E=>{i&&E.removeEventListener("scroll",t),s&&E.removeEventListener("resize",t)}),f==null||f(),(g=m)==null||g.disconnect(),m=null,l&&cancelAnimationFrame(y)}}const the=Lue,nhe=Rue,rhe=Bue,ihe=Iue,YB=Mue,she=Oue,ohe=(n,e,t)=>{const r=new Map,i={platform:Que,...t},s={...i.platform,_c:r};return bue(n,e,{...i,platform:s})},ahe=n=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:r,padding:i}=typeof n=="function"?n(t):n;return r&&e(r)?r.current!=null?YB({element:r.current,padding:i}).fn(t):{}:r?YB({element:r,padding:i}).fn(t):{}}}};var k_=typeof document<"u"?D.useLayoutEffect:D.useEffect;function VE(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,i;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!VE(n[r],e[r]))return!1;return!0}if(i=Object.keys(n),t=i.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=t;r--!==0;){const s=i[r];if(!(s==="_owner"&&n.$$typeof)&&!VE(n[s],e[s]))return!1}return!0}return n!==n&&e!==e}function d5(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function qB(n,e){const t=d5(n);return Math.round(e*t)/t}function QB(n){const e=D.useRef(n);return k_(()=>{e.current=n}),e}function lhe(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:i,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=n,[u,f]=D.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[p,m]=D.useState(r);VE(p,r)||m(r);const[y,A]=D.useState(null),[_,g]=D.useState(null),E=D.useCallback(le=>{le!==I.current&&(I.current=le,A(le))},[]),x=D.useCallback(le=>{le!==b.current&&(b.current=le,g(le))},[]),T=s||y,O=o||_,I=D.useRef(null),b=D.useRef(null),R=D.useRef(u),C=l!=null,M=QB(l),B=QB(i),F=D.useCallback(()=>{if(!I.current||!b.current)return;const le={placement:e,strategy:t,middleware:p};B.current&&(le.platform=B.current),ohe(I.current,b.current,le).then(X=>{const ee={...X,isPositioned:!0};z.current&&!VE(R.current,ee)&&(R.current=ee,Qg.flushSync(()=>{f(ee)}))})},[p,e,t,B]);k_(()=>{c===!1&&R.current.isPositioned&&(R.current.isPositioned=!1,f(le=>({...le,isPositioned:!1})))},[c]);const z=D.useRef(!1);k_(()=>(z.current=!0,()=>{z.current=!1}),[]),k_(()=>{if(T&&(I.current=T),O&&(b.current=O),T&&O){if(M.current)return M.current(T,O,F);F()}},[T,O,F,M,C]);const j=D.useMemo(()=>({reference:I,floating:b,setReference:E,setFloating:x}),[E,x]),Y=D.useMemo(()=>({reference:T,floating:O}),[T,O]),oe=D.useMemo(()=>{const le={position:t,left:0,top:0};if(!Y.floating)return le;const X=qB(Y.floating,u.x),ee=qB(Y.floating,u.y);return a?{...le,transform:"translate("+X+"px, "+ee+"px)",...d5(Y.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:X,top:ee}},[t,a,Y.floating,u.x,u.y]);return D.useMemo(()=>({...u,update:F,refs:j,elements:Y,floatingStyles:oe}),[u,F,j,Y,oe])}const che=D.forwardRef((n,e)=>{const{children:t,width:r=10,height:i=5,...s}=n;return D.createElement(Ph.svg,sr({},s,{ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),n.asChild?t:D.createElement("polygon",{points:"0,0 30,0 15,10"}))}),uhe=che;function hhe(n){const[e,t]=D.useState(void 0);return Ud(()=>{if(n){t({width:n.offsetWidth,height:n.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=n.offsetWidth,a=n.offsetHeight;t({width:o,height:a})});return r.observe(n,{box:"border-box"}),()=>r.unobserve(n)}else t(void 0)},[n]),e}const p5="Popper",[m5,g5]=n5(p5),[fhe,y5]=m5(p5),dhe=n=>{const{__scopePopper:e,children:t}=n,[r,i]=D.useState(null);return D.createElement(fhe,{scope:e,anchor:r,onAnchorChange:i},t)},phe="PopperAnchor",mhe=D.forwardRef((n,e)=>{const{__scopePopper:t,virtualRef:r,...i}=n,s=y5(phe,t),o=D.useRef(null),a=ap(e,o);return D.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:D.createElement(Ph.div,sr({},i,{ref:a}))}),v5="PopperContent",[ghe,yhe]=m5(v5),vhe=D.forwardRef((n,e)=>{var t,r,i,s,o,a,l,c;const{__scopePopper:u,side:f="bottom",sideOffset:p=0,align:m="center",alignOffset:y=0,arrowPadding:A=0,avoidCollisions:_=!0,collisionBoundary:g=[],collisionPadding:E=0,sticky:x="partial",hideWhenDetached:T=!1,updatePositionStrategy:O="optimized",onPlaced:I,...b}=n,R=y5(v5,u),[C,M]=D.useState(null),B=ap(e,Ne=>M(Ne)),[F,z]=D.useState(null),j=hhe(F),Y=(t=j==null?void 0:j.width)!==null&&t!==void 0?t:0,oe=(r=j==null?void 0:j.height)!==null&&r!==void 0?r:0,le=f+(m!=="center"?"-"+m:""),X=typeof E=="number"?E:{top:0,right:0,bottom:0,left:0,...E},ee=Array.isArray(g)?g:[g],ie=ee.length>0,fe={padding:X,boundary:ee.filter(Ahe),altBoundary:ie},{refs:me,floatingStyles:he,placement:Ae,isPositioned:De,middlewareData:Ie}=lhe({strategy:"fixed",placement:le,whileElementsMounted:(...Ne)=>ehe(...Ne,{animationFrame:O==="always"}),elements:{reference:R.anchor},middleware:[Due({mainAxis:p+oe,alignmentAxis:y}),_&&the({mainAxis:!0,crossAxis:!1,limiter:x==="partial"?she():void 0,...fe}),_&&nhe({...fe}),rhe({...fe,apply:({elements:Ne,rects:Me,availableWidth:ot,availableHeight:Ze})=>{const{width:$,height:V}=Me.reference,ce=Ne.floating.style;ce.setProperty("--radix-popper-available-width",`${ot}px`),ce.setProperty("--radix-popper-available-height",`${Ze}px`),ce.setProperty("--radix-popper-anchor-width",`${$}px`),ce.setProperty("--radix-popper-anchor-height",`${V}px`)}}),F&&ahe({element:F,padding:A}),whe({arrowWidth:Y,arrowHeight:oe}),T&&ihe({strategy:"referenceHidden",...fe})]}),[He,rt]=_5(Ae),vt=cp(I);Ud(()=>{De&&(vt==null||vt())},[De,vt]);const Qe=(i=Ie.arrow)===null||i===void 0?void 0:i.x,Xe=(s=Ie.arrow)===null||s===void 0?void 0:s.y,te=((o=Ie.arrow)===null||o===void 0?void 0:o.centerOffset)!==0,[Le,be]=D.useState();return Ud(()=>{C&&be(window.getComputedStyle(C).zIndex)},[C]),D.createElement("div",{ref:me.setFloating,"data-radix-popper-content-wrapper":"",style:{...he,transform:De?he.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Le,"--radix-popper-transform-origin":[(a=Ie.transformOrigin)===null||a===void 0?void 0:a.x,(l=Ie.transformOrigin)===null||l===void 0?void 0:l.y].join(" ")},dir:n.dir},D.createElement(ghe,{scope:u,placedSide:He,onArrowChange:z,arrowX:Qe,arrowY:Xe,shouldHideArrow:te},D.createElement(Ph.div,sr({"data-side":He,"data-align":rt},b,{ref:B,style:{...b.style,animation:De?void 0:"none",opacity:(c=Ie.hide)!==null&&c!==void 0&&c.referenceHidden?0:void 0}}))))}),_he="PopperArrow",Ehe={top:"bottom",right:"left",bottom:"top",left:"right"},xhe=D.forwardRef(function(e,t){const{__scopePopper:r,...i}=e,s=yhe(_he,r),o=Ehe[s.placedSide];return D.createElement("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0}},D.createElement(uhe,sr({},i,{ref:t,style:{...i.style,display:"block"}})))});function Ahe(n){return n!==null}const whe=n=>({name:"transformOrigin",options:n,fn(e){var t,r,i,s,o;const{placement:a,rects:l,middlewareData:c}=e,f=((t=c.arrow)===null||t===void 0?void 0:t.centerOffset)!==0,p=f?0:n.arrowWidth,m=f?0:n.arrowHeight,[y,A]=_5(a),_={start:"0%",center:"50%",end:"100%"}[A],g=((r=(i=c.arrow)===null||i===void 0?void 0:i.x)!==null&&r!==void 0?r:0)+p/2,E=((s=(o=c.arrow)===null||o===void 0?void 0:o.y)!==null&&s!==void 0?s:0)+m/2;let x="",T="";return y==="bottom"?(x=f?_:`${g}px`,T=`${-m}px`):y==="top"?(x=f?_:`${g}px`,T=`${l.floating.height+m}px`):y==="right"?(x=`${-m}px`,T=f?_:`${E}px`):y==="left"&&(x=`${l.floating.width+m}px`,T=f?_:`${E}px`),{data:{x,y:T}}}});function _5(n){const[e,t="center"]=n.split("-");return[e,t]}const She=dhe,The=mhe,Che=vhe,bhe=xhe;function Mhe(n,e){return D.useReducer((t,r)=>{const i=e[t][r];return i??t},n)}const E5=n=>{const{present:e,children:t}=n,r=Rhe(e),i=typeof t=="function"?t({present:r.isPresent}):D.Children.only(t),s=ap(r.ref,i.ref);return typeof t=="function"||r.isPresent?D.cloneElement(i,{ref:s}):null};E5.displayName="Presence";function Rhe(n){const[e,t]=D.useState(),r=D.useRef({}),i=D.useRef(n),s=D.useRef("none"),o=n?"mounted":"unmounted",[a,l]=Mhe(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return D.useEffect(()=>{const c=e_(r.current);s.current=a==="mounted"?c:"none"},[a]),Ud(()=>{const c=r.current,u=i.current;if(u!==n){const p=s.current,m=e_(c);n?l("MOUNT"):m==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&p!==m?"ANIMATION_OUT":"UNMOUNT"),i.current=n}},[n,l]),Ud(()=>{if(e){const c=f=>{const m=e_(r.current).includes(f.animationName);f.target===e&&m&&Qg.flushSync(()=>l("ANIMATION_END"))},u=f=>{f.target===e&&(s.current=e_(r.current))};return e.addEventListener("animationstart",u),e.addEventListener("animationcancel",c),e.addEventListener("animationend",c),()=>{e.removeEventListener("animationstart",u),e.removeEventListener("animationcancel",c),e.removeEventListener("animationend",c)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:D.useCallback(c=>{c&&(r.current=getComputedStyle(c)),t(c)},[])}}function e_(n){return(n==null?void 0:n.animationName)||"none"}function Ihe({prop:n,defaultProp:e,onChange:t=()=>{}}){const[r,i]=Phe({defaultProp:e,onChange:t}),s=n!==void 0,o=s?n:r,a=cp(t),l=D.useCallback(c=>{if(s){const f=typeof c=="function"?c(n):c;f!==n&&a(f)}else i(c)},[s,n,i,a]);return[o,l]}function Phe({defaultProp:n,onChange:e}){const t=D.useState(n),[r]=t,i=D.useRef(r),s=cp(e);return D.useEffect(()=>{i.current!==r&&(s(r),i.current=r)},[r,i,s]),t}const Dhe=D.forwardRef((n,e)=>D.createElement(Ph.span,sr({},n,{ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...n.style}}))),Lhe=Dhe,[dA,Dye]=n5("Tooltip",[g5]),pA=g5(),Ohe="TooltipProvider",kC="tooltip.open",[Lye,ZR]=dA(Ohe),eI="Tooltip",[Bhe,mA]=dA(eI),Nhe=n=>{const{__scopeTooltip:e,children:t,open:r,defaultOpen:i=!1,onOpenChange:s,disableHoverableContent:o,delayDuration:a}=n,l=ZR(eI,n.__scopeTooltip),c=pA(e),[u,f]=D.useState(null),p=vue(),m=D.useRef(0),y=o??l.disableHoverableContent,A=a??l.delayDuration,_=D.useRef(!1),[g=!1,E]=Ihe({prop:r,defaultProp:i,onChange:b=>{b?(l.onOpen(),document.dispatchEvent(new CustomEvent(kC))):l.onClose(),s==null||s(b)}}),x=D.useMemo(()=>g?_.current?"delayed-open":"instant-open":"closed",[g]),T=D.useCallback(()=>{window.clearTimeout(m.current),_.current=!1,E(!0)},[E]),O=D.useCallback(()=>{window.clearTimeout(m.current),E(!1)},[E]),I=D.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{_.current=!0,E(!0)},A)},[A,E]);return D.useEffect(()=>()=>window.clearTimeout(m.current),[]),D.createElement(She,c,D.createElement(Bhe,{scope:e,contentId:p,open:g,stateAttribute:x,trigger:u,onTriggerChange:f,onTriggerEnter:D.useCallback(()=>{l.isOpenDelayed?I():T()},[l.isOpenDelayed,I,T]),onTriggerLeave:D.useCallback(()=>{y?O():window.clearTimeout(m.current)},[O,y]),onOpen:T,onClose:O,disableHoverableContent:y},t))},ZB="TooltipTrigger",khe=D.forwardRef((n,e)=>{const{__scopeTooltip:t,...r}=n,i=mA(ZB,t),s=ZR(ZB,t),o=pA(t),a=D.useRef(null),l=ap(e,a,i.onTriggerChange),c=D.useRef(!1),u=D.useRef(!1),f=D.useCallback(()=>c.current=!1,[]);return D.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),D.createElement(The,sr({asChild:!0},o),D.createElement(Ph.button,sr({"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute},r,{ref:l,onPointerMove:el(n.onPointerMove,p=>{p.pointerType!=="touch"&&!u.current&&!s.isPointerInTransitRef.current&&(i.onTriggerEnter(),u.current=!0)}),onPointerLeave:el(n.onPointerLeave,()=>{i.onTriggerLeave(),u.current=!1}),onPointerDown:el(n.onPointerDown,()=>{c.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:el(n.onFocus,()=>{c.current||i.onOpen()}),onBlur:el(n.onBlur,i.onClose),onClick:el(n.onClick,i.onClose)})))}),Fhe="TooltipPortal",[Oye,Uhe]=dA(Fhe,{forceMount:void 0}),jg="TooltipContent",zhe=D.forwardRef((n,e)=>{const t=Uhe(jg,n.__scopeTooltip),{forceMount:r=t.forceMount,side:i="top",...s}=n,o=mA(jg,n.__scopeTooltip);return D.createElement(E5,{present:r||o.open},o.disableHoverableContent?D.createElement(x5,sr({side:i},s,{ref:e})):D.createElement(Hhe,sr({side:i},s,{ref:e})))}),Hhe=D.forwardRef((n,e)=>{const t=mA(jg,n.__scopeTooltip),r=ZR(jg,n.__scopeTooltip),i=D.useRef(null),s=ap(e,i),[o,a]=D.useState(null),{trigger:l,onClose:c}=t,u=i.current,{onPointerInTransitChange:f}=r,p=D.useCallback(()=>{a(null),f(!1)},[f]),m=D.useCallback((y,A)=>{const _=y.currentTarget,g={x:y.clientX,y:y.clientY},E=jhe(g,_.getBoundingClientRect()),x=Xhe(g,E),T=Khe(A.getBoundingClientRect()),O=Yhe([...x,...T]);a(O),f(!0)},[f]);return D.useEffect(()=>()=>p(),[p]),D.useEffect(()=>{if(l&&u){const y=_=>m(_,u),A=_=>m(_,l);return l.addEventListener("pointerleave",y),u.addEventListener("pointerleave",A),()=>{l.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",A)}}},[l,u,m,p]),D.useEffect(()=>{if(o){const y=A=>{const _=A.target,g={x:A.clientX,y:A.clientY},E=(l==null?void 0:l.contains(_))||(u==null?void 0:u.contains(_)),x=!Jhe(g,o);E?p():x&&(p(),c())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[l,u,o,c,p]),D.createElement(x5,sr({},n,{ref:s}))}),[Vhe,Ghe]=dA(eI,{isInside:!1}),x5=D.forwardRef((n,e)=>{const{__scopeTooltip:t,children:r,"aria-label":i,onEscapeKeyDown:s,onPointerDownOutside:o,...a}=n,l=mA(jg,t),c=pA(t),{onClose:u}=l;return D.useEffect(()=>(document.addEventListener(kC,u),()=>document.removeEventListener(kC,u)),[u]),D.useEffect(()=>{if(l.trigger){const f=p=>{const m=p.target;m!=null&&m.contains(l.trigger)&&u()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[l.trigger,u]),D.createElement(due,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:f=>f.preventDefault(),onDismiss:u},D.createElement(Che,sr({"data-state":l.stateAttribute},c,a,{ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}}),D.createElement(YV,null,r),D.createElement(Vhe,{scope:t,isInside:!0},D.createElement(Lhe,{id:l.contentId,role:"tooltip"},i||r))))}),Whe="TooltipArrow",$he=D.forwardRef((n,e)=>{const{__scopeTooltip:t,...r}=n,i=pA(t);return Ghe(Whe,t).isInside?null:D.createElement(bhe,sr({},i,r,{ref:e}))});function jhe(n,e){const t=Math.abs(e.top-n.y),r=Math.abs(e.bottom-n.y),i=Math.abs(e.right-n.x),s=Math.abs(e.left-n.x);switch(Math.min(t,r,i,s)){case s:return"left";case i:return"right";case t:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function Xhe(n,e,t=5){const r=[];switch(e){case"top":r.push({x:n.x-t,y:n.y+t},{x:n.x+t,y:n.y+t});break;case"bottom":r.push({x:n.x-t,y:n.y-t},{x:n.x+t,y:n.y-t});break;case"left":r.push({x:n.x+t,y:n.y-t},{x:n.x+t,y:n.y+t});break;case"right":r.push({x:n.x-t,y:n.y-t},{x:n.x-t,y:n.y+t});break}return r}function Khe(n){const{top:e,right:t,bottom:r,left:i}=n;return[{x:i,y:e},{x:t,y:e},{x:t,y:r},{x:i,y:r}]}function Jhe(n,e){const{x:t,y:r}=n;let i=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){const a=e[s].x,l=e[s].y,c=e[o].x,u=e[o].y;l>r!=u>r&&t<(c-a)*(r-l)/(u-l)+a&&(i=!i)}return i}function Yhe(n){const e=n.slice();return e.sort((t,r)=>t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0),qhe(e)}function qhe(n){if(n.length<=1)return n.slice();const e=[];for(let r=0;r<n.length;r++){const i=n[r];for(;e.length>=2;){const s=e[e.length-1],o=e[e.length-2];if((s.x-o.x)*(i.y-o.y)>=(s.y-o.y)*(i.x-o.x))e.pop();else break}e.push(i)}e.pop();const t=[];for(let r=n.length-1;r>=0;r--){const i=n[r];for(;t.length>=2;){const s=t[t.length-1],o=t[t.length-2];if((s.x-o.x)*(i.y-o.y)>=(s.y-o.y)*(i.x-o.x))t.pop();else break}t.push(i)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}const Qhe=Nhe,Zhe=khe,efe=zhe,tfe=$he;function nfe(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function kn(n,e){if(n==null)return{};var t=nfe(n,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}let cr;(function(n){n[n.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",n[n.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",n[n.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",n[n.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",n[n.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",n[n.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",n[n.THEME_ERROR=6]="THEME_ERROR",n[n.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",n[n.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",n[n.EMPTY_KEY=9]="EMPTY_KEY"})(cr||(cr={}));const rfe={[cr.UNSUPPORTED_INPUT]:(n,e)=>[`An input with type \`${n}\` input was found at path \`${e}\` but it's not supported yet.`],[cr.NO_COMPONENT_FOR_TYPE]:(n,e)=>[`Type \`${n}\` found at path \`${e}\` can't be displayed in panel because no component supports it yet.`],[cr.UNKNOWN_INPUT]:(n,e)=>[`input at path \`${n}\` is not recognized.`,e],[cr.DUPLICATE_KEYS]:(n,e,t)=>[`Key \`${n}\` of path \`${e}\` already exists at path \`${t}\`. Even nested keys need to be unique. Rename one of the keys.`],[cr.ALREADY_REGISTERED_TYPE]:n=>[`Type ${n} has already been registered. You can't register a component with the same type.`],[cr.CLIPBOARD_ERROR]:n=>["Error copying the value",n],[cr.THEME_ERROR]:(n,e)=>[`Error accessing the theme \`${n}.${e}\` value.`],[cr.PATH_DOESNT_EXIST]:n=>[`Error getting the value at path \`${n}\`. There is probably an error in your \`render\` function.`],[cr.PATH_DOESNT_EXIST]:n=>[`Error accessing the value at path \`${n}\``],[cr.INPUT_TYPE_OVERRIDE]:(n,e,t)=>[`Input at path \`${n}\` already exists with type: \`${e}\`. Its type cannot be overridden with type \`${t}\`.`],[cr.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function A5(n,e,...t){const[r,...i]=rfe[e](...t);console[n]("LEVA: "+r,...i)}const nl=A5.bind(null,"warn"),ife=A5.bind(null,"log"),sfe=["value"],ofe=["schema"],afe=["value"],w5=[],_h={};function eN(n){let{value:e}=n,t=kn(n,sfe);for(let r of w5){const i=r(e,t);if(i)return i}}function Ol(n,e){let{schema:t}=e,r=kn(e,ofe);if(n in _h){nl(cr.ALREADY_REGISTERED_TYPE,n);return}w5.push((i,s)=>t(i,s)&&n),_h[n]=r}function iS(n,e,t,r){const{normalize:i}=_h[n];if(i)return i(e,t,r);if(typeof e!="object"||!("value"in e))return{value:e};const{value:s}=e,o=kn(e,afe);return{value:s,settings:o}}function lfe(n,e,t,r,i,s){const{sanitize:o}=_h[n];return o?o(e,t,r,i,s):e}function tN(n,e,t){const{format:r}=_h[n];return r?r(e,t):e}function cfe(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nN(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function kt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?nN(Object(t),!0).forEach(function(r){cfe(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):nN(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}const Wc=(n,e,t)=>n>t?t:n<e?e:n,ufe=n=>{if(n===""||typeof n=="number")return n;try{const e=nc(n);if(!isNaN(e))return e}catch{}return parseFloat(n)},hfe=Math.log(10);function rN(n){let e=Math.abs(+String(n).replace(".",""));if(e===0)return .01;for(;e!==0&&e%10===0;)e/=10;const t=Math.floor(Math.log(e)/hfe)+1,r=Math.floor(Math.log10(Math.abs(n))),i=Math.pow(10,r-t);return Math.max(i,.001)}const GE=(n,e,t)=>t===e?0:(Wc(n,e,t)-e)/(t-e),WE=(n,e,t)=>n*(t-e)+e,ffe=()=>"_"+Math.random().toString(36).substr(2,9),iN=/\(([0-9+\-*/^ .]+)\)/,sN=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,oN=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,aN=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,lN=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,cN=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function nc(n){if(isNaN(Number(n)))if(iN.test(n)){const e=n.replace(iN,(t,r)=>String(nc(r)));return nc(e)}else if(sN.test(n)){const e=n.replace(sN,(t,r,i)=>String(Math.pow(Number(r),Number(i))));return nc(e)}else if(oN.test(n)){const e=n.replace(oN,(t,r,i)=>String(Number(r)*Number(i)));return nc(e)}else if(aN.test(n)){const e=n.replace(aN,(t,r,i)=>{if(i!=0)return String(Number(r)/Number(i));throw new Error("Division by zero")});return nc(e)}else if(lN.test(n)){const e=n.replace(lN,(t,r,i)=>String(Number(r)+Number(i)));return nc(e)}else if(cN.test(n)){const e=n.replace(cN,(t,r,i)=>String(Number(r)-Number(i)));return nc(e)}else return Number(n);return Number(n)}function dfe(n,e){return e.reduce((t,r)=>(n&&n.hasOwnProperty(r)&&(t[r]=n[r]),t),{})}function pfe(n,e){const t=kt({},n);return e.forEach(r=>r in n&&delete t[r]),t}function mfe(n,e){return n.reduce((t,r,i)=>Object.assign(t,{[e[i]]:r}),{})}function S5(n){return Object.prototype.toString.call(n)==="[object Object]"}const gfe=n=>S5(n)&&Object.keys(n).length===0;let yo;(function(n){n.BUTTON="BUTTON",n.BUTTON_GROUP="BUTTON_GROUP",n.MONITOR="MONITOR",n.FOLDER="FOLDER"})(yo||(yo={}));let Qo;(function(n){n.SELECT="SELECT",n.IMAGE="IMAGE",n.NUMBER="NUMBER",n.COLOR="COLOR",n.STRING="STRING",n.BOOLEAN="BOOLEAN",n.INTERVAL="INTERVAL",n.VECTOR3D="VECTOR3D",n.VECTOR2D="VECTOR2D"})(Qo||(Qo={}));const yfe=["type","__customInput"],vfe=["render","label","optional","order","disabled","hint","onChange","onEditStart","onEditEnd","transient"],_fe=["type"];function T5(n,e,t={},r){var i,s;if(typeof n!="object"||Array.isArray(n))return{type:r,input:n,options:kt({key:e,label:e,optional:!1,disabled:!1,order:0},t)};if("__customInput"in n){const{type:O,__customInput:I}=n,b=kn(n,yfe);return T5(I,e,b,O)}const{render:o,label:a,optional:l,order:c=0,disabled:u,hint:f,onChange:p,onEditStart:m,onEditEnd:y,transient:A}=n,_=kn(n,vfe),g=kt({render:o,key:e,label:a??e,hint:f,transient:A??!!p,onEditStart:m,onEditEnd:y,disabled:u,optional:l,order:c},t);let{type:E}=_,x=kn(_,_fe);if(E=r??E,E in yo)return{type:E,input:x,options:g};let T;return r&&S5(x)&&"value"in x?T=x.value:T=gfe(x)?void 0:x,{type:E,input:T,options:kt(kt({},g),{},{onChange:p,optional:(i=g.optional)!==null&&i!==void 0?i:!1,disabled:(s=g.disabled)!==null&&s!==void 0?s:!1})}}function Efe(n,e,t,r){const i=T5(n,e),{type:s,input:o,options:a}=i;if(s)return s in yo?i:{type:s,input:iS(s,o,t,r),options:a};let l=eN(o);return l?{type:l,input:iS(l,o,t,r),options:a}:(l=eN({value:o}),l?{type:l,input:iS(l,{value:o},t,r),options:a}:!1)}function uN(n,e,t,r,i){const{value:s,type:o,settings:a}=n;n.value=C5({type:o,value:s,settings:a},e,t,r),n.fromPanel=i}const xfe=function(e,t,r){this.type="LEVA_ERROR",this.message="LEVA: "+e,this.previousValue=t,this.error=r};function C5({type:n,value:e,settings:t},r,i,s){const o=n!=="SELECT"&&typeof r=="function"?r(e):r;let a;try{a=lfe(n,o,t,e,i,s)}catch(l){throw new xfe(`The value \`${r}\` did not result in a correct value.`,e,l)}return Vg(a,e)?e:a}const b5=(n,e,t=!1)=>{let r=0;return function(){const i=arguments,s=t&&!r,o=()=>n.apply(this,i);window.clearTimeout(r),r=window.setTimeout(o,e),s&&o()}},M5=n=>n.shiftKey?5:n.altKey?1/5:1;function Afe(n,e){const t=console.error;console.error=()=>{},aF.render(n,e),console.error=t}const wfe=["value"],Sfe=["min","max"],Tfe=n=>{if(typeof n=="number")return!0;if(typeof n=="string"){const e=parseFloat(n);return isNaN(e)?!1:n.substring((""+e).length).trim().length<4}return!1},R5=(n,{min:e=-1/0,max:t=1/0,suffix:r})=>{const i=parseFloat(n);if(n===""||isNaN(i))throw Error("Invalid number");const s=Wc(i,e,t);return r?s+r:s},Cfe=(n,{pad:e=0,suffix:t})=>{const r=parseFloat(n).toFixed(e);return t?r+t:r},I5=n=>{let{value:e}=n,t=kn(n,wfe);const{min:r=-1/0,max:i=1/0}=t,s=kn(t,Sfe);let o=parseFloat(e);const a=typeof e=="string"?e.substring((""+o).length):void 0;o=Wc(o,r,i);let l=t.step;l||(Number.isFinite(r)?Number.isFinite(i)?l=+(Math.abs(i-r)/100).toPrecision(1):l=+(Math.abs(o-r)/100).toPrecision(1):Number.isFinite(i)&&(l=+(Math.abs(i-o)/100).toPrecision(1)));const c=l?rN(l)*10:rN(o);l=l||c/10;const u=Math.round(Wc(Math.log10(1/c),0,2));return{value:a?o+a:o,settings:kt({initialValue:o,step:l,pad:u,min:r,max:i,suffix:a},s)}},P5=(n,{step:e,initialValue:t})=>{const r=Math.round((n-t)/e);return t+r*e};var D5=Object.freeze({__proto__:null,schema:Tfe,sanitize:R5,format:Cfe,normalize:I5,sanitizeStep:P5});function xr(){return xr=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},xr.apply(this,arguments)}const L5=D.createContext({});function Gi(){return D.useContext(L5)}const tI=D.createContext(null),O5=D.createContext(null),B5=D.createContext(null);function By(){return D.useContext(O5)}function bfe(){return D.useContext(B5)}const N5=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function t_(n,e){const[t,r]=n.split(" "),i={};return t!=="none"&&(i.boxShadow=`${e.inset?"inset ":""}0 0 0 $borderWidths${[e.key]} $colors${t!=="default"&&t||e.borderColor}`),r&&(i.backgroundColor=r),i}const _m={$inputStyle:()=>n=>t_(n,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>n=>t_(n,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>n=>t_(n,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>n=>t_(n,{key:"$active",borderColor:"$accent1",inset:!0})},{styled:Nt,css:Bye,createTheme:Mfe,globalCss:Rfe,keyframes:Nye}=aue({prefix:"leva",theme:N5(),utils:kt(kt({},_m),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:n=>({"&:focus":_m.$focusStyle()(n)}),$focusWithin:n=>({"&:focus-within":_m.$focusStyle()(n)}),$hover:n=>({"&:hover":_m.$hoverStyle()(n)}),$active:n=>({"&:active":_m.$activeStyle()(n)})})}),Ife=Rfe({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});function Pfe(n){const e=N5();if(!n)return{theme:e,className:""};Object.keys(n).forEach(r=>{Object.assign(e[r],n[r])});const t=Mfe(e);return{theme:e,className:t.className}}function yl(n,e){const{theme:t}=D.useContext(tI);if(!(n in t)||!(e in t[n]))return nl(cr.THEME_ERROR,n,e),"";let r=e;for(;;){let i=t[n][r];if(typeof i=="string"&&i.charAt(0)==="$")r=i.substr(1);else return i}}const k5=Nt("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),F5=Nt("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${k5}`]:{paddingLeft:0}}),Dfe=Nt(F5,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),Lfe=Nt("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),Ofe=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],Bfe=["onUpdate"];function nI(n){let{innerLabel:e,value:t,onUpdate:r,onChange:i,onKeyDown:s,type:o,id:a,inputType:l="text",rows:c=0}=n,u=kn(n,Ofe);const{id:f,emitOnEditStart:p,emitOnEditEnd:m,disabled:y}=Gi(),A=a||f,_=D.useRef(null),g=c>0,E=g?"textarea":"input",x=D.useCallback(I=>b=>{const R=b.currentTarget.value;I(R)},[]);ne.useEffect(()=>{const I=_.current,b=x(R=>{r(R),m()});return I==null||I.addEventListener("blur",b),()=>I==null?void 0:I.removeEventListener("blur",b)},[x,r,m]);const T=D.useCallback(I=>{I.key==="Enter"&&x(r)(I)},[x,r]),O=Object.assign({as:E},g?{rows:c}:{},u);return ne.createElement(Lfe,{textArea:g},e&&typeof e=="string"?ne.createElement(F5,null,e):e,ne.createElement(k5,xr({levaType:o,ref:_,id:A,type:l,autoComplete:"off",spellCheck:"false",value:t,onChange:x(i),onFocus:()=>p(),onKeyPress:T,onKeyDown:s,disabled:y},O)))}function Nfe(n){let{onUpdate:e}=n,t=kn(n,Bfe);const r=D.useCallback(s=>e(ufe(s)),[e]),i=D.useCallback(s=>{const o=s.key==="ArrowUp"?1:s.key==="ArrowDown"?-1:0;if(o){s.preventDefault();const a=s.altKey?.1:s.shiftKey?10:1;e(l=>parseFloat(l)+o*a)}},[e]);return ne.createElement(nI,xr({},t,{onUpdate:r,onKeyDown:i,type:"number"}))}const $E=Nt("div",{}),FC=Nt("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]}),kfe=Nt("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${FC}::after`]:{opacity:.6},[`${$E}:hover > & + ${FC}::after`]:{opacity:.6},[`${$E}:hover > & > svg`]:{opacity:1}}),U5=Nt("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${$E}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),z5=Nt("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${U5} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),H5=Nt(z5,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),Ffe=Nt("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),Ufe=Nt("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),UC=Nt("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}}),zfe=Nt("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${UC}`]:{pointerEvents:"auto"}}}}}),V5=Nt("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"}),Hfe=Nt("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),Vfe=Nt(tfe,{fill:"$toolTipBackground"});function rI({children:n}){const{className:e}=D.useContext(tI);return ne.createElement(Rce,{className:e},n)}const Gfe=["align"];function Wfe(){const{id:n,disable:e,disabled:t}=Gi();return ne.createElement(ne.Fragment,null,ne.createElement(Ufe,{id:n+"__disable",type:"checkbox",checked:!t,onChange:()=>e(!t)}),ne.createElement("label",{htmlFor:n+"__disable"}))}function $fe(n){const{id:e,optional:t,hint:r}=Gi(),i=n.htmlFor||(e?{htmlFor:e}:null),s=!r&&typeof n.children=="string"?{title:n.children}:null;return ne.createElement(ne.Fragment,null,t&&ne.createElement(Wfe,null),r!==void 0?ne.createElement(Qhe,null,ne.createElement(Zhe,{asChild:!0},ne.createElement(UC,xr({},i,n))),ne.createElement(efe,{side:"top",sideOffset:2},ne.createElement(Hfe,null,r,ne.createElement(Vfe,null)))):ne.createElement(UC,xr({},i,s,n)))}function ia(n){let{align:e}=n,t=kn(n,Gfe);const{value:r,label:i,key:s,disabled:o}=Gi(),{hideCopyButton:a}=bfe(),l=!a&&s!==void 0,[c,u]=D.useState(!1),f=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[s]:r??""})),u(!0)}catch{nl(cr.CLIPBOARD_ERROR,{[s]:r})}};return ne.createElement(Ffe,{align:e,onPointerLeave:()=>u(!1)},ne.createElement($fe,t),l&&!o&&ne.createElement("div",{title:`Click to copy ${typeof i=="string"?i:s} value`},c?ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},ne.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),ne.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):ne.createElement("svg",{onClick:f,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},ne.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),ne.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}const jfe=["toggled"],Xfe=Nt("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function iI(n){let{toggled:e}=n,t=kn(n,jfe);return ne.createElement(Xfe,xr({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${e?0:-90}deg)`}},t),ne.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}const Kfe=["input"];function Ao(n){let{input:e}=n,t=kn(n,Kfe);return e?ne.createElement(H5,t):ne.createElement(z5,t)}function G5({value:n,type:e,settings:t,setValue:r}){const[i,s]=D.useState(tN(e,n,t)),o=D.useRef(n),a=D.useRef(t);a.current=t;const l=D.useCallback(u=>s(tN(e,u,a.current)),[e]),c=D.useCallback(u=>{try{r(u)}catch(f){const{type:p,previousValue:m}=f;if(p!=="LEVA_ERROR")throw f;l(m)}},[l,r]);return D.useEffect(()=>{Vg(n,o.current)||l(n),o.current=n},[n,l]),{displayValue:i,onChange:s,onUpdate:c}}function Ny(n,e){const{emitOnEditStart:t,emitOnEditEnd:r}=Gi();return ale(i=>{i.first&&(document.body.classList.add("leva__panel__dragged"),t==null||t());const s=n(i);return i.last&&(document.body.classList.remove("leva__panel__dragged"),r==null||r()),s},e)}function Jfe(n){const e=D.useRef(null),t=D.useRef(null),r=D.useRef(!1);return D.useEffect(()=>{const i=b5(()=>{e.current.width=e.current.offsetWidth*window.devicePixelRatio,e.current.height=e.current.offsetHeight*window.devicePixelRatio,n(e.current,t.current)},250);return window.addEventListener("resize",i),r.current||(i(),r.current=!0),()=>window.removeEventListener("resize",i)},[n]),D.useEffect(()=>{t.current=e.current.getContext("2d")},[]),[e,t]}function W5(){const n=D.useRef(null),e=D.useRef({x:0,y:0}),t=D.useCallback(r=>{Object.assign(e.current,r),n.current&&(n.current.style.transform=`translate3d(${e.current.x}px, ${e.current.y}px, 0)`)},[]);return[n,t]}const Yfe=["__refCount"],sS=(n,e)=>{if(!n[e])return null;const t=n[e];return kn(t,Yfe)};function qfe(n){const e=By(),[t,r]=D.useState(sS(e.getData(),n)),i=D.useCallback(c=>e.setValueAtPath(n,c,!0),[n,e]),s=D.useCallback(c=>e.setSettingsAtPath(n,c),[n,e]),o=D.useCallback(c=>e.disableInputAtPath(n,c),[n,e]),a=D.useCallback(()=>e.emitOnEditStart(n),[n,e]),l=D.useCallback(()=>e.emitOnEditEnd(n),[n,e]);return D.useEffect(()=>{r(sS(e.getData(),n));const c=e.useStore.subscribe(u=>sS(u.data,n),r,{equalityFn:Ly});return()=>c()},[e,n]),[t,{set:i,setSettings:s,disable:o,storeId:e.storeId,emitOnEditStart:a,emitOnEditEnd:l}]}const Qfe=Nt("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),$5=Nt("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),zC=Nt("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),j5=Nt("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),X5=Nt("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function Zfe({value:n,min:e,max:t,onDrag:r,step:i,initialValue:s}){const o=D.useRef(null),a=D.useRef(null),l=D.useRef(0),c=yl("sizes","scrubberWidth"),u=Ny(({event:p,first:m,xy:[y],movement:[A],memo:_})=>{if(m){const{width:E,left:x}=o.current.getBoundingClientRect();l.current=E-parseFloat(c),_=(p==null?void 0:p.target)===a.current?n:WE((y-x)/E,e,t)}const g=_+WE(A/l.current,0,t-e);return r(P5(g,{step:i,initialValue:s})),_}),f=GE(n,e,t);return ne.createElement(j5,xr({ref:o},u()),ne.createElement($5,null,ne.createElement(X5,{style:{left:0,right:`${(1-f)*100}%`}})),ne.createElement(zC,{ref:a,style:{left:`calc(${f} * (100% - ${c}))`}}))}const ede=ne.memo(({label:n,onUpdate:e,step:t,innerLabelTrim:r})=>{const[i,s]=D.useState(!1),o=Ny(({active:a,delta:[l],event:c,memo:u=0})=>(s(a),u+=l/2,Math.abs(u)>=1&&(e(f=>parseFloat(f)+Math.floor(u)*t*M5(c)),u=0),u));return ne.createElement(Dfe,xr({dragging:i,title:n.length>1?n:""},o()),n.slice(0,r))});function K5({label:n,id:e,displayValue:t,onUpdate:r,onChange:i,settings:s,innerLabelTrim:o=1}){const a=o>0&&ne.createElement(ede,{label:n,step:s.step,onUpdate:r,innerLabelTrim:o});return ne.createElement(Nfe,{id:e,value:String(t),onUpdate:r,onChange:i,innerLabel:a})}function tde(){const n=Gi(),{label:e,value:t,onUpdate:r,settings:i,id:s}=n,{min:o,max:a}=i,l=a!==1/0&&o!==-1/0;return ne.createElement(Ao,{input:!0},ne.createElement(ia,null,e),ne.createElement(Qfe,{hasRange:l},l&&ne.createElement(Zfe,xr({value:parseFloat(t),onDrag:r},i)),ne.createElement(K5,xr({},n,{id:s,label:"value",innerLabelTrim:l?0:1}))))}const{sanitizeStep:nde}=D5,rde=kn(D5,["sanitizeStep"]);var ide=kt({component:tde},rde);const sde=(n,e)=>ys().schema({options:ys().passesAnyOf(ys().object(),ys().array())}).test(e),ode=(n,{values:e})=>{if(e.indexOf(n)<0)throw Error("Selected value doesn't match Select options");return n},ade=(n,{values:e})=>e.indexOf(n),lde=n=>{let{value:e,options:t}=n,r,i;return Array.isArray(t)?(i=t,r=t.map(s=>String(s))):(i=Object.values(t),r=Object.keys(t)),"value"in n?i.includes(e)||(r.unshift(String(e)),i.unshift(e)):e=i[0],Object.values(t).includes(e)||(t[String(e)]=e),{value:e,settings:{keys:r,values:i}}};var cde=Object.freeze({__proto__:null,schema:sde,sanitize:ode,format:ade,normalize:lde});const ude=Nt("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),HC=Nt("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),hde=Nt("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${HC}:focus + &`]:{$focusStyle:""},[`${HC}:hover + &`]:{$hoverStyle:""}});function fde({displayValue:n,value:e,onUpdate:t,id:r,settings:i,disabled:s}){const{keys:o,values:a}=i,l=D.useRef();return e===a[n]&&(l.current=o[n]),ne.createElement(ude,null,ne.createElement(HC,{id:r,value:n,onChange:c=>t(a[Number(c.currentTarget.value)]),disabled:s},o.map((c,u)=>ne.createElement("option",{key:c,value:u},c))),ne.createElement(hde,null,l.current),ne.createElement(iI,{toggled:!0}))}function dde(){const{label:n,value:e,displayValue:t,onUpdate:r,id:i,disabled:s,settings:o}=Gi();return ne.createElement(Ao,{input:!0},ne.createElement(ia,null,n),ne.createElement(fde,{id:i,value:e,displayValue:t,onUpdate:r,settings:o,disabled:s}))}var pde=kt({component:dde},cde);const mde=n=>ys().string().test(n),gde=n=>{if(typeof n!="string")throw Error("Invalid string");return n},yde=({value:n,editable:e=!0,rows:t=!1})=>({value:n,settings:{editable:e,rows:typeof t=="number"?t:t?5:0}});var vde=Object.freeze({__proto__:null,schema:mde,sanitize:gde,normalize:yde});const _de=["displayValue","onUpdate","onChange","editable"],Ede=Nt("div",{whiteSpace:"pre-wrap"});function xde(n){let{displayValue:e,onUpdate:t,onChange:r,editable:i=!0}=n,s=kn(n,_de);return i?ne.createElement(nI,xr({value:e,onUpdate:t,onChange:r},s)):ne.createElement(Ede,null,e)}function Ade(){const{label:n,settings:e,displayValue:t,onUpdate:r,onChange:i}=Gi();return ne.createElement(Ao,{input:!0},ne.createElement(ia,null,n),ne.createElement(xde,xr({displayValue:t,onUpdate:r,onChange:i},e)))}var wde=kt({component:Ade},vde);const Sde=n=>ys().boolean().test(n),Tde=n=>{if(typeof n!="boolean")throw Error("Invalid boolean");return n};var Cde=Object.freeze({__proto__:null,schema:Sde,sanitize:Tde});const bde=Nt("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function Mde({value:n,onUpdate:e,id:t,disabled:r}){return ne.createElement(bde,null,ne.createElement("input",{id:t,type:"checkbox",checked:n,onChange:i=>e(i.currentTarget.checked),disabled:r}),ne.createElement("label",{htmlFor:t},ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ne.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}function Rde(){const{label:n,value:e,onUpdate:t,disabled:r,id:i}=Gi();return ne.createElement(Ao,{input:!0},ne.createElement(ia,null,n),ne.createElement(Mde,{value:e,onUpdate:t,id:i,disabled:r}))}var Ide=kt({component:Rde},Cde);const Pde=["locked"];function Dde({value:n,id:e,valueKey:t,settings:r,onUpdate:i,innerLabelTrim:s}){const o=D.useRef(n[t]);o.current=n[t];const a=D.useCallback(c=>i({[t]:C5({type:"NUMBER",value:o.current,settings:r},c)}),[i,r,t]),l=G5({type:"NUMBER",value:n[t],settings:r,setValue:a});return ne.createElement(K5,{id:e,label:t,value:n[t],displayValue:l.displayValue,onUpdate:l.onUpdate,onChange:l.onChange,settings:r,innerLabelTrim:s})}const Lde=Nt("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});function Ode(n){let{locked:e}=n,t=kn(n,Pde);return ne.createElement("svg",xr({width:"10",height:"10",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),e?ne.createElement("path",{d:"M5 4.63601C5 3.76031 5.24219 3.1054 5.64323 2.67357C6.03934 2.24705 6.64582 1.9783 7.5014 1.9783C8.35745 1.9783 8.96306 2.24652 9.35823 2.67208C9.75838 3.10299 10 3.75708 10 4.63325V5.99999H5V4.63601ZM4 5.99999V4.63601C4 3.58148 4.29339 2.65754 4.91049 1.99307C5.53252 1.32329 6.42675 0.978302 7.5014 0.978302C8.57583 0.978302 9.46952 1.32233 10.091 1.99162C10.7076 2.65557 11 3.57896 11 4.63325V5.99999H12C12.5523 5.99999 13 6.44771 13 6.99999V13C13 13.5523 12.5523 14 12 14H3C2.44772 14 2 13.5523 2 13V6.99999C2 6.44771 2.44772 5.99999 3 5.99999H4ZM3 6.99999H12V13H3V6.99999Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}):ne.createElement("path",{d:"M9 3.63601C9 2.76044 9.24207 2.11211 9.64154 1.68623C10.0366 1.26502 10.6432 1 11.5014 1C12.4485 1 13.0839 1.30552 13.4722 1.80636C13.8031 2.23312 14 2.84313 14 3.63325H15C15 2.68242 14.7626 1.83856 14.2625 1.19361C13.6389 0.38943 12.6743 0 11.5014 0C10.4294 0 9.53523 0.337871 8.91218 1.0021C8.29351 1.66167 8 2.58135 8 3.63601V6H1C0.447715 6 0 6.44772 0 7V13C0 13.5523 0.447715 14 1 14H10C10.5523 14 11 13.5523 11 13V7C11 6.44772 10.5523 6 10 6H9V3.63601ZM1 7H10V13H1V7Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))}function sI({value:n,onUpdate:e,settings:t,innerLabelTrim:r}){const{id:i,setSettings:s}=Gi(),{lock:o,locked:a}=t;return ne.createElement(Lde,{withLock:o},o&&ne.createElement(Ode,{locked:a,onClick:()=>s({locked:!a})}),Object.keys(n).map((l,c)=>ne.createElement(Dde,{id:c===0?i:`${i}.${l}`,key:l,valueKey:l,value:n,settings:t[l],onUpdate:e,innerLabelTrim:r})))}const J5=(n,e)=>{const t={};let r=0,i=1/0;Object.entries(n).forEach(([s,o])=>{t[s]=I5(kt({value:o},e[s])).settings,r=Math.max(r,t[s].step),i=Math.min(i,t[s].pad)});for(let s in t){const{step:o,min:a,max:l}=e[s]||{};!isFinite(o)&&(!isFinite(a)||!isFinite(l))&&(t[s].step=r,t[s].pad=i)}return t},Bde=["lock"],Nde=["value"];function kde(n){const e=ys().array().length(n).every.number(),t=r=>{if(!r||typeof r!="object")return!1;const i=Object.values(r);return i.length===n&&i.every(s=>isFinite(s))};return r=>e.test(r)||t(r)}function Fde(n){return Array.isArray(n)?"array":"object"}function Qm(n,e,t){return Fde(n)===e?n:e==="array"?Object.values(n):mfe(n,t)}const Ude=(n,e,t)=>{const r=Qm(n,"object",e.keys);for(let o in r)r[o]=R5(r[o],e[o]);const i=Object.keys(r);let s={};if(i.length===e.keys.length)s=r;else{const o=Qm(t,"object",e.keys);if(i.length===1&&e.locked){const a=i[0],l=r[a],c=o[a],u=c!==0?l/c:1;for(let f in o)f===a?s[a]=l:s[f]=o[f]*u}else s=kt(kt({},o),r)}return Qm(s,e.format,e.keys)},zde=(n,e)=>Qm(n,"object",e.keys),Hde=n=>!!n&&("step"in n||"min"in n||"max"in n);function Vde(n,e,t=[]){const{lock:r=!1}=e,i=kn(e,Bde),s=Array.isArray(n)?"array":"object",o=s==="object"?Object.keys(n):t,a=Qm(n,"object",o),l=Hde(i)?o.reduce((u,f)=>Object.assign(u,{[f]:i}),{}):i,c=J5(a,l);return{value:s==="array"?n:a,settings:kt(kt({},c),{},{format:s,keys:o,lock:r,locked:!1})}}function Y5(n){return{schema:kde(n.length),normalize:e=>{let{value:t}=e,r=kn(e,Nde);return Vde(t,r,n)},format:(e,t)=>zde(e,t),sanitize:(e,t,r)=>Ude(e,t,r)}}var Gde={grad:.9,turn:360,rad:360/(2*Math.PI)},qa=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},Zr=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t+0},po=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n>e?n:e},q5=function(n){return(n=isFinite(n)?n%360:0)>0?n:n+360},hN=function(n){return{r:po(n.r,0,255),g:po(n.g,0,255),b:po(n.b,0,255),a:po(n.a)}},oS=function(n){return{r:Zr(n.r),g:Zr(n.g),b:Zr(n.b),a:Zr(n.a,3)}},Wde=/^#([0-9a-f]{3,8})$/i,n_=function(n){var e=n.toString(16);return e.length<2?"0"+e:e},Q5=function(n){var e=n.r,t=n.g,r=n.b,i=n.a,s=Math.max(e,t,r),o=s-Math.min(e,t,r),a=o?s===e?(t-r)/o:s===t?2+(r-e)/o:4+(e-t)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},Z5=function(n){var e=n.h,t=n.s,r=n.v,i=n.a;e=e/360*6,t/=100,r/=100;var s=Math.floor(e),o=r*(1-t),a=r*(1-(e-s)*t),l=r*(1-(1-e+s)*t),c=s%6;return{r:255*[r,a,o,o,l,r][c],g:255*[l,r,r,a,o,o][c],b:255*[o,o,l,r,r,a][c],a:i}},fN=function(n){return{h:q5(n.h),s:po(n.s,0,100),l:po(n.l,0,100),a:po(n.a)}},dN=function(n){return{h:Zr(n.h),s:Zr(n.s),l:Zr(n.l),a:Zr(n.a,3)}},pN=function(n){return Z5((t=(e=n).s,{h:e.h,s:(t*=((r=e.l)<50?r:100-r)/100)>0?2*t/(r+t)*100:0,v:r+t,a:e.a}));var e,t,r},Zm=function(n){return{h:(e=Q5(n)).h,s:(i=(200-(t=e.s))*(r=e.v)/100)>0&&i<200?t*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,t,r,i},$de=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,jde=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Xde=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Kde=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,VC={string:[[function(n){var e=Wde.exec(n);return e?(n=e[1]).length<=4?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?Zr(parseInt(n[3]+n[3],16)/255,2):1}:n.length===6||n.length===8?{r:parseInt(n.substr(0,2),16),g:parseInt(n.substr(2,2),16),b:parseInt(n.substr(4,2),16),a:n.length===8?Zr(parseInt(n.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(n){var e=Xde.exec(n)||Kde.exec(n);return e?e[2]!==e[4]||e[4]!==e[6]?null:hN({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(n){var e=$de.exec(n)||jde.exec(n);if(!e)return null;var t,r,i=fN({h:(t=e[1],r=e[2],r===void 0&&(r="deg"),Number(t)*(Gde[r]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return pN(i)},"hsl"]],object:[[function(n){var e=n.r,t=n.g,r=n.b,i=n.a,s=i===void 0?1:i;return qa(e)&&qa(t)&&qa(r)?hN({r:Number(e),g:Number(t),b:Number(r),a:Number(s)}):null},"rgb"],[function(n){var e=n.h,t=n.s,r=n.l,i=n.a,s=i===void 0?1:i;if(!qa(e)||!qa(t)||!qa(r))return null;var o=fN({h:Number(e),s:Number(t),l:Number(r),a:Number(s)});return pN(o)},"hsl"],[function(n){var e=n.h,t=n.s,r=n.v,i=n.a,s=i===void 0?1:i;if(!qa(e)||!qa(t)||!qa(r))return null;var o=function(a){return{h:q5(a.h),s:po(a.s,0,100),v:po(a.v,0,100),a:po(a.a)}}({h:Number(e),s:Number(t),v:Number(r),a:Number(s)});return Z5(o)},"hsv"]]},mN=function(n,e){for(var t=0;t<e.length;t++){var r=e[t][0](n);if(r)return[r,e[t][1]]}return[null,void 0]},e9=function(n){return typeof n=="string"?mN(n.trim(),VC.string):typeof n=="object"&&n!==null?mN(n,VC.object):[null,void 0]},Jde=function(n){return e9(n)[1]},aS=function(n,e){var t=Zm(n);return{h:t.h,s:po(t.s+100*e,0,100),l:t.l,a:t.a}},lS=function(n){return(299*n.r+587*n.g+114*n.b)/1e3/255},gN=function(n,e){var t=Zm(n);return{h:t.h,s:t.s,l:po(t.l+100*e,0,100),a:t.a}},GC=function(){function n(e){this.parsed=e9(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return n.prototype.isValid=function(){return this.parsed!==null},n.prototype.brightness=function(){return Zr(lS(this.rgba),2)},n.prototype.isDark=function(){return lS(this.rgba)<.5},n.prototype.isLight=function(){return lS(this.rgba)>=.5},n.prototype.toHex=function(){return e=oS(this.rgba),t=e.r,r=e.g,i=e.b,o=(s=e.a)<1?n_(Zr(255*s)):"","#"+n_(t)+n_(r)+n_(i)+o;var e,t,r,i,s,o},n.prototype.toRgb=function(){return oS(this.rgba)},n.prototype.toRgbString=function(){return e=oS(this.rgba),t=e.r,r=e.g,i=e.b,(s=e.a)<1?"rgba("+t+", "+r+", "+i+", "+s+")":"rgb("+t+", "+r+", "+i+")";var e,t,r,i,s},n.prototype.toHsl=function(){return dN(Zm(this.rgba))},n.prototype.toHslString=function(){return e=dN(Zm(this.rgba)),t=e.h,r=e.s,i=e.l,(s=e.a)<1?"hsla("+t+", "+r+"%, "+i+"%, "+s+")":"hsl("+t+", "+r+"%, "+i+"%)";var e,t,r,i,s},n.prototype.toHsv=function(){return e=Q5(this.rgba),{h:Zr(e.h),s:Zr(e.s),v:Zr(e.v),a:Zr(e.a,3)};var e},n.prototype.invert=function(){return qi({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},n.prototype.saturate=function(e){return e===void 0&&(e=.1),qi(aS(this.rgba,e))},n.prototype.desaturate=function(e){return e===void 0&&(e=.1),qi(aS(this.rgba,-e))},n.prototype.grayscale=function(){return qi(aS(this.rgba,-1))},n.prototype.lighten=function(e){return e===void 0&&(e=.1),qi(gN(this.rgba,e))},n.prototype.darken=function(e){return e===void 0&&(e=.1),qi(gN(this.rgba,-e))},n.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},n.prototype.alpha=function(e){return typeof e=="number"?qi({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):Zr(this.rgba.a,3);var t},n.prototype.hue=function(e){var t=Zm(this.rgba);return typeof e=="number"?qi({h:e,s:t.s,l:t.l,a:t.a}):Zr(t.h)},n.prototype.isEqual=function(e){return this.toHex()===qi(e).toHex()},n}(),qi=function(n){return n instanceof GC?n:new GC(n)},yN=[],Yde=function(n){n.forEach(function(e){yN.indexOf(e)<0&&(e(GC,VC),yN.push(e))})};function qde(n,e){var t={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in t)r[t[i]]=i;var s={};n.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,c=r[this.toHex()];if(c)return c;if(o!=null&&o.closest){var u=this.toRgb(),f=1/0,p="black";if(!s.length)for(var m in t)s[m]=new n(t[m]).toRgb();for(var y in t){var A=(a=u,l=s[y],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));A<f&&(f=A,p=y)}return p}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":t[a];return l?new n(l).toRgb():null},"name"])}function fp(){return(fp=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n}).apply(this,arguments)}function oI(n,e){if(n==null)return{};var t,r,i={},s=Object.keys(n);for(r=0;r<s.length;r++)e.indexOf(t=s[r])>=0||(i[t]=n[t]);return i}function WC(n){var e=D.useRef(n),t=D.useRef(function(r){e.current&&e.current(r)});return e.current=n,t.current}var Hd=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n<e?e:n},eg=function(n){return"touches"in n},$C=function(n){return n&&n.ownerDocument.defaultView||self},vN=function(n,e,t){var r=n.getBoundingClientRect(),i=eg(e)?function(s,o){for(var a=0;a<s.length;a++)if(s[a].identifier===o)return s[a];return s[0]}(e.touches,t):e;return{left:Hd((i.pageX-(r.left+$C(n).pageXOffset))/r.width),top:Hd((i.pageY-(r.top+$C(n).pageYOffset))/r.height)}},_N=function(n){!eg(n)&&n.preventDefault()},aI=ne.memo(function(n){var e=n.onMove,t=n.onKey,r=oI(n,["onMove","onKey"]),i=D.useRef(null),s=WC(e),o=WC(t),a=D.useRef(null),l=D.useRef(!1),c=D.useMemo(function(){var m=function(_){_N(_),(eg(_)?_.touches.length>0:_.buttons>0)&&i.current?s(vN(i.current,_,a.current)):A(!1)},y=function(){return A(!1)};function A(_){var g=l.current,E=$C(i.current),x=_?E.addEventListener:E.removeEventListener;x(g?"touchmove":"mousemove",m),x(g?"touchend":"mouseup",y)}return[function(_){var g=_.nativeEvent,E=i.current;if(E&&(_N(g),!function(T,O){return O&&!eg(T)}(g,l.current)&&E)){if(eg(g)){l.current=!0;var x=g.changedTouches||[];x.length&&(a.current=x[0].identifier)}E.focus(),s(vN(E,g,a.current)),A(!0)}},function(_){var g=_.which||_.keyCode;g<37||g>40||(_.preventDefault(),o({left:g===39?.05:g===37?-.05:0,top:g===40?.05:g===38?-.05:0}))},A]},[o,s]),u=c[0],f=c[1],p=c[2];return D.useEffect(function(){return p},[p]),ne.createElement("div",fp({},r,{onTouchStart:u,onMouseDown:u,className:"react-colorful__interactive",ref:i,onKeyDown:f,tabIndex:0,role:"slider"}))}),ky=function(n){return n.filter(Boolean).join(" ")},lI=function(n){var e=n.color,t=n.left,r=n.top,i=r===void 0?.5:r,s=ky(["react-colorful__pointer",n.className]);return ne.createElement("div",{className:s,style:{top:100*i+"%",left:100*t+"%"}},ne.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:e}}))},Zi=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t},t9=function(n){var e=n.s,t=n.v,r=n.a,i=(200-e)*t/100;return{h:Zi(n.h),s:Zi(i>0&&i<200?e*t/100/(i<=100?i:200-i)*100:0),l:Zi(i/2),a:Zi(r,2)}},jC=function(n){var e=t9(n);return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},cS=function(n){var e=t9(n);return"hsla("+e.h+", "+e.s+"%, "+e.l+"%, "+e.a+")"},n9=function(n){var e=n.h,t=n.s,r=n.v,i=n.a;e=e/360*6,t/=100,r/=100;var s=Math.floor(e),o=r*(1-t),a=r*(1-(e-s)*t),l=r*(1-(1-e+s)*t),c=s%6;return{r:Zi(255*[r,a,o,o,l,r][c]),g:Zi(255*[l,r,r,a,o,o][c]),b:Zi(255*[o,o,l,r,r,a][c]),a:Zi(i,2)}},r9=function(n){var e=n.r,t=n.g,r=n.b,i=n.a,s=Math.max(e,t,r),o=s-Math.min(e,t,r),a=o?s===e?(t-r)/o:s===t?2+(r-e)/o:4+(e-t)/o:0;return{h:Zi(60*(a<0?a+6:a)),s:Zi(s?o/s*100:0),v:Zi(s/255*100),a:i}},i9=ne.memo(function(n){var e=n.hue,t=n.onChange,r=ky(["react-colorful__hue",n.className]);return ne.createElement("div",{className:r},ne.createElement(aI,{onMove:function(i){t({h:360*i.left})},onKey:function(i){t({h:Hd(e+360*i.left,0,360)})},"aria-label":"Hue","aria-valuenow":Zi(e),"aria-valuemax":"360","aria-valuemin":"0"},ne.createElement(lI,{className:"react-colorful__hue-pointer",left:e/360,color:jC({h:e,s:100,v:100,a:1})})))}),s9=ne.memo(function(n){var e=n.hsva,t=n.onChange,r={backgroundColor:jC({h:e.h,s:100,v:100,a:1})};return ne.createElement("div",{className:"react-colorful__saturation",style:r},ne.createElement(aI,{onMove:function(i){t({s:100*i.left,v:100-100*i.top})},onKey:function(i){t({s:Hd(e.s+100*i.left,0,100),v:Hd(e.v-100*i.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+Zi(e.s)+"%, Brightness "+Zi(e.v)+"%"},ne.createElement(lI,{className:"react-colorful__saturation-pointer",top:1-e.v/100,left:e.s/100,color:jC(e)})))}),cI=function(n,e){if(n===e)return!0;for(var t in n)if(n[t]!==e[t])return!1;return!0};function o9(n,e,t){var r=WC(t),i=D.useState(function(){return n.toHsva(e)}),s=i[0],o=i[1],a=D.useRef({color:e,hsva:s});D.useEffect(function(){if(!n.equal(e,a.current.color)){var c=n.toHsva(e);a.current={hsva:c,color:e},o(c)}},[e,n]),D.useEffect(function(){var c;cI(s,a.current.hsva)||n.equal(c=n.fromHsva(s),a.current.color)||(a.current={hsva:s,color:c},r(c))},[s,n,r]);var l=D.useCallback(function(c){o(function(u){return Object.assign({},u,c)})},[]);return[s,l]}var Qde=typeof window<"u"?D.useLayoutEffect:D.useEffect,Zde=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},EN=new Map,a9=function(n){Qde(function(){var e=n.current?n.current.ownerDocument:document;if(e!==void 0&&!EN.has(e)){var t=e.createElement("style");t.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,EN.set(e,t);var r=Zde();r&&t.setAttribute("nonce",r),e.head.appendChild(t)}},[])},epe=function(n){var e=n.className,t=n.colorModel,r=n.color,i=r===void 0?t.defaultColor:r,s=n.onChange,o=oI(n,["className","colorModel","color","onChange"]),a=D.useRef(null);a9(a);var l=o9(t,i,s),c=l[0],u=l[1],f=ky(["react-colorful",e]);return ne.createElement("div",fp({},o,{ref:a,className:f}),ne.createElement(s9,{hsva:c,onChange:u}),ne.createElement(i9,{hue:c.h,onChange:u,className:"react-colorful__last-control"}))},tpe=function(n){var e=n.className,t=n.hsva,r=n.onChange,i={backgroundImage:"linear-gradient(90deg, "+cS(Object.assign({},t,{a:0}))+", "+cS(Object.assign({},t,{a:1}))+")"},s=ky(["react-colorful__alpha",e]),o=Zi(100*t.a);return ne.createElement("div",{className:s},ne.createElement("div",{className:"react-colorful__alpha-gradient",style:i}),ne.createElement(aI,{onMove:function(a){r({a:a.left})},onKey:function(a){r({a:Hd(t.a+a.left)})},"aria-label":"Alpha","aria-valuetext":o+"%","aria-valuenow":o,"aria-valuemin":"0","aria-valuemax":"100"},ne.createElement(lI,{className:"react-colorful__alpha-pointer",left:t.a,color:cS(t)})))},npe=function(n){var e=n.className,t=n.colorModel,r=n.color,i=r===void 0?t.defaultColor:r,s=n.onChange,o=oI(n,["className","colorModel","color","onChange"]),a=D.useRef(null);a9(a);var l=o9(t,i,s),c=l[0],u=l[1],f=ky(["react-colorful",e]);return ne.createElement("div",fp({},o,{ref:a,className:f}),ne.createElement(s9,{hsva:c,onChange:u}),ne.createElement(i9,{hue:c.h,onChange:u}),ne.createElement(tpe,{hsva:c,onChange:u,className:"react-colorful__last-control"}))},rpe={defaultColor:{r:0,g:0,b:0,a:1},toHsva:r9,fromHsva:n9,equal:cI},ipe=function(n){return ne.createElement(npe,fp({},n,{colorModel:rpe}))},spe={defaultColor:{r:0,g:0,b:0},toHsva:function(n){return r9({r:n.r,g:n.g,b:n.b,a:1})},fromHsva:function(n){return{r:(e=n9(n)).r,g:e.g,b:e.b};var e},equal:cI},ope=function(n){return ne.createElement(epe,fp({},n,{colorModel:spe}))};function dp(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(f){o(f)}}function l(u){try{c(r.throw(u))}catch(f){o(f)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})}function pp(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function ape(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return s}function lpe(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(ape(arguments[e]));return n}var cpe=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function Fy(n,e){var t=upe(n);if(typeof t.path!="string"){var r=n.webkitRelativePath;Object.defineProperty(t,"path",{value:typeof e=="string"?e:typeof r=="string"&&r.length>0?r:n.name,writable:!1,configurable:!1,enumerable:!0})}return t}function upe(n){var e=n.name,t=e&&e.lastIndexOf(".")!==-1;if(t&&!n.type){var r=e.split(".").pop().toLowerCase(),i=cpe.get(r);i&&Object.defineProperty(n,"type",{value:i,writable:!1,configurable:!1,enumerable:!0})}return n}var hpe=[".DS_Store","Thumbs.db"];function fpe(n){return dp(this,void 0,void 0,function(){return pp(this,function(e){return jE(n)&&dpe(n)?[2,ype(n.dataTransfer,n.type)]:ppe(n)?[2,mpe(n)]:Array.isArray(n)&&n.every(function(t){return"getFile"in t&&typeof t.getFile=="function"})?[2,gpe(n)]:[2,[]]})})}function dpe(n){return jE(n.dataTransfer)}function ppe(n){return jE(n)&&jE(n.target)}function jE(n){return typeof n=="object"&&n!==null}function mpe(n){return XC(n.target.files).map(function(e){return Fy(e)})}function gpe(n){return dp(this,void 0,void 0,function(){var e;return pp(this,function(t){switch(t.label){case 0:return[4,Promise.all(n.map(function(r){return r.getFile()}))];case 1:return e=t.sent(),[2,e.map(function(r){return Fy(r)})]}})})}function ype(n,e){return dp(this,void 0,void 0,function(){var t,r;return pp(this,function(i){switch(i.label){case 0:return n===null?[2,[]]:n.items?(t=XC(n.items).filter(function(s){return s.kind==="file"}),e!=="drop"?[2,t]:[4,Promise.all(t.map(vpe))]):[3,2];case 1:return r=i.sent(),[2,xN(l9(r))];case 2:return[2,xN(XC(n.files).map(function(s){return Fy(s)}))]}})})}function xN(n){return n.filter(function(e){return hpe.indexOf(e.name)===-1})}function XC(n){if(n===null)return[];for(var e=[],t=0;t<n.length;t++){var r=n[t];e.push(r)}return e}function vpe(n){if(typeof n.webkitGetAsEntry!="function")return AN(n);var e=n.webkitGetAsEntry();return e&&e.isDirectory?c9(e):AN(n)}function l9(n){return n.reduce(function(e,t){return lpe(e,Array.isArray(t)?l9(t):[t])},[])}function AN(n){var e=n.getAsFile();if(!e)return Promise.reject(n+" is not a File");var t=Fy(e);return Promise.resolve(t)}function _pe(n){return dp(this,void 0,void 0,function(){return pp(this,function(e){return[2,n.isDirectory?c9(n):Epe(n)]})})}function c9(n){var e=n.createReader();return new Promise(function(t,r){var i=[];function s(){var o=this;e.readEntries(function(a){return dp(o,void 0,void 0,function(){var l,c,u;return pp(this,function(f){switch(f.label){case 0:if(a.length)return[3,5];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,Promise.all(i)];case 2:return l=f.sent(),t(l),[3,4];case 3:return c=f.sent(),r(c),[3,4];case 4:return[3,6];case 5:u=Promise.all(a.map(_pe)),i.push(u),s(),f.label=6;case 6:return[2]}})})},function(a){r(a)})}s()})}function Epe(n){return dp(this,void 0,void 0,function(){return pp(this,function(e){return[2,new Promise(function(t,r){n.file(function(i){var s=Fy(i,n.fullPath);t(s)},function(i){r(i)})})]})})}var xpe=function(n,e){if(n&&e){var t=Array.isArray(e)?e:e.split(","),r=n.name||"",i=(n.type||"").toLowerCase(),s=i.replace(/\/.*$/,"");return t.some(function(o){var a=o.trim().toLowerCase();return a.charAt(0)==="."?r.toLowerCase().endsWith(a):a.endsWith("/*")?s===a.replace(/\/.*$/,""):i===a})}return!0};function wN(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function SN(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wN(Object(t),!0).forEach(function(r){u9(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):wN(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function u9(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TN(n,e){return Tpe(n)||Spe(n,e)||wpe(n,e)||Ape()}function Ape(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wpe(n,e){if(n){if(typeof n=="string")return CN(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return CN(n,e)}}function CN(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Spe(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r=[],i=!0,s=!1,o,a;try{for(t=t.call(n);!(i=(o=t.next()).done)&&(r.push(o.value),!(e&&r.length===e));i=!0);}catch(l){s=!0,a=l}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw a}}return r}}function Tpe(n){if(Array.isArray(n))return n}var Cpe="file-invalid-type",bpe="file-too-large",Mpe="file-too-small",Rpe="too-many-files",Ipe=function(e){e=Array.isArray(e)&&e.length===1?e[0]:e;var t=Array.isArray(e)?"one of ".concat(e.join(", ")):e;return{code:Cpe,message:"File type must be ".concat(t)}},bN=function(e){return{code:bpe,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},MN=function(e){return{code:Mpe,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},Ppe={code:Rpe,message:"Too many files"};function h9(n,e){var t=n.type==="application/x-moz-file"||xpe(n,e);return[t,t?null:Ipe(e)]}function f9(n,e,t){if(Em(n.size))if(Em(e)&&Em(t)){if(n.size>t)return[!1,bN(t)];if(n.size<e)return[!1,MN(e)]}else{if(Em(e)&&n.size<e)return[!1,MN(e)];if(Em(t)&&n.size>t)return[!1,bN(t)]}return[!0,null]}function Em(n){return n!=null}function Dpe(n){var e=n.files,t=n.accept,r=n.minSize,i=n.maxSize,s=n.multiple,o=n.maxFiles;return!s&&e.length>1||s&&o>=1&&e.length>o?!1:e.every(function(a){var l=h9(a,t),c=TN(l,1),u=c[0],f=f9(a,r,i),p=TN(f,1),m=p[0];return u&&m})}function XE(n){return typeof n.isPropagationStopped=="function"?n.isPropagationStopped():typeof n.cancelBubble<"u"?n.cancelBubble:!1}function r_(n){return n.dataTransfer?Array.prototype.some.call(n.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!n.target&&!!n.target.files}function RN(n){n.preventDefault()}function Lpe(n){return n.indexOf("MSIE")!==-1||n.indexOf("Trident/")!==-1}function Ope(n){return n.indexOf("Edge/")!==-1}function Bpe(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return Lpe(n)||Ope(n)}function da(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return e.some(function(a){return!XE(r)&&a&&a.apply(void 0,[r].concat(s)),XE(r)})}}function Npe(){return"showOpenFilePicker"in window}function kpe(n){return n=typeof n=="string"?n.split(","):n,[{description:"everything",accept:Array.isArray(n)?n.filter(function(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}).reduce(function(e,t){return SN(SN({},e),{},u9({},t,[]))},{}):{}}]}function Fpe(n){return n instanceof DOMException&&(n.name==="AbortError"||n.code===n.ABORT_ERR)}function Upe(n){return n instanceof DOMException&&(n.name==="SecurityError"||n.code===n.SECURITY_ERR)}var zpe=["children"],Hpe=["open"],Vpe=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],Gpe=["refKey","onChange","onClick"];function Wpe(n){return Xpe(n)||jpe(n)||d9(n)||$pe()}function $pe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jpe(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Xpe(n){if(Array.isArray(n))return KC(n)}function uS(n,e){return Ype(n)||Jpe(n,e)||d9(n,e)||Kpe()}function Kpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d9(n,e){if(n){if(typeof n=="string")return KC(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return KC(n,e)}}function KC(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Jpe(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r=[],i=!0,s=!1,o,a;try{for(t=t.call(n);!(i=(o=t.next()).done)&&(r.push(o.value),!(e&&r.length===e));i=!0);}catch(l){s=!0,a=l}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw a}}return r}}function Ype(n){if(Array.isArray(n))return n}function IN(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function lr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?IN(Object(t),!0).forEach(function(r){JC(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):IN(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function JC(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function KE(n,e){if(n==null)return{};var t=qpe(n,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function qpe(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}var uI=D.forwardRef(function(n,e){var t=n.children,r=KE(n,zpe),i=m9(r),s=i.open,o=KE(i,Hpe);return D.useImperativeHandle(e,function(){return{open:s}},[s]),ne.createElement(D.Fragment,null,t(lr(lr({},o),{},{open:s})))});uI.displayName="Dropzone";var p9={disabled:!1,getFilesFromEvent:fpe,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0};uI.defaultProps=p9;uI.propTypes={children:Vn.func,accept:Vn.oneOfType([Vn.string,Vn.arrayOf(Vn.string)]),multiple:Vn.bool,preventDropOnDocument:Vn.bool,noClick:Vn.bool,noKeyboard:Vn.bool,noDrag:Vn.bool,noDragEventsBubbling:Vn.bool,minSize:Vn.number,maxSize:Vn.number,maxFiles:Vn.number,disabled:Vn.bool,getFilesFromEvent:Vn.func,onFileDialogCancel:Vn.func,onFileDialogOpen:Vn.func,useFsAccessApi:Vn.bool,onDragEnter:Vn.func,onDragLeave:Vn.func,onDragOver:Vn.func,onDrop:Vn.func,onDropAccepted:Vn.func,onDropRejected:Vn.func,validator:Vn.func};var YC={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function m9(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=lr(lr({},p9),n),t=e.accept,r=e.disabled,i=e.getFilesFromEvent,s=e.maxSize,o=e.minSize,a=e.multiple,l=e.maxFiles,c=e.onDragEnter,u=e.onDragLeave,f=e.onDragOver,p=e.onDrop,m=e.onDropAccepted,y=e.onDropRejected,A=e.onFileDialogCancel,_=e.onFileDialogOpen,g=e.useFsAccessApi,E=e.preventDropOnDocument,x=e.noClick,T=e.noKeyboard,O=e.noDrag,I=e.noDragEventsBubbling,b=e.validator,R=D.useMemo(function(){return typeof _=="function"?_:PN},[_]),C=D.useMemo(function(){return typeof A=="function"?A:PN},[A]),M=D.useRef(null),B=D.useRef(null),F=D.useReducer(Qpe,YC),z=uS(F,2),j=z[0],Y=z[1],oe=j.isFocused,le=j.isFileDialogActive,X=j.draggedFiles,ee=D.useRef(typeof window<"u"&&window.isSecureContext&&g&&Npe()),ie=function(){!ee.current&&le&&setTimeout(function(){if(B.current){var ye=B.current.files;ye.length||(Y({type:"closeDialog"}),C())}},300)};D.useEffect(function(){return window.addEventListener("focus",ie,!1),function(){window.removeEventListener("focus",ie,!1)}},[B,le,C,ee]);var fe=D.useRef([]),me=function(ye){M.current&&M.current.contains(ye.target)||(ye.preventDefault(),fe.current=[])};D.useEffect(function(){return E&&(document.addEventListener("dragover",RN,!1),document.addEventListener("drop",me,!1)),function(){E&&(document.removeEventListener("dragover",RN),document.removeEventListener("drop",me))}},[M,E]);var he=D.useCallback(function(pe){pe.preventDefault(),pe.persist(),Me(pe),fe.current=[].concat(Wpe(fe.current),[pe.target]),r_(pe)&&Promise.resolve(i(pe)).then(function(ye){XE(pe)&&!I||(Y({draggedFiles:ye,isDragActive:!0,type:"setDraggedFiles"}),c&&c(pe))})},[i,c,I]),Ae=D.useCallback(function(pe){pe.preventDefault(),pe.persist(),Me(pe);var ye=r_(pe);if(ye&&pe.dataTransfer)try{pe.dataTransfer.dropEffect="copy"}catch{}return ye&&f&&f(pe),!1},[f,I]),De=D.useCallback(function(pe){pe.preventDefault(),pe.persist(),Me(pe);var ye=fe.current.filter(function(Ge){return M.current&&M.current.contains(Ge)}),qe=ye.indexOf(pe.target);qe!==-1&&ye.splice(qe,1),fe.current=ye,!(ye.length>0)&&(Y({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),r_(pe)&&u&&u(pe))},[M,u,I]),Ie=D.useCallback(function(pe,ye){var qe=[],Ge=[];pe.forEach(function(Ke){var yt=h9(Ke,t),At=uS(yt,2),Ue=At[0],Qt=At[1],Ht=f9(Ke,o,s),wt=uS(Ht,2),it=wt[0],at=wt[1],Ct=b?b(Ke):null;if(Ue&&it&&!Ct)qe.push(Ke);else{var bt=[Qt,at];Ct&&(bt=bt.concat(Ct)),Ge.push({file:Ke,errors:bt.filter(function(Wt){return Wt})})}}),(!a&&qe.length>1||a&&l>=1&&qe.length>l)&&(qe.forEach(function(Ke){Ge.push({file:Ke,errors:[Ppe]})}),qe.splice(0)),Y({acceptedFiles:qe,fileRejections:Ge,type:"setFiles"}),p&&p(qe,Ge,ye),Ge.length>0&&y&&y(Ge,ye),qe.length>0&&m&&m(qe,ye)},[Y,a,t,o,s,l,p,m,y,b]),He=D.useCallback(function(pe){pe.preventDefault(),pe.persist(),Me(pe),fe.current=[],r_(pe)&&Promise.resolve(i(pe)).then(function(ye){XE(pe)&&!I||Ie(ye,pe)}),Y({type:"reset"})},[i,Ie,I]),rt=D.useCallback(function(){if(ee.current){Y({type:"openDialog"}),R();var pe={multiple:a,types:kpe(t)};window.showOpenFilePicker(pe).then(function(ye){return i(ye)}).then(function(ye){Ie(ye,null),Y({type:"closeDialog"})}).catch(function(ye){Fpe(ye)?(C(ye),Y({type:"closeDialog"})):Upe(ye)&&(ee.current=!1,B.current&&(B.current.value=null,B.current.click()))});return}B.current&&(Y({type:"openDialog"}),R(),B.current.value=null,B.current.click())},[Y,R,C,g,Ie,t,a]),vt=D.useCallback(function(pe){!M.current||!M.current.isEqualNode(pe.target)||(pe.key===" "||pe.key==="Enter"||pe.keyCode===32||pe.keyCode===13)&&(pe.preventDefault(),rt())},[M,rt]),Qe=D.useCallback(function(){Y({type:"focus"})},[]),Xe=D.useCallback(function(){Y({type:"blur"})},[]),te=D.useCallback(function(){x||(Bpe()?setTimeout(rt,0):rt())},[x,rt]),Le=function(ye){return r?null:ye},be=function(ye){return T?null:Le(ye)},Ne=function(ye){return O?null:Le(ye)},Me=function(ye){I&&ye.stopPropagation()},ot=D.useMemo(function(){return function(){var pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ye=pe.refKey,qe=ye===void 0?"ref":ye,Ge=pe.role,Ke=pe.onKeyDown,yt=pe.onFocus,At=pe.onBlur,Ue=pe.onClick,Qt=pe.onDragEnter,Ht=pe.onDragOver,wt=pe.onDragLeave,it=pe.onDrop,at=KE(pe,Vpe);return lr(lr(JC({onKeyDown:be(da(Ke,vt)),onFocus:be(da(yt,Qe)),onBlur:be(da(At,Xe)),onClick:Le(da(Ue,te)),onDragEnter:Ne(da(Qt,he)),onDragOver:Ne(da(Ht,Ae)),onDragLeave:Ne(da(wt,De)),onDrop:Ne(da(it,He)),role:typeof Ge=="string"&&Ge!==""?Ge:"button"},qe,M),!r&&!T?{tabIndex:0}:{}),at)}},[M,vt,Qe,Xe,te,he,Ae,De,He,T,O,r]),Ze=D.useCallback(function(pe){pe.stopPropagation()},[]),$=D.useMemo(function(){return function(){var pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ye=pe.refKey,qe=ye===void 0?"ref":ye,Ge=pe.onChange,Ke=pe.onClick,yt=KE(pe,Gpe),At=JC({accept:t,multiple:a,type:"file",style:{display:"none"},onChange:Le(da(Ge,He)),onClick:Le(da(Ke,Ze)),tabIndex:-1},qe,B);return lr(lr({},At),yt)}},[B,t,a,He,r]),V=X.length,ce=V>0&&Dpe({files:X,accept:t,minSize:o,maxSize:s,multiple:a,maxFiles:l}),ke=V>0&&!ce;return lr(lr({},j),{},{isDragAccept:ce,isDragReject:ke,isFocused:oe&&!r,getRootProps:ot,getInputProps:$,rootRef:M,inputRef:B,open:Le(rt)})}function Qpe(n,e){switch(e.type){case"focus":return lr(lr({},n),{},{isFocused:!0});case"blur":return lr(lr({},n),{},{isFocused:!1});case"openDialog":return lr(lr({},YC),{},{isFileDialogActive:!0});case"closeDialog":return lr(lr({},n),{},{isFileDialogActive:!1});case"setDraggedFiles":var t=e.isDragActive,r=e.draggedFiles;return lr(lr({},n),{},{draggedFiles:r,isDragActive:t});case"setFiles":return lr(lr({},n),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections});case"reset":return lr({},YC);default:return n}}function PN(){}/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var Zpe=function(e){return e!=null&&typeof e=="object"&&Array.isArray(e)===!1};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var eme=Zpe;function DN(n){return eme(n)===!0&&Object.prototype.toString.call(n)==="[object Object]"}var g9=function(e){var t,r;return!(DN(e)===!1||(t=e.constructor,typeof t!="function")||(r=t.prototype,DN(r)===!1)||r.hasOwnProperty("isPrototypeOf")===!1)};/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var tme=g9,hI=function(e){return tme(e)||typeof e=="function"||Array.isArray(e)};/*!
 * for-in <https://github.com/jonschlinkert/for-in>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var nme=function(e,t,r){for(var i in e)if(t.call(r,e[i],i,e)===!1)break},rme=hI,ime=nme;function y9(n,e){for(var t=arguments.length,r=0;++r<t;){var i=arguments[r];qC(i)&&ime(i,sme,n)}return n}function sme(n,e){if(ome(e)){var t=this[e];qC(n)&&qC(t)?y9(t,n):this[e]=n}}function qC(n){return rme(n)&&!Array.isArray(n)}function ome(n){return n!=="__proto__"&&n!=="constructor"&&n!=="prototype"}var ame=y9;/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var lme=function(n,e,t,r,i){if(!cme(n)||!e)return n;if(e=i_(e),t&&(e+="."+i_(t)),r&&(e+="."+i_(r)),i&&(e+="."+i_(i)),e in n)return n[e];for(var s=e.split("."),o=s.length,a=-1;n&&++a<o;){for(var l=s[a];l[l.length-1]==="\\";)l=l.slice(0,-1)+"."+s[++a];n=n[l]}return n};function cme(n){return n!==null&&(typeof n=="object"||typeof n=="function")}function i_(n){return n?Array.isArray(n)?n.join("."):n:""}/*!
 * assign-symbols <https://github.com/jonschlinkert/assign-symbols>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var ume=function(n,e){if(n===null||typeof n>"u")throw new TypeError("expected first argument to be an object.");if(typeof e>"u"||typeof Symbol>"u"||typeof Object.getOwnPropertySymbols!="function")return n;for(var t=Object.prototype.propertyIsEnumerable,r=Object(n),i=arguments.length,s=0;++s<i;)for(var o=Object(arguments[s]),a=Object.getOwnPropertySymbols(o),l=0;l<a.length;l++){var c=a[l];t.call(o,c)&&(r[c]=o[c])}return r},hme=hI,fme=ume,dme=Object.assign||function(n){if(n===null||typeof n>"u")throw new TypeError("Cannot convert undefined or null to object");LN(n)||(n={});for(var e=1;e<arguments.length;e++){var t=arguments[e];mme(t)&&(t=gme(t)),LN(t)&&(pme(n,t),fme(n,t))}return n};function pme(n,e){for(var t in e)yme(e,t)&&(n[t]=e[t])}function mme(n){return n&&typeof n=="string"}function gme(n){var e={};for(var t in n)e[t]=n[t];return e}function LN(n){return n&&typeof n=="object"||hme(n)}function yme(n,e){return Object.prototype.hasOwnProperty.call(n,e)}/*!
 * split-string <https://github.com/jonschlinkert/split-string>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var vme=dme,_me=function(n,e,t){if(typeof n!="string")throw new TypeError("expected a string");typeof e=="function"&&(t=e,e=null),typeof e=="string"&&(e={sep:e});var r=vme({sep:"."},e),i=r.quotes||['"',"'","`"],s;r.brackets===!0?s={"<":">","(":")","[":"]","{":"}"}:r.brackets&&(s=r.brackets);var o=[],a=[],l=[""],c=r.sep,u=n.length,f=-1,p;function m(){if(s&&a.length)return s[a[a.length-1]]}for(;++f<u;){var y=n[f],A=n[f+1],_={val:y,idx:f,arr:l,str:n};if(o.push(_),y==="\\"){_.val=xme(r,n,f)===!0?y+A:A,_.escaped=!0,typeof t=="function"&&t(_),l[l.length-1]+=_.val,f++;continue}if(s&&s[y]){a.push(y);var g=m(),E=f+1;if(n.indexOf(g,E+1)!==-1)for(;a.length&&E<u;){var x=n[++E];if(x==="\\"){x++;continue}if(i.indexOf(x)!==-1){E=QC(n,x,E+1);continue}if(g=m(),a.length&&n.indexOf(g,E+1)===-1)break;if(s[x]){a.push(x);continue}g===x&&a.pop()}if(p=E,p===-1){l[l.length-1]+=y;continue}y=n.slice(f,p+1),_.val=y,_.idx=f=p}if(i.indexOf(y)!==-1){if(p=QC(n,y,f+1),p===-1){l[l.length-1]+=y;continue}Eme(y,r)===!0?y=n.slice(f,p+1):y=n.slice(f+1,p),_.val=y,_.idx=f=p}if(typeof t=="function"&&(t(_,o),y=_.val,f=_.idx),_.val===c&&_.split!==!1){l.push("");continue}l[l.length-1]+=_.val}return l};function QC(n,e,t,r){var i=n.indexOf(e,t);return n.charAt(i-1)==="\\"?QC(n,e,i+1):i}function Eme(n,e){return e.keepDoubleQuotes===!0&&n==='"'||e.keepSingleQuotes===!0&&n==="'"?!0:e.keepQuotes}function xme(n,e,t){return typeof n.keepEscaping=="function"?n.keepEscaping(e,t):n.keepEscaping===!0||e[t+1]==="\\"}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var Ame=function(e){return typeof e<"u"&&e!==null&&(typeof e=="object"||typeof e=="function")},ON=Ame,wme=function(e){ON(e)||(e={});for(var t=arguments.length,r=1;r<t;r++){var i=arguments[r];ON(i)&&Sme(e,i)}return e};function Sme(n,e){for(var t in e)Tme(e,t)&&(n[t]=e[t])}function Tme(n,e){return Object.prototype.hasOwnProperty.call(n,e)}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var Cme=function(e){return typeof e<"u"&&e!==null&&(typeof e=="object"||typeof e=="function")};/*!
 * set-value <https://github.com/jonschlinkert/set-value>
 *
 * Copyright (c) 2014-2015, 2017, Jon Schlinkert.
 * Released under the MIT License.
 */var bme=_me,Mme=wme,BN=g9,NN=Cme,Rme=function(n,e,t){if(!NN(n)||(Array.isArray(e)&&(e=[].concat.apply([],e).join(".")),typeof e!="string"))return n;for(var r=bme(e,{sep:".",brackets:!0}).filter(Ime),i=r.length,s=-1,o=n;++s<i;){var a=r[s];if(s!==i-1){NN(o[a])||(o[a]={}),o=o[a];continue}BN(o[a])&&BN(t)?o[a]=Mme({},o[a],t):o[a]=t}return n};function Ime(n){return n!=="__proto__"&&n!=="constructor"&&n!=="prototype"}var hS=hI,kN=ame,Pme=lme,FN=Rme,Dme=function(e,t,r){if(!hS(e))throw new TypeError("expected an object");if(typeof t!="string"||r==null)return kN.apply(null,arguments);if(typeof r=="string")return FN(e,t,r),e;var i=Pme(e,t);return hS(r)&&hS(i)&&(r=kN({},i,r)),FN(e,t,r),e};const Lme=Vd(Dme),fI=(...n)=>n.filter(Boolean).join(".");function Ome(n){const e=n.split(".");return[e.pop(),e.join(".")||void 0]}function Bme(n,e){return Object.entries(dfe(n,e)).reduce((t,[,{value:r,disabled:i,key:s}])=>(t[s]=i?void 0:r,t),{})}function Nme(n,e){const t=D.useRef();return(e?Vg:Ly)(n,t.current)||(t.current=n),t.current}function v9(n,e){return D.useMemo(n,Nme(e,!0))}function kme(n){const e=D.useRef(null),t=D.useRef(null),r=D.useRef(!0);return D.useLayoutEffect(()=>{n||(e.current.style.height="0px",e.current.style.overflow="hidden")},[]),D.useEffect(()=>{if(r.current){r.current=!1;return}let i;const s=e.current,o=()=>{n&&(s.style.removeProperty("height"),s.style.removeProperty("overflow"),t.current.scrollIntoView({behavior:"smooth",block:"nearest"}))};s.addEventListener("transitionend",o,{once:!0});const{height:a}=t.current.getBoundingClientRect();return s.style.height=a+"px",n||(s.style.overflow="hidden",i=window.setTimeout(()=>s.style.height="0px",50)),()=>{s.removeEventListener("transitionend",o),clearTimeout(i)}},[n]),{wrapperRef:e,contentRef:t}}const Fme=n=>{const[e,t]=D.useState(n.getVisiblePaths());return D.useEffect(()=>{t(n.getVisiblePaths());const r=n.useStore.subscribe(n.getVisiblePaths,t,{equalityFn:Ly});return()=>r()},[n]),e};function Ume(n,e,t){return n.useStore(i=>{const s=kt(kt({},t),i.data);return Bme(s,e)},Ly)}function _9(n=3){const e=D.useRef(null),t=D.useRef(null),[r,i]=D.useState(!1),s=D.useCallback(()=>i(!0),[]),o=D.useCallback(()=>i(!1),[]);return D.useLayoutEffect(()=>{if(r){const{bottom:a,top:l,left:c}=e.current.getBoundingClientRect(),{height:u}=t.current.getBoundingClientRect(),f=a+u>window.innerHeight-40?"up":"down";t.current.style.position="fixed",t.current.style.zIndex="10000",t.current.style.left=c+"px",f==="down"?t.current.style.top=a+n+"px":t.current.style.bottom=window.innerHeight-l+n+"px"}},[n,r]),{popinRef:e,wrapperRef:t,shown:r,show:s,hide:o}}Yde([qde]);const zme={rgb:"toRgb",hsl:"toHsl",hsv:"toHsv",hex:"toHex"};ys.extend({color:()=>n=>qi(n).isValid()});const Hme=n=>ys().color().test(n);function E9(n,{format:e,hasAlpha:t,isString:r}){const i=zme[e]+(r&&e!=="hex"?"String":""),s=n[i]();return typeof s=="object"&&!t?pfe(s,["a"]):s}const x9=(n,e)=>{const t=qi(n);if(!t.isValid())throw Error("Invalid color");return E9(t,e)},Vme=(n,e)=>E9(qi(n),kt(kt({},e),{},{isString:!0,format:"hex"})),Gme=({value:n})=>{const e=Jde(n),t=e==="name"?"hex":e,r=typeof n=="object"?"a"in n:e==="hex"&&n.length===8||/^(rgba)|(hsla)|(hsva)/.test(n),i={format:t,hasAlpha:r,isString:typeof n=="string"};return{value:x9(n,i),settings:i}};var Wme=Object.freeze({__proto__:null,schema:Hme,sanitize:x9,format:Vme,normalize:Gme});const $me=Nt("div",{position:"relative",boxSizing:"border-box",borderRadius:"$sm",overflow:"hidden",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",backgroundColor:"#fff",backgroundImage:`url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')`,$inputStyle:"",$hover:"",zIndex:1,variants:{active:{true:{$inputStyle:"$accent1"}}},"&::before":{content:'""',position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"currentColor",zIndex:1}}),jme=Nt("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto",columnGap:"$colGap",alignItems:"center"}),Xme=Nt("div",{width:"$colorPickerWidth",height:"$colorPickerHeight",".react-colorful":{width:"100%",height:"100%",boxShadow:"$level2",cursor:"crosshair"},".react-colorful__saturation":{borderRadius:"$sm $sm 0 0"},".react-colorful__alpha, .react-colorful__hue":{height:10},".react-colorful__last-control":{borderRadius:"0 0 $sm $sm"},".react-colorful__pointer":{height:12,width:12}});function UN(n,e){return e!=="rgb"?qi(n).toRgb():n}function Kme({value:n,displayValue:e,settings:t,onUpdate:r}){const{emitOnEditStart:i,emitOnEditEnd:s}=Gi(),{format:o,hasAlpha:a}=t,{popinRef:l,wrapperRef:c,shown:u,show:f,hide:p}=_9(),m=D.useRef(0),[y,A]=D.useState(()=>UN(n,o)),_=a?ipe:ope,g=()=>{A(UN(n,o)),f(),i()},E=()=>{p(),s(),window.clearTimeout(m.current)},x=()=>{m.current=window.setTimeout(E,500)};return D.useEffect(()=>()=>window.clearTimeout(m.current),[]),ne.createElement(ne.Fragment,null,ne.createElement($me,{ref:l,active:u,onClick:()=>g(),style:{color:e}}),u&&ne.createElement(rI,null,ne.createElement(V5,{onPointerUp:E}),ne.createElement(Xme,{ref:c,onMouseEnter:()=>window.clearTimeout(m.current),onMouseLeave:T=>T.buttons===0&&x()},ne.createElement(_,{color:y,onChange:r}))))}function Jme(){const{value:n,displayValue:e,label:t,onChange:r,onUpdate:i,settings:s}=Gi();return ne.createElement(Ao,{input:!0},ne.createElement(ia,null,t),ne.createElement(jme,null,ne.createElement(Kme,{value:n,displayValue:e,onChange:r,onUpdate:i,settings:s}),ne.createElement(nI,{value:e,onChange:r,onUpdate:i})))}var Yme=kt({component:Jme},Wme);function qme(){const{label:n,displayValue:e,onUpdate:t,settings:r}=Gi();return ne.createElement(Ao,{input:!0},ne.createElement(ia,null,n),ne.createElement(sI,{value:e,settings:r,onUpdate:t}))}var Qme=kt({component:qme},Y5(["x","y","z"]));const Zme=Nt("div",{$flexCenter:"",position:"relative",backgroundColor:"$elevation3",borderRadius:"$sm",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",touchAction:"none",$draggable:"",$hover:"","&:active":{cursor:"none"},"&::after":{content:'""',backgroundColor:"$accent2",height:4,width:4,borderRadius:2}}),ege=Nt("div",{$flexCenter:"",width:"$joystickWidth",height:"$joystickHeight",borderRadius:"$sm",boxShadow:"$level2",position:"fixed",zIndex:1e4,overflow:"hidden",$draggable:"",transform:"translate(-50%, -50%)",variants:{isOutOfBounds:{true:{backgroundColor:"$elevation1"},false:{backgroundColor:"$elevation3"}}},"> div":{position:"absolute",$flexCenter:"",borderStyle:"solid",borderWidth:1,borderColor:"$highlight1",backgroundColor:"$elevation3",width:"80%",height:"80%","&::after,&::before":{content:'""',position:"absolute",zindex:10,backgroundColor:"$highlight1"},"&::before":{width:"100%",height:1},"&::after":{height:"100%",width:1}},"> span":{position:"relative",zindex:100,width:10,height:10,backgroundColor:"$accent2",borderRadius:"50%"}});function tge({value:n,settings:e,onUpdate:t}){const r=D.useRef(),i=D.useRef(0),s=D.useRef(0),o=D.useRef(1),[a,l]=D.useState(!1),[c,u]=D.useState(!1),[f,p]=W5(),m=D.useRef(null),y=D.useRef(null);D.useLayoutEffect(()=>{if(a){const{top:F,left:z,width:j,height:Y}=m.current.getBoundingClientRect();y.current.style.left=z+j/2+"px",y.current.style.top=F+Y/2+"px"}},[a]);const{keys:[A,_],joystick:g}=e,E=g==="invertY"?1:-1,{[A]:{step:x},[_]:{step:T}}=e,O=yl("sizes","joystickWidth"),I=yl("sizes","joystickHeight"),b=parseFloat(O)*.8/2,R=parseFloat(I)*.8/2,C=D.useCallback(()=>{r.current||(u(!0),i.current&&p({x:i.current*b}),s.current&&p({y:s.current*-R}),r.current=window.setInterval(()=>{t(F=>{const z=x*i.current*o.current,j=E*T*s.current*o.current;return Array.isArray(F)?{[A]:F[0]+z,[_]:F[1]+j}:{[A]:F[A]+z,[_]:F[_]+j}})},16))},[b,R,t,p,x,T,A,_,E]),M=D.useCallback(()=>{window.clearTimeout(r.current),r.current=void 0,u(!1)},[]);D.useEffect(()=>{function F(z){o.current=M5(z)}return window.addEventListener("keydown",F),window.addEventListener("keyup",F),()=>{window.clearTimeout(r.current),window.removeEventListener("keydown",F),window.removeEventListener("keyup",F)}},[]);const B=Ny(({first:F,active:z,delta:[j,Y],movement:[oe,le]})=>{F&&l(!0);const X=Wc(oe,-b,b),ee=Wc(le,-R,R);i.current=Math.abs(oe)>Math.abs(X)?Math.sign(oe-X):0,s.current=Math.abs(le)>Math.abs(ee)?Math.sign(ee-le):0;let ie=n[A],fe=n[_];z?(i.current||(ie+=j*x*o.current,p({x:X})),s.current||(fe-=E*Y*T*o.current,p({y:ee})),i.current||s.current?C():M(),t({[A]:ie,[_]:fe})):(l(!1),i.current=0,s.current=0,p({x:0,y:0}),M())});return ne.createElement(Zme,xr({ref:m},B()),a&&ne.createElement(rI,null,ne.createElement(ege,{ref:y,isOutOfBounds:c},ne.createElement("div",null),ne.createElement("span",{ref:f}))))}const nge=Nt("div",{display:"grid",columnGap:"$colGap",variants:{withJoystick:{true:{gridTemplateColumns:"$sizes$rowHeight auto"},false:{gridTemplateColumns:"auto"}}}});function rge(){const{label:n,displayValue:e,onUpdate:t,settings:r}=Gi();return ne.createElement(Ao,{input:!0},ne.createElement(ia,null,n),ne.createElement(nge,{withJoystick:!!r.joystick},r.joystick&&ne.createElement(tge,{value:e,settings:r,onUpdate:t}),ne.createElement(sI,{value:e,settings:r,onUpdate:t})))}const ige=["joystick"],A9=Y5(["x","y"]),sge=n=>{let{joystick:e=!0}=n,t=kn(n,ige);const{value:r,settings:i}=A9.normalize(t);return{value:r,settings:kt(kt({},i),{},{joystick:e})}};var oge=kt(kt({component:rge},A9),{},{normalize:sge});const age=n=>{if(n!==void 0){if(n instanceof File)try{return URL.createObjectURL(n)}catch{return}if(typeof n=="string"&&n.indexOf("blob:")===0)return n;throw Error("Invalid image format [undefined | blob |File].")}},lge=(n,e)=>typeof e=="object"&&"image"in e,cge=({image:n})=>({value:n});var uge=Object.freeze({__proto__:null,sanitize:age,schema:lge,normalize:cge});const hge=Nt("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto 20px",columnGap:"$colGap",alignItems:"center"}),fge=Nt("div",{$flexCenter:"",overflow:"hidden",height:"$rowHeight",background:"$elevation3",textAlign:"center",color:"inherit",borderRadius:"$sm",outline:"none",userSelect:"none",cursor:"pointer",$inputStyle:"",$hover:"",$focusWithin:"",$active:"$accent1 $elevation1",variants:{isDragAccept:{true:{$inputStyle:"$accent1",backgroundColor:"$elevation1"}}}}),dge=Nt("div",{boxSizing:"border-box",borderRadius:"$sm",height:"$rowHeight",width:"$rowHeight",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center",variants:{hasImage:{true:{cursor:"pointer",$hover:"",$active:""}}}}),pge=Nt("div",{$flexCenter:"",width:"$imagePreviewWidth",height:"$imagePreviewHeight",borderRadius:"$sm",boxShadow:"$level2",pointerEvents:"none",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center"}),mge=Nt("div",{fontSize:"0.8em",height:"100%",padding:"$rowGap $md"}),gge=Nt("div",{$flexCenter:"",top:"0",right:"0",marginRight:"$sm",height:"100%",cursor:"pointer",variants:{disabled:{true:{color:"$elevation3",cursor:"default"}}},"&::after,&::before":{content:'""',position:"absolute",height:2,width:10,borderRadius:1,backgroundColor:"currentColor"},"&::after":{transform:"rotate(45deg)"},"&::before":{transform:"rotate(-45deg)"}});function yge(){const{label:n,value:e,onUpdate:t,disabled:r}=Gi(),{popinRef:i,wrapperRef:s,shown:o,show:a,hide:l}=_9(),c=D.useCallback(y=>{y.length&&t(y[0])},[t]),u=D.useCallback(y=>{y.stopPropagation(),t(void 0)},[t]),{getRootProps:f,getInputProps:p,isDragAccept:m}=m9({maxFiles:1,accept:"image/*",onDrop:c,disabled:r});return ne.createElement(Ao,{input:!0},ne.createElement(ia,null,n),ne.createElement(hge,null,ne.createElement(dge,{ref:i,hasImage:!!e,onPointerDown:()=>!!e&&a(),onPointerUp:l,style:{backgroundImage:e?`url(${e})`:"none"}}),o&&!!e&&ne.createElement(rI,null,ne.createElement(V5,{onPointerUp:l,style:{cursor:"pointer"}}),ne.createElement(pge,{ref:s,style:{backgroundImage:`url(${e})`}})),ne.createElement(fge,f({isDragAccept:m}),ne.createElement("input",p()),ne.createElement(mge,null,m?"drop image":"click or drop")),ne.createElement(gge,{onClick:u,disabled:!e})))}var vge=kt({component:yge},uge);const zN=ys().number(),_ge=(n,e)=>ys().array().length(2).every.number().test(n)&&ys().schema({min:zN,max:zN}).test(e),JE=n=>({min:n[0],max:n[1]}),w9=(n,{bounds:[e,t]},r)=>{const i=Array.isArray(n)?JE(n):n,s={min:r[0],max:r[1]},{min:o,max:a}=kt(kt({},s),i);return[Wc(Number(o),e,Math.max(e,a)),Wc(Number(a),Math.min(t,o),t)]},Ege=({value:n,min:e,max:t})=>{const r={min:e,max:t},i=J5(JE(n),{min:r,max:r}),s=[e,t],o=kt(kt({},i),{},{bounds:s});return{value:w9(JE(n),o,n),settings:o}};var xge=Object.freeze({__proto__:null,schema:_ge,format:JE,sanitize:w9,normalize:Ege});const Age=["value","bounds","onDrag"],wge=["bounds"],Sge=Nt("div",{display:"grid",columnGap:"$colGap",gridTemplateColumns:"auto calc($sizes$numberInputMinWidth * 2 + $space$rowGap)"});function Tge(n){let{value:e,bounds:[t,r],onDrag:i}=n,s=kn(n,Age);const o=D.useRef(null),a=D.useRef(null),l=D.useRef(null),c=D.useRef(0),u=yl("sizes","scrubberWidth"),f=Ny(({event:y,first:A,xy:[_],movement:[g],memo:E={}})=>{if(A){const{width:T,left:O}=o.current.getBoundingClientRect();c.current=T-parseFloat(u);const I=(y==null?void 0:y.target)===a.current||(y==null?void 0:y.target)===l.current;E.pos=WE((_-O)/T,t,r);const b=Math.abs(E.pos-e.min)-Math.abs(E.pos-e.max);E.key=b<0||b===0&&E.pos<=e.min?"min":"max",I&&(E.pos=e[E.key])}const x=E.pos+WE(g/c.current,0,r-t);return i({[E.key]:nde(x,s[E.key])}),E}),p=`calc(${GE(e.min,t,r)} * (100% - ${u} - 8px) + 4px)`,m=`calc(${1-GE(e.max,t,r)} * (100% - ${u} - 8px) + 4px)`;return ne.createElement(j5,xr({ref:o},f()),ne.createElement($5,null,ne.createElement(X5,{style:{left:p,right:m}})),ne.createElement(zC,{position:"left",ref:a,style:{left:p}}),ne.createElement(zC,{position:"right",ref:l,style:{right:m}}))}function Cge(){const{label:n,displayValue:e,onUpdate:t,settings:r}=Gi(),i=kn(r,wge);return ne.createElement(ne.Fragment,null,ne.createElement(Ao,{input:!0},ne.createElement(ia,null,n),ne.createElement(Sge,null,ne.createElement(Tge,xr({value:e},r,{onDrag:t})),ne.createElement(sI,{value:e,settings:i,onUpdate:t,innerLabelTrim:0}))))}var bge=kt({component:Cge},xge);const Mge=()=>{const n=new Map;return{on:(e,t)=>{let r=n.get(e);r===void 0&&(r=new Set,n.set(e,r)),r.add(t)},off:(e,t)=>{const r=n.get(e);r!==void 0&&(r.delete(t),r.size===0&&n.delete(e))},emit:(e,...t)=>{const r=n.get(e);if(r!==void 0)for(const i of r)i(...t)}}},Rge=["type","value"],Ige=["onChange","transient","onEditStart","onEditEnd"],Pge=function(){const e=lA(lle(()=>({data:{}}))),t=Mge();this.storeId=ffe(),this.useStore=e;const r={},i=new Set;this.getVisiblePaths=()=>{const o=this.getData(),a=Object.keys(o),l=[];Object.entries(r).forEach(([u,f])=>{f.render&&a.some(p=>p.indexOf(u)===0)&&!f.render(this.get)&&l.push(u+".")});const c=[];return i.forEach(u=>{u in o&&o[u].__refCount>0&&l.every(f=>u.indexOf(f)===-1)&&(!o[u].render||o[u].render(this.get))&&c.push(u)}),c},this.setOrderedPaths=o=>{o.forEach(a=>i.add(a))},this.orderPaths=o=>(this.setOrderedPaths(o),o),this.disposePaths=o=>{e.setState(a=>{const l=a.data;return o.forEach(c=>{if(c in l){const u=l[c];u.__refCount--,u.__refCount===0&&u.type in yo&&delete l[c]}}),{data:l}})},this.dispose=()=>{e.setState(()=>({data:{}}))},this.getFolderSettings=o=>r[o]||{},this.getData=()=>e.getState().data,this.addData=(o,a)=>{e.setState(l=>{const c=l.data;return Object.entries(o).forEach(([u,f])=>{let p=c[u];if(p){const{type:m,value:y}=f,A=kn(f,Rge);m!==p.type?nl(cr.INPUT_TYPE_OVERRIDE,m):((p.__refCount===0||a)&&Object.assign(p,A),p.__refCount++)}else c[u]=kt(kt({},f),{},{__refCount:1})}),{data:c}})},this.setValueAtPath=(o,a,l)=>{e.setState(c=>{const u=c.data;return uN(u[o],a,o,this,l),{data:u}})},this.setSettingsAtPath=(o,a)=>{e.setState(l=>{const c=l.data;return c[o].settings=kt(kt({},c[o].settings),a),{data:c}})},this.disableInputAtPath=(o,a)=>{e.setState(l=>{const c=l.data;return c[o].disabled=a,{data:c}})},this.set=(o,a)=>{e.setState(l=>{const c=l.data;return Object.entries(o).forEach(([u,f])=>{try{uN(c[u],f,void 0,void 0,a)}catch{}}),{data:c}})},this.getInput=o=>{try{return this.getData()[o]}catch{nl(cr.PATH_DOESNT_EXIST,o)}},this.get=o=>{var a;return(a=this.getInput(o))===null||a===void 0?void 0:a.value},this.emitOnEditStart=o=>{t.emit(`onEditStart:${o}`,this.get(o),o,kt(kt({},this.getInput(o)),{},{get:this.get}))},this.emitOnEditEnd=o=>{t.emit(`onEditEnd:${o}`,this.get(o),o,kt(kt({},this.getInput(o)),{},{get:this.get}))},this.subscribeToEditStart=(o,a)=>{const l=`onEditStart:${o}`;return t.on(l,a),()=>t.off(l,a)},this.subscribeToEditEnd=(o,a)=>{const l=`onEditEnd:${o}`;return t.on(l,a),()=>t.off(l,a)};const s=(o,a,l)=>{const c={};return Object.entries(o).forEach(([u,f])=>{if(u==="")return nl(cr.EMPTY_KEY);let p=fI(a,u);if(f.type===yo.FOLDER){const m=s(f.schema,p,l);Object.assign(c,m),p in r||(r[p]=f.settings)}else if(u in l)nl(cr.DUPLICATE_KEYS,u,p,l[u].path);else{const m=Efe(f,u,p,c);if(m){const{type:y,options:A,input:_}=m,{onChange:g,transient:E,onEditStart:x,onEditEnd:T}=A,O=kn(A,Ige);c[p]=kt(kt(kt({type:y},O),_),{},{fromPanel:!0}),l[u]={path:p,onChange:g,transient:E,onEditStart:x,onEditEnd:T}}else nl(cr.UNKNOWN_INPUT,p,f)}}),c};this.getDataFromSchema=o=>{const a={};return[s(o,"",a),a]}},S9=new Pge,Dge={collapsed:!1};function Lge(n,e){return{type:yo.FOLDER,schema:n,settings:kt(kt({},Dge),e)}}const Oge={disabled:!1};function HN(n,e){return{type:yo.BUTTON,onClick:n,settings:kt(kt({},Oge),e)}}const VN=n=>"__levaInput"in n,Bge=(n,e)=>{const t={},r=e?e.toLowerCase():null;return n.forEach(i=>{const[s,o]=Ome(i);(!r||s.toLowerCase().indexOf(r)>-1)&&Lme(t,o,{[s]:{__levaInput:!0,path:i}})}),t},Nge=["type","label","path","valueKey","value","settings","setValue","disabled"];function kge(n){let{type:e,label:t,path:r,valueKey:i,value:s,settings:o,setValue:a,disabled:l}=n,c=kn(n,Nge);const{displayValue:u,onChange:f,onUpdate:p}=G5({type:e,value:s,settings:o,setValue:a}),m=_h[e].component;return m?ne.createElement(L5.Provider,{value:kt({key:i,path:r,id:""+r,label:t,displayValue:u,value:s,onChange:f,onUpdate:p,settings:o,setValue:a,disabled:l},c)},ne.createElement(zfe,{disabled:l},ne.createElement(m,null))):(nl(cr.NO_COMPONENT_FOR_TYPE,e,r),null)}const Fge=Nt("button",{display:"block",$reset:"",fontWeight:"$button",height:"$rowHeight",borderStyle:"none",borderRadius:"$sm",backgroundColor:"$elevation1",color:"$highlight1","&:not(:disabled)":{color:"$highlight3",backgroundColor:"$accent2",cursor:"pointer",$hover:"$accent3",$active:"$accent3 $accent1",$focus:""}});function Uge({onClick:n,settings:e,label:t}){const r=By();return ne.createElement(Ao,null,ne.createElement(Fge,{disabled:e.disabled,onClick:()=>n(r.get)},t))}const zge=Nt("div",{$flex:"",justifyContent:"flex-end",gap:"$colGap"}),Hge=Nt("button",{$reset:"",cursor:"pointer",borderRadius:"$xs","&:hover":{backgroundColor:"$elevation3"}}),Vge=({label:n,opts:e})=>{let t=typeof n=="string"&&n.trim()===""?null:n,r=e;return typeof e.opts=="object"&&(r.label!==void 0&&(t=e.label),r=e.opts),{label:t,opts:r}};function Gge(n){const{label:e,opts:t}=Vge(n),r=By();return ne.createElement(Ao,{input:!!e},e&&ne.createElement(ia,null,e),ne.createElement(zge,null,Object.entries(t).map(([i,s])=>ne.createElement(Hge,{key:i,onClick:()=>s(r.get)},i))))}const Wge=Nt("canvas",{height:"$monitorHeight",width:"100%",display:"block",borderRadius:"$sm"}),T9=100;function $ge(n,e){n.push(e),n.length>T9&&n.shift()}const jge=D.forwardRef(function({initialValue:n},e){const t=yl("colors","highlight3"),r=yl("colors","elevation2"),i=yl("colors","highlight1"),[s,o]=D.useMemo(()=>[qi(i).alpha(.4).toRgbString(),qi(i).alpha(.1).toRgbString()],[i]),a=D.useRef([n]),l=D.useRef(n),c=D.useRef(n),u=D.useRef(),f=D.useCallback((y,A)=>{if(!y)return;const{width:_,height:g}=y,E=new Path2D,x=_/T9,T=g*.05;for(let b=0;b<a.current.length;b++){const R=GE(a.current[b],l.current,c.current),C=x*b,M=g-R*(g-T*2)-T;E.lineTo(C,M)}A.clearRect(0,0,_,g);const O=new Path2D(E);O.lineTo(x*(a.current.length+1),g),O.lineTo(0,g),O.lineTo(0,0);const I=A.createLinearGradient(0,0,0,g);I.addColorStop(0,s),I.addColorStop(1,o),A.fillStyle=I,A.fill(O),A.strokeStyle=r,A.lineJoin="round",A.lineWidth=14,A.stroke(E),A.strokeStyle=t,A.lineWidth=2,A.stroke(E)},[t,r,s,o]),[p,m]=Jfe(f);return D.useImperativeHandle(e,()=>({frame:y=>{(l.current===void 0||y<l.current)&&(l.current=y),(c.current===void 0||y>c.current)&&(c.current=y),$ge(a.current,y),u.current=requestAnimationFrame(()=>f(p.current,m.current))}}),[p,m,f]),D.useEffect(()=>()=>cancelAnimationFrame(u.current),[]),ne.createElement(Wge,{ref:p})}),GN=n=>Number.isFinite(n)?n.toPrecision(2):n.toString(),Xge=D.forwardRef(function({initialValue:n},e){const[t,r]=D.useState(GN(n));return D.useImperativeHandle(e,()=>({frame:i=>r(GN(i))}),[]),ne.createElement("div",null,t)});function WN(n){return typeof n=="function"?n():n.current}function Kge({label:n,objectOrFn:e,settings:t}){const r=D.useRef(),i=D.useRef(WN(e));return D.useEffect(()=>{const s=window.setInterval(()=>{var o;document.hidden||(o=r.current)===null||o===void 0||o.frame(WN(e))},t.interval);return()=>window.clearInterval(s)},[e,t.interval]),ne.createElement(Ao,{input:!0},ne.createElement(ia,{align:"top"},n),t.graph?ne.createElement(jge,{ref:r,initialValue:i.current}):ne.createElement(Xge,{ref:r,initialValue:i.current}))}const Jge=["type","label","key"],Yge={[yo.BUTTON]:Uge,[yo.BUTTON_GROUP]:Gge,[yo.MONITOR]:Kge},qge=ne.memo(({path:n})=>{const[e,{set:t,setSettings:r,disable:i,storeId:s,emitOnEditStart:o,emitOnEditEnd:a}]=qfe(n);if(!e)return null;const{type:l,label:c,key:u}=e,f=kn(e,Jge);if(l in yo){const p=Yge[l];return ne.createElement(p,xr({label:c,path:n},f))}return l in _h?ne.createElement(kge,xr({key:s+n,type:l,label:c,storeId:s,path:n,valueKey:u,setValue:t,setSettings:r,disable:i,emitOnEditStart:o,emitOnEditEnd:a},f)):(ife(cr.UNSUPPORTED_INPUT,l,n),null)});function Qge({toggle:n,toggled:e,name:t}){return ne.createElement(kfe,{onClick:()=>n()},ne.createElement(iI,{toggled:e}),ne.createElement("div",null,t))}const Zge=({name:n,path:e,tree:t})=>{const r=By(),i=fI(e,n),{collapsed:s,color:o}=r.getFolderSettings(i),[a,l]=D.useState(!s),c=D.useRef(null),u=yl("colors","folderWidgetColor"),f=yl("colors","folderTextColor");return D.useLayoutEffect(()=>{c.current.style.setProperty("--leva-colors-folderWidgetColor",o||u),c.current.style.setProperty("--leva-colors-folderTextColor",o||f)},[o,u,f]),ne.createElement($E,{ref:c},ne.createElement(Qge,{name:n,toggled:a,toggle:()=>l(p=>!p)}),ne.createElement(C9,{parent:i,tree:t,toggled:a}))},C9=ne.memo(({isRoot:n=!1,fill:e=!1,flat:t=!1,parent:r,tree:i,toggled:s})=>{const{wrapperRef:o,contentRef:a}=kme(s),l=By(),c=([f,p])=>{var m;return(VN(p)?(m=l.getInput(p.path))===null||m===void 0?void 0:m.order:l.getFolderSettings(fI(r,f)).order)||0},u=Object.entries(i).sort((f,p)=>c(f)-c(p));return ne.createElement(FC,{ref:o,isRoot:n,fill:e,flat:t},ne.createElement(U5,{ref:a,isRoot:n,toggled:s},u.map(([f,p])=>VN(p)?ne.createElement(qge,{key:p.path,valueKey:p.valueKey,path:p.path}):ne.createElement(Zge,{key:f,name:f,path:r,tree:p}))))}),eye=Nt("div",{position:"relative",fontFamily:"$mono",fontSize:"$root",color:"$rootText",backgroundColor:"$elevation1",variants:{fill:{false:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,width:"$rootWidth"},true:{position:"relative",width:"100%"}},flat:{false:{borderRadius:"$lg",boxShadow:"$level1"}},oneLineLabels:{true:{[`${H5}`]:{gridTemplateColumns:"auto",gridAutoColumns:"minmax(max-content, 1fr)",gridAutoRows:"minmax($sizes$rowHeight), auto)",rowGap:0,columnGap:0,marginTop:"$rowGap"}}},hideTitleBar:{true:{$$titleBarHeight:"0px"},false:{$$titleBarHeight:"$sizes$titleBarHeight"}}},"&,*,*:after,*:before":{boxSizing:"border-box"},"*::selection":{backgroundColor:"$accent2"}}),b9=40,YE=Nt("i",{$flexCenter:"",width:b9,userSelect:"none",cursor:"pointer","> svg":{fill:"$highlight1",transition:"transform 350ms ease, fill 250ms ease"},"&:hover > svg":{fill:"$highlight3"},variants:{active:{true:{"> svg":{fill:"$highlight2"}}}}}),tye=Nt("div",{display:"flex",alignItems:"stretch",justifyContent:"space-between",height:"$titleBarHeight",variants:{mode:{drag:{cursor:"grab"}}}}),nye=Nt("div",{$flex:"",position:"relative",width:"100%",overflow:"hidden",transition:"height 250ms ease",color:"$highlight3",paddingLeft:"$md",[`> ${YE}`]:{height:30},variants:{toggled:{true:{height:30},false:{height:0}}}}),rye=Nt("input",{$reset:"",flex:1,position:"relative",height:30,width:"100%",backgroundColor:"transparent",fontSize:"10px",borderRadius:"$root","&:focus":{},"&::placeholder":{color:"$highlight2"}}),iye=Nt("div",{touchAction:"none",$flexCenter:"",flex:1,"> svg":{fill:"$highlight1"},color:"$highlight1",variants:{drag:{true:{$draggable:"","> svg":{transition:"fill 250ms ease"},"&:hover":{color:"$highlight3"},"&:hover > svg":{fill:"$highlight3"}}},filterEnabled:{false:{paddingRight:b9}}}}),sye=ne.forwardRef(({setFilter:n,toggle:e},t)=>{const[r,i]=D.useState(""),s=D.useMemo(()=>b5(n,250),[n]),o=()=>{n(""),i("")},a=l=>{const c=l.currentTarget.value;e(!0),i(c)};return D.useEffect(()=>{s(r)},[r,s]),ne.createElement(ne.Fragment,null,ne.createElement(rye,{ref:t,value:r,placeholder:"[Open filter with CMD+SHIFT+L]",onPointerDown:l=>l.stopPropagation(),onChange:a}),ne.createElement(YE,{onClick:()=>o(),style:{visibility:r?"visible":"hidden"}},ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 20 20",fill:"currentColor"},ne.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))))});function oye({setFilter:n,onDrag:e,onDragStart:t,onDragEnd:r,toggle:i,toggled:s,title:o,drag:a,filterEnabled:l,from:c}){const[u,f]=D.useState(!1),p=D.useRef(null);D.useEffect(()=>{var y,A;u?(y=p.current)===null||y===void 0||y.focus():(A=p.current)===null||A===void 0||A.blur()},[u]);const m=Ny(({offset:[y,A],first:_,last:g})=>{e({x:y,y:A}),_&&t({x:y,y:A}),g&&r({x:y,y:A})},{filterTaps:!0,from:({offset:[y,A]})=>[(c==null?void 0:c.x)||y,(c==null?void 0:c.y)||A]});return D.useEffect(()=>{const y=A=>{A.key==="L"&&A.shiftKey&&A.metaKey&&f(_=>!_)};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[]),ne.createElement(ne.Fragment,null,ne.createElement(tye,{mode:a?"drag":void 0},ne.createElement(YE,{active:!s,onClick:()=>i()},ne.createElement(iI,{toggled:s,width:12,height:8})),ne.createElement(iye,xr({},a?m():{},{drag:a,filterEnabled:l}),o===void 0&&a?ne.createElement("svg",{width:"20",height:"10",viewBox:"0 0 28 14",xmlns:"http://www.w3.org/2000/svg"},ne.createElement("circle",{cx:"2",cy:"2",r:"2"}),ne.createElement("circle",{cx:"14",cy:"2",r:"2"}),ne.createElement("circle",{cx:"26",cy:"2",r:"2"}),ne.createElement("circle",{cx:"2",cy:"12",r:"2"}),ne.createElement("circle",{cx:"14",cy:"12",r:"2"}),ne.createElement("circle",{cx:"26",cy:"12",r:"2"})):o),l&&ne.createElement(YE,{active:u,onClick:()=>f(y=>!y)},ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 20 20"},ne.createElement("path",{d:"M9 9a2 2 0 114 0 2 2 0 01-4 0z"}),ne.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z",clipRule:"evenodd"})))),ne.createElement(nye,{toggled:u},ne.createElement(sye,{ref:p,setFilter:n,toggle:i})))}const aye=["store","hidden","theme","collapsed"];function lye(n){let{store:e,hidden:t=!1,theme:r,collapsed:i=!1}=n,s=kn(n,aye);const o=v9(()=>Pfe(r),[r]),[a,l]=D.useState(!i),c=typeof i=="object"?!i.collapsed:a,u=D.useMemo(()=>typeof i=="object"?f=>{typeof f=="function"?i.onChange(!f(!i.collapsed)):i.onChange(!f)}:l,[i]);return!e||t?null:ne.createElement(tI.Provider,{value:o},ne.createElement(cye,xr({store:e},s,{toggled:c,setToggle:u,rootClass:o.className})))}const cye=ne.memo(({store:n,rootClass:e,fill:t=!1,flat:r=!1,neverHide:i=!1,oneLineLabels:s=!1,titleBar:o={title:void 0,drag:!0,filter:!0,position:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0},hideCopyButton:a=!1,toggled:l,setToggle:c})=>{var u,f;const p=Fme(n),[m,y]=D.useState(""),A=D.useMemo(()=>Bge(p,m),[p,m]),[_,g]=W5(),E=i||p.length>0,x=typeof o=="object"&&o.title||void 0,T=typeof o=="object"&&(u=o.drag)!==null&&u!==void 0?u:!0,O=typeof o=="object"&&(f=o.filter)!==null&&f!==void 0?f:!0,I=typeof o=="object"&&o.position||void 0,b=typeof o=="object"&&o.onDrag||void 0,R=typeof o=="object"&&o.onDragStart||void 0,C=typeof o=="object"&&o.onDragEnd||void 0;return ne.useEffect(()=>{g({x:I==null?void 0:I.x,y:I==null?void 0:I.y})},[I,g]),Ife(),ne.createElement(B5.Provider,{value:{hideCopyButton:a}},ne.createElement(eye,{ref:_,className:e,fill:t,flat:r,oneLineLabels:s,hideTitleBar:!o,style:{display:E?"block":"none"}},o&&ne.createElement(oye,{onDrag:M=>{g(M),b==null||b(M)},onDragStart:M=>R==null?void 0:R(M),onDragEnd:M=>C==null?void 0:C(M),setFilter:y,toggle:M=>c(B=>M??!B),toggled:l,title:x,drag:T,filterEnabled:O,from:I}),E&&ne.createElement(O5.Provider,{value:n},ne.createElement(C9,{isRoot:!0,fill:t,flat:r,tree:A,toggled:l}))))}),uye=["isRoot"];let qE=!1,Wu=null;function M9(n){let{isRoot:e=!1}=n,t=kn(n,uye);return D.useEffect(()=>(qE=!0,!e&&Wu&&(Wu.remove(),Wu=null),()=>{e||(qE=!1)}),[e]),ne.createElement(lye,xr({store:S9},t))}function hye(n){D.useEffect(()=>{n&&!qE&&(Wu||(Wu=document.getElementById("leva__root")||Object.assign(document.createElement("div"),{id:"leva__root"}),document.body&&(document.body.appendChild(Wu),Afe(ne.createElement(M9,{isRoot:!0}),Wu))),qE=!0)},[n])}function fye(n,e,t,r,i){let s,o,a,l,c;return typeof n=="string"?(o=n,s=e,Array.isArray(t)?c=t:t&&("store"in t?(l=t,c=r):(a=t,Array.isArray(r)?c=r:(l=r,c=i)))):(s=n,Array.isArray(e)?c=e:(l=e,c=t)),{schema:s,folderName:o,folderSettings:a,hookSettings:l,deps:c||[]}}function $N(n,e,t,r,i){const{folderName:s,schema:o,folderSettings:a,hookSettings:l,deps:c}=fye(n,e,t,r,i),u=typeof o=="function",f=D.useRef(!1),p=D.useRef(!0),m=v9(()=>{f.current=!0;const B=typeof o=="function"?o():o;return s?{[s]:Lge(B,a)}:B},c),y=!(l!=null&&l.store);hye(y);const[A]=D.useState(()=>(l==null?void 0:l.store)||S9),[_,g]=D.useMemo(()=>A.getDataFromSchema(m),[A,m]),[E,x,T,O,I]=D.useMemo(()=>{const B=[],F=[],z={},j={},Y={};return Object.values(g).forEach(({path:oe,onChange:le,onEditStart:X,onEditEnd:ee,transient:ie})=>{B.push(oe),le?(z[oe]=le,ie||F.push(oe)):F.push(oe),X&&(j[oe]=X),ee&&(Y[oe]=ee)}),[B,F,z,j,Y]},[g]),b=D.useMemo(()=>A.orderPaths(E),[E,A]),R=Ume(A,x,_),C=D.useCallback(B=>{const F=Object.entries(B).reduce((z,[j,Y])=>Object.assign(z,{[g[j].path]:Y}),{});A.set(F,!1)},[A,g]),M=D.useCallback(B=>A.get(g[B].path),[A,g]);return D.useEffect(()=>{const B=!p.current&&f.current;return A.addData(_,B),p.current=!1,f.current=!1,()=>A.disposePaths(b)},[A,b,_]),D.useEffect(()=>{const B=[];return Object.entries(T).forEach(([F,z])=>{z(A.get(F),F,kt({initial:!0,get:A.get},A.getInput(F)));const j=A.useStore.subscribe(Y=>{const oe=Y.data[F];return[oe.disabled?void 0:oe.value,oe]},([Y,oe])=>z(Y,F,kt({initial:!1,get:A.get},oe)),{equalityFn:Ly});B.push(j)}),()=>B.forEach(F=>F())},[A,T]),D.useEffect(()=>{const B=[];return Object.entries(O).forEach(([F,z])=>B.push(A.subscribeToEditStart(F,z))),Object.entries(I).forEach(([F,z])=>B.push(A.subscribeToEditEnd(F,z))),()=>B.forEach(F=>F())},[O,I,A]),u?[R,C,M]:R}Ol(Qo.SELECT,pde);Ol(Qo.IMAGE,vge);Ol(Qo.NUMBER,ide);Ol(Qo.COLOR,Yme);Ol(Qo.STRING,wde);Ol(Qo.BOOLEAN,Ide);Ol(Qo.INTERVAL,bge);Ol(Qo.VECTOR3D,Qme);Ol(Qo.VECTOR2D,oge);const dye="https://uninvestigable-elicia-punchiest.ngrok-free.dev",R9=D.createContext(),pye=({children:n})=>{const[e,t]=D.useState(!1),[r,i]=D.useState([]),[s,o]=D.useState(),[a,l]=D.useState(!1),c=D.useRef(null),u=D.useRef("demo_user_123"),f=_=>{u.current=_};D.useEffect(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const _=window.SpeechRecognition||window.webkitSpeechRecognition,g=new _;g.continuous=!1,g.interimResults=!1,g.lang="en-US",g.onresult=async E=>{const x=E.results[0][0].transcript;console.log(" Voice input:",x),await y(x,u.current)},g.onerror=E=>{console.error("Speech recognition error:",E.error),t(!1),E.error==="no-speech"?alert("No speech detected. Please try again."):E.error==="not-allowed"?alert("Microphone access denied. Please allow microphone access."):alert(`Voice recognition error: ${E.error}`)},g.onend=()=>{t(!1)},c.current=g}else console.warn("Web Speech API not supported in this browser")},[]);const p=async()=>{if(!c.current){alert("Voice recognition is not supported in your browser. Please use Chrome, Edge, or Safari.");return}try{t(!0),c.current.start(),console.log(" Listening...")}catch(_){console.error("Error starting recognition:",_),t(!1),alert("Failed to start voice recognition. Please try again.")}},m=()=>{c.current&&e&&(c.current.stop(),t(!1))},y=async(_,g)=>{const E=g||u.current||"demo_user_123";l(!0);try{const T=(await(await fetch(`${dye}/tts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:_,userId:E})})).json()).messages;i(O=>[...O,...T])}catch(x){console.error("TTS error:",x),alert("Failed to get response. Please try again.")}finally{l(!1)}},A=()=>{i(_=>_.slice(1))};return D.useEffect(()=>{r.length>0?o(r[0]):o(null)},[r]),Oe.jsx(R9.Provider,{value:{startRecording:p,stopRecording:m,recording:e,tts:y,message:s,onMessagePlayed:A,loading:a,setUserId:f},children:n})},I9=()=>{const n=D.useContext(R9);if(!n)throw new Error("useSpeech must be used within a SpeechProvider");return n},jN={default:{},smile:{browInnerUp:.17,eyeSquintLeft:.4,eyeSquintRight:.44,noseSneerLeft:.1700000727403593,noseSneerRight:.14000002836874015,mouthPressLeft:.61,mouthPressRight:.41000000000000003},funnyFace:{jawLeft:.63,mouthPucker:.53,noseSneerLeft:1,noseSneerRight:.39,mouthLeft:1,eyeLookUpLeft:1,eyeLookUpRight:1,cheekPuff:.9999924982764238,mouthDimpleLeft:.414743888682652,mouthRollLower:.32,mouthSmileLeft:.35499733688813034,mouthSmileRight:.35499733688813034},sad:{mouthFrownLeft:1,mouthFrownRight:1,mouthShrugLower:.78341,browInnerUp:.452,eyeSquintLeft:.72,eyeSquintRight:.75,eyeLookDownLeft:.5,eyeLookDownRight:.5,jawForward:1},surprised:{eyeWideLeft:.5,eyeWideRight:.5,jawOpen:0,mouthFunnel:.2,browInnerUp:1},angry:{browDownLeft:1,browDownRight:1,eyeSquintLeft:1,eyeSquintRight:1,jawForward:1,jawLeft:1,mouthShrugLower:1,noseSneerLeft:1,noseSneerRight:.42,eyeLookDownLeft:.16,eyeLookDownRight:.16,cheekSquintLeft:1,cheekSquintRight:1,mouthClose:.23,mouthFunnel:.63,mouthDimpleRight:1},crazy:{browInnerUp:.9,jawForward:1,noseSneerLeft:.5700000000000001,noseSneerRight:.51,eyeLookDownLeft:.39435766259644545,eyeLookUpRight:.4039761421719682,eyeLookInLeft:.9618479575523053,eyeLookInRight:.9618479575523053,jawOpen:.9618479575523053,mouthDimpleLeft:.9618479575523053,mouthDimpleRight:.9618479575523053,mouthStretchLeft:.27893590769016857,mouthStretchRight:.2885543872656917,mouthSmileLeft:.5578718153803371,mouthSmileRight:.38473918302092225,tongueOut:.9618479575523053}},XN={A:"viseme_PP",B:"viseme_kk",C:"viseme_I",D:"viseme_aa",E:"viseme_O",F:"viseme_U",G:"viseme_FF",H:"viseme_TH",X:"viseme_sil"},fS=["mouthOpen","viseme_sil","viseme_PP","viseme_FF","viseme_TH","viseme_DD","viseme_kk","viseme_CH","viseme_SS","viseme_nn","viseme_RR","viseme_aa","viseme_E","viseme_I","viseme_O","viseme_U","mouthSmile","browDownLeft","browDownRight","browInnerUp","browOuterUpLeft","browOuterUpRight","eyeSquintLeft","eyeSquintRight","eyeWideLeft","eyeWideRight","jawForward","jawLeft","jawRight","mouthFrownLeft","mouthFrownRight","mouthPucker","mouthShrugLower","mouthShrugUpper","noseSneerLeft","noseSneerRight","mouthLowerDownLeft","mouthLowerDownRight","mouthLeft","mouthRight","eyeLookDownLeft","eyeLookDownRight","eyeLookUpLeft","eyeLookUpRight","eyeLookInLeft","eyeLookInRight","eyeLookOutLeft","eyeLookOutRight","cheekPuff","cheekSquintLeft","cheekSquintRight","jawOpen","mouthClose","mouthFunnel","mouthDimpleLeft","mouthDimpleRight","mouthStretchLeft","mouthStretchRight","mouthRollLower","mouthRollUpper","mouthPressLeft","mouthPressRight","mouthUpperUpLeft","mouthUpperUpRight","mouthSmileLeft","mouthSmileRight","tongueOut","eyeBlinkLeft","eyeBlinkRight"];function mye(n){const{nodes:e,materials:t,scene:r}=Fd("/models/avatar.glb"),{animations:i}=Fd("/models/animations.glb");D.useEffect(()=>{console.log("GLTF Nodes available:",Object.keys(e)),console.log("GLTF Materials available:",Object.keys(t))},[e,t]);const{message:s,onMessagePlayed:o}=I9(),[a,l]=D.useState(),[c,u]=D.useState(!1);e.Wolf3D_Head&&e.Wolf3D_Head.morphTargetDictionary&&console.log("Morph Targets available:",Object.keys(e.Wolf3D_Head.morphTargetDictionary)),D.useEffect(()=>{if(!s){m("Idle"),l(null);return}console.log(" New message received:",s.text),m("Idle"),E(""),l(s.lipsync);const M=new Blob([Uint8Array.from(atob(s.audio),z=>z.charCodeAt(0))],{type:"audio/mp3"}),B=URL.createObjectURL(M),F=new Audio(B);return F.onloadeddata=()=>{var z,j;console.log(` Audio loaded, duration: ${F.duration}s`),console.log(` Lip sync cues: ${((j=(z=s.lipsync)==null?void 0:z.mouthCues)==null?void 0:j.length)||0}`),F.play().catch(Y=>{console.error(" Failed to play audio (Autoplay blocked?):",Y),I(!0),R(Y.message)})},F.onplay=()=>{console.log(" Audio started playing")},F.ontimeupdate=()=>{Math.random()<.05&&console.log(` Audio time: ${F.currentTime.toFixed(2)}s / ${F.duration.toFixed(2)}s`)},F.onended=()=>{console.log(" Audio playback ended"),o()},F.onerror=z=>{console.error(" Audio error:",z)},F.play().catch(z=>{console.error(" Failed to play audio:",z)}),T(F),()=>{F&&(F.pause(),F.src="")}},[s,o]);const f=D.useRef();hce(i,f);const[p,m]=D.useState(i.find(M=>M.name==="Idle")?"Idle":i[0].name);D.useEffect(()=>{},[p]);const y=(M,B,F=.1)=>{let z=!1;r.traverse(j=>{if(j.isSkinnedMesh&&j.morphTargetDictionary){const Y=j.morphTargetDictionary[M];if(Y===void 0||j.morphTargetInfluences[Y]===void 0)return;z=!0,j.morphTargetInfluences[Y]=Ux.lerp(j.morphTargetInfluences[Y],B,F)}}),!z&&B>0},[A,_]=D.useState(!1),[g,E]=D.useState(""),[x,T]=D.useState(),[O,I]=D.useState(!1),[b,R]=D.useState(""),C=()=>{x&&x.play().then(()=>{I(!1),R("")}).catch(M=>{console.error("Still failed to play audio:",M),R(M.message)})};return My(()=>{const M=[],B={viseme_PP:["mouthClose","mouthPucker"],viseme_aa:["jawOpen","mouthOpen"],viseme_O:["mouthFunnel","jawOpen"],viseme_U:["mouthPucker","mouthFunnel"],viseme_I:["mouthSmile","jawOpen"],viseme_TH:["mouthOpen","jawOpen"],viseme_kk:["jawOpen","mouthOpen"],viseme_FF:["mouthUpperUpLeft","mouthUpperUpRight"],viseme_DD:["jawOpen","mouthOpen"],viseme_nn:["mouthClose","jawOpen"],viseme_RR:["mouthOpen","mouthFunnel"],viseme_SS:["mouthSmile","mouthDimpleLeft","mouthDimpleRight"],viseme_sil:["mouthClose"],viseme_CH:["mouthSmile","mouthFunnel"],viseme_E:["mouthSmile","jawOpen"]};if(s&&a&&x&&!x.paused&&!x.ended){const F=x.currentTime;for(let z=0;z<a.mouthCues.length;z++){const j=a.mouthCues[z];if(F>=j.start&&F<=j.end){const Y=XN[j.value];if(Y&&B[Y])for(const oe of B[Y])e.Wolf3D_Head.morphTargetDictionary&&e.Wolf3D_Head.morphTargetDictionary[oe]!==void 0&&M.push(oe);M.length===0&&Y&&e.Wolf3D_Head.morphTargetDictionary&&e.Wolf3D_Head.morphTargetDictionary[Y]!==void 0&&M.push(Y);break}}}!c&&fS.forEach(F=>{if(M.includes(F))return;const z=jN[g];F==="eyeBlinkLeft"||F==="eyeBlinkRight"||(z&&z[F]?y(F,z[F],.1):y(F,0,.1))}),y("eyeBlinkLeft",A?1:0,.5),y("eyeBlinkRight",A?1:0,.5),!c&&(M.forEach(F=>{y(F,1,.8)}),Object.values(XN).forEach(F=>{M.includes(F)}))}),$N("FacialExpressions",{animation:{value:p,options:i.map(M=>M.name),onChange:M=>m(M)},facialExpression:{options:Object.keys(jN),onChange:M=>E(M)},setupMode:HN(()=>{u(!c)}),logMorphTargetValues:HN(()=>{const M={};Object.values(e).forEach(B=>{B.morphTargetInfluences&&B.morphTargetDictionary&&fS.forEach(F=>{if(F==="eyeBlinkLeft"||F==="eyeBlinkRight")return;const z=B.morphTargetInfluences[B.morphTargetDictionary[F]];z>.01&&(M[F]=z)})}),console.log(JSON.stringify(M,null,2))})}),$N("MorphTarget",()=>Object.assign({},...fS.map(M=>({[M]:{label:M,value:0,min:0,max:1,onChange:B=>{y(M,B,.1)}}})))),D.useEffect(()=>{_(!1)},[]),Oe.jsxs("group",{...n,dispose:null,ref:f,position:[0,-.5,0],children:[e.Hips&&Oe.jsx("primitive",{object:e.Hips}),e.EyeLeft&&Oe.jsx("skinnedMesh",{name:"EyeLeft",geometry:e.EyeLeft.geometry,material:t.Wolf3D_Eye,skeleton:e.EyeLeft.skeleton,morphTargetDictionary:e.EyeLeft.morphTargetDictionary,morphTargetInfluences:e.EyeLeft.morphTargetInfluences}),e.EyeRight&&Oe.jsx("skinnedMesh",{name:"EyeRight",geometry:e.EyeRight.geometry,material:t.Wolf3D_Eye,skeleton:e.EyeRight.skeleton,morphTargetDictionary:e.EyeRight.morphTargetDictionary,morphTargetInfluences:e.EyeRight.morphTargetInfluences}),e.Wolf3D_Head&&Oe.jsx("skinnedMesh",{name:"Wolf3D_Head",geometry:e.Wolf3D_Head.geometry,material:t.Wolf3D_Skin,skeleton:e.Wolf3D_Head.skeleton,morphTargetDictionary:e.Wolf3D_Head.morphTargetDictionary,morphTargetInfluences:e.Wolf3D_Head.morphTargetInfluences}),e.Wolf3D_Teeth&&Oe.jsx("skinnedMesh",{name:"Wolf3D_Teeth",geometry:e.Wolf3D_Teeth.geometry,material:t.Wolf3D_Teeth,skeleton:e.Wolf3D_Teeth.skeleton,morphTargetDictionary:e.Wolf3D_Teeth.morphTargetDictionary,morphTargetInfluences:e.Wolf3D_Teeth.morphTargetInfluences}),e.Wolf3D_Glasses&&Oe.jsx("skinnedMesh",{geometry:e.Wolf3D_Glasses.geometry,material:t.Wolf3D_Glasses,skeleton:e.Wolf3D_Glasses.skeleton}),e.Wolf3D_Headwear&&Oe.jsx("skinnedMesh",{geometry:e.Wolf3D_Headwear.geometry,material:t.Wolf3D_Headwear,skeleton:e.Wolf3D_Headwear.skeleton}),e.Wolf3D_Hair&&Oe.jsx("skinnedMesh",{geometry:e.Wolf3D_Hair.geometry,material:t.Wolf3D_Hair,skeleton:e.Wolf3D_Hair.skeleton}),e.Wolf3D_Beard&&Oe.jsx("skinnedMesh",{geometry:e.Wolf3D_Beard.geometry,material:t.Wolf3D_Beard,skeleton:e.Wolf3D_Beard.skeleton,morphTargetDictionary:e.Wolf3D_Beard.morphTargetDictionary,morphTargetInfluences:e.Wolf3D_Beard.morphTargetInfluences}),e.Wolf3D_Body&&Oe.jsx("skinnedMesh",{geometry:e.Wolf3D_Body.geometry,material:t.Wolf3D_Body,skeleton:e.Wolf3D_Body.skeleton}),e.Wolf3D_Outfit_Bottom&&Oe.jsx("skinnedMesh",{geometry:e.Wolf3D_Outfit_Bottom.geometry,material:t.Wolf3D_Outfit_Bottom,skeleton:e.Wolf3D_Outfit_Bottom.skeleton}),e.Wolf3D_Outfit_Footwear&&Oe.jsx("skinnedMesh",{geometry:e.Wolf3D_Outfit_Footwear.geometry,material:t.Wolf3D_Outfit_Footwear,skeleton:e.Wolf3D_Outfit_Footwear.skeleton}),e.Wolf3D_Outfit_Top&&Oe.jsx("skinnedMesh",{geometry:e.Wolf3D_Outfit_Top.geometry,material:t.Wolf3D_Outfit_Top,skeleton:e.Wolf3D_Outfit_Top.skeleton}),O&&Oe.jsx(hae,{position:[0,1.5,0],center:!0,children:Oe.jsxs("div",{style:{textAlign:"center"},children:[Oe.jsx("button",{onClick:C,style:{background:"rgba(255, 0, 0, 0.9)",color:"white",padding:"12px 24px",borderRadius:"24px",border:"2px solid white",cursor:"pointer",fontSize:"18px",fontWeight:"bold",pointerEvents:"auto",marginBottom:"10px",boxShadow:"0 4px 6px rgba(0,0,0,0.3)"},children:" Tap to Unmute / Play"}),Oe.jsx("div",{style:{background:"rgba(0,0,0,0.7)",color:"#ffaaaa",padding:"5px",borderRadius:"5px",fontSize:"12px"},children:b})]})})]})}Fd.preload("/models/avatar.glb");const gye=()=>{const n=D.useRef();return D.useEffect(()=>{n.current.setLookAt(0,2.2,5,0,1,0,!0)},[]),Oe.jsxs(Oe.Fragment,{children:[Oe.jsx(uce,{ref:n}),Oe.jsx(Ace,{preset:"sunset"}),Oe.jsx(mye,{})]})},yye=({hidden:n,...e})=>{const t=D.useRef(),{tts:r,loading:i,message:s,startRecording:o,stopRecording:a,recording:l}=I9(),{currentUser:c,logout:u}=Dx(),f=ey(),p=async()=>{try{await u(),f("/login")}catch(y){console.error("Failed to log out",y)}},m=()=>{const y=t.current.value,A=c?c.uid:"demo_user_123";!i&&!s&&(r(y,A),t.current.value="")};return n?null:Oe.jsxs("div",{className:"fixed top-0 left-0 right-0 bottom-0 z-10 flex justify-between p-4 flex-col pointer-events-none",children:[Oe.jsxs("div",{className:"self-start backdrop-blur-md bg-white bg-opacity-50 p-4 rounded-lg flex justify-between items-center w-full max-w-md pointer-events-auto",children:[Oe.jsxs("div",{children:[Oe.jsx("h1",{className:"font-black text-xl text-gray-700",children:c!=null&&c.displayName?`Hello, ${c.displayName} `:"Dr. HealBot "}),Oe.jsx("p",{className:"text-gray-600 text-sm",children:i?"Thinking...":"Your AI Medical Assistant"})]}),Oe.jsx("button",{onClick:p,className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm font-medium transition-colors",children:"Logout"})]}),Oe.jsx("div",{className:"w-full flex flex-col items-end justify-center gap-4"}),Oe.jsx("div",{className:"flex flex-col items-center gap-2 pointer-events-auto max-w-screen-sm w-full mx-auto",children:Oe.jsxs("div",{className:"flex items-center gap-2 w-full",children:[Oe.jsx("button",{onClick:l?a:o,className:`bg-gray-500 hover:bg-gray-600 text-white p-4 px-4 font-semibold uppercase rounded-md ${l?"bg-red-500 hover:bg-red-600":""} ${i||s?"cursor-not-allowed opacity-30":""}`,children:Oe.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:Oe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"})})}),Oe.jsx("input",{className:"w-full placeholder:text-gray-800 placeholder:italic p-4 rounded-md bg-opacity-50 bg-white backdrop-blur-md",placeholder:"Type a message...",ref:t,onKeyDown:y=>{y.key==="Enter"&&m()}}),Oe.jsx("button",{disabled:i||s,onClick:m,className:`bg-gray-500 hover:bg-gray-600 text-white p-4 px-10 font-semibold uppercase rounded-md ${i||s?"cursor-not-allowed opacity-30":""}`,children:"Send"})]})})]})};class vye extends ne.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Error caught by boundary:",e,t)}render(){var e;return this.state.hasError?Oe.jsxs("div",{style:{padding:"20px",color:"white",background:"#ff0000"},children:[Oe.jsx("h1",{children:"Something went wrong"}),Oe.jsx("p",{children:(e=this.state.error)==null?void 0:e.message}),Oe.jsx("button",{onClick:()=>window.location.reload(),children:"Reload Page"})]}):this.props.children}}function _ye(){return Oe.jsxs(vye,{children:[Oe.jsx(pae,{}),Oe.jsx(M9,{collapsed:!0,hidden:!0}),Oe.jsx(tae,{shadows:!0,camera:{position:[0,0,0],fov:10},style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:1},children:Oe.jsx(gye,{})}),Oe.jsx(yye,{})]})}function Eye(){const n=D.useRef(),e=D.useRef(),{login:t}=Dx(),[r,i]=D.useState(""),[s,o]=D.useState(!1),a=ey();async function l(c){c.preventDefault();try{i(""),o(!0),await t(n.current.value,e.current.value),a("/")}catch(u){console.error(u),i("Failed to log in: "+u.message)}o(!1)}return Oe.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 via-purple-900 to-violet-800",children:Oe.jsxs("div",{className:"w-full max-w-md p-8 space-y-8 bg-white/10 backdrop-blur-lg rounded-2xl shadow-2xl border border-white/20",children:[Oe.jsxs("div",{className:"text-center",children:[Oe.jsx("h2",{className:"mt-6 text-4xl font-extrabold text-white tracking-tight",children:"Welcome Back"}),Oe.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"Sign in to access your digital avatar"})]}),r&&Oe.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-100 px-4 py-3 rounded relative",role:"alert",children:Oe.jsx("span",{className:"block sm:inline",children:r})}),Oe.jsxs("form",{className:"mt-8 space-y-6",onSubmit:l,children:[Oe.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[Oe.jsxs("div",{className:"mb-4",children:[Oe.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),Oe.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,ref:n,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-600 placeholder-gray-400 text-white bg-gray-800/50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent focus:z-10 sm:text-sm transition-all duration-200",placeholder:"Email address"})]}),Oe.jsxs("div",{children:[Oe.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),Oe.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,ref:e,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-600 placeholder-gray-400 text-white bg-gray-800/50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent focus:z-10 sm:text-sm transition-all duration-200",placeholder:"Password"})]})]}),Oe.jsx("div",{children:Oe.jsxs("button",{type:"submit",disabled:s,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transform hover:scale-[1.02] transition-all duration-200 shadow-lg",children:[Oe.jsx("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:Oe.jsx("svg",{className:"h-5 w-5 text-purple-300 group-hover:text-purple-200 transition-colors",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:Oe.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})})}),"Sign in"]})})]}),Oe.jsx("div",{className:"text-center mt-4",children:Oe.jsxs("p",{className:"text-sm text-gray-300",children:["Don't have an account?"," ",Oe.jsx(gx,{to:"/signup",className:"font-medium text-purple-400 hover:text-purple-300 transition-colors",children:"Sign up"})]})})]})})}function xye(){const n=D.useRef(),e=D.useRef(),t=D.useRef(),r=D.useRef(),i=D.useRef(),{signup:s}=Dx(),[o,a]=D.useState(""),[l,c]=D.useState(!1),u=ey();async function f(p){if(p.preventDefault(),e.current.value!==t.current.value)return a("Passwords do not match");try{a(""),c(!0),await s(n.current.value,e.current.value,r.current.value,i.current.value),u("/")}catch(m){console.error(m),a("Failed to create an account: "+m.message)}c(!1)}return Oe.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 via-purple-900 to-violet-800",children:Oe.jsxs("div",{className:"w-full max-w-md p-8 space-y-8 bg-white/10 backdrop-blur-lg rounded-2xl shadow-2xl border border-white/20",children:[Oe.jsxs("div",{className:"text-center",children:[Oe.jsx("h2",{className:"mt-6 text-4xl font-extrabold text-white tracking-tight",children:"Create Account"}),Oe.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"Join the digital health revolution"})]}),o&&Oe.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-100 px-4 py-3 rounded relative",role:"alert",children:Oe.jsx("span",{className:"block sm:inline",children:o})}),Oe.jsxs("form",{className:"mt-8 space-y-6",onSubmit:f,children:[Oe.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[Oe.jsxs("div",{className:"mb-4",children:[Oe.jsx("label",{htmlFor:"name",className:"sr-only",children:"Full Name"}),Oe.jsx("input",{id:"name",name:"name",type:"text",autoComplete:"name",required:!0,ref:r,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-600 placeholder-gray-400 text-white bg-gray-800/50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent focus:z-10 sm:text-sm transition-all duration-200",placeholder:"Full Name"})]}),Oe.jsxs("div",{className:"mb-4",children:[Oe.jsx("label",{htmlFor:"username",className:"sr-only",children:"Username"}),Oe.jsx("input",{id:"username",name:"username",type:"text",autoComplete:"username",required:!0,ref:i,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-600 placeholder-gray-400 text-white bg-gray-800/50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent focus:z-10 sm:text-sm transition-all duration-200",placeholder:"Username"})]}),Oe.jsxs("div",{className:"mb-4",children:[Oe.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),Oe.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,ref:n,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-600 placeholder-gray-400 text-white bg-gray-800/50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent focus:z-10 sm:text-sm transition-all duration-200",placeholder:"Email address"})]}),Oe.jsxs("div",{className:"mb-4",children:[Oe.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),Oe.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,ref:e,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-600 placeholder-gray-400 text-white bg-gray-800/50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent focus:z-10 sm:text-sm transition-all duration-200",placeholder:"Password"})]}),Oe.jsxs("div",{children:[Oe.jsx("label",{htmlFor:"password-confirm",className:"sr-only",children:"Confirm Password"}),Oe.jsx("input",{id:"password-confirm",name:"password-confirm",type:"password",autoComplete:"new-password",required:!0,ref:t,className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-600 placeholder-gray-400 text-white bg-gray-800/50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent focus:z-10 sm:text-sm transition-all duration-200",placeholder:"Confirm Password"})]})]}),Oe.jsx("div",{children:Oe.jsxs("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transform hover:scale-[1.02] transition-all duration-200 shadow-lg",children:[Oe.jsx("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:Oe.jsx("svg",{className:"h-5 w-5 text-purple-300 group-hover:text-purple-200 transition-colors",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:Oe.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),"Sign Up"]})})]}),Oe.jsx("div",{className:"text-center mt-4",children:Oe.jsxs("p",{className:"text-sm text-gray-300",children:["Already have an account?"," ",Oe.jsx(gx,{to:"/login",className:"font-medium text-purple-400 hover:text-purple-300 transition-colors",children:"Log in"})]})})]})})}function Aye(){return Oe.jsx(qW,{children:Oe.jsx(xQ,{children:Oe.jsxs(bW,{children:[Oe.jsx(y_,{path:"/",element:Oe.jsx(AQ,{children:Oe.jsx(_ye,{})})}),Oe.jsx(y_,{path:"/signup",element:Oe.jsx(xye,{})}),Oe.jsx(y_,{path:"/login",element:Oe.jsx(Eye,{})})]})})})}dS.createRoot(document.getElementById("root")).render(Oe.jsx(ne.StrictMode,{children:Oe.jsx(pye,{children:Oe.jsx(Aye,{})})}));
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
